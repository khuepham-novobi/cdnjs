import _extends from"@babel/runtime/helpers/esm/extends";import _objectWithoutPropertiesLoose from"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose";import*as React from"react";import PropTypes from"prop-types";import{Transition}from"react-transition-group";import{elementAcceptingRef}from"@material-ui/utils";import debounce from"../utils/debounce";import useForkRef from"../utils/useForkRef";import useTheme from"../styles/useTheme";import{duration}from"../styles/transitions";import{reflow,getTransitionProps}from"../transitions/utils";import{ownerWindow}from"../utils";function getTranslateValue(e,t){const n=t.getBoundingClientRect(),r=ownerWindow(t);let o;if(t.fakeTransform)o=t.fakeTransform;else{const e=r.getComputedStyle(t);o=e.getPropertyValue("-webkit-transform")||e.getPropertyValue("transform")}let i=0,s=0;if(o&&"none"!==o&&"string"==typeof o){const e=o.split("(")[1].split(")")[0].split(",");i=parseInt(e[4],10),s=parseInt(e[5],10)}return"left"===e?`translateX(${r.innerWidth}px) translateX(${i-n.left}px)`:"right"===e?`translateX(-${n.left+n.width-i}px)`:"up"===e?`translateY(${r.innerHeight}px) translateY(${s-n.top}px)`:`translateY(-${n.top+n.height-s}px)`}export function setTranslateValue(e,t){const n=getTranslateValue(e,t);n&&(t.style.webkitTransform=n,t.style.transform=n)};const defaultTimeout={enter:duration.enteringScreen,exit:duration.leavingScreen},Slide=React.forwardRef(function(e,t){const{appear:n=!0,children:r,direction:o="down",in:i,onEnter:s,onEntered:a,onEntering:p,onExit:l,onExited:u,onExiting:c,style:f,timeout:m=defaultTimeout,TransitionComponent:d=Transition}=e,T=_objectWithoutPropertiesLoose(e,["appear","children","direction","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"]),y=useTheme(),g=React.useRef(null),x=useForkRef(r.ref,g),E=useForkRef(x,t),b=e=>t=>{e&&(void 0===t?e(g.current):e(g.current,t))},P=b((e,t)=>{setTranslateValue(o,e),reflow(e),s&&s(e,t)}),h=b((e,t)=>{const n=getTransitionProps({timeout:m,style:f},{mode:"enter"});e.style.webkitTransition=y.transitions.create("-webkit-transform",_extends({},n,{easing:y.transitions.easing.easeOut})),e.style.transition=y.transitions.create("transform",_extends({},n,{easing:y.transitions.easing.easeOut})),e.style.webkitTransform="none",e.style.transform="none",p&&p(e,t)}),w=b(a),R=b(c),k=b(e=>{const t=getTransitionProps({timeout:m,style:f},{mode:"exit"});e.style.webkitTransition=y.transitions.create("-webkit-transform",_extends({},t,{easing:y.transitions.easing.sharp})),e.style.transition=y.transitions.create("transform",_extends({},t,{easing:y.transitions.easing.sharp})),setTranslateValue(o,e),l&&l(e)}),_=b(e=>{e.style.webkitTransition="",e.style.transition="",u&&u(e)}),V=React.useCallback(()=>{g.current&&setTranslateValue(o,g.current)},[o]);return React.useEffect(()=>{if(i||"down"===o||"right"===o)return;const e=debounce(()=>{g.current&&setTranslateValue(o,g.current)}),t=ownerWindow(g.current);return t.addEventListener("resize",e),()=>{e.clear(),t.removeEventListener("resize",e)}},[o,i]),React.useEffect(()=>{i||V()},[i,V]),React.createElement(d,_extends({nodeRef:g,onEnter:P,onEntered:w,onEntering:h,onExit:k,onExited:_,onExiting:R,appear:n,in:i,timeout:m},T),(e,t)=>React.cloneElement(r,_extends({ref:E,style:_extends({visibility:"exited"!==e||i?void 0:"hidden"},f,r.props.style)},t)))});"production"!==process.env.NODE_ENV&&(Slide.propTypes={appear:PropTypes.bool,children:elementAcceptingRef,direction:PropTypes.oneOf(["down","left","right","up"]),in:PropTypes.bool,onEnter:PropTypes.func,onEntered:PropTypes.func,onEntering:PropTypes.func,onExit:PropTypes.func,onExited:PropTypes.func,onExiting:PropTypes.func,style:PropTypes.object,timeout:PropTypes.oneOfType([PropTypes.number,PropTypes.shape({appear:PropTypes.number,enter:PropTypes.number,exit:PropTypes.number})])});export default Slide;