"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_objectWithoutPropertiesLoose2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutPropertiesLoose")),_utils=require("@material-ui/utils"),React=_interopRequireWildcard(require("react")),_reactIs=require("react-is"),_propTypes=_interopRequireDefault(require("prop-types")),_clsx=_interopRequireDefault(require("clsx")),_ownerDocument=_interopRequireDefault(require("../utils/ownerDocument")),_capitalize=_interopRequireDefault(require("../utils/capitalize")),_Menu=_interopRequireDefault(require("../Menu/Menu")),_utils2=require("../InputBase/utils"),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_useControlled=_interopRequireDefault(require("../utils/useControlled"));function areEqualValues(e,t){return"object"==typeof t&&null!==t?e===t:String(e)===String(t)}function isEmpty(e){return null==e||"string"==typeof e&&!e.trim()}const SelectInput=React.forwardRef(function(e,t){const{"aria-describedby":r,"aria-label":a,autoFocus:l,autoWidth:o,children:n,classes:u,className:s,defaultValue:p,disabled:i,displayEmpty:d,IconComponent:c,inputRef:f,labelId:y,MenuProps:_={},multiple:b,name:m,onBlur:v,onChange:R,onClose:h,onFocus:T,onOpen:q,open:E,readOnly:g,renderValue:D,SelectDisplayProps:x={},tabIndex:I,value:C,variant:P="standard"}=e,O=(0,_objectWithoutPropertiesLoose2.default)(e,["aria-describedby","aria-label","autoFocus","autoWidth","children","classes","className","defaultValue","disabled","displayEmpty","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"]),[M,j]=(0,_useControlled.default)({controlled:C,default:p,name:"Select"}),w=React.useRef(null),S=React.useRef(null),[F,N]=React.useState(null),{current:V}=React.useRef(null!=E),[W,k]=React.useState(),[A,L]=React.useState(!1),$=(0,_useForkRef.default)(t,f),B=React.useCallback(e=>{S.current=e,e&&N(e)},[]);React.useImperativeHandle($,()=>({focus:()=>{S.current.focus()},node:w.current,value:M}),[M]),React.useEffect(()=>{l&&S.current.focus()},[l]),React.useEffect(()=>{const e=(0,_ownerDocument.default)(S.current).getElementById(y);if(e){const t=()=>{getSelection().isCollapsed&&S.current.focus()};return e.addEventListener("click",t),()=>{e.removeEventListener("click",t)}}},[y]);const U=(e,t)=>{e?q&&q(t):h&&h(t),V||(k(o?null:F.clientWidth),L(e))},K=React.Children.toArray(n),z=null!==F&&(V?E:A);let H,Y;delete O["aria-invalid"];const G=[];let J=!1,Q=!1;((0,_utils2.isFilled)({value:M})||d)&&(D?H=D(M):J=!0);const X=K.map(e=>{if(!React.isValidElement(e))return null;let t;if("production"!==process.env.NODE_ENV&&(0,_reactIs.isFragment)(e)&&console.error(["Material-UI: The Select component doesn't accept a Fragment as a child.","Consider providing an array instead."].join("\n")),b){if(!Array.isArray(M))throw new Error("production"!==process.env.NODE_ENV?"Material-UI: The `value` prop must be an array when using the `Select` component with `multiple`.":(0,_utils.formatMuiErrorMessage)(2));(t=M.some(t=>areEqualValues(t,e.props.value)))&&J&&G.push(e.props.children)}else(t=areEqualValues(M,e.props.value))&&J&&(Y=e.props.children);return t&&(Q=!0),React.cloneElement(e,{"aria-selected":t?"true":void 0,onClick:(e=>t=>{let r;if(b){r=Array.isArray(M)?M.slice():[];const t=M.indexOf(e.props.value);-1===t?r.push(e.props.value):r.splice(t,1)}else r=e.props.value;e.props.onClick&&e.props.onClick(t),M!==r&&(j(r),R&&(t.persist(),Object.defineProperty(t,"target",{writable:!0,value:{value:r,name:m}}),R(t,e))),b||U(!1,t)})(e),onKeyUp:t=>{" "===t.key&&t.preventDefault(),e.props.onKeyUp&&e.props.onKeyUp(t)},role:"option",selected:t,value:void 0,"data-value":e.props.value})});"production"!==process.env.NODE_ENV&&React.useEffect(()=>{if(!Q&&!b&&""!==M){const e=K.map(e=>e.props.value);console.warn([`Material-UI: You have provided an out-of-range value \`${M}\` for the select ${m?`(name="${m}") `:""}component.`,"Consider providing a value that matches one of the available options or ''.",`The available values are ${e.filter(e=>null!=e).map(e=>`\`${e}\``).join(", ")||'""'}.`].join("\n"))}},[Q,K,b,m,M]),J&&(H=b?G.join(", "):Y);let Z,ee=W;!o&&V&&F&&(ee=F.clientWidth),Z=void 0!==I?I:i?null:0;const te=x.id||(m?`mui-component-select-${m}`:void 0);return React.createElement(React.Fragment,null,React.createElement("div",(0,_extends2.default)({ref:B,tabIndex:Z,role:"button","aria-disabled":i?"true":void 0,"aria-expanded":z?"true":void 0,"aria-haspopup":"listbox","aria-label":a,"aria-labelledby":[y,te].filter(Boolean).join(" ")||void 0,"aria-describedby":r,onKeyDown:e=>{g||-1!==[" ","ArrowUp","ArrowDown","Enter"].indexOf(e.key)&&(e.preventDefault(),U(!0,e))},onMouseDown:i||g?null:e=>{0===e.button&&(e.preventDefault(),S.current.focus(),U(!0,e))},onBlur:e=>{!z&&v&&(e.persist(),Object.defineProperty(e,"target",{writable:!0,value:{value:M,name:m}}),v(e))},onFocus:T},x,{className:(0,_clsx.default)(u.root,u.select,u.selectMenu,u[P],s,x.className,i&&u.disabled),id:te}),isEmpty(H)?React.createElement("span",{dangerouslySetInnerHTML:{__html:"&#8203;"}}):H),React.createElement("input",(0,_extends2.default)({value:Array.isArray(M)?M.join(","):M,name:m,ref:w,"aria-hidden":!0,onChange:e=>{const t=K.map(e=>e.props.value).indexOf(e.target.value);if(-1===t)return;const r=K[t];j(r.props.value),R&&R(e,r)},tabIndex:-1,disabled:i,className:u.nativeInput,autoFocus:l},O)),React.createElement(c,{className:(0,_clsx.default)(u.icon,u[`icon${(0,_capitalize.default)(P)}`],z&&u.iconOpen,i&&u.disabled)}),React.createElement(_Menu.default,(0,_extends2.default)({id:`menu-${m||""}`,anchorEl:F,open:z,onClose:e=>{U(!1,e)}},_,{MenuListProps:(0,_extends2.default)({"aria-labelledby":y,role:"listbox",disableListWrap:!0},_.MenuListProps),PaperProps:(0,_extends2.default)({},_.PaperProps,{style:(0,_extends2.default)({minWidth:ee},null!=_.PaperProps?_.PaperProps.style:null)})}),X))});"production"!==process.env.NODE_ENV&&(SelectInput.propTypes={"aria-describedby":_propTypes.default.string,"aria-label":_propTypes.default.string,autoFocus:_propTypes.default.bool,autoWidth:_propTypes.default.bool,children:_propTypes.default.node,classes:_propTypes.default.object.isRequired,className:_propTypes.default.string,defaultValue:_propTypes.default.any,disabled:_propTypes.default.bool,displayEmpty:_propTypes.default.bool,IconComponent:_propTypes.default.elementType.isRequired,inputRef:_utils.refType,labelId:_propTypes.default.string,MenuProps:_propTypes.default.object,multiple:_propTypes.default.bool,name:_propTypes.default.string,onBlur:_propTypes.default.func,onChange:_propTypes.default.func,onClose:_propTypes.default.func,onFocus:_propTypes.default.func,onOpen:_propTypes.default.func,open:_propTypes.default.bool,readOnly:_propTypes.default.bool,renderValue:_propTypes.default.func,SelectDisplayProps:_propTypes.default.object,tabIndex:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),type:_propTypes.default.any,value:_propTypes.default.any,variant:_propTypes.default.oneOf(["standard","outlined","filled"])});var _default=SelectInput;exports.default=_default;