"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.styles=void 0;var _objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),_extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),React=_interopRequireWildcard(require("react")),ReactDOM=_interopRequireWildcard(require("react-dom")),_propTypes=_interopRequireDefault(require("prop-types")),_styles=require("@material-ui/styles"),_utils=require("@material-ui/utils"),_ownerDocument=_interopRequireDefault(require("../utils/ownerDocument")),_Portal=_interopRequireDefault(require("../Portal")),_createChainedFunction=_interopRequireDefault(require("../utils/createChainedFunction")),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_useEventCallback=_interopRequireDefault(require("../utils/useEventCallback")),_zIndex=_interopRequireDefault(require("../styles/zIndex")),_ModalManager=_interopRequireWildcard(require("./ModalManager")),_Unstable_TrapFocus=_interopRequireDefault(require("../Unstable_TrapFocus")),_SimpleBackdrop=_interopRequireDefault(require("./SimpleBackdrop"));function getContainer(e){return e="function"==typeof e?e():e,ReactDOM.findDOMNode(e)}function getHasTransition(e){return!!e.children&&e.children.props.hasOwnProperty("in")}var defaultManager=new _ModalManager.default,styles=function(e){return{root:{position:"fixed",zIndex:e.zIndex.modal,right:0,bottom:0,top:0,left:0},hidden:{visibility:"hidden"}}};exports.styles=styles;var Modal=React.forwardRef(function(e,o){function t(){return(0,_ownerDocument.default)(B.current)}function r(){return g.current.modalRef=P.current,g.current.mountNode=B.current,g.current}function n(){E.mount(r(),{disableScrollLock:v}),P.current.scrollTop=0}var a=(0,_styles.useTheme)(),i=(0,_styles.getThemeProps)({name:"MuiModal",props:(0,_extends2.default)({},e),theme:a}),l=i.BackdropComponent,u=void 0===l?_SimpleBackdrop.default:l,d=i.BackdropProps,s=i.children,p=i.closeAfterTransition,c=void 0!==p&&p,f=i.container,_=i.disableAutoFocus,b=void 0!==_&&_,R=i.disableBackdropClick,y=void 0!==R&&R,k=i.disableEnforceFocus,T=void 0!==k&&k,m=i.disableEscapeKeyDown,q=void 0!==m&&m,e=i.disablePortal,l=void 0!==e&&e,p=i.disableRestoreFocus,_=void 0!==p&&p,R=i.disableScrollLock,v=void 0!==R&&R,k=i.hideBackdrop,m=void 0!==k&&k,e=i.keepMounted,p=void 0!==e&&e,R=i.manager,E=void 0===R?defaultManager:R,D=i.onBackdropClick,h=i.onClose,C=i.onEscapeKeyDown,M=i.onRendered,x=i.open,k=(0,_objectWithoutProperties2.default)(i,["BackdropComponent","BackdropProps","children","closeAfterTransition","container","disableAutoFocus","disableBackdropClick","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","manager","onBackdropClick","onClose","onEscapeKeyDown","onRendered","open"]),e=React.useState(!0),R=e[0],F=e[1],g=React.useRef({}),B=React.useRef(null),P=React.useRef(null),o=(0,_useForkRef.default)(P,o),w=getHasTransition(i),I=(0,_useEventCallback.default)(function(){var e=getContainer(f)||t().body;E.add(r(),e),P.current&&n()}),A=React.useCallback(function(){return E.isTopModal(r())},[E]),i=(0,_useEventCallback.default)(function(e){(B.current=e)&&(M&&M(),x&&A()?n():(0,_ModalManager.ariaHidden)(P.current,!0))}),K=React.useCallback(function(){E.remove(r())},[E]);if(React.useEffect(function(){return function(){K()}},[K]),React.useEffect(function(){x?I():w&&c||K()},[x,K,w,c,I]),!p&&!x&&(!w||R))return null;p=styles(a||{zIndex:_zIndex.default}),a={};return void 0===s.props.tabIndex&&(a.tabIndex=s.props.tabIndex||"-1"),w&&(a.onEnter=(0,_createChainedFunction.default)(function(){F(!1)},s.props.onEnter),a.onExited=(0,_createChainedFunction.default)(function(){F(!0),c&&K()},s.props.onExited)),React.createElement(_Portal.default,{ref:i,container:f,disablePortal:l},React.createElement("div",(0,_extends2.default)({ref:o,onKeyDown:function(e){"Escape"===e.key&&A()&&(C&&C(e),q||(e.stopPropagation(),h&&h(e,"escapeKeyDown")))},role:"presentation"},k,{style:(0,_extends2.default)({},p.root,!x&&R?p.hidden:{},k.style)}),m?null:React.createElement(u,(0,_extends2.default)({open:x,onClick:function(e){e.target===e.currentTarget&&(D&&D(e),!y&&h&&h(e,"backdropClick"))}},d)),React.createElement(_Unstable_TrapFocus.default,{disableEnforceFocus:T,disableAutoFocus:b,disableRestoreFocus:_,getDoc:t,isEnabled:A,open:x},React.cloneElement(s,a))))});"production"!==process.env.NODE_ENV&&(Modal.propTypes={BackdropComponent:_propTypes.default.elementType,BackdropProps:_propTypes.default.object,children:_utils.elementAcceptingRef.isRequired,closeAfterTransition:_propTypes.default.bool,container:_propTypes.default.oneOfType([_utils.HTMLElementType,_propTypes.default.instanceOf(React.Component),_propTypes.default.func]),disableAutoFocus:_propTypes.default.bool,disableBackdropClick:_propTypes.default.bool,disableEnforceFocus:_propTypes.default.bool,disableEscapeKeyDown:_propTypes.default.bool,disablePortal:_propTypes.default.bool,disableRestoreFocus:_propTypes.default.bool,disableScrollLock:_propTypes.default.bool,hideBackdrop:_propTypes.default.bool,keepMounted:_propTypes.default.bool,manager:_propTypes.default.object,onBackdropClick:_propTypes.default.func,onClose:_propTypes.default.func,onEscapeKeyDown:_propTypes.default.func,onRendered:_propTypes.default.func,open:_propTypes.default.bool.isRequired});var _default=Modal;exports.default=Modal;