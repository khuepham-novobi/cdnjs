"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),React=_interopRequireWildcard(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_debounce=_interopRequireDefault(require("../utils/debounce")),_useForkRef=_interopRequireDefault(require("../utils/useForkRef"));function getStyleValue(e,t){return parseInt(e[t],10)||0}var useEnhancedEffect="undefined"!=typeof window?React.useLayoutEffect:React.useEffect,styles={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}},TextareaAutosize=React.forwardRef(function(s,e){var t=s.onChange,r=s.rows,i=s.rowsMax,a=s.rowsMin,o=void 0===a?1:a,u=s.style,n=s.value,a=(0,_objectWithoutProperties2.default)(s,["onChange","rows","rowsMax","rowsMin","style","value"]),p=r||o,l=React.useRef(null!=n).current,d=React.useRef(null),r=(0,_useForkRef.default)(e,d),f=React.useRef(null),c=React.useRef(0),o=React.useState({}),e=o[0],y=o[1],h=React.useCallback(function(){var e=d.current,t=window.getComputedStyle(e),r=f.current;r.style.width=t.width,r.value=e.value||s.placeholder||"x","\n"===r.value.slice(-1)&&(r.value+=" ");var a=t["box-sizing"],o=getStyleValue(t,"padding-bottom")+getStyleValue(t,"padding-top"),u=getStyleValue(t,"border-bottom-width")+getStyleValue(t,"border-top-width"),e=r.scrollHeight-o;r.value="x";t=r.scrollHeight-o,r=e;p&&(r=Math.max(Number(p)*t,r)),i&&(r=Math.min(Number(i)*t,r));var n=(r=Math.max(r,t))+("border-box"===a?o+u:0),l=Math.abs(r-e)<=1;y(function(e){return c.current<20&&(0<n&&1<Math.abs((e.outerHeightStyle||0)-n)||e.overflow!==l)?(c.current+=1,{overflow:l,outerHeightStyle:n}):("production"!==process.env.NODE_ENV&&20===c.current&&console.error(["Material-UI: Too many re-renders. The layout is unstable.","TextareaAutosize limits the number of renders to prevent an infinite loop."].join("\n")),e)})},[i,p,s.placeholder]);React.useEffect(function(){var e=(0,_debounce.default)(function(){c.current=0,h()});return window.addEventListener("resize",e),function(){e.clear(),window.removeEventListener("resize",e)}},[h]),useEnhancedEffect(function(){h()}),React.useEffect(function(){c.current=0},[n]);return React.createElement(React.Fragment,null,React.createElement("textarea",(0,_extends2.default)({value:n,onChange:function(e){c.current=0,l||h(),t&&t(e)},ref:r,rows:p,style:(0,_extends2.default)({height:e.outerHeightStyle,overflow:e.overflow?"hidden":null},u)},a)),React.createElement("textarea",{"aria-hidden":!0,className:s.className,readOnly:!0,ref:f,tabIndex:-1,style:(0,_extends2.default)({},styles.shadow,u)}))});"production"!==process.env.NODE_ENV&&(TextareaAutosize.propTypes={className:_propTypes.default.string,onChange:_propTypes.default.func,placeholder:_propTypes.default.string,rows:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),rowsMax:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),rowsMin:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),style:_propTypes.default.object,value:_propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.string),_propTypes.default.number,_propTypes.default.string])});var _default=TextareaAutosize;exports.default=TextareaAutosize;