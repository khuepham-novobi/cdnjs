import _extends from"@babel/runtime/helpers/esm/extends";import _objectWithoutPropertiesLoose from"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose";import*as React from"react";import PropTypes from"prop-types";import*as ReactDOM from"react-dom";import debounce from"../utils/debounce";import{Transition}from"react-transition-group";import{elementAcceptingRef}from"@material-ui/utils";import useForkRef from"../utils/useForkRef";import useTheme from"../styles/useTheme";import{duration}from"../styles/transitions";import{reflow,getTransitionProps}from"../transitions/utils";function getTranslateValue(e,t){const n=t.getBoundingClientRect();let r;if(t.fakeTransform)r=t.fakeTransform;else{const e=window.getComputedStyle(t);r=e.getPropertyValue("-webkit-transform")||e.getPropertyValue("transform")}let o=0,i=0;if(r&&"none"!==r&&"string"==typeof r){const e=r.split("(")[1].split(")")[0].split(",");o=parseInt(e[4],10),i=parseInt(e[5],10)}return"left"===e?`translateX(${window.innerWidth}px) translateX(${o-n.left}px)`:"right"===e?`translateX(-${n.left+n.width-o}px)`:"up"===e?`translateY(${window.innerHeight}px) translateY(${i-n.top}px)`:`translateY(-${n.top+n.height-i}px)`}export function setTranslateValue(e,t){const n=getTranslateValue(e,t);n&&(t.style.webkitTransform=n,t.style.transform=n)};const defaultTimeout={enter:duration.enteringScreen,exit:duration.leavingScreen},Slide=React.forwardRef(function(e,t){const{children:n,direction:r="down",in:o,onEnter:i,onEntered:s,onEntering:a,onExit:p,onExited:l,onExiting:u,style:c,timeout:f=defaultTimeout,TransitionComponent:m=Transition}=e,d=_objectWithoutPropertiesLoose(e,["children","direction","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"]),T=useTheme(),y=React.useRef(null),g=React.useCallback(e=>{y.current=ReactDOM.findDOMNode(e)},[]),x=useForkRef(n.ref,g),E=useForkRef(x,t),b=e=>t=>{e&&(void 0===t?e(y.current):e(y.current,t))},w=b((e,t)=>{setTranslateValue(r,e),reflow(e),i&&i(e,t)}),P=b((e,t)=>{const n=getTransitionProps({timeout:f,style:c},{mode:"enter"});e.style.webkitTransition=T.transitions.create("-webkit-transform",_extends({},n,{easing:T.transitions.easing.easeOut})),e.style.transition=T.transitions.create("transform",_extends({},n,{easing:T.transitions.easing.easeOut})),e.style.webkitTransform="none",e.style.transform="none",a&&a(e,t)}),h=b(s),R=b(u),k=b(e=>{const t=getTransitionProps({timeout:f,style:c},{mode:"exit"});e.style.webkitTransition=T.transitions.create("-webkit-transform",_extends({},t,{easing:T.transitions.easing.sharp})),e.style.transition=T.transitions.create("transform",_extends({},t,{easing:T.transitions.easing.sharp})),setTranslateValue(r,e),p&&p(e)}),_=b(e=>{e.style.webkitTransition="",e.style.transition="",l&&l(e)}),V=React.useCallback(()=>{y.current&&setTranslateValue(r,y.current)},[r]);return React.useEffect(()=>{if(o||"down"===r||"right"===r)return;const e=debounce(()=>{y.current&&setTranslateValue(r,y.current)});return window.addEventListener("resize",e),()=>{e.clear(),window.removeEventListener("resize",e)}},[r,o]),React.useEffect(()=>{o||V()},[o,V]),React.createElement(m,_extends({nodeRef:y,onEnter:w,onEntered:h,onEntering:P,onExit:k,onExited:_,onExiting:R,appear:!0,in:o,timeout:f},d),(e,t)=>React.cloneElement(n,_extends({ref:E,style:_extends({visibility:"exited"!==e||o?void 0:"hidden"},c,n.props.style)},t)))});"production"!==process.env.NODE_ENV&&(Slide.propTypes={children:elementAcceptingRef,direction:PropTypes.oneOf(["down","left","right","up"]),in:PropTypes.bool,onEnter:PropTypes.func,onEntered:PropTypes.func,onEntering:PropTypes.func,onExit:PropTypes.func,onExited:PropTypes.func,onExiting:PropTypes.func,style:PropTypes.object,timeout:PropTypes.oneOfType([PropTypes.number,PropTypes.shape({appear:PropTypes.number,enter:PropTypes.number,exit:PropTypes.number})])});export default Slide;