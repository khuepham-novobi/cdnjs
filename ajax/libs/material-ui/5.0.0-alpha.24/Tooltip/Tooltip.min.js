import _extends from"@babel/runtime/helpers/esm/extends";import _objectWithoutPropertiesLoose from"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose";import*as React from"react";import PropTypes from"prop-types";import clsx from"clsx";import{elementAcceptingRef}from"@material-ui/utils";import{alpha}from"../styles/colorManipulator";import withStyles from"../styles/withStyles";import capitalize from"../utils/capitalize";import Grow from"../Grow";import Popper from"../Popper";import useEventCallback from"../utils/useEventCallback";import useForkRef from"../utils/useForkRef";import useId from"../utils/useId";import useIsFocusVisible from"../utils/useIsFocusVisible";import useControlled from"../utils/useControlled";import useTheme from"../styles/useTheme";function round(e){return Math.round(1e5*e)/1e5}function arrowGenerator(){return{'&[data-popper-placement*="bottom"] $arrow':{top:0,left:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},'&[data-popper-placement*="top"] $arrow':{bottom:0,left:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},'&[data-popper-placement*="right"] $arrow':{left:0,marginLeft:"-0.71em",height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},'&[data-popper-placement*="left"] $arrow':{right:0,marginRight:"-0.71em",height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}}export const styles=e=>({popper:{zIndex:e.zIndex.tooltip,pointerEvents:"none"},popperInteractive:{pointerEvents:"auto"},popperArrow:arrowGenerator(),tooltip:{backgroundColor:alpha(e.palette.grey[700],.92),borderRadius:e.shape.borderRadius,color:e.palette.common.white,fontFamily:e.typography.fontFamily,padding:"4px 8px",fontSize:e.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:e.typography.fontWeightMedium},tooltipArrow:{position:"relative",margin:0},arrow:{overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:alpha(e.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}},touch:{padding:"8px 16px",fontSize:e.typography.pxToRem(14),lineHeight:`${round(16/14)}em`,fontWeight:e.typography.fontWeightRegular},tooltipPlacementLeft:{transformOrigin:"right center",marginRight:"24px",[e.breakpoints.up("sm")]:{marginRight:"14px"}},tooltipPlacementRight:{transformOrigin:"left center",marginLeft:"24px",[e.breakpoints.up("sm")]:{marginLeft:"14px"}},tooltipPlacementTop:{transformOrigin:"center bottom",marginBottom:"24px",[e.breakpoints.up("sm")]:{marginBottom:"14px"}},tooltipPlacementBottom:{transformOrigin:"center top",marginTop:"24px",[e.breakpoints.up("sm")]:{marginTop:"14px"}}});let hystersisOpen=!1,hystersisTimer=null;export function testReset(){hystersisOpen=!1,clearTimeout(hystersisTimer)};function composeEventHandler(e,t){return o=>{t&&t(o),e(o)}}const Tooltip=React.forwardRef(function(e,t){const{arrow:o=!1,children:r,classes:n,describeChild:s=!1,disableFocusListener:i=!1,disableHoverListener:p=!1,disableTouchListener:a=!1,enterDelay:l=100,enterNextDelay:c=0,enterTouchDelay:u=700,followCursor:m=!1,id:d,disableInteractive:h=!1,leaveDelay:f=0,leaveTouchDelay:y=1500,onClose:T,onOpen:b,open:g,placement:R="bottom",PopperComponent:v=Popper,PopperProps:P={},title:w,TransitionComponent:x=Grow,TransitionProps:E}=e,O=_objectWithoutPropertiesLoose(e,["arrow","children","classes","describeChild","disableFocusListener","disableHoverListener","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","followCursor","id","disableInteractive","leaveDelay","leaveTouchDelay","onClose","onOpen","open","placement","PopperComponent","PopperProps","title","TransitionComponent","TransitionProps"]),C=useTheme(),[k,L]=React.useState(),[M,D]=React.useState(null),F=React.useRef(!1),N=h||m,S=React.useRef(),I=React.useRef(),W=React.useRef(),_=React.useRef(),[A,B]=useControlled({controlled:g,default:!1,name:"Tooltip",state:"open"});let j=A;if("production"!==process.env.NODE_ENV){const{current:e}=React.useRef(void 0!==g);React.useEffect(()=>{k&&k.disabled&&!e&&""!==w&&"button"===k.tagName.toLowerCase()&&console.error(["Material-UI: You are providing a disabled `button` child to the Tooltip component.","A disabled element does not fire events.","Tooltip needs to listen to the child element's events to display the title.","","Add a simple wrapper element, such as a `span`."].join("\n"))},[w,k,e])}const H=useId(d),z=React.useRef(),V=React.useCallback(()=>{void 0!==z.current&&(document.body.style.WebkitUserSelect=z.current,z.current=void 0),clearTimeout(_.current)},[]);React.useEffect(()=>()=>{clearTimeout(S.current),clearTimeout(I.current),clearTimeout(W.current),V()},[V]);const U=e=>{clearTimeout(hystersisTimer),hystersisOpen=!0,B(!0),b&&!j&&b(e)},$=useEventCallback(e=>{clearTimeout(hystersisTimer),hystersisTimer=setTimeout(()=>{hystersisOpen=!1},800+f),B(!1),T&&j&&T(e),clearTimeout(S.current),S.current=setTimeout(()=>{F.current=!1},C.transitions.duration.shortest)}),G=e=>{F.current&&"touchstart"!==e.type||(k&&k.removeAttribute("title"),clearTimeout(I.current),clearTimeout(W.current),l||hystersisOpen&&c?(e.persist(),I.current=setTimeout(()=>{U(e)},hystersisOpen?c:l)):U(e))},Y=e=>{clearTimeout(I.current),clearTimeout(W.current),e.persist(),W.current=setTimeout(()=>{$(e)},f)},{isFocusVisibleRef:q,onBlur:X,onFocus:J,ref:K}=useIsFocusVisible(),[,Q]=React.useState(!1),Z=e=>{X(e),!1===q.current&&(Q(!1),Y(e))},ee=e=>{k||L(e.currentTarget),J(e),!0===q.current&&(Q(!0),G(e))},te=e=>{F.current=!0;const t=r.props;t.onTouchStart&&t.onTouchStart(e)},oe=G,re=Y,ne=e=>{te(e),clearTimeout(W.current),clearTimeout(S.current),V(),e.persist(),z.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",_.current=setTimeout(()=>{document.body.style.WebkitUserSelect=z.current,G(e)},u)},se=e=>{r.props.onTouchEnd&&r.props.onTouchEnd(e),clearTimeout(_.current),clearTimeout(W.current),e.persist(),W.current=setTimeout(()=>{$(e)},y)};React.useEffect(()=>{if(j)return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)};function e(e){"Escape"!==e.key&&"Esc"!==e.key||$(e)}},[$,j]);const ie=useForkRef(L,t),pe=useForkRef(K,ie),ae=useForkRef(r.ref,pe);""===w&&(j=!1);const le=React.useRef({x:0,y:0}),ce=React.useRef(),ue={},me="string"==typeof w;s?(ue.title=j||!me||p?null:w,ue["aria-describedby"]=j?H:null):(ue["aria-label"]=me?w:null,ue["aria-labelledby"]=j&&!me?H:null);const de=_extends({},ue,O,r.props,{className:clsx(O.className,r.props.className),onTouchStart:te,ref:ae},m?{onMouseMove:e=>{const t=r.props;t.onMouseMove&&t.onMouseMove(e),le.current={x:e.clientX,y:e.clientY},ce.current&&ce.current.update()}}:{});"production"!==process.env.NODE_ENV&&(de["data-mui-internal-clone-element"]=!0,React.useEffect(()=>{k&&!k.getAttribute("data-mui-internal-clone-element")&&console.error(["Material-UI: The `children` component of the Tooltip is not forwarding its props correctly.","Please make sure that props are spread on the same element that the ref is applied to."].join("\n"))},[k]));const he={};a||(de.onTouchStart=ne,de.onTouchEnd=se),p||(de.onMouseOver=composeEventHandler(oe,de.onMouseOver),de.onMouseLeave=composeEventHandler(re,de.onMouseLeave),N||(he.onMouseOver=oe,he.onMouseLeave=re)),i||(de.onFocus=composeEventHandler(ee,de.onFocus),de.onBlur=composeEventHandler(Z,de.onBlur),N||(he.onFocus=ee,he.onBlur=Z)),"production"!==process.env.NODE_ENV&&r.props.title&&console.error(["Material-UI: You have provided a `title` prop to the child of <Tooltip />.",`Remove this title prop \`${r.props.title}\` or the Tooltip component.`].join("\n"));const fe=React.useMemo(()=>{var e;let t=[{name:"arrow",enabled:Boolean(M),options:{element:M,padding:4}}];return null!==(e=P.popperOptions)&&void 0!==e&&e.modifiers&&(t=t.concat(P.popperOptions.modifiers)),_extends({},P.popperOptions,{modifiers:t})},[M,P]);return React.createElement(React.Fragment,null,React.cloneElement(r,de),React.createElement(v,_extends({className:clsx(n.popper,!N&&n.popperInteractive,o&&n.popperArrow),placement:R,anchorEl:m?{getBoundingClientRect:()=>({top:le.current.y,left:le.current.x,right:le.current.x,bottom:le.current.y,width:0,height:0})}:k,popperRef:ce,open:!!k&&j,id:H,transition:!0},he,P,{popperOptions:fe}),({placement:e,TransitionProps:t})=>React.createElement(x,_extends({timeout:C.transitions.duration.shorter},t,E),React.createElement("div",{className:clsx(n.tooltip,n[`tooltipPlacement${capitalize(e.split("-")[0])}`],F.current&&n.touch,o&&n.tooltipArrow)},w,o?React.createElement("span",{className:n.arrow,ref:D}):null))))});"production"!==process.env.NODE_ENV&&(Tooltip.propTypes={arrow:PropTypes.bool,children:elementAcceptingRef.isRequired,classes:PropTypes.object,className:PropTypes.string,describeChild:PropTypes.bool,disableFocusListener:PropTypes.bool,disableHoverListener:PropTypes.bool,disableInteractive:PropTypes.bool,disableTouchListener:PropTypes.bool,enterDelay:PropTypes.number,enterNextDelay:PropTypes.number,enterTouchDelay:PropTypes.number,followCursor:PropTypes.bool,id:PropTypes.string,leaveDelay:PropTypes.number,leaveTouchDelay:PropTypes.number,onClose:PropTypes.func,onOpen:PropTypes.func,open:PropTypes.bool,placement:PropTypes.oneOf(["bottom-end","bottom-start","bottom","left-end","left-start","left","right-end","right-start","right","top-end","top-start","top"]),PopperComponent:PropTypes.elementType,PopperProps:PropTypes.object,title:PropTypes.node.isRequired,TransitionComponent:PropTypes.elementType,TransitionProps:PropTypes.object});export default withStyles(styles,{name:"MuiTooltip",flip:!1})(Tooltip);