import _extends from"@babel/runtime/helpers/esm/extends";import _slicedToArray from"@babel/runtime/helpers/esm/slicedToArray";import _objectWithoutProperties from"@babel/runtime/helpers/esm/objectWithoutProperties";import*as React from"react";import{isFragment}from"react-is";import PropTypes from"prop-types";import clsx from"clsx";import{duration}from"../styles/transitions";import withStyles from"../styles/withStyles";import Zoom from"../Zoom";import Fab from"../Fab";import capitalize from"../utils/capitalize";import isMuiElement from"../utils/isMuiElement";import useForkRef from"../utils/useForkRef";import useControlled from"../utils/useControlled";function getOrientation(e){return"up"===e||"down"===e?"vertical":"right"===e||"left"===e?"horizontal":void 0}function clamp(e,o,n){return e<o?o:e>n?n:e}var dialRadius=32,spacingActions=16;export var styles=function(e){return{root:{zIndex:e.zIndex.speedDial,display:"flex",alignItems:"center",pointerEvents:"none"},fab:{pointerEvents:"auto"},directionUp:{flexDirection:"column-reverse","& $actions":{flexDirection:"column-reverse",marginBottom:-dialRadius,paddingBottom:spacingActions+dialRadius}},directionDown:{flexDirection:"column","& $actions":{flexDirection:"column",marginTop:-dialRadius,paddingTop:spacingActions+dialRadius}},directionLeft:{flexDirection:"row-reverse","& $actions":{flexDirection:"row-reverse",marginRight:-dialRadius,paddingRight:spacingActions+dialRadius}},directionRight:{flexDirection:"row","& $actions":{flexDirection:"row",marginLeft:-dialRadius,paddingLeft:spacingActions+dialRadius}},actions:{display:"flex",pointerEvents:"auto"},actionsClosed:{transition:"top 0s linear 0.2s",pointerEvents:"none"}}};var SpeedDial=React.forwardRef(function(e,o){var n=e.ariaLabel,t=e.FabProps,r=(t=void 0===t?{}:t).ref,i=_objectWithoutProperties(t,["ref"]),a=e.children,s=e.classes,c=e.className,p=e.direction,u=void 0===p?"up":p,l=e.hidden,d=void 0!==l&&l,m=e.icon,f=e.onBlur,y=e.onClose,T=e.onFocus,v=e.onKeyDown,g=e.onMouseEnter,P=e.onMouseLeave,R=e.onOpen,b=e.open,h=(e.openIcon,e.TransitionComponent),x=void 0===h?Zoom:h,D=e.transitionDuration,E=void 0===D?{enter:duration.enteringScreen,exit:duration.leavingScreen}:D,w=e.TransitionProps,C=_objectWithoutProperties(e,["ariaLabel","FabProps","children","classes","className","direction","hidden","icon","onBlur","onClose","onFocus","onKeyDown","onMouseEnter","onMouseLeave","onOpen","open","openIcon","TransitionComponent","transitionDuration","TransitionProps"]),F=useControlled({controlled:b,default:!1,name:"SpeedDial",state:"open"}),M=_slicedToArray(F,2),O=M[0],_=M[1],L=React.useRef();React.useEffect(function(){return function(){clearTimeout(L.current)}},[]);var S=React.useRef(0),N=React.useRef(),A=React.useRef([]);A.current=[A.current[0]];var j=React.useCallback(function(e){A.current[0]=e},[]),k=useForkRef(r,j);React.useEffect(function(){O||(S.current=0,N.current=void 0)},[O]);var I=function(e){"mouseleave"===e.type&&P&&P(e),"blur"===e.type&&f&&f(e),clearTimeout(L.current),"blur"===e.type?(e.persist(),L.current=setTimeout(function(){_(!1),y&&y(e,"blur")})):(_(!1),y&&y(e,"mouseLeave"))},z=function(e){"mouseenter"===e.type&&g&&g(e),"focus"===e.type&&T&&T(e),clearTimeout(L.current),O||(e.persist(),L.current=setTimeout(function(){if(_(!0),R){R(e,{focus:"focus",mouseenter:"mouseEnter"}[e.type])}}))},B=n.replace(/^[^a-z]+|[^\w:.-]+/gi,""),K=React.Children.toArray(a).filter(function(e){return"production"!==process.env.NODE_ENV&&isFragment(e)&&console.error(["Material-UI: The SpeedDial component doesn't accept a Fragment as a child.","Consider providing an array instead."].join("\n")),React.isValidElement(e)}),W=K.map(function(e,o){var n=e.props.FabProps,t=(n=void 0===n?{}:n).ref,r=_objectWithoutProperties(n,["ref"]);return React.cloneElement(e,{FabProps:_extends({},r,{ref:function(e,o){return function(n){A.current[e+1]=n,o&&o(n)}}(o,t)}),delay:30*(O?o:K.length-o),open:O,id:"".concat(B,"-action-").concat(o)})});return React.createElement("div",_extends({className:clsx(s.root,s["direction".concat(capitalize(u))],c),ref:o,role:"presentation",onKeyDown:function(e){v&&v(e);var o=e.key.replace("Arrow","").toLowerCase(),n=N.current,t=void 0===n?o:n;if("Escape"===e.key)return _(!1),void(y&&(A.current[0].focus(),y(e,"escapeKeyDown")));if(getOrientation(o)===getOrientation(t)&&void 0!==getOrientation(o)){e.preventDefault();var r=o===t?1:-1,i=clamp(S.current+r,0,A.current.length-1);A.current[i].focus(),S.current=i,N.current=t}},onBlur:I,onFocus:z,onMouseEnter:z,onMouseLeave:I},C),React.createElement(x,_extends({in:!d,timeout:E,unmountOnExit:!0},w),React.createElement(Fab,_extends({color:"primary","aria-label":n,"aria-haspopup":"true","aria-expanded":O,"aria-controls":"".concat(B,"-actions")},i,{onClick:function(e){i.onClick&&i.onClick(e),clearTimeout(L.current),O?(_(!1),y&&y(e,"toggle")):(_(!0),R&&R(e,"toggle"))},className:clsx(s.fab,i.className),ref:k}),React.isValidElement(m)&&isMuiElement(m,["SpeedDialIcon"])?React.cloneElement(m,{open:O}):m)),React.createElement("div",{id:"".concat(B,"-actions"),role:"menu","aria-orientation":getOrientation(u),className:clsx(s.actions,!O&&s.actionsClosed)},W))});"production"!==process.env.NODE_ENV&&(SpeedDial.propTypes={ariaLabel:PropTypes.string.isRequired,children:PropTypes.node,classes:PropTypes.object,className:PropTypes.string,direction:PropTypes.oneOf(["down","left","right","up"]),FabProps:PropTypes.object,hidden:PropTypes.bool,icon:PropTypes.node,onBlur:PropTypes.func,onClose:PropTypes.func,onFocus:PropTypes.func,onKeyDown:PropTypes.func,onMouseEnter:PropTypes.func,onMouseLeave:PropTypes.func,onOpen:PropTypes.func,open:PropTypes.bool,openIcon:PropTypes.node,TransitionComponent:PropTypes.elementType,transitionDuration:PropTypes.oneOfType([PropTypes.number,PropTypes.shape({appear:PropTypes.number,enter:PropTypes.number,exit:PropTypes.number})]),TransitionProps:PropTypes.object});export default withStyles(styles,{name:"MuiSpeedDial"})(SpeedDial);