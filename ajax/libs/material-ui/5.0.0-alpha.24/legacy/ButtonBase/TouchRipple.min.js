import _extends from"@babel/runtime/helpers/esm/extends";import _toConsumableArray from"@babel/runtime/helpers/esm/toConsumableArray";import _objectWithoutProperties from"@babel/runtime/helpers/esm/objectWithoutProperties";import _taggedTemplateLiteral from"@babel/runtime/helpers/esm/taggedTemplateLiteral";function _templateObject4(){var e=_taggedTemplateLiteral(["\n  opacity: 0;\n  position: absolute;\n\n  &."," {\n    opacity: 0.3;\n    transform: scale(1);\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  &."," {\n    animation-duration: ","ms;\n  }\n\n  & ."," {\n    opacity: 1;\n    display: block;\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    background-color: currentColor;\n  }\n\n  & ."," {\n    opacity: 0;\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  & ."," {\n    position: absolute;\n    left: 0;\n    top: 0;\n    animation-name: ",";\n    animation-duration: 2500ms;\n    animation-timing-function: ",";\n    animation-iteration-count: infinite;\n    animation-delay: 200ms;\n  }\n"]);return _templateObject4=function(){return e},e}function _templateObject3(){var e=_taggedTemplateLiteral(["\n0% {\n  transform: scale(1);\n}\n50% {\n  transform: scale(0.92);\n}\n100% {\n  transform: scale(1);\n}\n"]);return _templateObject3=function(){return e},e}function _templateObject2(){var e=_taggedTemplateLiteral(["\n0% {\n  opacity: 1;\n}\n100% {\n  opacity: 0;\n}\n"]);return _templateObject2=function(){return e},e}function _templateObject(){var e=_taggedTemplateLiteral(["\n0% {\n  transform: scale(0);\n  opacity: 0.1;\n}\n100% {\n  transform: scale(1);\n  opacity: 0.3;\n}\n"]);return _templateObject=function(){return e},e}import*as React from"react";import PropTypes from"prop-types";import{TransitionGroup}from"react-transition-group";import clsx from"clsx";import{keyframes}from"@material-ui/styled-engine";import experimentalStyled,{shouldForwardProp as _shouldForwardProp}from"../styles/experimentalStyled";import useThemeProps from"../styles/useThemeProps";import Ripple from"./Ripple";import touchRippleClasses from"./touchRippleClasses";var DURATION=550;export var DELAY_RIPPLE=80;var enterKeyframe=keyframes(_templateObject()),exitKeyframe=keyframes(_templateObject2()),pulsateKeyframe=keyframes(_templateObject3());export var TouchRippleRoot=experimentalStyled("span",{},{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"});export var TouchRippleRipple=experimentalStyled(Ripple,{shouldForwardProp:function(e){return _shouldForwardProp(e)||"classes"===e}},{name:"MuiTouchRipple",slot:"Ripple"})(_templateObject4(),touchRippleClasses.rippleVisible,enterKeyframe,DURATION,function(e){return e.theme.transitions.easing.easeInOut},touchRippleClasses.ripplePulsate,function(e){return e.theme.transitions.duration.shorter},touchRippleClasses.child,touchRippleClasses.childLeaving,exitKeyframe,DURATION,function(e){return e.theme.transitions.easing.easeInOut},touchRippleClasses.childPulsate,pulsateKeyframe,function(e){return e.theme.transitions.easing.easeInOut});var TouchRipple=React.forwardRef(function(e,t){var n=useThemeProps({props:e,name:"MuiTouchRipple"}),r=n.center,i=void 0!==r&&r,a=n.classes,l=void 0===a?{}:a,o=n.className,s=_objectWithoutProperties(n,["center","classes","className"]),p=React.useState([]),c=p[0],u=p[1],m=React.useRef(0),h=React.useRef(null);React.useEffect(function(){h.current&&(h.current(),h.current=null)},[c]);var f=React.useRef(!1),d=React.useRef(null),R=React.useRef(null),b=React.useRef(null);React.useEffect(function(){return function(){clearTimeout(d.current)}},[]);var y=React.useCallback(function(e){var t=e.pulsate,n=e.rippleX,r=e.rippleY,i=e.rippleSize,a=e.cb;u(function(e){return[].concat(_toConsumableArray(e),[React.createElement(TouchRippleRipple,{key:m.current,classes:{ripple:clsx(l.ripple,touchRippleClasses.ripple),rippleVisible:clsx(l.rippleVisible,touchRippleClasses.rippleVisible),ripplePulsate:clsx(l.ripplePulsate,touchRippleClasses.ripplePulsate),child:clsx(l.child,touchRippleClasses.child),childLeaving:clsx(l.childLeaving,touchRippleClasses.childLeaving),childPulsate:clsx(l.childPulsate,touchRippleClasses.childPulsate)},timeout:DURATION,pulsate:t,rippleX:n,rippleY:r,rippleSize:i})])}),m.current+=1,h.current=a},[l]),g=React.useCallback(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=t.pulsate,a=void 0!==r&&r,l=t.center,o=void 0===l?i||t.pulsate:l,s=t.fakeElement,p=void 0!==s&&s;if("mousedown"===e.type&&f.current)f.current=!1;else{"touchstart"===e.type&&(f.current=!0);var c,u,m,h=p?null:b.current,g=h?h.getBoundingClientRect():{width:0,height:0,left:0,top:0};if(o||0===e.clientX&&0===e.clientY||!e.clientX&&!e.touches)c=Math.round(g.width/2),u=Math.round(g.height/2);else{var v=e.touches?e.touches[0]:e,T=v.clientX,_=v.clientY;c=Math.round(T-g.left),u=Math.round(_-g.top)}if(o)(m=Math.sqrt((2*Math.pow(g.width,2)+Math.pow(g.height,2))/3))%2==0&&(m+=1);else{var x=2*Math.max(Math.abs((h?h.clientWidth:0)-c),c)+2,P=2*Math.max(Math.abs((h?h.clientHeight:0)-u),u)+2;m=Math.sqrt(Math.pow(x,2)+Math.pow(P,2))}e.touches?null===R.current&&(R.current=function(){y({pulsate:a,rippleX:c,rippleY:u,rippleSize:m,cb:n})},d.current=setTimeout(function(){R.current&&(R.current(),R.current=null)},DELAY_RIPPLE)):y({pulsate:a,rippleX:c,rippleY:u,rippleSize:m,cb:n})}},[i,y]),v=React.useCallback(function(){g({},{pulsate:!0})},[g]),T=React.useCallback(function(e,t){if(clearTimeout(d.current),"touchend"===e.type&&R.current)return e.persist(),R.current(),R.current=null,void(d.current=setTimeout(function(){T(e,t)}));R.current=null,u(function(e){return e.length>0?e.slice(1):e}),h.current=t},[]);return React.useImperativeHandle(t,function(){return{pulsate:v,start:g,stop:T}},[v,g,T]),React.createElement(TouchRippleRoot,_extends({className:clsx(l.root,touchRippleClasses.root,o),ref:b},s),React.createElement(TransitionGroup,{component:null,exit:!0},c))});"production"!==process.env.NODE_ENV&&(TouchRipple.propTypes={center:PropTypes.bool,classes:PropTypes.object,className:PropTypes.string});export default TouchRipple;