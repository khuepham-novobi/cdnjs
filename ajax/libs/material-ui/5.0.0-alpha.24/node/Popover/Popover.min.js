"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.getOffsetTop=getOffsetTop,exports.getOffsetLeft=getOffsetLeft,exports.default=exports.styles=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_objectWithoutPropertiesLoose2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutPropertiesLoose")),React=_interopRequireWildcard(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_utils=require("@material-ui/utils"),_clsx=_interopRequireDefault(require("clsx")),_debounce=_interopRequireDefault(require("../utils/debounce")),_ownerDocument=_interopRequireDefault(require("../utils/ownerDocument")),_ownerWindow=_interopRequireDefault(require("../utils/ownerWindow")),_withStyles=_interopRequireDefault(require("../styles/withStyles")),_Modal=_interopRequireDefault(require("../Modal")),_Grow=_interopRequireDefault(require("../Grow")),_Paper=_interopRequireDefault(require("../Paper"));function getOffsetTop(e,t){let o=0;return"number"==typeof t?o=t:"center"===t?o=e.height/2:"bottom"===t&&(o=e.height),o}function getOffsetLeft(e,t){let o=0;return"number"==typeof t?o=t:"center"===t?o=e.width/2:"right"===t&&(o=e.width),o}function getTransformOriginValue(e){return[e.horizontal,e.vertical].map(e=>"number"==typeof e?`${e}px`:e).join(" ")}function getScrollParent(e,t){let o=t,r=0;for(;o&&o!==e;)r+=(o=o.parentElement).scrollTop;return r}function getAnchorEl(e){return"function"==typeof e?e():e}const styles={root:{},paper:{position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}};exports.styles=styles;const Popover=React.forwardRef(function(e,t){const{action:o,anchorEl:r,anchorOrigin:n={vertical:"top",horizontal:"left"},anchorPosition:i,anchorReference:a="anchorEl",children:p,classes:l,className:s,container:u,elevation:c=8,getContentAnchorEl:f,marginThreshold:d=16,open:h,PaperProps:_={},transformOrigin:m={vertical:"top",horizontal:"left"},TransitionComponent:T=_Grow.default,transitionDuration:y="auto",TransitionProps:{onEntering:g}={}}=e,v=(0,_objectWithoutPropertiesLoose2.default)(e.TransitionProps,["onEntering"]),b=(0,_objectWithoutPropertiesLoose2.default)(e,["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","classes","className","container","elevation","getContentAnchorEl","marginThreshold","open","PaperProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps"]),E=React.useRef(),R=React.useCallback(e=>{if("anchorPosition"===a)return"production"!==process.env.NODE_ENV&&(i||console.error('Material-UI: You need to provide a `anchorPosition` prop when using <Popover anchorReference="anchorPosition" />.')),i;const t=getAnchorEl(r),o=t&&1===t.nodeType?t:(0,_ownerDocument.default)(E.current).body,p=o.getBoundingClientRect();if("production"!==process.env.NODE_ENV){const e=o.getBoundingClientRect();"test"!==process.env.NODE_ENV&&0===e.top&&0===e.left&&0===e.right&&0===e.bottom&&console.warn(["Material-UI: The `anchorEl` prop provided to the component is invalid.","The anchor element should be part of the document layout.","Make sure the element is present in the document or that it's not display none."].join("\n"))}const l=0===e?n.vertical:"center";return{top:p.top+getOffsetTop(p,l),left:p.left+getOffsetLeft(p,n.horizontal)}},[r,n.horizontal,n.vertical,i,a]),O=React.useCallback(e=>{let t=0;if(f&&"anchorEl"===a){const o=f(e);if(o&&e.contains(o)){const r=getScrollParent(e,o);t=o.offsetTop+o.clientHeight/2-r||0}"production"!==process.env.NODE_ENV&&"top"!==n.vertical&&console.error(["Material-UI: You can not change the default `anchorOrigin.vertical` value ","when also providing the `getContentAnchorEl` prop to the popover component.","Only use one of the two props.","Set `getContentAnchorEl` to `null | undefined` or leave `anchorOrigin.vertical` unchanged."].join("\n"))}return t},[n.vertical,a,f]),q=React.useCallback((e,t=0)=>({vertical:getOffsetTop(e,m.vertical)+t,horizontal:getOffsetLeft(e,m.horizontal)}),[m.horizontal,m.vertical]),P=React.useCallback(e=>{const t=O(e),o={width:e.offsetWidth,height:e.offsetHeight},n=q(o,t);if("none"===a)return{top:null,left:null,transformOrigin:getTransformOriginValue(n)};const i=R(t);let p=i.top-n.vertical,l=i.left-n.horizontal;const s=p+o.height,u=l+o.width,c=(0,_ownerWindow.default)(getAnchorEl(r)),f=c.innerHeight-d,h=c.innerWidth-d;if(p<d){const e=p-d;p-=e,n.vertical+=e}else if(s>f){const e=s-f;p-=e,n.vertical+=e}if("production"!==process.env.NODE_ENV&&o.height>f&&o.height&&f&&console.error(["Material-UI: The popover component is too tall.",`Some part of it can not be seen on the screen (${o.height-f}px).`,"Please consider adding a `max-height` to improve the user-experience."].join("\n")),l<d){const e=l-d;l-=e,n.horizontal+=e}else if(u>h){const e=u-h;l-=e,n.horizontal+=e}return{top:`${Math.round(p)}px`,left:`${Math.round(l)}px`,transformOrigin:getTransformOriginValue(n)}},[r,a,R,O,q,d]),w=React.useCallback(()=>{const e=E.current;if(!e)return;const t=P(e);null!==t.top&&(e.style.top=t.top),null!==t.left&&(e.style.left=t.left),e.style.transformOrigin=t.transformOrigin},[P]);React.useEffect(()=>{h&&w()}),React.useImperativeHandle(o,()=>h?{updatePosition:()=>{w()}}:null,[h,w]),React.useEffect(()=>{if(!h)return;const e=(0,_debounce.default)(()=>{w()}),t=(0,_ownerWindow.default)(r);return t.addEventListener("resize",e),()=>{e.clear(),t.removeEventListener("resize",e)}},[r,h,w]);let x=y;"auto"!==y||T.muiSupportAuto||(x=void 0);const D=u||(r?(0,_ownerDocument.default)(getAnchorEl(r)).body:void 0);return React.createElement(_Modal.default,(0,_extends2.default)({container:D,open:h,ref:t,BackdropProps:{invisible:!0},className:(0,_clsx.default)(l.root,s)},b),React.createElement(T,(0,_extends2.default)({appear:!0,in:h,timeout:x,onEntering:(e,t)=>{g&&g(e,t),w()}},v),React.createElement(_Paper.default,(0,_extends2.default)({elevation:c,ref:E},_,{className:(0,_clsx.default)(l.paper,_.className)}),p)))});"production"!==process.env.NODE_ENV&&(Popover.propTypes={action:_utils.refType,anchorEl:(0,_utils.chainPropTypes)(_propTypes.default.oneOfType([_utils.HTMLElementType,_propTypes.default.func]),e=>{if(e.open&&(!e.anchorReference||"anchorEl"===e.anchorReference)){const t=getAnchorEl(e.anchorEl);if(!t||1!==t.nodeType)return new Error(["Material-UI: The `anchorEl` prop provided to the component is invalid.",`It should be an Element instance but it's \`${t}\` instead.`].join("\n"));{const e=t.getBoundingClientRect();if("test"!==process.env.NODE_ENV&&0===e.top&&0===e.left&&0===e.right&&0===e.bottom)return new Error(["Material-UI: The `anchorEl` prop provided to the component is invalid.","The anchor element should be part of the document layout.","Make sure the element is present in the document or that it's not display none."].join("\n"))}}return null}),anchorOrigin:_propTypes.default.shape({horizontal:_propTypes.default.oneOfType([_propTypes.default.oneOf(["center","left","right"]),_propTypes.default.number]).isRequired,vertical:_propTypes.default.oneOfType([_propTypes.default.oneOf(["bottom","center","top"]),_propTypes.default.number]).isRequired}),anchorPosition:_propTypes.default.shape({left:_propTypes.default.number.isRequired,top:_propTypes.default.number.isRequired}),anchorReference:_propTypes.default.oneOf(["anchorEl","anchorPosition","none"]),children:_propTypes.default.node,classes:_propTypes.default.object,className:_propTypes.default.string,container:_propTypes.default.oneOfType([_utils.HTMLElementType,_propTypes.default.func]),elevation:_propTypes.default.number,getContentAnchorEl:_propTypes.default.func,marginThreshold:_propTypes.default.number,onClose:_propTypes.default.func,open:_propTypes.default.bool.isRequired,PaperProps:_propTypes.default.shape({component:_utils.elementTypeAcceptingRef}),transformOrigin:_propTypes.default.shape({horizontal:_propTypes.default.oneOfType([_propTypes.default.oneOf(["center","left","right"]),_propTypes.default.number]).isRequired,vertical:_propTypes.default.oneOfType([_propTypes.default.oneOf(["bottom","center","top"]),_propTypes.default.number]).isRequired}),TransitionComponent:_propTypes.default.elementType,transitionDuration:_propTypes.default.oneOfType([_propTypes.default.oneOf(["auto"]),_propTypes.default.number,_propTypes.default.shape({appear:_propTypes.default.number,enter:_propTypes.default.number,exit:_propTypes.default.number})]),TransitionProps:_propTypes.default.object});var _default=(0,_withStyles.default)(styles,{name:"MuiPopover"})(Popover);exports.default=_default;