"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_objectWithoutPropertiesLoose2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutPropertiesLoose")),React=_interopRequireWildcard(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_core=require("@popperjs/core"),_utils=require("@material-ui/utils"),_styles=require("@material-ui/styles"),_Portal=_interopRequireDefault(require("../Portal")),_setRef=_interopRequireDefault(require("../utils/setRef")),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_useEnhancedEffect=_interopRequireDefault(require("../utils/useEnhancedEffect"));function flipPlacement(e,t){if("ltr"===(t&&t.direction||"ltr"))return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}function getAnchorEl(e){return"function"==typeof e?e():e}const defaultPopperOptions={},Popper=React.forwardRef(function(e,t){const{anchorEl:r,children:o,container:n,disablePortal:p=!1,keepMounted:a=!1,modifiers:l,open:s,placement:u="bottom",popperOptions:i=defaultPopperOptions,popperRef:f,style:d,transition:c=!1}=e,_=(0,_objectWithoutPropertiesLoose2.default)(e,["anchorEl","children","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition"]),y=React.useRef(null),m=(0,_useForkRef.default)(y,t),h=React.useRef(null),T=(0,_useForkRef.default)(h,f),b=React.useRef(T);(0,_useEnhancedEffect.default)(()=>{b.current=T},[T]),React.useImperativeHandle(f,()=>h.current,[]);const[R,E]=React.useState(!0),q=flipPlacement(u,(0,_styles.useTheme)()),[g,v]=React.useState(q);React.useEffect(()=>{h.current&&h.current.forceUpdate()});const O=React.useCallback(()=>{if(!y.current||!r||!s)return;h.current&&(h.current.destroy(),b.current(null));const e=getAnchorEl(r);if("production"!==process.env.NODE_ENV&&e&&1===e.nodeType){const t=e.getBoundingClientRect();"test"!==process.env.NODE_ENV&&0===t.top&&0===t.left&&0===t.right&&0===t.bottom&&console.warn(["Material-UI: The `anchorEl` prop provided to the component is invalid.","The anchor element should be part of the document layout.","Make sure the element is present in the document or that it's not display none."].join("\n"))}let t=[{name:"preventOverflow",options:{altBoundary:p}},{name:"flip",options:{altBoundary:p}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:e})=>{(e=>{v(e.placement)})(e)}}];null!=l&&(t=t.concat(l)),i&&null!=i.modifiers&&(t=t.concat(i.modifiers));const o=(0,_core.createPopper)(getAnchorEl(r),y.current,(0,_extends2.default)({placement:q},i,{modifiers:t}));b.current(o)},[r,p,l,s,q,i]),P=React.useCallback(e=>{(0,_setRef.default)(m,e),O()},[m,O]),x=()=>{E(!1)},M=()=>{h.current&&(h.current.destroy(),b.current(null))},j=()=>{E(!0),M()};if(React.useEffect(()=>()=>{M()},[]),React.useEffect(()=>{s||c||M()},[s,c]),!a&&!s&&(!c||R))return null;const D={placement:g};return c&&(D.TransitionProps={in:s,onEnter:x,onExited:j}),React.createElement(_Portal.default,{disablePortal:p,container:n},React.createElement("div",(0,_extends2.default)({ref:P,role:"tooltip"},_,{style:(0,_extends2.default)({position:"fixed",top:0,left:0,display:s||!a||c?null:"none"},d)}),"function"==typeof o?o(D):o))});"production"!==process.env.NODE_ENV&&(Popper.propTypes={anchorEl:(0,_utils.chainPropTypes)(_propTypes.default.oneOfType([_utils.HTMLElementType,_propTypes.default.object,_propTypes.default.func]),e=>{if(e.open){const t=getAnchorEl(e.anchorEl);if(t&&1===t.nodeType){const e=t.getBoundingClientRect();if("test"!==process.env.NODE_ENV&&0===e.top&&0===e.left&&0===e.right&&0===e.bottom)return new Error(["Material-UI: The `anchorEl` prop provided to the component is invalid.","The anchor element should be part of the document layout.","Make sure the element is present in the document or that it's not display none."].join("\n"))}else if(!t||"function"!=typeof t.getBoundingClientRect||null!=t.contextElement&&1!==t.contextElement.nodeType)return new Error(["Material-UI: The `anchorEl` prop provided to the component is invalid.","It should be an HTML element instance or a virtualElement ","(https://popper.js.org/docs/v2/virtual-elements/)."].join("\n"))}return null}),children:_propTypes.default.oneOfType([_propTypes.default.node,_propTypes.default.func]),container:_propTypes.default.oneOfType([_utils.HTMLElementType,_propTypes.default.func]),disablePortal:_propTypes.default.bool,keepMounted:_propTypes.default.bool,modifiers:_propTypes.default.arrayOf(_propTypes.default.shape({data:_propTypes.default.object,effect:_propTypes.default.func,enabled:_propTypes.default.bool,fn:_propTypes.default.func,name:_propTypes.default.any.isRequired,options:_propTypes.default.object,phase:_propTypes.default.oneOf(["afterMain","afterRead","afterWrite","beforeMain","beforeRead","beforeWrite","main","read","write"]),requires:_propTypes.default.arrayOf(_propTypes.default.string),requiresIfExists:_propTypes.default.arrayOf(_propTypes.default.string)})),open:_propTypes.default.bool.isRequired,placement:_propTypes.default.oneOf(["auto-end","auto-start","auto","bottom-end","bottom-start","bottom","left-end","left-start","left","right-end","right-start","right","top-end","top-start","top"]),popperOptions:_propTypes.default.shape({modifiers:_propTypes.default.array,onFirstUpdate:_propTypes.default.func,placement:_propTypes.default.oneOf(["auto-end","auto-start","auto","bottom-end","bottom-start","bottom","left-end","left-start","left","right-end","right-start","right","top-end","top-start","top"]),strategy:_propTypes.default.oneOf(["absolute","fixed"])}),popperRef:_utils.refType,style:_propTypes.default.object,transition:_propTypes.default.bool});var _default=Popper;exports.default=_default;