"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.styles=void 0;var _objectWithoutPropertiesLoose2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutPropertiesLoose")),_extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),React=_interopRequireWildcard(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_styles=require("@material-ui/styles"),_utils=require("@material-ui/utils"),_ownerDocument=_interopRequireDefault(require("../utils/ownerDocument")),_Portal=_interopRequireDefault(require("../Portal")),_createChainedFunction=_interopRequireDefault(require("../utils/createChainedFunction")),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_useEventCallback=_interopRequireDefault(require("../utils/useEventCallback")),_zIndex=_interopRequireDefault(require("../styles/zIndex")),_ModalManager=_interopRequireWildcard(require("./ModalManager")),_Unstable_TrapFocus=_interopRequireDefault(require("../Unstable_TrapFocus")),_SimpleBackdrop=_interopRequireDefault(require("./SimpleBackdrop"));function getContainer(e){return"function"==typeof e?e():e}function getHasTransition(e){return!!e.children&&e.children.props.hasOwnProperty("in")}const defaultManager=new _ModalManager.default,styles=e=>({root:{position:"fixed",zIndex:e.zIndex.modal,right:0,bottom:0,top:0,left:0},hidden:{visibility:"hidden"}});exports.styles=styles;const Modal=React.forwardRef(function(e,t){const o=(0,_styles.useTheme)(),r=(0,_styles.getThemeProps)({name:"MuiModal",props:(0,_extends2.default)({},e),theme:o}),{BackdropComponent:a=_SimpleBackdrop.default,BackdropProps:l,children:n,closeAfterTransition:u=!1,container:s,disableAutoFocus:i=!1,disableEnforceFocus:p=!1,disableEscapeKeyDown:d=!1,disablePortal:c=!1,disableRestoreFocus:f=!1,disableScrollLock:_=!1,hideBackdrop:b=!1,keepMounted:y=!1,manager:R=defaultManager,onBackdropClick:k,onClose:T,onKeyDown:q,open:m}=r,h=(0,_objectWithoutPropertiesLoose2.default)(r,["BackdropComponent","BackdropProps","children","closeAfterTransition","container","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","manager","onBackdropClick","onClose","onKeyDown","open"]),[E,D]=React.useState(!0),x=React.useRef({}),C=React.useRef(null),F=React.useRef(null),M=(0,_useForkRef.default)(F,t),g=getHasTransition(r),P=()=>(0,_ownerDocument.default)(C.current),B=()=>(x.current.modalRef=F.current,x.current.mountNode=C.current,x.current),v=()=>{R.mount(B(),{disableScrollLock:_}),F.current.scrollTop=0},w=(0,_useEventCallback.default)(()=>{const e=getContainer(s)||P().body;R.add(B(),e),F.current&&v()}),I=React.useCallback(()=>R.isTopModal(B()),[R]),A=(0,_useEventCallback.default)(e=>{C.current=e,e&&(m&&I()?v():(0,_ModalManager.ariaHidden)(F.current,!0))}),K=React.useCallback(()=>{R.remove(B())},[R]);if(React.useEffect(()=>()=>{K()},[K]),React.useEffect(()=>{m?w():g&&u||K()},[m,K,g,u,w]),!y&&!m&&(!g||E))return null;const L=()=>{D(!1)},S=()=>{D(!0),u&&K()},W=styles(o||{zIndex:_zIndex.default}),j={};return void 0===n.props.tabIndex&&(j.tabIndex=n.props.tabIndex||"-1"),g&&(j.onEnter=(0,_createChainedFunction.default)(L,n.props.onEnter),j.onExited=(0,_createChainedFunction.default)(S,n.props.onExited)),React.createElement(_Portal.default,{ref:A,container:s,disablePortal:c},React.createElement("div",(0,_extends2.default)({ref:M,onKeyDown:e=>{q&&q(e),"Escape"===e.key&&I()&&(d||(e.stopPropagation(),T&&T(e,"escapeKeyDown")))},role:"presentation"},h,{style:(0,_extends2.default)({},W.root,!m&&E?W.hidden:{},h.style)}),b?null:React.createElement(a,(0,_extends2.default)({open:m,onClick:e=>{e.target===e.currentTarget&&(k&&k(e),T&&T(e,"backdropClick"))}},l)),React.createElement(_Unstable_TrapFocus.default,{disableEnforceFocus:p,disableAutoFocus:i,disableRestoreFocus:f,getDoc:P,isEnabled:I,open:m},React.cloneElement(n,j))))});"production"!==process.env.NODE_ENV&&(Modal.propTypes={BackdropComponent:_propTypes.default.elementType,BackdropProps:_propTypes.default.object,children:_utils.elementAcceptingRef.isRequired,closeAfterTransition:_propTypes.default.bool,container:_propTypes.default.oneOfType([_utils.HTMLElementType,_propTypes.default.func]),disableAutoFocus:_propTypes.default.bool,disableEnforceFocus:_propTypes.default.bool,disableEscapeKeyDown:_propTypes.default.bool,disablePortal:_propTypes.default.bool,disableRestoreFocus:_propTypes.default.bool,disableScrollLock:_propTypes.default.bool,hideBackdrop:_propTypes.default.bool,keepMounted:_propTypes.default.bool,onBackdropClick:_propTypes.default.func,onClose:_propTypes.default.func,onKeyDown:_propTypes.default.func,open:_propTypes.default.bool.isRequired,style:_propTypes.default.object});var _default=Modal;exports.default=_default;