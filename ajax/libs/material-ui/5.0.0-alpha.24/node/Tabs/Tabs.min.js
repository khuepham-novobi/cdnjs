"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.styles=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_objectWithoutPropertiesLoose2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutPropertiesLoose")),React=_interopRequireWildcard(require("react")),_reactIs=require("react-is"),_propTypes=_interopRequireDefault(require("prop-types")),_clsx=_interopRequireDefault(require("clsx")),_utils=require("@material-ui/utils"),_debounce=_interopRequireDefault(require("../utils/debounce")),_ownerWindow=_interopRequireDefault(require("../utils/ownerWindow")),_scrollLeft=require("../utils/scrollLeft"),_animate=_interopRequireDefault(require("../internal/animate")),_ScrollbarSize=_interopRequireDefault(require("./ScrollbarSize")),_withStyles=_interopRequireDefault(require("../styles/withStyles")),_TabIndicator=_interopRequireDefault(require("./TabIndicator")),_TabScrollButton=_interopRequireDefault(require("../TabScrollButton")),_useEventCallback=_interopRequireDefault(require("../utils/useEventCallback")),_useTheme=_interopRequireDefault(require("../styles/useTheme"));const styles=e=>({root:{overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex"},vertical:{flexDirection:"column"},flexContainer:{display:"flex"},flexContainerVertical:{flexDirection:"column"},centered:{justifyContent:"center"},scroller:{position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap"},fixed:{overflowX:"hidden",width:"100%"},scrollableX:{overflowX:"auto",overflowY:"hidden"},scrollableY:{overflowY:"auto",overflowX:"hidden"},hideScrollbar:{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}},scrollButtons:{},scrollButtonsHideMobile:{[e.breakpoints.down("sm")]:{display:"none"}},indicator:{}});exports.styles=styles;const Tabs=React.forwardRef(function(e,t){const{"aria-label":l,"aria-labelledby":r,action:o,centered:a=!1,children:n,classes:i,className:s,component:c="div",allowScrollButtonsMobile:u=!1,indicatorColor:d="secondary",onChange:p,orientation:f="horizontal",ScrollButtonComponent:b=_TabScrollButton.default,scrollButtons:h="auto",selectionFollowsFocus:_,TabIndicatorProps:m={},TabScrollButtonProps:v,textColor:y="inherit",value:T,variant:R="standard",visibleScrollbar:w=!1}=e,S=(0,_objectWithoutPropertiesLoose2.default)(e,["aria-label","aria-labelledby","action","centered","children","classes","className","component","allowScrollButtonsMobile","indicatorColor","onChange","orientation","ScrollButtonComponent","scrollButtons","selectionFollowsFocus","TabIndicatorProps","TabScrollButtonProps","textColor","value","variant","visibleScrollbar"]),g=(0,_useTheme.default)(),x="scrollable"===R,q="rtl"===g.direction,C="vertical"===f,E=C?"scrollTop":"scrollLeft",B=C?"top":"left",N=C?"bottom":"right",W=C?"clientHeight":"clientWidth",D=C?"height":"width";"production"!==process.env.NODE_ENV&&a&&x&&console.error('Material-UI: You can not use the `centered={true}` and `variant="scrollable"` properties at the same time on a `Tabs` component.');const[L,M]=React.useState(!1),[k,I]=React.useState({}),[z,j]=React.useState({start:!1,end:!1}),[O,F]=React.useState({overflow:"hidden",scrollbarWidth:0}),P=new Map,A=React.useRef(null),H=React.useRef(null),V=()=>{const e=A.current;let t,l;if(e){const l=e.getBoundingClientRect();t={clientWidth:e.clientWidth,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop,scrollLeftNormalized:(0,_scrollLeft.getNormalizedScrollLeft)(e,g.direction),scrollWidth:e.scrollWidth,top:l.top,bottom:l.bottom,left:l.left,right:l.right}}if(e&&!1!==T){const e=H.current.children;if(e.length>0){const t=e[P.get(T)];"production"!==process.env.NODE_ENV&&(t||console.error(["Material-UI: The value provided to the Tabs component is invalid.",`None of the Tabs' children match with \`${T}\`.`,P.keys?`You can provide one of the following values: ${Array.from(P.keys()).join(", ")}.`:null].join("\n"))),l=t?t.getBoundingClientRect():null}}return{tabsMeta:t,tabMeta:l}},X=(0,_useEventCallback.default)(()=>{const{tabsMeta:e,tabMeta:t}=V();let l=0;if(t&&e)if(C)l=t.top-e.top+e.scrollTop;else{const r=q?e.scrollLeftNormalized+e.clientWidth-e.scrollWidth:e.scrollLeft;l=t.left-e.left+r}const r={[B]:l,[D]:t?t[D]:0};if(isNaN(k[B])||isNaN(k[D]))I(r);else{const e=Math.abs(k[B]-r[B]),t=Math.abs(k[D]-r[D]);(e>=1||t>=1)&&I(r)}}),Y=e=>{(0,_animate.default)(E,A.current,e)},U=e=>{let t=A.current[E];C?t+=e:(t+=e*(q?-1:1),t*=q&&"reverse"===(0,_scrollLeft.detectScrollType)()?-1:1),Y(t)},$=()=>{const e=A.current[W];let t=0;const l=Array.from(H.current.children);for(let r=0;r<l.length;r+=1){const o=l[r];if(t+o[W]>e)break;t+=o[W]}return t},K=()=>{U(-1*$())},G=()=>{U($())},J=React.useCallback(e=>{F({overflow:null,scrollbarWidth:e})},[]),Q=(0,_useEventCallback.default)(()=>{const{tabsMeta:e,tabMeta:t}=V();if(t&&e)if(t[B]<e[B]){const l=e[E]+(t[B]-e[B]);Y(l)}else if(t[N]>e[N]){const l=e[E]+(t[N]-e[N]);Y(l)}}),Z=(0,_useEventCallback.default)(()=>{if(x&&!1!==h){const{scrollTop:e,scrollHeight:t,clientHeight:l,scrollWidth:r,clientWidth:o}=A.current;let a,n;if(C)a=e>1,n=e<t-l-1;else{const e=(0,_scrollLeft.getNormalizedScrollLeft)(A.current,g.direction);a=q?e<r-o-1:e>1,n=q?e>1:e<r-o-1}a===z.start&&n===z.end||j({start:a,end:n})}});React.useEffect(()=>{const e=(0,_debounce.default)(()=>{X(),Z()}),t=(0,_ownerWindow.default)(A.current);return t.addEventListener("resize",e),()=>{e.clear(),t.removeEventListener("resize",e)}},[X,Z]);const ee=React.useMemo(()=>(0,_debounce.default)(()=>{Z()}),[Z]);React.useEffect(()=>()=>{ee.clear()},[ee]),React.useEffect(()=>{M(!0)},[]),React.useEffect(()=>{X(),Z()}),React.useEffect(()=>{Q()},[Q,k]),React.useImperativeHandle(o,()=>({updateIndicator:X,updateScrollButtons:Z}),[X,Z]);const te=React.createElement(_TabIndicator.default,(0,_extends2.default)({className:i.indicator,orientation:f,color:d},m,{style:(0,_extends2.default)({},k,m.style)}));let le=0;const re=React.Children.map(n,e=>{if(!React.isValidElement(e))return null;"production"!==process.env.NODE_ENV&&(0,_reactIs.isFragment)(e)&&console.error(["Material-UI: The Tabs component doesn't accept a Fragment as a child.","Consider providing an array instead."].join("\n"));const t=void 0===e.props.value?le:e.props.value;P.set(t,le);const l=t===T;return le+=1,React.cloneElement(e,(0,_extends2.default)({fullWidth:"fullWidth"===R,indicator:l&&!L&&te,selected:l,selectionFollowsFocus:_,onChange:p,textColor:y,value:t},1!==le||!1!==T||e.props.tabIndex?{}:{tabIndex:0}))}),oe=(()=>{const e={};e.scrollbarSizeListener=x?React.createElement(_ScrollbarSize.default,{onChange:J,className:(0,_clsx.default)(i.scrollableX,i.hideScrollbar)}):null;const t=z.start||z.end,l=x&&("auto"===h&&t||!0===h);return e.scrollButtonStart=l?React.createElement(b,(0,_extends2.default)({orientation:f,direction:q?"right":"left",onClick:K,disabled:!z.start,className:(0,_clsx.default)(i.scrollButtons,!u&&i.scrollButtonsHideMobile)},v)):null,e.scrollButtonEnd=l?React.createElement(b,(0,_extends2.default)({orientation:f,direction:q?"left":"right",onClick:G,disabled:!z.end,className:(0,_clsx.default)(i.scrollButtons,!u&&i.scrollButtonsHideMobile)},v)):null,e})();return React.createElement(c,(0,_extends2.default)({className:(0,_clsx.default)(i.root,s,C&&i.vertical),ref:t},S),oe.scrollButtonStart,oe.scrollbarSizeListener,React.createElement("div",{className:(0,_clsx.default)(i.scroller,x?[C?i.scrollableY:i.scrollableX,!w&&i.hideScrollbar]:i.fixed),style:{overflow:O.overflow,[C?`margin${q?"Left":"Right"}`:"marginBottom"]:w?void 0:-O.scrollbarWidth},ref:A,onScroll:ee},React.createElement("div",{"aria-label":l,"aria-labelledby":r,"aria-orientation":"vertical"===f?"vertical":null,className:(0,_clsx.default)(i.flexContainer,C&&i.flexContainerVertical,a&&!x&&i.centered),onKeyDown:e=>{const{target:t}=e;if("tab"!==t.getAttribute("role"))return;let l=null,r="vertical"!==f?"ArrowLeft":"ArrowUp",o="vertical"!==f?"ArrowRight":"ArrowDown";switch("vertical"!==f&&"rtl"===g.direction&&(r="ArrowRight",o="ArrowLeft"),e.key){case r:l=t.previousElementSibling||H.current.lastChild;break;case o:l=t.nextElementSibling||H.current.firstChild;break;case"Home":l=H.current.firstChild;break;case"End":l=H.current.lastChild}null!==l&&(l.focus(),e.preventDefault())},ref:H,role:"tablist"},re),L&&te),oe.scrollButtonEnd)});"production"!==process.env.NODE_ENV&&(Tabs.propTypes={action:_utils.refType,allowScrollButtonsMobile:_propTypes.default.bool,"aria-label":_propTypes.default.string,"aria-labelledby":_propTypes.default.string,centered:_propTypes.default.bool,children:_propTypes.default.node,classes:_propTypes.default.object,className:_propTypes.default.string,component:_propTypes.default.elementType,indicatorColor:_propTypes.default.oneOf(["primary","secondary"]),onChange:_propTypes.default.func,orientation:_propTypes.default.oneOf(["horizontal","vertical"]),ScrollButtonComponent:_propTypes.default.elementType,scrollButtons:_propTypes.default.oneOf(["auto",!1,!0]),selectionFollowsFocus:_propTypes.default.bool,TabIndicatorProps:_propTypes.default.object,TabScrollButtonProps:_propTypes.default.object,textColor:_propTypes.default.oneOf(["inherit","primary","secondary"]),value:_propTypes.default.any,variant:_propTypes.default.oneOf(["fullWidth","scrollable","standard"]),visibleScrollbar:_propTypes.default.bool});var _default=(0,_withStyles.default)(styles,{name:"MuiTabs"})(Tabs);exports.default=_default;