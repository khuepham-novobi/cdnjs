"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _objectWithoutPropertiesLoose2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutPropertiesLoose")),_extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),React=_interopRequireWildcard(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_clsx=_interopRequireDefault(require("clsx")),_utils=require("@material-ui/utils"),_unstyled=require("@material-ui/unstyled"),_experimentalStyled=_interopRequireDefault(require("../styles/experimentalStyled")),_useThemeProps=_interopRequireDefault(require("../styles/useThemeProps")),_Person=_interopRequireDefault(require("../internal/svg-icons/Person")),_avatarClasses=_interopRequireWildcard(require("./avatarClasses"));const overridesResolver=(e,t)=>{const{styleProps:r}=e;return(0,_utils.deepmerge)(t.root||{},(0,_extends2.default)({},t[r.variant],r.colorDefault&&t.colorDefault,{[`& .${_avatarClasses.default.img}`]:t.img,[`& .${_avatarClasses.default.fallback}`]:t.fallback}))},useUtilityClasses=e=>{const{classes:t,variant:r,colorDefault:a}=e,s={root:["root",r,a&&"colorDefault"],img:["img"],fallback:["fallback"]};return(0,_unstyled.unstable_composeClasses)(s,_avatarClasses.getAvatarUtilityClass,t)},AvatarRoot=(0,_experimentalStyled.default)("div",{},{name:"MuiAvatar",slot:"Root",overridesResolver:overridesResolver})(({theme:e,styleProps:t})=>(0,_extends2.default)({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none"},"rounded"===t.variant&&{borderRadius:e.shape.borderRadius},"square"===t.variant&&{borderRadius:0},t.colorDefault&&{color:e.palette.background.default,backgroundColor:"light"===e.palette.mode?e.palette.grey[400]:e.palette.grey[600]})),AvatarImg=(0,_experimentalStyled.default)("img",{},{name:"MuiAvatar",slot:"Img"})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),AvatarFallback=(0,_experimentalStyled.default)(_Person.default,{},{name:"MuiAvatar",slot:"Fallback"})({width:"75%",height:"75%"});function useLoaded({src:e,srcSet:t}){const[r,a]=React.useState(!1);return React.useEffect(()=>{if(!e&&!t)return;a(!1);let r=!0;const s=new Image;return s.src=e,t&&(s.srcset=t),s.onload=(()=>{r&&a("loaded")}),s.onerror=(()=>{r&&a("error")}),()=>{r=!1}},[e,t]),r}const Avatar=React.forwardRef(function(e,t){const r=(0,_useThemeProps.default)({props:e,name:"MuiAvatar"}),{alt:a,children:s,className:l,component:o="div",imgProps:i,sizes:u,src:n,srcSet:p,variant:d="circular"}=r,c=(0,_objectWithoutPropertiesLoose2.default)(r,["alt","children","className","component","imgProps","sizes","src","srcSet","variant"]);let f=null;const _=useLoaded({src:n,srcSet:p}),m=n||p,y=m&&"error"!==_,v=(0,_extends2.default)({},r,{colorDefault:!y,component:o,variant:d}),g=useUtilityClasses(v);return f=y?React.createElement(AvatarImg,(0,_extends2.default)({alt:a,src:n,srcSet:p,sizes:u,styleProps:v,className:g.img},i)):null!=s?s:m&&a?a[0]:React.createElement(AvatarFallback,{className:g.fallback}),React.createElement(AvatarRoot,(0,_extends2.default)({as:o,styleProps:v,className:(0,_clsx.default)(g.root,l),ref:t},c),f)});"production"!==process.env.NODE_ENV&&(Avatar.propTypes={alt:_propTypes.default.string,children:_propTypes.default.node,classes:_propTypes.default.object,className:_propTypes.default.string,component:_propTypes.default.elementType,imgProps:_propTypes.default.object,sizes:_propTypes.default.string,src:_propTypes.default.string,srcSet:_propTypes.default.string,sx:_propTypes.default.object,variant:_propTypes.default.oneOfType([_propTypes.default.oneOf(["circular","rounded","square"]),_propTypes.default.string])});var _default=Avatar;exports.default=_default;