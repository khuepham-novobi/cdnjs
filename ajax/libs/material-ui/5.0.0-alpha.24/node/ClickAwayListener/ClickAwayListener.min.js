"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var React=_interopRequireWildcard(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_utils=require("@material-ui/utils"),_ownerDocument=_interopRequireDefault(require("../utils/ownerDocument")),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_useEventCallback=_interopRequireDefault(require("../utils/useEventCallback"));function mapEventPropToEvent(e){return e.substring(2).toLowerCase()}function clickedRootScrollbar(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}function ClickAwayListener(e){const{children:t,disableReactTree:r=!1,mouseEvent:n="onClick",onClickAway:u,touchEvent:o="onTouchEnd"}=e,c=React.useRef(!1),i=React.useRef(null),a=React.useRef(!1),l=React.useRef(!1);React.useEffect(()=>(setTimeout(()=>{a.current=!0},0),()=>{a.current=!1}),[]);const s=(0,_useForkRef.default)(t.ref,i),p=(0,_useEventCallback.default)(e=>{const t=l.current;l.current=!1;const n=(0,_ownerDocument.default)(i.current);if(!a.current||!i.current||clickedRootScrollbar(e,n))return;if(c.current)return void(c.current=!1);let o;(o=e.composedPath?e.composedPath().indexOf(i.current)>-1:!n.documentElement.contains(e.target)||i.current.contains(e.target))||!r&&t||u(e)}),d=e=>r=>{l.current=!0;const n=t.props[e];n&&n(r)},f={ref:s};return!1!==o&&(f[o]=d(o)),React.useEffect(()=>{if(!1!==o){const e=mapEventPropToEvent(o),t=(0,_ownerDocument.default)(i.current),r=()=>{c.current=!0};return t.addEventListener(e,p),t.addEventListener("touchmove",r),()=>{t.removeEventListener(e,p),t.removeEventListener("touchmove",r)}}},[p,o]),!1!==n&&(f[n]=d(n)),React.useEffect(()=>{if(!1!==n){const e=mapEventPropToEvent(n),t=(0,_ownerDocument.default)(i.current);return t.addEventListener(e,p),()=>{t.removeEventListener(e,p)}}},[p,n]),React.createElement(React.Fragment,null,React.cloneElement(t,f))}"production"!==process.env.NODE_ENV&&(ClickAwayListener.propTypes={children:_utils.elementAcceptingRef.isRequired,disableReactTree:_propTypes.default.bool,mouseEvent:_propTypes.default.oneOf(["onClick","onMouseDown","onMouseUp",!1]),onClickAway:_propTypes.default.func.isRequired,touchEvent:_propTypes.default.oneOf(["onTouchEnd","onTouchStart",!1])}),"production"!==process.env.NODE_ENV&&(ClickAwayListener.propTypes=(0,_utils.exactProp)(ClickAwayListener.propTypes));var _default=ClickAwayListener;exports.default=_default;