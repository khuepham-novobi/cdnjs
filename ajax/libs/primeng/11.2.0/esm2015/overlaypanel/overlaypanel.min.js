import{NgModule,Component,Input,Output,EventEmitter,Renderer2,ElementRef,ChangeDetectorRef,NgZone,ContentChildren,ChangeDetectionStrategy,ViewEncapsulation}from"@angular/core";import{CommonModule}from"@angular/common";import{DomHandler,ConnectedOverlayScrollHandler}from"primeng/dom";import{PrimeTemplate}from"primeng/api";import{RippleModule}from"primeng/ripple";import{trigger,state,style,transition,animate}from"@angular/animations";export class OverlayPanel{constructor(e,t,n,i){this.el=e,this.renderer=t,this.cd=n,this.zone=i,this.dismissable=!0,this.autoZIndex=!0,this.baseZIndex=0,this.focusOnShow=!0,this.showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)",this.hideTransitionOptions=".1s linear",this.onShow=new EventEmitter,this.onHide=new EventEmitter,this.overlayVisible=!1,this.render=!1,this.isContainerClicked=!0}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"content":default:this.contentTemplate=e.template}this.cd.markForCheck()})}onContainerClick(){this.isContainerClicked=!0}bindDocumentClickListener(){!this.documentClickListener&&this.dismissable&&this.zone.runOutsideAngular(()=>{let e=DomHandler.isIOS()?"touchstart":"click";const t=this.el?this.el.nativeElement.ownerDocument:"document";this.documentClickListener=this.renderer.listen(t,e,e=>{this.container.contains(e.target)||this.target===e.target||this.target.contains(e.target)||this.isContainerClicked||this.zone.run(()=>{this.hide()}),this.isContainerClicked=!1,this.cd.markForCheck()})})}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}toggle(e,t){this.overlayVisible?(this.hasTargetChanged(e,t)&&(this.destroyCallback=(()=>{this.show(null,t||e.currentTarget||e.target)})),this.hide()):this.show(e,t)}show(e,t){this.target=t||e.currentTarget||e.target,this.overlayVisible=!0,this.render=!0,this.cd.markForCheck()}hasTargetChanged(e,t){return null!=this.target&&this.target!==(t||e.currentTarget||e.target)}appendContainer(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.container):DomHandler.appendChild(this.container,this.appendTo))}restoreAppend(){this.container&&this.appendTo&&this.el.nativeElement.appendChild(this.container)}align(){this.autoZIndex&&(this.container.style.zIndex=String(this.baseZIndex+ ++DomHandler.zindex)),DomHandler.absolutePosition(this.container,this.target);const e=DomHandler.getOffset(this.container),t=DomHandler.getOffset(this.target);let n=0;e.left<t.left&&(n=t.left-e.left),this.container.style.setProperty("--overlayArrowLeft",`${n}px`),e.top<t.top&&DomHandler.addClass(this.container,"p-overlaypanel-flipped")}onAnimationStart(e){"open"===e.toState&&(this.container=e.element,this.onShow.emit(null),this.appendContainer(),this.align(),this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindScrollListener(),this.focusOnShow&&this.focus())}onAnimationEnd(e){switch(e.toState){case"void":this.destroyCallback&&(this.destroyCallback(),this.destroyCallback=null);break;case"close":this.onContainerDestroy(),this.onHide.emit({}),this.render=!1}}focus(){let e=DomHandler.findSingle(this.container,"[autofocus]");e&&this.zone.runOutsideAngular(()=>{setTimeout(()=>e.focus(),5)})}hide(){this.overlayVisible=!1,this.cd.markForCheck()}onCloseClick(e){this.hide(),e.preventDefault()}onWindowResize(e){this.hide()}bindDocumentResizeListener(){this.documentResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.documentResizeListener)}unbindDocumentResizeListener(){this.documentResizeListener&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new ConnectedOverlayScrollHandler(this.target,()=>{this.overlayVisible&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}onContainerDestroy(){this.target=null,this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindScrollListener()}ngOnDestroy(){this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.target=null,this.destroyCallback=null,this.container&&(this.restoreAppend(),this.onContainerDestroy())}};OverlayPanel.decorators=[{type:Component,args:[{selector:"p-overlayPanel",template:'\n        <div *ngIf="render" [ngClass]="\'p-overlaypanel p-component\'" [ngStyle]="style" [class]="styleClass" (click)="onContainerClick()"\n            [@animation]="{value: (overlayVisible ? \'open\': \'close\'), params: {showTransitionParams: showTransitionOptions, hideTransitionParams: hideTransitionOptions}}"\n                (@animation.start)="onAnimationStart($event)" (@animation.done)="onAnimationEnd($event)">\n            <div class="p-overlaypanel-content">\n                <ng-content></ng-content>\n                <ng-container *ngTemplateOutlet="contentTemplate"></ng-container>\n            </div>\n            <button *ngIf="showCloseIcon" type="button" class="p-overlaypanel-close p-link" (click)="onCloseClick($event)" (keydown.enter)="hide()" [attr.aria-label]="ariaCloseLabel" pRipple>\n                <span class="p-overlaypanel-close-icon pi pi-times"></span>\n            </button>\n        </div>\n    ',animations:[trigger("animation",[state("void",style({transform:"scaleY(0.8)",opacity:0})),state("close",style({opacity:0})),state("open",style({transform:"translateY(0)",opacity:1})),transition("void => open",animate("{{showTransitionParams}}")),transition("open => close",animate("{{hideTransitionParams}}"))])],changeDetection:ChangeDetectionStrategy.OnPush,encapsulation:ViewEncapsulation.None,styles:['.p-overlaypanel{margin-top:10px;position:absolute}.p-overlaypanel-flipped{margin-bottom:10px;margin-top:0}.p-overlaypanel-close{align-items:center;display:flex;justify-content:center;overflow:hidden;position:relative}.p-overlaypanel:after,.p-overlaypanel:before{bottom:100%;content:" ";height:0;left:calc(var(--overlayArrowLeft, 0) + 1.25rem);pointer-events:none;position:absolute;width:0}.p-overlaypanel:after{border-width:8px;margin-left:-8px}.p-overlaypanel:before{border-width:10px;margin-left:-10px}.p-overlaypanel-shifted:after,.p-overlaypanel-shifted:before{left:auto;margin-left:auto;right:1.25em}.p-overlaypanel-flipped:after,.p-overlaypanel-flipped:before{bottom:auto;top:100%}.p-overlaypanel.p-overlaypanel-flipped:after,.p-overlaypanel.p-overlaypanel-flipped:before{border-bottom-color:transparent}']}]}],OverlayPanel.ctorParameters=(()=>[{type:ElementRef},{type:Renderer2},{type:ChangeDetectorRef},{type:NgZone}]),OverlayPanel.propDecorators={dismissable:[{type:Input}],showCloseIcon:[{type:Input}],style:[{type:Input}],styleClass:[{type:Input}],appendTo:[{type:Input}],autoZIndex:[{type:Input}],ariaCloseLabel:[{type:Input}],baseZIndex:[{type:Input}],focusOnShow:[{type:Input}],showTransitionOptions:[{type:Input}],hideTransitionOptions:[{type:Input}],onShow:[{type:Output}],onHide:[{type:Output}],templates:[{type:ContentChildren,args:[PrimeTemplate]}]};export class OverlayPanelModule{};OverlayPanelModule.decorators=[{type:NgModule,args:[{imports:[CommonModule,RippleModule],exports:[OverlayPanel],declarations:[OverlayPanel]}]}];