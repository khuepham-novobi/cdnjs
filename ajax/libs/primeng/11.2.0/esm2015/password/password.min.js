import{NgModule,Directive,ElementRef,HostListener,Input,NgZone}from"@angular/core";import{CommonModule}from"@angular/common";import{DomHandler,ConnectedOverlayScrollHandler}from"primeng/dom";export class Password{constructor(e,t){this.el=e,this.zone=t,this.promptLabel="Enter a password",this.weakLabel="Weak",this.mediumLabel="Medium",this.strongLabel="Strong",this.feedback=!0}set showPassword(e){this.el.nativeElement.type=e?"text":"password"}ngDoCheck(){this.updateFilledState()}onInput(e){this.updateFilledState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}createPanel(){this.panel=document.createElement("div"),this.panel.className="p-password-panel p-component p-password-panel-overlay p-connected-overlay",this.meter=document.createElement("div"),this.meter.className="p-password-meter",this.info=document.createElement("div"),this.info.className="p-password-info",this.info.textContent=this.promptLabel,this.panel.appendChild(this.meter),this.panel.appendChild(this.info),this.panel.style.minWidth=DomHandler.getOuterWidth(this.el.nativeElement)+"px",document.body.appendChild(this.panel)}showOverlay(){this.feedback&&(this.panel||this.createPanel(),this.panel.style.zIndex=String(++DomHandler.zindex),this.panel.style.display="block",this.zone.runOutsideAngular(()=>{setTimeout(()=>{DomHandler.addClass(this.panel,"p-connected-overlay-visible"),this.bindScrollListener(),this.bindDocumentResizeListener()},1)}),DomHandler.absolutePosition(this.panel,this.el.nativeElement))}hideOverlay(){this.feedback&&this.panel&&(DomHandler.addClass(this.panel,"p-connected-overlay-hidden"),DomHandler.removeClass(this.panel,"p-connected-overlay-visible"),this.unbindScrollListener(),this.unbindDocumentResizeListener(),this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.ngOnDestroy()},150)}))}onFocus(){this.showOverlay()}onBlur(){this.hideOverlay()}onKeyup(e){if(this.feedback){let s=e.target.value,n=null,i=null;if(0===s.length)n=this.promptLabel,i="0px 0px";else{var t=this.testStrength(s);t<30?(n=this.weakLabel,i="0px -10px"):t>=30&&t<80?(n=this.mediumLabel,i="0px -20px"):t>=80&&(n=this.strongLabel,i="0px -30px")}this.panel&&DomHandler.hasClass(this.panel,"p-connected-overlay-visible")||this.showOverlay(),this.meter.style.backgroundPosition=i,this.info.textContent=n}}testStrength(e){let t,s=0;return t=e.match("[0-9]"),s+=25*this.normalize(t?t.length:.25,1),t=e.match("[a-zA-Z]"),s+=10*this.normalize(t?t.length:.5,3),t=e.match("[!@#$%^&*?_~.,;=]"),s+=35*this.normalize(t?t.length:1/6,1),t=e.match("[A-Z]"),s+=30*this.normalize(t?t.length:1/6,1),(s*=e.length/8)>100?100:s}normalize(e,t){return e-t<=0?e/t:1+e/(e+t/4)*.5}get disabled(){return this.el.nativeElement.disabled}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new ConnectedOverlayScrollHandler(this.el.nativeElement,()=>{DomHandler.hasClass(this.panel,"p-connected-overlay-visible")&&this.hideOverlay()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}bindDocumentResizeListener(){this.documentResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.documentResizeListener)}unbindDocumentResizeListener(){this.documentResizeListener&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}onWindowResize(){this.hideOverlay()}ngOnDestroy(){this.panel&&(this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.unbindDocumentResizeListener(),document.body.removeChild(this.panel),this.panel=null,this.meter=null,this.info=null)}};Password.decorators=[{type:Directive,args:[{selector:"[pPassword]",host:{"[class.p-inputtext]":"true","[class.p-component]":"true","[class.p-filled]":"filled"}}]}],Password.ctorParameters=(()=>[{type:ElementRef},{type:NgZone}]),Password.propDecorators={promptLabel:[{type:Input}],weakLabel:[{type:Input}],mediumLabel:[{type:Input}],strongLabel:[{type:Input}],feedback:[{type:Input}],showPassword:[{type:Input}],onInput:[{type:HostListener,args:["input",["$event"]]}],onFocus:[{type:HostListener,args:["focus"]}],onBlur:[{type:HostListener,args:["blur"]}],onKeyup:[{type:HostListener,args:["keyup",["$event"]]}]};export class PasswordModule{};PasswordModule.decorators=[{type:NgModule,args:[{imports:[CommonModule],exports:[Password],declarations:[Password]}]}];