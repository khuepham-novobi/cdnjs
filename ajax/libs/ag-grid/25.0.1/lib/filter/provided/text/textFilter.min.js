"use strict";var __extends=this&&this.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),__decorate=this&&this.__decorate||function(t,e,i,r){var n,o=arguments.length,l=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;0<=a;a--)(n=t[a])&&(l=(o<3?n(l):3<o?n(e,i,l):n(e,i))||l);return 3<o&&l&&Object.defineProperty(e,i,l),l},__metadata=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(exports,"__esModule",{value:!0});var componentAnnotations_1=require("../../../widgets/componentAnnotations"),utils_1=require("../../../utils"),simpleFilter_1=require("../simpleFilter"),TextFilter=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.getDefaultDebounceMs=function(){return 500},n.prototype.getValue=function(t){t=t.value;return(t=utils_1._.makeNull(t))&&""===t.trim()&&(t=null),t},n.prototype.addValueChangedListeners=function(){function t(){return e.onUiChanged()}var e=this;this.addDestroyableEventListener(this.eValue1,"input",t),this.addDestroyableEventListener(this.eValue2,"input",t)},n.prototype.setParams=function(t){e.prototype.setParams.call(this,t),this.textFilterParams=t,this.comparator=this.textFilterParams.textCustomComparator||n.DEFAULT_COMPARATOR,this.formatter=this.textFilterParams.textFormatter||(1==this.textFilterParams.caseSensitive?n.DEFAULT_FORMATTER:n.DEFAULT_LOWERCASE_FORMATTER),this.addValueChangedListeners()},n.prototype.setConditionIntoUi=function(t,e){(e===simpleFilter_1.ConditionPosition.One?this.eValue1:this.eValue2).value=t?t.filter:null},n.prototype.createCondition=function(t){var e=t===simpleFilter_1.ConditionPosition.One,i=e?this.getCondition1Type():this.getCondition2Type(),t=e?this.eValue1:this.eValue2,e=this.getValue(t),t={filterType:n.FILTER_TYPE,type:i};return this.doesFilterHaveHiddenInput(i)||(t.filter=e),t},n.prototype.getFilterType=function(){return n.FILTER_TYPE},n.prototype.areSimpleModelsEqual=function(t,e){return t.filter===e.filter&&t.type===e.type},n.prototype.resetUiToDefaults=function(){e.prototype.resetUiToDefaults.call(this),this.eValue1.value=null,this.eValue2.value=null},n.prototype.setValueFromFloatingFilter=function(t){this.eValue1.value=t,this.eValue2.value=null},n.prototype.getDefaultFilterOptions=function(){return n.DEFAULT_FILTER_OPTIONS},n.prototype.createValueTemplate=function(t){t=t===simpleFilter_1.ConditionPosition.One?"1":"2";return'<div class="ag-filter-body" ref="eCondition'+t+'Body" role="presentation">\n            <div class="ag-input-wrapper" ref="eInputWrapper'+t+'" role="presentation">\n                <input class="ag-filter-filter" ref="eValue'+t+'" type="text" placeholder="'+this.gridOptionsWrapper.getLocaleTextFunc()("filterOoo","Filter...")+'"/>\n            </div>\n        </div>'},n.prototype.updateUiVisibility=function(){e.prototype.updateUiVisibility.call(this);var t=this.showValueFrom(this.getCondition1Type());utils_1._.setDisplayed(this.eInputWrapper1,t);t=this.showValueFrom(this.getCondition2Type());utils_1._.setDisplayed(this.eInputWrapper2,t)},n.prototype.afterGuiAttached=function(){this.eValue1.focus()},n.prototype.isConditionUiComplete=function(t){var e=t===simpleFilter_1.ConditionPosition.One,t=e?this.getCondition1Type():this.getCondition2Type(),e=e?this.eValue1:this.eValue2;if(t===simpleFilter_1.SimpleFilter.EMPTY)return!1;e=this.getValue(e);return!!this.doesFilterHaveHiddenInput(t)||null!=e},n.prototype.individualConditionPasses=function(t,e){var i=e.filter,r=e.type,n=this.textFilterParams.valueGetter(t.node),e=this.formatter(n),t=this.optionsFactory.getCustomOption(r);if(t&&(null!=i||t.hideFilterInput))return t.test(i,e);if(null==n)return r===simpleFilter_1.SimpleFilter.NOT_EQUAL||r===simpleFilter_1.SimpleFilter.NOT_CONTAINS;i=this.formatter(i);return this.comparator(r,e,i)},n.FILTER_TYPE="text",n.DEFAULT_FILTER_OPTIONS=[simpleFilter_1.SimpleFilter.CONTAINS,simpleFilter_1.SimpleFilter.NOT_CONTAINS,simpleFilter_1.SimpleFilter.EQUALS,simpleFilter_1.SimpleFilter.NOT_EQUAL,simpleFilter_1.SimpleFilter.STARTS_WITH,simpleFilter_1.SimpleFilter.ENDS_WITH],n.DEFAULT_FORMATTER=function(t){return t},n.DEFAULT_LOWERCASE_FORMATTER=function(t){return null==t?null:t.toString().toLowerCase()},n.DEFAULT_COMPARATOR=function(t,e,i){switch(t){case n.CONTAINS:return 0<=e.indexOf(i);case n.NOT_CONTAINS:return-1===e.indexOf(i);case n.EQUALS:return e===i;case n.NOT_EQUAL:return e!=i;case n.STARTS_WITH:return 0===e.indexOf(i);case n.ENDS_WITH:var r=e.lastIndexOf(i);return 0<=r&&r===e.length-i.length;default:return console.warn("invalid filter type "+t),!1}},__decorate([componentAnnotations_1.RefSelector("eValue1"),__metadata("design:type",HTMLInputElement)],n.prototype,"eValue1",void 0),__decorate([componentAnnotations_1.RefSelector("eValue2"),__metadata("design:type",HTMLInputElement)],n.prototype,"eValue2",void 0),__decorate([componentAnnotations_1.RefSelector("eInputWrapper1"),__metadata("design:type",HTMLElement)],n.prototype,"eInputWrapper1",void 0),__decorate([componentAnnotations_1.RefSelector("eInputWrapper2"),__metadata("design:type",HTMLElement)],n.prototype,"eInputWrapper2",void 0),n}(simpleFilter_1.SimpleFilter);exports.TextFilter=TextFilter;