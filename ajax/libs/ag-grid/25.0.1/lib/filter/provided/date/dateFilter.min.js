"use strict";var __extends=this&&this.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)};return function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),__decorate=this&&this.__decorate||function(t,e,o,r){var i,a=arguments.length,n=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;0<=s;s--)(i=t[s])&&(n=(a<3?i(n):3<a?i(e,o,n):i(e,o))||n);return 3<a&&n&&Object.defineProperty(e,o,n),n},__metadata=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(exports,"__esModule",{value:!0});var componentAnnotations_1=require("../../../widgets/componentAnnotations"),context_1=require("../../../context/context"),userComponentFactory_1=require("../../../components/framework/userComponentFactory"),utils_1=require("../../../utils"),dateCompWrapper_1=require("./dateCompWrapper"),simpleFilter_1=require("../simpleFilter"),scalerFilter_1=require("../scalerFilter"),DateFilter=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return __extends(r,e),r.prototype.mapRangeFromModel=function(t){return{from:utils_1._.parseYyyyMmDdToDate(t.dateFrom,"-"),to:utils_1._.parseYyyyMmDdToDate(t.dateTo,"-")}},r.prototype.setValueFromFloatingFilter=function(t){null!=t?(t=utils_1._.parseYyyyMmDdToDate(t,"-"),this.dateCompFrom1.setDate(t)):this.dateCompFrom1.setDate(null),this.dateCompTo1.setDate(null),this.dateCompFrom2.setDate(null),this.dateCompTo2.setDate(null)},r.prototype.setConditionIntoUi=function(t,e){var o=e===simpleFilter_1.ConditionPosition.One,r=t?t.dateFrom:null,e=t?t.dateTo:null,t=utils_1._.parseYyyyMmDdToDate(r,"-"),r=utils_1._.parseYyyyMmDdToDate(e,"-"),e=o?this.dateCompFrom1:this.dateCompFrom2,o=o?this.dateCompTo1:this.dateCompTo2;e.setDate(t),o.setDate(r)},r.prototype.resetUiToDefaults=function(){e.prototype.resetUiToDefaults.call(this),this.dateCompTo1.setDate(null),this.dateCompTo2.setDate(null),this.dateCompFrom1.setDate(null),this.dateCompFrom2.setDate(null)},r.prototype.comparator=function(){return this.dateFilterParams.comparator||this.defaultComparator.bind(this)},r.prototype.defaultComparator=function(t,e){return e<t?-1:t<e?1:null!=e?0:-1},r.prototype.setParams=function(t){e.prototype.setParams.call(this,t),this.dateFilterParams=t,this.createDateComponents()},r.prototype.createDateComponents=function(){var t=this,e={onDateChanged:function(){return t.onUiChanged()},filterParams:this.dateFilterParams};this.dateCompFrom1=new dateCompWrapper_1.DateCompWrapper(this.userComponentFactory,e,this.ePanelFrom1),this.dateCompFrom2=new dateCompWrapper_1.DateCompWrapper(this.userComponentFactory,e,this.ePanelFrom2),this.dateCompTo1=new dateCompWrapper_1.DateCompWrapper(this.userComponentFactory,e,this.ePanelTo1),this.dateCompTo2=new dateCompWrapper_1.DateCompWrapper(this.userComponentFactory,e,this.ePanelTo2),this.addDestroyFunc(function(){t.dateCompFrom1.destroy(),t.dateCompFrom2.destroy(),t.dateCompTo1.destroy(),t.dateCompTo2.destroy()})},r.prototype.getDefaultFilterOptions=function(){return r.DEFAULT_FILTER_OPTIONS},r.prototype.createValueTemplate=function(t){t=t===simpleFilter_1.ConditionPosition.One?"1":"2";return'<div class="ag-filter-body" ref="eCondition'+t+'Body">\n                    <div class="ag-filter-date-from" ref="ePanelFrom'+t+'">\n                    </div>\n                    <div class="ag-filter-date-to" ref="ePanelTo'+t+'"">\n                    </div>\n                </div>'},r.prototype.isConditionUiComplete=function(t){var e=t===simpleFilter_1.ConditionPosition.One,o=e?this.getCondition1Type():this.getCondition2Type(),t=e?this.dateCompFrom1:this.dateCompFrom2,e=e?this.dateCompTo1:this.dateCompTo2,t=t.getDate(),e=e.getDate();return o!==simpleFilter_1.SimpleFilter.EMPTY&&(!!this.doesFilterHaveHiddenInput(o)||(o===simpleFilter_1.SimpleFilter.IN_RANGE?null!=t&&null!=e:null!=t))},r.prototype.areSimpleModelsEqual=function(t,e){return t.dateFrom===e.dateFrom&&t.dateTo===e.dateTo&&t.type===e.type},r.prototype.getFilterType=function(){return r.FILTER_TYPE},r.prototype.createCondition=function(t){var e=t===simpleFilter_1.ConditionPosition.One,o=e?this.getCondition1Type():this.getCondition2Type(),t=e?this.dateCompTo1:this.dateCompTo2,e=e?this.dateCompFrom1:this.dateCompFrom2;return{dateTo:utils_1._.serializeDateToYyyyMmDd(t.getDate(),"-"),dateFrom:utils_1._.serializeDateToYyyyMmDd(e.getDate(),"-"),type:o,filterType:r.FILTER_TYPE}},r.prototype.updateUiVisibility=function(){e.prototype.updateUiVisibility.call(this);var t=this.showValueFrom(this.getCondition1Type());utils_1._.setDisplayed(this.ePanelFrom1,t);t=this.showValueTo(this.getCondition1Type());utils_1._.setDisplayed(this.ePanelTo1,t);t=this.showValueFrom(this.getCondition2Type());utils_1._.setDisplayed(this.ePanelFrom2,t);t=this.showValueTo(this.getCondition2Type());utils_1._.setDisplayed(this.ePanelTo2,t)},r.FILTER_TYPE="date",r.DEFAULT_FILTER_OPTIONS=[scalerFilter_1.ScalerFilter.EQUALS,scalerFilter_1.ScalerFilter.GREATER_THAN,scalerFilter_1.ScalerFilter.LESS_THAN,scalerFilter_1.ScalerFilter.NOT_EQUAL,scalerFilter_1.ScalerFilter.IN_RANGE],__decorate([componentAnnotations_1.RefSelector("ePanelFrom1"),__metadata("design:type",HTMLElement)],r.prototype,"ePanelFrom1",void 0),__decorate([componentAnnotations_1.RefSelector("ePanelFrom2"),__metadata("design:type",HTMLElement)],r.prototype,"ePanelFrom2",void 0),__decorate([componentAnnotations_1.RefSelector("ePanelTo1"),__metadata("design:type",HTMLElement)],r.prototype,"ePanelTo1",void 0),__decorate([componentAnnotations_1.RefSelector("ePanelTo2"),__metadata("design:type",HTMLElement)],r.prototype,"ePanelTo2",void 0),__decorate([context_1.Autowired("userComponentFactory"),__metadata("design:type",userComponentFactory_1.UserComponentFactory)],r.prototype,"userComponentFactory",void 0),r}(scalerFilter_1.ScalerFilter);exports.DateFilter=DateFilter;