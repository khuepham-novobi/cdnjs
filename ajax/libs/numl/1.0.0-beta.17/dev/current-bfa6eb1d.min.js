import{B as Behavior,d as deepQueryAll,R as ROOT}from"./index-da59e341.js";const history=window.history,_wr=function(e){return function(){const t=History.prototype[e].apply(history,arguments),n=new Event(e.toLowerCase());return window.dispatchEvent(n),t}};let timerId;function handleHashLinks(){const e=deepQueryAll(ROOT,'[is-current-spy] > a[href^="#"]'),t=[];if(e.forEach(e=>{const n=e.getAttribute("href").slice(1),r=e.parentNode.nuQueryById(n);if(!r)return;const a=r.getBoundingClientRect().y;r&&t.push({link:e,id:n,target:r,offset:a,parent:e.parentNode})}),!t.length)return;t.sort((e,t)=>t.offset-e.offset);let n=t.find(e=>e.offset<=1);n&&n.parent.nuSetMod("current",!0),t.forEach(e=>{e!==n&&e.parent.nuSetMod("current",!1)})}function isCurrent(e){if(null==e)return!1;let t=location.href.replace(location.hash,"");return t=t.replace(/\/$/,""),(e=e.replace(/\/$/,""))===t}function handleLinkState(e){const t=e.href;e.parentNode&&e.parentNode.nuSetMod&&e.parentNode.nuSetMod("current",isCurrent(t))}function handleLinksState(e=!1){timerId&&!e||(e&&clearTimeout(timerId),timerId=setTimeout(()=>{timerId=null;const e=deepQueryAll(ROOT,'[is-current-spy] > a:not([href^="#"])');handleHashLinks(),e.forEach(handleLinkState)},e?0:100))}history.pushState=_wr("pushState"),history.replaceState=_wr("replaceState"),["popstate","pushstate","replacestate"].forEach(e=>{window.addEventListener(e,()=>{requestAnimationFrame(handleLinksState),setTimeout(handleLinksState,250)},{passive:!0})}),["scroll","hashchange"].forEach(e=>{window.addEventListener(e,handleHashLinks,{passive:!0})}),setTimeout(handleLinksState,50);class CurrentBehavior extends Behavior{connected(){this.setMod("current-spy",!0),this.on("tap",()=>{this.setMod("current",!0)})}disconnected(){this.setMod("current-spy",!1)}}export default CurrentBehavior;export{handleLinkState,handleLinksState};