import{l as e}from"./index-133d9ede.js";class t{constructor(e){this.children=[],this.parent=e}delete(e){const t=this.children.indexOf(e);return-1!==t&&(this.children=this.children.slice(0,t).concat(this.children.slice(t+1)),0===this.children.length&&this.parent.delete(this),!0)}add(e){return this.children.push(e),this}}class n{constructor(e){this.parent=null,this.children={},this.parent=e||null}get(e){return this.children[e]}insert(e){let i=this;for(let r=0;r<e.length;r+=1){const l=e[r];let s=i.get(l);if(r===e.length-1)return s instanceof n&&(i.delete(s),s=null),s||(s=new t(i),i.children[l]=s),s;s instanceof t&&(s=null),s||(s=new n(i),i.children[l]=s),i=s}return i}delete(e){for(const t in this.children){if(this.children[t]===e){const e=delete this.children[t];return 0===Object.keys(this.children).length&&this.parent&&this.parent.delete(this),e}}return!1}}function i(e){if(!(e instanceof HTMLElement))return!1;const t=e.nodeName.toLowerCase(),n=(e.getAttribute("type")||"").toLowerCase();return"select"===t||"textarea"===t||"input"===t&&"submit"!==n&&"reset"!==n&&"checkbox"!==n&&"radio"!==n||e.isContentEditable}const r=new n,l=new WeakMap;let s=r,c=null;function o(){c=null,s=r}function d(e){if(e.defaultPrevented)return;if(e.target instanceof Node&&i(e.target))return;null!=c&&window.clearTimeout(c),c=window.setTimeout(o,1500);const n=s.get(function(e){return`${e.ctrlKey?"Control+":""}${e.altKey?"Alt+":""}${e.metaKey?"Meta+":""}${e.shiftKey&&e.key.toUpperCase()!==e.key?"Shift+":""}${e.key}`}(e));var r;if(n)return s=n,n instanceof t?(i(r=n.children[n.children.length-1])?r.focus():r.click(),e.preventDefault(),void o()):void 0;o()}function h(t,n){let i=!1;return{connected(){setTimeout((()=>{const s=t.nuRef||t;s.dataset.hotkey=(n||"").trim(),function(e,t){0===Object.keys(r.children).length&&document.addEventListener("keydown",d);const n=function(e){return e.split(",").map((e=>e.split(" ")))}(t||e.getAttribute("data-hotkey")||"").map((t=>r.insert(t).add(e)));l.set(e,n)}(s),e("hotkey installed",s,s.dataset.hotkey),i=!0}),300)},disconnected(){i&&(!function(e){const t=l.get(e);if(t&&t.length)for(const n of t)n&&n.delete(e);0===Object.keys(r.children).length&&document.removeEventListener("keydown",d)}(t),e("hotkey uninstalled",t,n),i=!1)}}}export default h;
