import{W as WidgetBehavior,s as setAttr,h,w as warn}from"./index-0338ddf6.js";import{f as fixSafariInvisibleContents}from"./browser-fixes-ad0e4ba1.js";class ImageBehavior extends WidgetBehavior{init(){this.props.src=(e=>{this.load(e)}),this.props.loading=(e=>{this.ref&&this.ref!==this.host&&setAttr(this.ref,"loading",e)}),super.init()}connected(){[...this.host.querySelectorAll("img:not([src])")].forEach(e=>{e.parentNode.removeChild(e)})}load(e){const{host:t}=this;if(!(e=e&&e.trim())||e===this.cachedSrc)return;this.cachedSrc=e;let i=t.querySelector("img")||h("img");return setAttr(i,"loading",t.getAttribute("loading")),i.src=e,i.alt="",this.ref=i,i.parentNode||t.appendChild(i),fixSafariInvisibleContents(t),i.onerror=(()=>{this.removeChild(i);const r=h("nu-icon");r.setAttribute("name","image"),t.appendChild(r),warn("image not loaded",e)}),e}}export default ImageBehavior;