!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("fs")):"function"==typeof define&&define.amd?define(["fs"],e):"object"==typeof exports?exports.scribble=e(require("fs")):t.scribble=e(t.fs)}(window,function(n){return o={},i.m=r=[function(t,u,e){"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=e(2);u.scaleMaps={major:"WWHWWW",minor:"WHWWHW","major pentatonic":"WWAW","ionian pentatonic":"HHWH","mixolydian pentatonic":"HHWA",ritusen:"WAWW",egyptian:"WAWA","neopolitan major pentatonic":"HHHH","vietnamese 1":"AWWH",pelog:"HWHH",kumoijoshi:"HHWH",hirajoshi:"WHHH",iwato:"HHHH","in-sen":"HHWA","lydian pentatonic":"HWHH","malkos raga":"AWAW","locrian pentatonic":"AWHH","minor pentatonic":"AWWA","minor six pentatonic":"AWWW","flat three pentatonic":"WHHW","flat six pentatonic":"WWAH",scriabin:"HAAW","whole tone pentatonic":"HWWW","lydian #5P pentatonic":"HWWA","lydian dominant pentatonic":"HWHA","minor #7M pentatonic":"AWWH","super locrian pentatonic":"AHWH","minor hexatonic":"WHWWH",augmented:"AHAHA","major blues":"WHHAW",piongio:"WAWWH","prometheus neopolitan":"HAWAH",prometheus:"WWWAH","mystery #1":"HAWWW","six tone symmetric":"HAHAH","whole tone":"WWWWW","messiaen's mode #5":"HHHHH","minor blues":"AWHHA","locrian major":"WWHHWW","double harmonic lydian":"HAWHHA","harmonic minor":"WHWWHA",altered:"HWHWWW","locrian #2":"WHWHWW","mixolydian b6":"WWHWHW","lydian dominant":"WWWHWH",lydian:"WWWHWW","lydian augmented":"WWWWHW","dorian b2":"HWWWWH","melodic minor":"WHWWWW",locrian:"HWWHWW",ultralocrian:"HWHWWH","locrian 6":"HWWHAH","augmented heptatonic":"AHHWHA","romanian minor":"WHAHWH","dorian #4":"WHAHWH","lydian diminished":"WHAHWW",phrygian:"HWWWHW","leading whole tone":"WWWWWH","lydian minor":"WWWHHW","phrygian dominant":"HAHWHW",balinese:"HWWWHA","neopolitan major":"HWWWWW",aeolian:"WHWWHW","harmonic major":"WWHWHA","double harmonic major":"HAHWHA",dorian:"WHWWWH","hungarian minor":"WHAHHA","hungarian major":"AHWHWH",oriental:"HAHHAH",flamenco:"HWHWHA","todi raga":"HWAHHA",mixolydian:"WWHWWH",persian:"HAHHWA",enigmatic:"HAWWWH","major augmented":"WWHAHW","lydian #9":"AHWHWW","messiaen's mode #4":"HHAHHHA","purvi raga":"HAHHHHA","spanish heptatonic":"HWHHWHW",bebop:"WWHWWHH","bebop minor":"WHHHWWH","bebop major":"WWHWHHW","bebop locrian":"HWWHHHW","minor bebop":"WHWWHWH",diminished:"WHWHWHW",ichikosucho:"WWHHHWW","minor six diminished":"WHWWHHW","half-whole diminished":"HWHWHWH","kafi raga":"AHHWWHH","messiaen's mode #6":"WWHHWWH","composite blues":"WHHHHHWH","messiaen's mode #3":"WHHWHHWH","messiaen's mode #7":"HHHWHHHHW",chromatic:"HHHHHHHHHHH"},u.scales=function(){return Object.keys(u.scaleMaps)},u.chordMaps={"5th":[0,7],fifth:[0,7],"M7#5sus4":[0,5,8,11],"7#5sus4":[0,5,8,10],sus4:[0,5,7],"suspended fourth":[0,5,7],M7sus4:[0,5,7,11],"7sus4":[0,5,7,10],"suspended fourth seventh":[0,5,7,10],"7no5":[0,4,10],aug:[0,4,8],"+":[0,4,8],"+5":[0,4,8],augmented:[0,4,8],Mb6:[0,4,20],M7b6:[0,4,8,11],"major seventh flat sixth":[0,4,8,11],"maj7#5":[0,4,8,11],"maj7+5":[0,4,8,11],"+maj7":[0,4,8,11],"augmented seventh":[0,4,8,11],"7#5":[0,4,8,10],"+7":[0,4,8,10],"7aug":[0,4,8,10],aug7:[0,4,8,10],"7b13":[0,4,10,20],M:[0,4,7],major:[0,4,7],maj7:[0,4,7,11],"Δ":[0,4,7,11],ma7:[0,4,7,11],M7:[0,4,7,11],Maj7:[0,4,7,11],"major seventh":[0,4,7,11],"7th":[0,4,7,10],dom:[0,4,7,10],"dominant seventh":[0,4,7,10],add6:[0,4,7,9],add13:[0,4,7,9],M6:[0,4,7,9],sixth:[0,4,7,9],"7add6":[0,4,7,10,21],"7add13":[0,4,7,10,21],"7b6":[0,4,7,8,10],Mb5:[0,4,6],M7b5:[0,4,6,11],"7b5":[0,4,6,10],"maj#4":[0,4,7,11,18],"Δ#4":[0,4,7,11,18],"Δ#11":[0,4,7,11,18],lydian:[0,4,7,11,18],"7#11":[0,4,7,10,18],"7#4":[0,4,7,10,18],"lydian dominant seventh":[0,4,7,10,18],"M6#11":[0,4,7,9,18],M6b5:[0,4,7,9,18],"6#11":[0,4,7,9,18],"6b5":[0,4,7,9,18],"7#11b13":[0,4,7,10,18,20],"7b5b13":[0,4,7,10,18,20],"m#5":[0,3,8],"m+":[0,3,8],mb6:[0,3,8],mb6M7:[0,3,8,11],"m7#5":[0,3,8,10],m:[0,3,7],min:[0,3,7],"-":[0,4,7],minor:[0,3,7],"m/ma7":[0,3,7,11],"m/maj7":[0,3,7,11],mM7:[0,3,7,11],mMaj7:[0,3,7,11],"m/M7":[0,3,7,11],"mΔ":[0,3,7,11],"minor/major seventh":[0,3,7,11],m7:[0,3,7,10],min7:[0,3,7,10],mi7:[0,3,7,10],"minor seventh":[0,3,7,10],m6:[0,3,7,9],"minor sixth":[0,3,7,9],mMaj7b6:[0,3,7,8,11],dim:[0,3,6],"°":[0,3,6],o:[0,3,6],diminished:[0,3,6],oM7:[0,3,6,11],m7b5:[0,3,6,10],"ø":[0,3,6,10],dim7:[0,3,6,9],"°7":[0,3,6,9],o7:[0,3,6,9],"diminished seventh":[0,3,6,9],o7M7:[0,3,6,9,11],"4th":[0,5,10,15],quartal:[0,5,10,15],madd4:[0,3,5,7],m7add11:[0,3,7,10,17],m7add4:[0,3,7,10,17],"+add#9":[0,4,8,15],"7#5#9":[0,4,8,10,15],"7alt":[0,4,8,10,15],"7#9":[0,4,7,10,15],"dominant sharp ninth":[0,4,7,10,15],"13#9":[0,4,7,10,15,21],"7#9b13":[0,4,7,10,15,20],"maj7#9#11":[0,4,7,11,15,18],"7#9#11":[0,4,7,10,15,18],"7b5#9":[0,4,7,10,15,18],"13#9#11":[0,4,7,10,15,18,21],"7#9#11b13":[0,4,7,10,15,18,20],sus2:[0,2,7],"suspended second":[0,2,7],"M9#5sus4":[0,5,8,11,14],sus24:[0,2,5,7],sus4add9:[0,2,5,7],M9sus4:[0,5,7,11,14],"11th":[0,7,10,14,17],eleventh:[0,7,10,14,17],"9sus4":[0,5,7,10,14],"9sus":[0,5,7,10,14],"13sus4":[0,5,7,10,14,21],"13sus":[0,5,7,10,14,21],"9no5":[0,4,10,14],"13no5":[0,4,10,14,21],"M#5add9":[0,4,8,14],"+add9":[0,4,8,14],"maj9#5":[0,4,8,11,14],"Maj9#5":[0,4,8,11,14],"9#5":[0,4,8,10,14],"9+":[0,4,8,10,14],"9b13":[0,4,10,14,20],Madd9:[0,4,7,14],add9:[0,4,7,14],add2:[0,4,7,14],maj9:[0,4,7,11,14],"Δ9":[0,4,7,11,14],"major ninth":[0,4,7,11,14],"9th":[0,4,7,10,14],"dominant ninth":[0,4,7,10,14],"6/9":[0,4,7,9,14],"sixth/ninth":[0,4,7,9,14],maj13:[0,4,7,11,14,21],Maj13:[0,4,7,11,14,21],"major thirteenth":[0,4,7,11,14,21],M7add13:[0,4,7,9,11,14],"13th":[0,4,7,10,14,21],"dominant thirteenth":[0,4,7,10,14,21],M9b5:[0,4,6,11,14],"9b5":[0,4,6,10,14],"13b5":[0,4,6,9,10,14],"9#5#11":[0,4,8,10,14,18],"maj9#11":[0,4,7,11,14,18],"Δ9#11":[0,4,7,11,14,18],"major sharp eleventh (lydian)":[0,4,7,11,14,18],"9#11":[0,4,7,10,14,18],"9+4":[0,4,7,10,14,18],"9#4":[0,4,7,10,14,18],"M13#11":[0,4,7,11,14,18,21],"maj13#11":[0,4,7,11,14,18,21],"M13+4":[0,4,7,11,14,18,21],"M13#4":[0,4,7,11,14,18,21],"13#11":[0,4,7,10,14,18,21],"13+4":[0,4,7,10,14,18,21],"13#4":[0,4,7,10,14,18,21],"9#11b13":[0,4,7,10,14,18,20],"9b5b13":[0,4,7,10,14,18,20],"m9#5":[0,3,8,10,14],madd9:[0,3,7,14],mMaj9:[0,3,7,11,14],m9:[0,3,7,10,14],"minor ninth":[0,3,7,10,14],m69:[0,3,7,9,14],m13:[0,3,7,10,14,21],"minor thirteenth":[0,3,7,10,14,21],mMaj9b6:[0,3,7,8,11,14],m9b5:[0,2,3,6,10],m11A:[0,3,8,10,14,17],m11:[0,3,7,10,14,17],"minor eleventh":[0,3,7,10,14,17],b9sus:[0,5,7,10,14],phryg:[0,5,7,10,13],"suspended fourth flat ninth":[0,5,7,10,13],"11b9":[0,7,10,13,17],"7sus4b9b13":[0,5,7,10,13,20],"7b9b13sus4":[0,5,7,10,13,20],alt7:[0,4,10,13],altered:[0,4,10,13],"7#5b9":[0,4,8,10,13],Maddb9:[0,4,7,13],M7b9:[0,4,7,11,13],"7b9":[0,4,7,10,13],"dominant flat ninth":[0,4,7,10,13],"13b9":[0,4,7,10,13,21],"7b9b13":[0,4,7,10,13,20],"7#5b9#11":[0,4,8,10,13,18],"7b9#11":[0,4,7,10,13,18],"7b5b9":[0,4,7,10,13,18],"13b9#11":[0,4,7,10,13,18,21],"7b9b13#11":[0,4,7,10,13,18,20],"7b9#11b13":[0,4,7,10,13,18,20],"7b5b9b13":[0,4,7,10,13,18,20],mb6b9:[0,3,8,13],"7b9#9":[0,4,7,10,13,15]},u.chords=function(){return Object.keys(u.chordMaps)},u.scale=function(t){var e=t.match(/([A-Ga-g])(b|#)?([0-9])\s([a-zA-Z0-9\s\#]+)/),t=e[1],n=e[2]||"",t=t+n+e[3],r=e[4];if(!u.scaleMaps[r])throw"No such scale "+r;for(var i=c.Util.midiPitchFromNote(t),o=[t],a=0;a<u.scaleMaps[r].length;a++){"A"===u.scaleMaps[r][a]?i+=3:"W"===u.scaleMaps[r][a]?i+=2:i+=1;var s=(s=c.Util.noteFromMidiPitch(i,!n||"b"===n))[0].toUpperCase()+s.slice(1);o.push(s)}return o},u.chord=function(t){var e=t.match(/([A-Ga-g])(b|#)?([a-zA-Z0-9\-\+\#\s\Δ\°\ø\(\)\/]+)(\_[0-9])?/),n=e[1],r=e[2]||"",i=e[4]&&e[4].replace(/\D/,"")||"4",t=n+r+i,e=e[3];if(!u.chordMaps[e])throw"No such chord "+e;var o=u.scale(t+" chromatic").concat(u.scale(n+r+(+i+1)+" chromatic")),a=[];return u.chordMaps[e].forEach(function(t){a.push(o[t])}),a}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isNote=function(t){return/^[a-gA-G](?:#|b)?\d$/.test(t)},e.expandStr=function(t){return t=(t=(t=(t=JSON.stringify(t.split(""))).replace(/,"\[",/g,", [")).replace(/"\[",/g,"[")).replace(/,"\]"/g,"]"),JSON.parse(t)},e.shuffle=function(r){var i=r.length-1;return r.forEach(function(t,e){var n=Math.round(Math.random()*i);r[e]=r[n],r[n]=t}),r},e.sizzleMap=function(e){void 0===e&&(e=127);var t=Math.PI,n=[t/6,t/4,t/3,t/2,2*t/3,3*t/4,5*t/6,t],t=[0,t/6,t/4,t/3,t/2,2*t/3,3*t/4,5*t/6];return t.reverse(),n.concat(t).map(function(t){return Math.round(Math.sin(t)*e)})},e.pickOne=function(t){return 1<t.length?t[Math.round(Math.random())]:t[0]},e.dice=function(){return!!Math.round(Math.random())},e.flat=function(t){return t.reduce(function(t,e){return t.concat(e)},[])}},function(t,n,e){(function(t){var e={};!function(t){t.DEFAULT_VOLUME=90;var o=(t.DEFAULT_DURATION=128,t.DEFAULT_CHANNEL=0,{midi_letter_pitches:{a:21,b:23,c:12,d:14,e:16,f:17,g:19},midiPitchFromNote:function(t){var e=/([a-g])(#+|b+)?([0-9]+)$/i.exec(t),n=e[1].toLowerCase(),t=e[2]||"";return 12*parseInt(e[3],10)+o.midi_letter_pitches[n]+("#"==t.substr(0,1)?1:-1)*t.length},ensureMidiPitch:function(t){return"number"!=typeof t&&/[^0-9]/.test(t)?o.midiPitchFromNote(t):parseInt(t,10)},midi_pitches_letter:{12:"c",13:"c#",14:"d",15:"d#",16:"e",17:"f",18:"f#",19:"g",20:"g#",21:"a",22:"a#",23:"b"},midi_flattened_notes:{"a#":"bb","c#":"db","d#":"eb","f#":"gb","g#":"ab"},noteFromMidiPitch:function(t,e){var n=0,r=t;return e=e||!1,23<t&&(r=t-12*(n=Math.floor(t/12)-1)),r=o.midi_pitches_letter[r],e&&0<r.indexOf("#")&&(r=o.midi_flattened_notes[r]),r+n},mpqnFromBpm:function(t){for(var e=Math.floor(6e7/t),n=[];n.unshift(255&e),e>>=8,e;);for(;n.length<3;)n.push(0);return n},bpmFromMpqn:function(t){if(void 0!==t[0])for(var e=0,n=t.length-1;0<=n;++e,--n)t[e];return Math.floor(6e7/t)},codes2Str:function(t){return String.fromCharCode.apply(null,t)},str2Bytes:function(t,e){if(e)for(;t.length/2<e;)t="0"+t;for(var n=[],r=t.length-1;0<=r;r-=2){var i=0===r?t[r]:t[r-1]+t[r];n.unshift(parseInt(i,16))}return n},translateTickTime:function(t){for(var e=127&t;t>>=7;)e<<=8,e|=127&t|128;for(var n=[];n.push(255&e),128&e;)e>>=8;return n}}),i=function(t){if(!this)return new i(t);!t||null===t.type&&void 0===t.type||null===t.channel&&void 0===t.channel||null===t.param1&&void 0===t.param1||(this.setTime(t.time),this.setType(t.type),this.setChannel(t.channel),this.setParam1(t.param1),this.setParam2(t.param2))};i.NOTE_OFF=128,i.NOTE_ON=144,i.AFTER_TOUCH=160,i.CONTROLLER=176,i.PROGRAM_CHANGE=192,i.CHANNEL_AFTERTOUCH=208,i.PITCH_BEND=224,i.prototype.setTime=function(t){this.time=o.translateTickTime(t||0)},i.prototype.setType=function(t){if(t<i.NOTE_OFF||t>i.PITCH_BEND)throw new Error("Trying to set an unknown event: "+t);this.type=t},i.prototype.setChannel=function(t){if(t<0||15<t)throw new Error("Channel is out of bounds.");this.channel=t},i.prototype.setParam1=function(t){this.param1=t},i.prototype.setParam2=function(t){this.param2=t},i.prototype.toBytes=function(){var t=[],e=this.type|15&this.channel;return t.push.apply(t,this.time),t.push(e),t.push(this.param1),void 0!==this.param2&&null!==this.param2&&t.push(this.param2),t};var n=function(t){if(!this)return new n(t);this.setTime(t.time),this.setType(t.type),this.setData(t.data)};n.SEQUENCE=0,n.TEXT=1,n.COPYRIGHT=2,n.TRACK_NAME=3,n.INSTRUMENT=4,n.LYRIC=5,n.MARKER=6,n.CUE_POINT=7,n.CHANNEL_PREFIX=32,n.END_OF_TRACK=47,n.TEMPO=81,n.SMPTE=84,n.TIME_SIG=88,n.KEY_SIG=89,n.SEQ_EVENT=127,n.prototype.setTime=function(t){this.time=o.translateTickTime(t||0)},n.prototype.setType=function(t){this.type=t},n.prototype.setData=function(t){this.data=t},n.prototype.toBytes=function(){if(!this.type)throw new Error("Type for meta-event not specified.");var t,e=[];return e.push.apply(e,this.time),e.push(255,this.type),Array.isArray(this.data)?(e.push(this.data.length),e.push.apply(e,this.data)):"number"==typeof this.data?e.push(1,this.data):null!==this.data&&void 0!==this.data?(e.push(this.data.length),t=this.data.split("").map(function(t){return t.charCodeAt(0)}),e.push.apply(e,t)):e.push(0),e};var a=function(t){if(!this)return new a(t);t=t||{};this.events=t.events||[]};a.START_BYTES=[77,84,114,107],a.END_BYTES=[0,255,47,0],a.prototype.addEvent=function(t){return this.events.push(t),this},a.prototype.addNoteOn=a.prototype.noteOn=function(t,e,n,r){return this.events.push(new i({type:i.NOTE_ON,channel:t,param1:o.ensureMidiPitch(e),param2:r||90,time:n||0})),this},a.prototype.addNoteOff=a.prototype.noteOff=function(t,e,n,r){return this.events.push(new i({type:i.NOTE_OFF,channel:t,param1:o.ensureMidiPitch(e),param2:r||90,time:n||0})),this},a.prototype.addNote=a.prototype.note=function(t,e,n,r,i){return this.noteOn(t,e,r,i),n&&this.noteOff(t,e,n,i),this},a.prototype.addChord=a.prototype.chord=function(n,t,r,e){if(!Array.isArray(t)&&!t.length)throw new Error("Chord must be an array of pitches");return t.forEach(function(t){this.noteOn(n,t,0,e)},this),t.forEach(function(t,e){0===e?this.noteOff(n,t,r):this.noteOff(n,t)},this),this},a.prototype.setInstrument=a.prototype.instrument=function(t,e,n){return this.events.push(new i({type:i.PROGRAM_CHANGE,channel:t,param1:e,time:n||0})),this},a.prototype.setTempo=a.prototype.tempo=function(t,e){return this.events.push(new n({type:n.TEMPO,data:o.mpqnFromBpm(t),time:e||0})),this},a.prototype.toBytes=function(){var e=0,n=[],t=a.START_BYTES,r=a.END_BYTES;this.events.forEach(function(t){t=t.toBytes();e+=t.length,n.push.apply(n,t)}),e+=r.length;var i=o.str2Bytes(e.toString(16),4);return t.concat(i,n,r)};var r=function(t){if(!this)return new r(t);t=t||{};if(t.ticks){if("number"!=typeof t.ticks)throw new Error("Ticks per beat must be a number!");if(t.ticks<=0||32768<=t.ticks||t.ticks%1!=0)throw new Error("Ticks per beat must be an integer between 1 and 32767!")}this.ticks=t.ticks||128,this.tracks=t.tracks||[]};r.HDR_CHUNKID="MThd",r.HDR_CHUNK_SIZE="\0\0\0",r.HDR_TYPE0="\0\0",r.HDR_TYPE1="\0",r.prototype.addTrack=function(t){return t?(this.tracks.push(t),this):(t=new a,this.tracks.push(t),t)},r.prototype.toBytes=function(){var t=this.tracks.length.toString(16),e=r.HDR_CHUNKID+r.HDR_CHUNK_SIZE;return 1<parseInt(t,16)?e+=r.HDR_TYPE1:e+=r.HDR_TYPE0,e+=o.codes2Str(o.str2Bytes(t,2)),e+=String.fromCharCode(this.ticks/256,this.ticks%256),this.tracks.forEach(function(t){e+=o.codes2Str(t.toBytes())}),e},t.Util=o,t.File=r,t.Track=a,t.Event=i,t.MetaEvent=n}(e),null!==t?t.exports=e:null!==n?n=e:this.Midi=e}).call(this,e(4)(t))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.scales=r.scales,e.modes=r.scales,e.chords=r.chords,e.scale=r.scale,e.mode=r.scale,e.chord=r.chord;r=n(5);e.clip=r.clip;r=n(6);e.getChordDegrees=r.getChordDegrees,e.getChordsByProgression=r.getChordsByProgression,e.progression=r.progression;r=n(7);e.arp=r.arp;r=n(8);e.midi=r.midi;n=n(10);e.Session=n.Session},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,u,e){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},o=this&&this.__awaiter||function(t,a,s,u){return new(s=s||Promise)(function(n,e){function r(t){try{o(u.next(t))}catch(t){e(t)}}function i(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof s?e:new s(function(t){t(e)})).then(r,i)}o((u=u.apply(t,a||[])).next())})},a=this&&this.__generator||function(n,r){var i,o,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=2&e[0]?o.return:e[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,e[1])).done)return a;switch(o=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,o=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!((a=0<(a=s.trys).length&&a[a.length-1])||6!==e[0]&&2!==e[0])){s=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){s.label=e[1];break}if(6===e[0]&&s.label<a[1]){s.label=a[1],a=e;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(e);break}a[2]&&s.ops.pop(),s.trys.pop();continue}e=r.call(n,s)}catch(t){e=[6,t],o=0}finally{i=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(u,"__esModule",{value:!0});function n(t){if(l.isNote(t))return[t];if(Array.isArray(t))return t.forEach(function(t){if(!l.isNote(t))throw new TypeError("array must comprise valid notes")}),t;if(!Array.isArray(t)){var e=r.chord(t);if(e&&e.length)return e}throw new Error("Chord "+t+" not found")}function s(t,e,n){return"R"===t&&e.randomNotes?e.randomNotes[void 0===(t=e.randomNotes.length-1)&&(t=1),Math.round(Math.random()*t)]:e.notes[n%e.notes.length]}function c(t,e){return t.durations?t.durations[e%t.durations.length]:t.dur||t.subdiv||"8n"}var l=e(1),r=e(0);u.recursivelyApplyPatternToDurations=function(t,e,n){return void 0===n&&(n=[]),t.forEach(function(t){"string"==typeof t&&("x"!==t&&"R"!==t||n.push(e),"_"===t&&n.length&&(n[n.length-1]+=e)),Array.isArray(t)&&u.recursivelyApplyPatternToDurations(t,e/t.length,n)}),n};function p(t,e){var n;if(e=e||Tone.getContext(),!t.pattern)throw new Error("No pattern provided!");if(!(t.player||t.instrument||t.sample||t.buffer||t.synth||t.sampler||t.samples))throw new Error("No player or instrument provided!");t.durations||t.dur||(t.durations=u.recursivelyApplyPatternToDurations(l.expandStr(t.pattern),Tone.Ticks(t.subdiv||"4n").toSeconds()));var r,i,o=[];return t.effects&&(Array.isArray(t.effects)||(t.effects=[t.effects]),o=t.effects.map(function(t){return("string"==typeof t?new Tone[t]({context:e}):t.context!==e?d(t,e):t).toDestination()}).map(function(t){return"function"==typeof t.start?t.start():t})),t.synth&&!t.instrument&&(t.instrument=t.synth,console.warn('The "synth" parameter will be deprecated in the future. Please use the "instrument" parameter instead.')),t.instrument=t.sample||t.buffer?new Tone.Player({url:t.sample||t.buffer,context:e}):t.sampler||t.player||(t.samples?new Tone.Sampler({url:t.samples,context:e}):"string"==typeof t.instrument?new Tone[t.instrument]({context:e}):t.instrument),t.instrument.context!==e&&(t.instrument=d(t.instrument,e)),t.volume&&(t.instrument.volume.value=t.volume),(n=t.instrument).chain.apply(n,o).toDestination(),new Tone.Sequence({callback:(i=0,(r=t).instrument instanceof Tone.Player?function(t,e){"x"!==e&&"R"!==e||(r.instrument.start(t),i++)}:r.instrument instanceof Tone.PolySynth||r.instrument instanceof Tone.Sampler?function(t,e){"x"!==e&&"R"!==e||(r.instrument.triggerAttackRelease(s(e,r,i),c(r,i),t),i++)}:r.instrument instanceof Tone.NoiseSynth?function(t,e){"x"!==e&&"R"!==e||(r.instrument.triggerAttackRelease(c(r,i),t),i++)}:function(t,e){"x"!==e&&"R"!==e||(r.instrument.triggerAttackRelease(s(e,r,i)[0],c(r,i),t),i++)}),events:l.expandStr(t.pattern),subdivision:t.subdiv||"4n",context:e})}u.totalPatternDuration=function(t,e){return"number"==typeof e?e*l.expandStr(t).length:Tone.Ticks(e).toSeconds()*l.expandStr(t).length},u.renderingDuration=function(t,e,n,r){var i=t.split("").filter(function(t){return"x"===t}).length,o=t.split("").filter(function(t){return"R"===t}).length,a=null!==r&&void 0!==r&&r.length?i:i+o,s=n.length||1;return u.totalPatternDuration(t,e)/a*function(){for(var t=s<a?[s,a]:[a,s],e=t[0],n=t[1],r=n;r%e!=0;)r+=n;return r}()};var h,f=0,d=function(t,e){if(t instanceof Tone.PolySynth)return new Tone.PolySynth(Tone[t._dummyVoice.name],i(i({},t.get()),{context:e}));if(t instanceof Tone.Player)return new Tone.Player({url:t._buffer,context:e});if(t instanceof Tone.Sampler){var n=t.get(),r={attack:n.attack,curve:n.curve,release:n.release,volume:n.volume},n={baseUrl:t._buffers.baseUrl,urls:Object.fromEntries(t._buffers._buffers.entries())};return new Tone.Sampler(i(i(i({},r),n),{context:e}))}return new Tone[t.name](i(i({},t.get()),{context:e}))};u.clip=function(t){if("string"==typeof(t=i(i({},{notes:["C4"],pattern:"x",shuffle:!1,sizzle:!1,sizzleReps:1,arpegiate:!1,subdiv:"4n",amp:100,accentLow:70,randomNotes:null,effects:[],offlineRendering:!1}),t||{})).notes&&(t.notes=t.notes.replace(/\s{2,}/g," "),t.notes=t.notes.split(" ")),t.notes=t.notes.map(n),/[^x\-_\[\]R]/.test(t.pattern))throw new TypeError("pattern can only comprise x - _ [ ], found "+t.pattern);return t.shuffle&&(t.notes=l.shuffle(t.notes)),t.randomNotes&&"string"==typeof t.randomNotes&&(t.randomNotes=t.randomNotes.replace(/\s{2,}/g," ").split(/\s/)),t.randomNotes&&(t.randomNotes=t.randomNotes.map(n)),t.offlineRendering?function(r,t){h=h||Tone.getContext(),f++;var e=new Tone.Player({context:h,loop:!0});return Tone.Offline(function(n){return o(void 0,void 0,void 0,function(){var e;return a(this,function(t){switch(t.label){case 0:return e=p(r,n),[4,Tone.loaded()];case 1:return t.sent(),e.start(),n.transport.start(),[2]}})})},t).then(function(t){e.buffer=t,0==--f&&(Tone.setContext(h),null===(t=r.offlineRenderingCallback)||void 0===t||t.call(r))}),e.toDestination(),e.sync(),e}(t,u.renderingDuration(t.pattern,t.subdiv||"4n",t.notes,t.randomNotes)):p(t,h)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),a=n(1);e.getChordDegrees=function(t){var e={ionian:["I","ii","iii","IV","V","vi","vii°"],dorian:["i","ii","III","IV","v","vi°","VII"],phrygian:["i","II","III","iv","v°","VI","vii"],lydian:["I","II","iii","iv°","V","vi","vii"],mixolydian:["I","ii","iii°","IV","v","vi","VII"],aeolian:["i","ii°","III","iv","v","VI","VII"],locrian:["i°","II","iii","iv","V","VI","vii"],"melodic minor":["i","ii","III+","IV","V","vi°","vii°"],"harmonic minor":["i","ii°","III+","iv","V","VI","vii°"]};return e.major=e.ionian,e.minor=e.aeolian,e[t]||[]};var s={i:0,ii:1,iii:2,iv:3,v:4,vi:5,vii:6};e.getChordsByProgression=function(t,e){var n=t.split(" ");n[0].match(/\d/)||(n[0]+="4",t=n.join(" "));var o=r.scale(t);return e.replace(/\s*,+\s*/g," ").split(" ").map(function(t,e){var n,r,i,n=(r=(n=t).replace(/\W/g,""),i="M",r.toLowerCase()===r&&(i="m"),-1<n.indexOf("°")?i+"7b5":-1<n.indexOf("+")?i+"#5":-1<n.indexOf("7")?"M"===i?"Maj7":"m7":i),i=s[t.replace(/\W|\d/g,"").toLowerCase()],t=o[i],i=t.replace(/\D+/,"");return t.replace(/\d/,"")+n+"-"+i}).toString().replace(/,/g," ")};var n=function(t){var r=t.T,i=t.P,o=t.D;return function(t){void 0===t&&(t=4);var e=[];e.push(a.pickOne(r));var n=1;for(n<t-1&&(e.push(a.pickOne(i)),n++),n<t-1&&a.dice()&&(e.push(a.pickOne(i)),n++),n<t-1&&(e.push(a.pickOne(o)),n++),n<t-1&&(e.push(a.pickOne(i)),n++),n<t-1&&(e.push(a.pickOne(o)),n++),n<t-1&&a.dice()&&(e.push(a.pickOne(i)),n++);n<t;)e.push(a.pickOne(o)),n++;return e}},i=n({T:["I","vi"],P:["ii","IV"],D:["V"]}),o=n({T:["i","VI"],P:["ii","iv"],D:["V"]});e.progression=function(t,e){return void 0===e&&(e=4),"major"===t||"M"===t?i(e):"minor"===t||"m"===t?o(e):void 0}},function(t,e,n){"use strict";var s=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r};Object.defineProperty(e,"__esModule",{value:!0});function u(t,e){var n=function(t){return t.replace(/\d/,"")+(+t.replace(/\D/g,"")+1)},r=t.map(n),n=r.map(n);return s(t,r,n).slice(0,e)}var c=n(0);e.arp=function(t){var n=[],r={count:4,order:"0123",chords:""};if("string"==typeof t)r.chords=t;else{if(t.order&&t.order.match(/\D/g))throw new TypeError("Invalid value for order");if(8<t.count||t.count<2)throw new TypeError("Invalid value for count");t.count&&!t.order&&(r.order=Array.from(Array(t.count).keys()).join("")),Object.assign(r,t)}if("string"==typeof r.chords)for(var e=0,i=r.chords.split(" ");e<i.length;e++)!function(t){var e=u(c.chord(t),r.count),t=r.order.split("").map(function(t){return e[t]});n=s(n,t)}(i[e]);else{if(!Array.isArray(r.chords))throw new TypeError("Invalid value for chords");for(var o=0,a=r.chords;o<a.length;o++)!function(t){var e=u(t,r.count),t=r.order.split("").map(function(t){return e[t]});n=s(n,t)}(a[o])}return n}},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var o=r(n(9)),u=i(n(2));e.midi=function(t,e,n){void 0===e&&(e="music.mid");n=s(t,n).toBytes();return null===e?n:(e.endsWith(".mid")||(e+=".mid"),"undefined"!=typeof window&&window.URL&&window.URL.createObjectURL?a(n,e):(o.default.writeFileSync(e,n,"binary"),void console.log("MIDI file generated: "+e+".")))};var a=function(t,e){for(var n=new Uint8Array(t.length),r=0;r<t.length;r++){var i=t.charCodeAt(r);n[r]=i}var o=new Blob([n],{type:"audio/midi"}),a=document.createElement("a");return a.href="undefined"!=typeof window&&void 0!==window.URL&&void 0!==window.URL.createObjectURL&&window.URL.createObjectURL(o)||"",a.download=e,a.innerText="Download MIDI file",a},s=function(t,e){var n=new u.File,r=new u.Track;"number"==typeof e&&r.setTempo(e),n.addTrack(r);for(var i=0,o=t;i<o.length;i++){var a=o[i],s=a.level||127;a.note?"string"==typeof a.note?(r.noteOn(0,a.note,a.length,s),r.noteOff(0,a.note,a.length,s)):r.addChord(0,a.note,a.length,s):r.noteOff(0,"",a.length)}return n}},function(t,e){t.exports=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(11),n=(i.prototype.createChannel=function(t){t.idx=t.idx||this.sessionChannels.length;t=new r.Channel(t);return this.sessionChannels.push(t),t},Object.defineProperty(i.prototype,"channels",{get:function(){return this.sessionChannels},enumerable:!0,configurable:!0}),i.prototype.startRow=function(e){this.sessionChannels.forEach(function(t){t.startClip(e)})},i.prototype.play=function(t){function u(t,e){t.map(function(t){return t.stop(e)})}var c=this,e=t.channelPatterns,t=t.clipDuration||"4:0:0",l=Tone.Time(t).toSeconds();e.forEach(function(t){var i=t.channelIdx,t=t.pattern,o=[],a=0,s="-";t.split("").forEach(function(t){var e,n,r;t!==s&&"_"!==t&&(u(o,a),e=i,r=a,o="-"===(n=t)?[]:c.channels.filter(function(t){return t.idx===e}).map(function(t){return t.clips[n].start(r)})),s=t,a+=l}),u(o,a)})},i);function i(t){t=t||[],this.sessionChannels=t.map(function(t,e){return t.idx=t.idx||e,new r.Channel(t)})}e.Session=n},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=this&&this.__rest||function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};Object.defineProperty(e,"__esModule",{value:!0});function o(){var t=Tone.Transport.position.split(":");return"0"===t[0]&&"0"===t[1]?0:+t[0]+1+":0:0"}var a=n(12),n=(Object.defineProperty(s.prototype,"clips",{get:function(){return this.channelClips},enumerable:!0,configurable:!0}),s.prototype.startClip=function(t){-1<this.activePatternIdx&&this.activePatternIdx!==t&&this.stopClip(this.activePatternIdx),this.channelClips[t]&&"started"!==this.channelClips[t].state&&(this.activePatternIdx=t,this.channelClips[t].start(o()))},s.prototype.stopClip=function(t){this.channelClips[t].stop(o())},s.prototype.addClip=function(t,e){e=e||this.channelClips.length,t.pattern?this.channelClips[e]=a.clip(r({player:this.player,instrument:this.instrument,sampler:this.sampler},t)):this.channelClips[e]=null},Object.defineProperty(s.prototype,"activeClipIdx",{get:function(){return this.activePatternIdx},enumerable:!0,configurable:!0}),s);function s(t){var e=this;this.idx=t.idx||0,this.activePatternIdx=-1,this.channelClips=[],t.sample&&(this.player=new Tone.Player(t.sample)),t.synth&&(this.instrument=new Tone[t.synth]),t.samples&&(this.sampler=new Tone.Sampler(t.samples)),t.clips,t.samples,t.sample,t.synth;var n=i(t,["clips","samples","sample","synth"]);t.clips.forEach(function(t){e.addClip(r(r({},t),n))},this)}e.Channel=n},function(t,e,n){"use strict";var y=this&&this.__assign||function(){return(y=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});function H(t){if(v.isNote(t))return[t];if(Array.isArray(t))return t.forEach(function(t){if(!v.isNote(t))throw new TypeError("array must comprise valid notes")}),t;if(!Array.isArray(t)){var e=r.chord(t);if(e&&e.length)return e}throw new Error("Chord "+t+" not found")}var v=n(1),r=n(0),W={"1m":2048,"2m":4096,"3m":6144,"4m":8192,"1n":512,"2n":256,"4n":128,"8n":64,"16n":32};e.clip=function(r){if("string"==typeof(r=y(y({},{notes:["C4"],pattern:"x",shuffle:!1,sizzle:!1,sizzleReps:1,arpegiate:!1,subdiv:"4n",amp:100,accentLow:70,randomNotes:null,effects:[],offlineRendering:!1}),r||{})).notes&&(r.notes=r.notes.replace(/\s{2,}/g," "),r.notes=r.notes.split(" ")),r.notes=r.notes.map(H),/[^x\-_\[\]R]/.test(r.pattern))throw new TypeError("pattern can only comprise x - _ [ ], found "+r.pattern);r.shuffle&&(r.notes=v.shuffle(r.notes)),r.randomNotes&&"string"==typeof r.randomNotes&&(r.randomNotes=r.randomNotes.replace(/\s{2,}/g," ").split(/\s/)),r.randomNotes&&(r.randomNotes=r.randomNotes.map(H));var i=[],o=0,a=function(t,n){t.forEach(function(t){var e;"string"==typeof t&&(e=null,"x"===t&&(e=r.notes[o],o++),"R"===t&&(Math.round(Math.random())||r.randomNotes)&&(e=r.randomNotes?r.randomNotes[Math.round(Math.random()*(r.randomNotes.length-1))]:r.notes[o],o++),"x"!==t&&"-"!==t&&"R"!==t||i.push({note:e,length:n,level:"R"!==t||r.randomNotes?r.amp:r.accentLow}),"_"===t&&i.length&&(i[i.length-1].length+=n),o===r.notes.length&&(o=0)),Array.isArray(t)&&a(t,n/t.length)})};if(a(v.expandStr(r.pattern),W[r.subdiv]||W["4n"]),r.sizzle){var t=[],e=!0===r.sizzle?"sin":r.sizzle,n=i.length,s=r.amp,u=r.sizzleReps,c=s/(n/u);if("sin"===e||"cos"===e)for(var l=0;l<n;l++){var p=Math[e](l*Math.PI/(n/u))*s;t.push(Math.round(Math.abs(p)))}if("rampUp"===e)for(l=p=0;l<n;l++)l%(n/u)==0?p=0:p+=c,t.push(Math.round(Math.abs(p)));if("rampDown"===e)for(p=s,l=0;l<n;l++)l%(n/u)==0?p=s:p-=c,t.push(Math.round(Math.abs(p)));for(l=0;l<t.length;l++)i[l].level=t[l]||1}if(r.accent){if(/[^x\-]/.test(r.accent))throw new TypeError("Accent can only have x and - characters");for(var h=0,f=0,d=i;f<d.length;f++){var m=d[f],p="x"===r.accent[h]?r.amp:r.accentLow;r.sizzle&&(p=(m.level+p)/2),m.level=Math.round(p),(h+=1)===r.accent.length&&(h=0)}}return i}}],i.c=o,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=3);function i(t){if(o[t])return o[t].exports;var e=o[t]={i:t,l:!1,exports:{}};return r[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}var r,o});