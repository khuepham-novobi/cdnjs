define(["./when-54c2dc71","./Check-6c0211bc","./Math-fc8cecf5","./Cartesian2-bddc1162","./Transforms-43808565","./RuntimeError-2109023a","./WebGLConstants-76bb35d1","./ComponentDatatype-6d99a1ee","./GeometryAttribute-49698167","./GeometryAttributes-4fcfcf40","./IndexDatatype-53503fee","./GeometryOffsetAttribute-7350d9af","./EllipsoidRhumbLine-c704bf4c","./PolygonPipeline-c425d4a8","./RectangleGeometryLibrary-98225f15"],function(s,e,c,p,f,t,i,b,_,v,E,g,a,h,A){"use strict";var y=new f.BoundingSphere,m=new f.BoundingSphere,G=new p.Cartesian3,R=new p.Rectangle;function P(e,t){var i=e._ellipsoid,a=t.height,r=t.width,n=t.northCap,o=t.southCap,l=a,u=2,s=0,e=4;n&&(--u,--l,s+=1,e-=2),o&&(--u,--l,s+=1,e-=2),s+=u*r+2*l-e;var c,p=new Float64Array(3*s),d=0,f=0,g=G;if(n)A.RectangleGeometryLibrary.computePosition(t,i,!1,f,0,g),p[d++]=g.x,p[d++]=g.y,p[d++]=g.z;else for(c=0;c<r;c++)A.RectangleGeometryLibrary.computePosition(t,i,!1,f,c,g),p[d++]=g.x,p[d++]=g.y,p[d++]=g.z;for(c=r-1,f=1;f<a;f++)A.RectangleGeometryLibrary.computePosition(t,i,!1,f,c,g),p[d++]=g.x,p[d++]=g.y,p[d++]=g.z;if(f=a-1,!o)for(c=r-2;0<=c;c--)A.RectangleGeometryLibrary.computePosition(t,i,!1,f,c,g),p[d++]=g.x,p[d++]=g.y,p[d++]=g.z;for(c=0,f=a-2;0<f;f--)A.RectangleGeometryLibrary.computePosition(t,i,!1,f,c,g),p[d++]=g.x,p[d++]=g.y,p[d++]=g.z;for(var o=p.length/3*2,h=E.IndexDatatype.createTypedArray(p.length/3,o),y=0,m=0;m<p.length/3-1;m++)h[y++]=m,h[y++]=m+1;h[y++]=p.length/3-1,h[y++]=0;o=new _.Geometry({attributes:new v.GeometryAttributes,primitiveType:_.PrimitiveType.LINES});return o.attributes.position=new _.GeometryAttribute({componentDatatype:b.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:p}),o.indices=h,o}function d(e){var t=(e=s.defaultValue(e,s.defaultValue.EMPTY_OBJECT)).rectangle,i=s.defaultValue(e.granularity,c.CesiumMath.RADIANS_PER_DEGREE),a=s.defaultValue(e.ellipsoid,p.Ellipsoid.WGS84),r=s.defaultValue(e.rotation,0),n=s.defaultValue(e.height,0),o=s.defaultValue(e.extrudedHeight,n);this._rectangle=p.Rectangle.clone(t),this._granularity=i,this._ellipsoid=a,this._surfaceHeight=Math.max(n,o),this._rotation=r,this._extrudedHeight=Math.min(n,o),this._offsetAttribute=e.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}d.packedLength=p.Rectangle.packedLength+p.Ellipsoid.packedLength+5,d.pack=function(e,t,i){return i=s.defaultValue(i,0),p.Rectangle.pack(e._rectangle,t,i),i+=p.Rectangle.packedLength,p.Ellipsoid.pack(e._ellipsoid,t,i),i+=p.Ellipsoid.packedLength,t[i++]=e._granularity,t[i++]=e._surfaceHeight,t[i++]=e._rotation,t[i++]=e._extrudedHeight,t[i]=s.defaultValue(e._offsetAttribute,-1),t};var w=new p.Rectangle,L=p.Ellipsoid.clone(p.Ellipsoid.UNIT_SPHERE),C={rectangle:w,ellipsoid:L,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};d.unpack=function(e,t,i){t=s.defaultValue(t,0);var a=p.Rectangle.unpack(e,t,w);t+=p.Rectangle.packedLength;var r=p.Ellipsoid.unpack(e,t,L);t+=p.Ellipsoid.packedLength;var n=e[t++],o=e[t++],l=e[t++],u=e[t++],t=e[t];return s.defined(i)?(i._rectangle=p.Rectangle.clone(a,i._rectangle),i._ellipsoid=p.Ellipsoid.clone(r,i._ellipsoid),i._surfaceHeight=o,i._rotation=l,i._extrudedHeight=u,i._offsetAttribute=-1===t?void 0:t,i):(C.granularity=n,C.height=o,C.rotation=l,C.extrudedHeight=u,C.offsetAttribute=-1===t?void 0:t,new d(C))};var D=new p.Cartographic;return d.createGeometry=function(d){var e=d._rectangle,t=d._ellipsoid,i=A.RectangleGeometryLibrary.computeOptions(e,d._granularity,d._rotation,0,R,D);if(!c.CesiumMath.equalsEpsilon(e.north,e.south,c.CesiumMath.EPSILON10)&&!c.CesiumMath.equalsEpsilon(e.east,e.west,c.CesiumMath.EPSILON10)){var a,r,n,o=d._surfaceHeight,l=d._extrudedHeight,u=c.CesiumMath.equalsEpsilon(o,l,0,c.CesiumMath.EPSILON2)?((a=P(d,i)).attributes.position.values=h.PolygonPipeline.scaleToGeodeticHeight(a.attributes.position.values,o,t,!1),s.defined(d._offsetAttribute)&&(n=a.attributes.position.values.length,r=new Uint8Array(n/3),n=d._offsetAttribute===g.GeometryOffsetAttribute.NONE?0:1,g.arrayFill(r,n),a.attributes.applyOffset=new _.GeometryAttribute({componentDatatype:b.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:r})),f.BoundingSphere.fromRectangle3D(e,t,o)):(a=function(e){var t=d._surfaceHeight,i=d._extrudedHeight,a=d._ellipsoid,r=i,n=t,o=P(d,e),l=e.height,i=e.width,t=h.PolygonPipeline.scaleToGeodeticHeight(o.attributes.position.values,n,a,!1),u=t.length,n=new Float64Array(2*u);n.set(t);r=h.PolygonPipeline.scaleToGeodeticHeight(o.attributes.position.values,r,a);n.set(r,u),o.attributes.position.values=n;a=e.northCap,r=e.southCap,e=4;a&&--e,r&&--e;for(var e=2*(n.length/3+e),s=E.IndexDatatype.createTypedArray(n.length/3,e),u=n.length/6,c=0,p=0;p<u-1;p++)s[c++]=p,s[c++]=p+1,s[c++]=p+u,s[c++]=p+u+1;return s[c++]=u-1,s[c++]=0,s[c++]=u+u-1,s[c++]=u,s[c++]=0,s[c++]=u,l=a?l-1:(a=i-1,s[c++]=a,s[c++]=a+u,i+l-2),s[c++]=l,s[c++]=l+u,r||(l=i+l-1,s[c++]=l,s[c]=l+u),o.indices=s,o}(i),s.defined(d._offsetAttribute)&&(i=a.attributes.position.values.length/3,u=new Uint8Array(i),u=d._offsetAttribute===g.GeometryOffsetAttribute.TOP?g.arrayFill(u,1,0,i/2):(n=d._offsetAttribute===g.GeometryOffsetAttribute.NONE?0:1,g.arrayFill(u,n)),a.attributes.applyOffset=new _.GeometryAttribute({componentDatatype:b.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:u})),o=f.BoundingSphere.fromRectangle3D(e,t,o,m),u=f.BoundingSphere.fromRectangle3D(e,t,l,y),f.BoundingSphere.union(o,u));return new _.Geometry({attributes:a.attributes,indices:a.indices,primitiveType:_.PrimitiveType.LINES,boundingSphere:u,offsetAttribute:d._offsetAttribute})}},function(e,t){return s.defined(t)&&(e=d.unpack(e,t)),e._ellipsoid=p.Ellipsoid.clone(e._ellipsoid),e._rectangle=p.Rectangle.clone(e._rectangle),d.createGeometry(e)}});