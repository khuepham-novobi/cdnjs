!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).CordovaAuth0Plugin=t()}(this,function(){"use strict";var e="9.13.4",t=Object.prototype.toString;function u(e,t,r,n){if(r="array"===r?"object":r,e&&typeof e[t]!==r)throw new Error(n)}function a(e,t,r){if(typeof e!==t)throw new Error(r)}function c(e,t,r){if(-1===t.indexOf(e))throw new Error(r)}var s={check:function(e,t,r){if(t.optional&&!e||a(e,t.type,t.message),"object"===t.type&&r)for(var n=Object.keys(r),o=0;o<n.length;o++){var i=n[o];r[i].optional&&!e[i]||r[i].condition&&!r[i].condition(e)||(u(e,i,r[i].type,r[i].message),r[i].values&&c(e[i],r[i].values,r[i].value_message))}},attribute:u,variable:a,value:c,isArray:function(e){return this.supportsIsArray()?Array.isArray(e):"[object Array]"===t.call(e)},supportsIsArray:function(){return null!=Array.isArray}};function r(e){if(null==e)throw new TypeError("Cannot convert first argument to object");for(var t=Object(e),r=1;r<arguments.length;r++){var n=arguments[r];if(null!=n)for(var o=Object.keys(Object(n)),i=0,u=o.length;i<u;i++){var a=o[i],c=Object.getOwnPropertyDescriptor(n,a);void 0!==c&&c.enumerable&&(t[a]=n[a])}}return t}var n={get:function(){return Object.assign||r},objectAssignPolyfill:r};function o(r,e){return e.reduce(function(e,t){return r[t]&&(e[t]=r[t]),e},{})}function i(){var e=function(e){var t,r=[];for(t in e)r.push(e[t]);return r}(arguments);return e.unshift({}),n.get().apply(void 0,e)}function p(e){var t=e.match(/^(https?:|file:|chrome-extension:)\/\/(([^:/?#]*)(?::([0-9]+))?)([/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);return t&&{href:e,protocol:t[1],host:t[2],hostname:t[3],port:t[4],pathname:t[5],search:t[6],hash:t[7]}}function l(e,t){var r=i(e);return e[t]&&(r[t]=e[t].trim()),r}var f={toSnakeCase:function r(n,o){return"object"!=typeof n||s.isArray(n)||null===n?n:(o=o||[],Object.keys(n).reduce(function(e,t){return e[-1===o.indexOf(t)?function(e){for(var t,r="",n=0,o=!0,i=!0;n<e.length;)t=e.charCodeAt(n),(!i&&65<=t&&t<=90||!o&&48<=t&&t<=57)&&(r+="_"),r+=e[n].toLowerCase(),o=48<=t&&t<=57,i=65<=t&&t<=90,n++;return r}(t):t]=r(n[t]),e},{}))},toCamelCase:function n(o,i,u){return"object"!=typeof o||s.isArray(o)||null===o?o:(i=i||[],u=u||{},Object.keys(o).reduce(function(e,t){var r=-1===i.indexOf(t)?(r=(r=t).split("_")).reduce(function(e,t){return e+t.charAt(0).toUpperCase()+t.slice(1)},r.shift()):t;return e[r]=n(o[r]||o[t],[],u),u.keepOriginal&&(e[t]=n(o[t],[],u)),e},{}))},blacklist:function(r,n){return Object.keys(r).reduce(function(e,t){return-1===n.indexOf(t)&&(e[t]=r[t]),e},{})},merge:function(e,t){return{base:t?o(e,t):e,with:function(e,t){return e=t?o(e,t):e,i(this.base,e)}}},pick:o,getKeysNotIn:function(e,t){var r,n=[];for(r in e)-1===t.indexOf(r)&&n.push(r);return n},extend:i,getOriginFromUrl:function(e){if(e){var t=p(e);if(!t)return null;e=t.protocol+"//"+t.hostname;return t.port&&(e+=":"+t.port),e}},getLocationFromUrl:p,trimUserDetails:function(e){return["username","email","phoneNumber"].reduce(l,e)},updatePropertyOn:function e(t,r,n){"string"==typeof r&&(r=r.split("."));var o=r[0];t.hasOwnProperty(o)&&(1===r.length?t[o]=n:e(t[o],r.slice(1),n))}};function h(){return window}var d={redirect:function(e){h().location=e},getDocument:function(){return h().document},getWindow:h,getOrigin:function(){var e=h().location;return e.origin||f.getOriginFromUrl(e.href)}},y="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function b(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)void 0!==e[n]&&(r[n]=e[n]);return r}function m(e,t){P.apply(e,D(t)?t:[t])}function w(e,t,r,n,o,i,u,a,c,s,p,l,f){var h=e;if("function"==typeof u?h=u(t,h):h instanceof Date?h=s(h):"comma"===r&&D(h)&&(h=A.maybeMap(h,function(e){return e instanceof Date?s(e):e}).join(",")),null===h){if(n)return i&&!l?i(t,F.encoder,f,"key"):t;h=""}if(e=h,"string"==typeof e||"number"==typeof e||"boolean"==typeof e||"symbol"==typeof e||"bigint"==typeof e||A.isBuffer(h))return i?[p(l?t:i(t,F.encoder,f,"key"))+"="+p(i(h,F.encoder,f,"value"))]:[p(t)+"="+p(String(h))];var d,y=[];if(void 0===h)return y;d=D(u)?u:(e=Object.keys(h),a?e.sort(a):e);for(var b=0;b<d.length;++b){var v=d[b],g=h[v];o&&null===g||(v=D(h)?"function"==typeof r?r(t,v):t:t+(c?"."+v:"["+v+"]"),m(y,w(g,v,r,n,o,i,u,a,c,s,p,l,f)))}return y}var v,g=(function(e){var t,r;t=y,r=function(){return function(){var e="object"==typeof arguments[0]?arguments[0]:[].slice.call(arguments);return function(e){var t=[];if(0===e.length)return"";if("string"!=typeof e[0])throw new TypeError("Url must be a string. Received "+e[0]);e[0].match(/^[^/:]+:\/*$/)&&1<e.length&&(i=e.shift(),e[0]=i+e[0]),e[0].match(/^file:\/\/\//)?e[0]=e[0].replace(/^([^/:]+):\/*/,"$1:///"):e[0]=e[0].replace(/^([^/:]+):\/*/,"$1://");for(var r=0;r<e.length;r++){var n=e[r];if("string"!=typeof n)throw new TypeError("Url must be a string. Received "+n);""!==n&&(0<r&&(n=n.replace(/^[\/]+/,"")),n=r<e.length-1?n.replace(/[\/]+$/,""):n.replace(/[\/]+$/,"/"),t.push(n))}var o=t.join("/"),i=(o=o.replace(/\/(\?|&|#[^!])/g,"$1")).split("?");return o=i.shift()+(0<i.length?"?":"")+i.join("&")}(e)}},e.exports?e.exports=r():t.urljoin=r()}(v={exports:{}}),v.exports),j=Object.prototype.hasOwnProperty,O=Array.isArray,_=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),A={arrayToObject:b,assign:function(e,r){return Object.keys(r).reduce(function(e,t){return e[t]=r[t],e},e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var o=t[n],i=o.obj[o.prop],u=Object.keys(i),a=0;a<u.length;++a){var c=u[a],s=i[c];"object"==typeof s&&null!==s&&-1===r.indexOf(s)&&(t.push({obj:i,prop:c}),r.push(s))}return function(e){for(;1<e.length;){var t=e.pop(),r=t.obj[t.prop];if(O(r)){for(var n=[],o=0;o<r.length;++o)void 0!==r[o]&&n.push(r[o]);t.obj[t.prop]=n}}}(t),e},decode:function(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(e){return n}},encode:function(e,t,r){if(0===e.length)return e;var n=e;if("symbol"==typeof e?n=Symbol.prototype.toString.call(e):"string"!=typeof e&&(n=String(e)),"iso-8859-1"===r)return escape(n).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});for(var o="",i=0;i<n.length;++i){var u=n.charCodeAt(i);45===u||46===u||95===u||126===u||48<=u&&u<=57||65<=u&&u<=90||97<=u&&u<=122?o+=n.charAt(i):u<128?o+=_[u]:u<2048?o+=_[192|u>>6]+_[128|63&u]:u<55296||57344<=u?o+=_[224|u>>12]+_[128|u>>6&63]+_[128|63&u]:(i+=1,u=65536+((1023&u)<<10|1023&n.charCodeAt(i)),o+=_[240|u>>18]+_[128|u>>12&63]+_[128|u>>6&63]+_[128|63&u])}return o},isBuffer:function(e){return!(!e||"object"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(O(e)){for(var r=[],n=0;n<e.length;n+=1)r.push(t(e[n]));return r}return t(e)},merge:function n(o,i,u){if(!i)return o;if("object"!=typeof i){if(O(o))o.push(i);else{if(!o||"object"!=typeof o)return[o,i];(u&&(u.plainObjects||u.allowPrototypes)||!j.call(Object.prototype,i))&&(o[i]=!0)}return o}if(!o||"object"!=typeof o)return[o].concat(i);var e=o;return O(o)&&!O(i)&&(e=b(o,u)),O(o)&&O(i)?(i.forEach(function(e,t){var r;j.call(o,t)?(r=o[t])&&"object"==typeof r&&e&&"object"==typeof e?o[t]=n(r,e,u):o.push(e):o[t]=e}),o):Object.keys(i).reduce(function(e,t){var r=i[t];return j.call(e,t)?e[t]=n(e[t],r,u):e[t]=r,e},e)}},k=String.prototype.replace,x=/%20/g,E={RFC1738:"RFC1738",RFC3986:"RFC3986"},H=A.assign({default:E.RFC3986,formatters:{RFC1738:function(e){return k.call(e,x,"+")},RFC3986:function(e){return String(e)}}},E),C=Object.prototype.hasOwnProperty,S={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},D=Array.isArray,P=Array.prototype.push,N=Date.prototype.toISOString,E=H.default,F={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:A.encode,encodeValuesOnly:!1,format:E,formatter:H.formatters[E],indices:!1,serializeDate:function(e){return N.call(e)},skipNulls:!1,strictNullHandling:!1},R=(Object.prototype.hasOwnProperty,Array.isArray,function(e,t){var r=e,n=function(e){if(!e)return F;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||F.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=H.default;if(void 0!==e.format){if(!C.call(H.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var n=H.formatters[r],r=F.filter;return"function"!=typeof e.filter&&!D(e.filter)||(r=e.filter),{addQueryPrefix:("boolean"==typeof e.addQueryPrefix?e:F).addQueryPrefix,allowDots:void 0===e.allowDots?F.allowDots:!!e.allowDots,charset:t,charsetSentinel:("boolean"==typeof e.charsetSentinel?e:F).charsetSentinel,delimiter:(void 0===e.delimiter?F:e).delimiter,encode:("boolean"==typeof e.encode?e:F).encode,encoder:("function"==typeof e.encoder?e:F).encoder,encodeValuesOnly:("boolean"==typeof e.encodeValuesOnly?e:F).encodeValuesOnly,filter:r,formatter:n,serializeDate:("function"==typeof e.serializeDate?e:F).serializeDate,skipNulls:("boolean"==typeof e.skipNulls?e:F).skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:("boolean"==typeof e.strictNullHandling?e:F).strictNullHandling}}(t);"function"==typeof n.filter?r=(0,n.filter)("",r):D(n.filter)&&(u=n.filter);var o=[];if("object"!=typeof r||null===r)return"";e=t&&t.arrayFormat in S?t.arrayFormat:!(t&&"indices"in t)||t.indices?"indices":"repeat";var i=S[e],u=u||Object.keys(r);n.sort&&u.sort(n.sort);for(var a=0;a<u.length;++a){var c=u[a];n.skipNulls&&null===r[c]||m(o,w(r[c],c,i,n.strictNullHandling,n.skipNulls,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.formatter,n.encodeValuesOnly,n.charset))}t=o.join(n.delimiter),e=!0===n.addQueryPrefix?"?":"";return n.charsetSentinel&&("iso-8859-1"===n.charset?e+="utf8=%26%2310003%3B&":e+="utf8=%E2%9C%93&"),0<t.length?e+t:""});function U(e){this.webAuth=e,this._current_popup=null,this.options=null}function T(e){this.webAuth=e}function L(){this.webAuth=null,this.version=e,this.extensibilityPoints=["popup.authorize","popup.getPopupHandler"]}return U.prototype.preload=function(e){var t=this,r=d.getWindow(),n=e.url||"about:blank",e=e.popupOptions||{};e.location="yes",delete e.width,delete e.height;e=R(e,{encode:!1,delimiter:","});return this._current_popup&&!this._current_popup.closed||(this._current_popup=r.open(n,"_blank",e),this._current_popup.kill=function(e){t._current_popup.success=e,this.close(),t._current_popup=null}),this._current_popup},U.prototype.load=function(e,t,r,n){var o=this;this.url=e,this.options=r,this._current_popup?this._current_popup.location.href=e:(r.url=e,this.preload(r)),this.transientErrorHandler=function(e){o.errorHandler(e,n)},this.transientStartHandler=function(e){o.startHandler(e,n)},this.transientExitHandler=function(){o.exitHandler(n)},this._current_popup.addEventListener("loaderror",this.transientErrorHandler),this._current_popup.addEventListener("loadstart",this.transientStartHandler),this._current_popup.addEventListener("exit",this.transientExitHandler)},U.prototype.errorHandler=function(e,t){this._current_popup&&(this._current_popup.kill(!0),t({error:"window_error",errorDescription:e.message}))},U.prototype.unhook=function(){this._current_popup.removeEventListener("loaderror",this.transientErrorHandler),this._current_popup.removeEventListener("loadstart",this.transientStartHandler),this._current_popup.removeEventListener("exit",this.transientExitHandler)},U.prototype.exitHandler=function(e){this._current_popup&&(this.unhook(),this._current_popup.success||e({error:"window_closed",errorDescription:"Browser window closed"}))},U.prototype.startHandler=function(e,r){var t,n=this;this._current_popup&&(t=g("https:",this.webAuth.baseOptions.domain,"/mobile"),e.url&&0!==e.url.indexOf(t+"#")||1!==(e=e.url.split("#")).length&&(e={hash:e.pop()},this.options.nonce&&(e.nonce=this.options.nonce),this.webAuth.parseHash(e,function(e,t){(e||t)&&(n._current_popup.kill(!0),r(e,t))})))},T.prototype.processParams=function(e){return e.redirectUri=g("https://"+e.domain,"mobile"),delete e.owp,e},T.prototype.getPopupHandler=function(){return new U(this.webAuth)},L.prototype.setWebAuth=function(e){this.webAuth=e},L.prototype.supports=function(e){var t=d.getWindow();return(!!t.cordova||!!t.electron)&&-1<this.extensibilityPoints.indexOf(e)},L.prototype.init=function(){return new T(this.webAuth)},L});