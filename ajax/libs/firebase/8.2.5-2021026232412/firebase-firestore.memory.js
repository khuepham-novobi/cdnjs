!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Wd){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u,e=t(Wd);function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ee=u=u||{})[Ee.DEBUG=0]="DEBUG",Ee[Ee.VERBOSE=1]="VERBOSE",Ee[Ee.INFO=2]="INFO",Ee[Ee.WARN=3]="WARN",Ee[Ee.ERROR=4]="ERROR",Ee[Ee.SILENT=5]="SILENT";function n(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var r={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},i=u.INFO,a=((Te={})[u.DEBUG]="log",Te[u.VERBOSE]="log",Te[u.INFO]="info",Te[u.WARN]="warn",Te[u.ERROR]="error",Te),o=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?r[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},c);function c(t){this.name=t,this._logLevel=i,this._logHandler=n,this._userLogHandler=null}var h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function f(t,e){function n(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function l(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(f(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(_.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},_);function _(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function I(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S={},O=N||self;function D(){}function L(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function C(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var R="closure_uid_"+(1e9*Math.random()>>>0),k=0;function P(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function x(t,e,n){return(x=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?P:V).apply(null,arguments)}function U(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function M(){return Date.now()}function F(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,R)&&t[R]||(t[R]=++k))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},H=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function B(t){return/^[\s\xa0]*$/.test(t)}var K,J=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function W(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var Y=O.navigator;if(Y){Y=Y.userAgent;if(Y){K=Y;break t}}K=""}function Q(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e,n={};for(e in t)n[e]=t[e];return n}var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=D;var nt,rt=W(K,"Opera"),it=W(K,"Trident")||W(K,"MSIE"),ot=W(K,"Edge"),st=ot||it,ut=W(K,"Gecko")&&!(W(K.toLowerCase(),"webkit")&&!W(K,"Edge"))&&!(W(K,"Trident")||W(K,"MSIE"))&&!W(K,"Edge"),at=W(K.toLowerCase(),"webkit")&&!W(K,"Edge");function ct(){var t=O.document;return t?t.documentMode:void 0}t:{var ht="",ft=(ft=K,ut?/rv:([^\);]+)(\)|;)/.exec(ft):ot?/Edge\/([\d\.]+)/.exec(ft):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):at?/WebKit\/(\S+)/.exec(ft):rt?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(ht=ft?ft[1]:""),it){ft=ct();if(null!=ft&&ft>parseFloat(ht)){nt=String(ft);break t}}nt=ht}var lt={};function pt(u){return t=u,e=function(){for(var t=0,e=J(String(nt)).split("."),n=J(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=lt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var dt=O.document&&it?ct()||(parseInt(nt,10)||void 0):void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!O.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{O.addEventListener("test",D,e),O.removeEventListener("test",D,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},F(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var _t="closure_listenable_"+(1e6*Math.random()|0),Et=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Et,this.Y=this.Z=!1}function It(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function At(t){this.src=t,this.a={},this.b=0}function Nt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=q(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(It(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}At.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ot="closure_lm_"+(1e6*Math.random()|0),Dt={};function Lt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Mt(r);return e&&e[_t]?e.wa(n,r,C(i)?!!i.capture:!!i,o):Ct(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Lt(t,e[o],n,r,i);return null}return n=Mt(n),t&&t[_t]?t.va(e,n,C(r)?!!r.capture:!!r,i):Ct(t,e,n,!1,r,i)}function Ct(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=C(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,c=xt(t);if(c||(t[Ot]=c=new At(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Vt,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(kt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Rt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[_t]?Nt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(kt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=xt(e))?(Nt(n,t),0==n.b&&(n.src=null,e[Ot]=null)):It(t)))}function kt(t){return t in Dt?Dt[t]:Dt[t]="on"+t}function Pt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Rt(t),n.call(r,e)}function Vt(t,e){if(t.Y)return!0;if(yt)return Pt(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=O,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Pt(t,e=new wt(e,this))}function xt(t){return(t=t[Ot])instanceof At?t:null}var Ut="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mt(e){return"function"==typeof e?e:(e[Ut]||(e[Ut]=function(t){return e.handleEvent(t)}),e[Ut])}function Ft(){j.call(this),this.c=new At(this),(this.J=this).C=null}function jt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new mt(e,t):e instanceof mt?e.target=e.target||t:(s=e,tt(e=new mt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=qt(o,r,!0,e)&&s;if(s=qt(o=e.a=t,r,!0,e)&&s,s=qt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=qt(o=e.a=n[i],r,!1,e)&&s}function qt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Nt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}F(Ft,j),Ft.prototype[_t]=!0,(A=Ft.prototype).addEventListener=function(t,e,n,r){Lt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=C(i)?!!i.capture:!!i,r=Mt(r),e&&e[_t]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(It(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&xt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&Rt(r))}(this,t,e,n,r)},A.G=function(){if(Ft.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)It(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ht=O.JSON.stringify;function Gt(){this.b=this.a=null}var zt,Bt=(Kt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Kt(function(){return new Jt},function(t){t.reset()}));function Kt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Jt(){this.next=this.b=this.a=null}function Wt(t,e){var n;zt||(n=O.Promise.resolve(void 0),zt=function(){n.then(Qt)}),Xt||(zt(),Xt=!0),Yt.add(t,e)}Gt.prototype.add=function(t,e){var n=Bt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Jt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Jt.prototype.reset=function(){this.next=this.b=this.a=null}),Yt=new Gt;function Qt(){for(var t,e;n=e=void 0,n=null,(e=Yt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){O.setTimeout(function(){throw t},0)}(t)}var n=Bt;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function $t(t,e){Ft.call(this),this.b=t||1,this.a=e||O,this.f=x(this.Za,this),this.g=M()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==typeof t)n&&(t=x(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=x(t.handleEvent,t)}return 2147483647<Number(e)?-1:O.setTimeout(t,e||0)}F($t,Ft),(A=$t.prototype).aa=!1,A.M=null,A.Za=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),jt(this,"tick"),this.aa&&(Zt(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},A.G=function(){$t.X.G.call(this),Zt(this),delete this.a};var ee,ne,re,ie=(T(ne=se,re=ee=j),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(O.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e){var n=ee.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ue(t){j.call(this),this.b=t,this.a={}}F(ue,j);var ae=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=Lt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){Q(t.a,function(t,e){this.a.hasOwnProperty(e)&&Rt(t)},t),t.a={}}function fe(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Ht(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.X.G.call(this),he(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fe.prototype.info=function(){};var pe={},de=null;function ye(){return de=de||new Ft}function ve(t){mt.call(this,pe.Fa,t)}function ge(t){var e=ye();jt(e,new ve(e))}function me(t,e){mt.call(this,pe.STAT_EVENT,t),this.stat=e}function we(t){var e=ye();jt(e,new me(e,t))}function be(t){mt.call(this,pe.Ga,t)}function _e(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return O.setTimeout(function(){t()},e)}pe.Fa="serverreachability",F(ve,mt),pe.STAT_EVENT="statevent",F(me,mt),pe.Ga="timingevent",F(be,mt);var Ee={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Te={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Ie(){}function Ae(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}Ie.prototype.a=null;var Se,N={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Oe(){mt.call(this,"d")}function De(){mt.call(this,"c")}function Le(){}function Ce(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ue(this),this.P=Re,t=st?125:void 0,this.R=new $t(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}F(Oe,mt),F(De,mt),F(Le,Ie),Se=new Le;var Re=45e3,ke={},Pe={};function Ve(t,e,n){t.H=1,t.i=nn(Ye(e)),t.j=n,t.I=!0,xe(t,null)}function xe(t,e){t.u=M(),Me(t),t.l=Ye(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=cr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(x(t.Ca,t,t.a),t.O)),ce(t.J,t.a,"readystatechange",t.Xa),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ue(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Pe:(i=Number(u.substring(i,o)),isNaN(i)?ke:(o+=1)+i>u.length?Pe:(u=u.substr(o,i),r.D=o+i,u)));if(u==Pe){4==e&&(t.h=4,we(14),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==ke){t.h=4,we(15),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),Ge(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(le(t.c,t.f,n,"[Invalid Chunked Response]"),He(t),qe(t))}function Me(t){t.T=M()+t.P,Fe(t,t.P)}function Fe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=_e(x(t.Va,t),e)}function je(t){t.o&&(O.clearTimeout(t.o),t.o=null)}function qe(t){0==t.g.v||t.A||ir(t.g,t)}function He(t){je(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ge(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||Tn(u.b,t)))if(u.I=t.N,!t.C&&Tn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Kn(u)}tr(u),we(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=_e(x(u.Sa,u),6e3));if(En(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!B(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(W(r,"spdy")||W(r,"quic")||W(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(In(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=M()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(An(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(je(o),Me(o)),n.a=i):Zn(n),0<u.g.length&&Xn(u)):"stop"!=c[0]&&"close"!=c[0]||sr(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?sr(u,7):Bn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ge(4)}catch(t){}}function ze(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(L(t)||"string"==typeof t)H(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(L(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(L(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Be(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Be)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ke(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Je(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Je(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Je(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=Ce.prototype).setTimeout=function(t){this.P=t},A.Xa=function(t){t=t.target;var e=this.F;e&&3==qn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=qn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),je(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),He(this),qe(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ge(this,s)}this.I?(Ue(this,e,n),st&&this.b&&3==e&&(ce(this.J,this.R,"tick",this.Wa),this.R.start())):(le(this.c,this.f,n,null),Ge(this,n)),4==e&&He(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),He(this),qe(this)}}}catch(t){}var u,a,c,h,f,l},A.Wa=function(){var t,e;this.a&&(t=qn(this.a),e=this.a.$(),this.D<e.length&&(je(this),Ue(this,t,e),this.b&&4!=t&&Me(this)))},A.cancel=function(){this.A=!0,He(this)},A.Va=function(){this.o=null;var t,e,n=M();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),He(this),this.h=2,qe(this)):Fe(this,this.T-n)},(A=Be.prototype).K=function(){Ke(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return Ke(this),this.a.concat()},A.get=function(t,e){return Je(this.b,t)?this.b[t]:e},A.set=function(t,e){Je(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var We=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Xe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Xe?(this.a=void 0!==e?e:t.a,Qe(this,t.f),this.j=t.j,$e(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new Be(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(We))?(this.a=!!e,Qe(this,n[1]||"",!0),this.j=rn(n[2]||""),$e(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Ye(t){return new Xe(t)}function Qe(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,hn)),t.b=new ln(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Xe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?cn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,fn)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,cn=/[#\?]/g,hn=/[#\?@]/g,fn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new Be,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),Je(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Je((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ke(t)))}function yn(t,e){return pn(t),e=gn(t,e),Je(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),z(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(A=ln.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){H(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=G(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},A.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=function(t,e){this.b=t,this.a=e};function wn(t){this.g=t||bn,t=O.PerformanceNavigationTiming?0<(t=O.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(O.ia&&O.ia.ya&&O.ia.ya()&&O.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var bn=10;function _n(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function Tn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=I(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Sn(){}function On(){this.a=new Sn}function Dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=I(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Sn.prototype.stringify=function(t){return O.JSON.stringify(t,void 0)},Sn.prototype.parse=function(t){return O.JSON.parse(t,void 0)};var Ln=O.JSON.parse;function Cn(t){Ft.call(this),this.headers=new Be,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Rn,this.D=this.F=!1}F(Cn,Ft);var Rn="",kn=/^https?$/i,Pn=["POST","PUT"];function Vn(t){return"content-type"==t.toLowerCase()}function xn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Un(t),Fn(t)}function Un(t){t.u||(t.u=!0,jt(t,"complete"),jt(t,"error"))}function Mn(t){if(t.b&&void 0!==S&&(!t.s[1]||4!=qn(t)||2!=t.W()))if(t.l&&4==qn(t))te(t.za,0,t);else if(jt(t,"readystatechange"),4==qn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}(e=s)||((n=0===o)&&(!(i=String(t.B).match(We)[1]||null)&&O.self&&O.self.location&&(i=(r=O.self.location.protocol).substr(0,r.length-1)),n=!kn.test(i?i.toLowerCase():"")),e=n);if(e)jt(t,"complete"),jt(t,"success");else{t.h=6;try{var u=2<qn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Un(t)}}finally{Fn(t)}}}function Fn(t,e){if(t.a){jn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||jt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function jn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(O.clearTimeout(t.m),t.m=null)}function qn(t){return t.a?t.a.readyState:0}function Hn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Q(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function zn(t){this.pa=0,this.g=[],this.c=new fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Gn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Gn("baseRetryDelayMs",5e3,t),this.Ra=Gn("retryDelaySeedMs",1e4,t),this.Ma=Gn("forwardChannelMaxRetries",2,t),this.ma=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new On,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Bn(t){var e,n;Jn(t),3==t.v&&(e=t.R++,en(n=Ye(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Qn(t,n),(e=new Ce(t,t.c,e,void 0)).H=2,e.i=nn(Ye(n)),n=!1,O.navigator&&O.navigator.sendBeacon&&(n=O.navigator.sendBeacon(e.i.toString(),"")),!n&&O.Image&&((new Image).src=e.i,n=!0),n||(e.a=cr(e.g,null),e.a.ba(e.i)),e.u=M(),Me(e)),ur(t)}function Kn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Jn(t){Kn(t),t.j&&(O.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&O.clearTimeout(t.h),t.h=null)}function Wn(t,e){t.g.push(new mn(t.Oa++,e)),3==t.v&&Xn(t)}function Xn(t){_n(t.b)||t.h||(t.h=!0,Wt(t.Ba,t),t.u=0)}function Yn(t,e){var n=e?e.f:t.R++,r=Ye(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Qn(t,r),t.i&&t.l&&Hn(r,t.i,t.l),n=new Ce(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=$n(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),In(t.b,n),Ve(n,r,e)}function Qn(t,n){t.f&&ze({},function(t,e){en(n,e,t)})}function $n(t,e,n){n=Math.min(t.g.length,n);var r=t.f?x(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{ze(t,function(t,e){var n=t;C(t)&&(n=Ht(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.T=1,Wt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=_e(x(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(O.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new Ce(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ye(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Qn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Hn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Ye(e)),n.j=null,n.I=!0,xe(n,t)}function rr(t){null!=t.m&&(O.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!Tn(t.b,e))return;r=e.s,An(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=M()-e.u,n=t.u,jt(i=ye(),new be(i)),Xn(t)):Zn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(En(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)))return t.h=_e(x(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=x(t.Ya,t),r||(r=new Xe("//www.google.com/images/cleardot.gif"),O.location&&"http"==O.location.protocol||Qe(r,"https"),nn(r)),n=r.toString(),r=o,o=new fe,O.Image?((i=new Image).onload=U(Dn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=U(Dn,o,i,"TestLoadImage: error",!1,r),i.onabort=U(Dn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=U(Dn,o,i,"TestLoadImage: timeout",!1,r),O.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Jn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Xe?Ye(s):new Xe(s,void 0);return""!=a.c?(e&&$e(a,e+"."+a.c),Ze(a,a.h)):(u=O.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Xe(null,void 0),r&&Qe(u,r),i&&$e(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.V&&Q(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Qn(t,a),a}function cr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Cn(t.Na)).F=t.C,e}function hr(){}function fr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function lr(t,e){Ft.call(this),this.a=new zn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!B(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!B(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new yr(this)}function pr(t){Oe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){De.call(this),this.status=1}function yr(t){this.a=t}(A=Cn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ae(this.H):Ae(Se),this.a.onreadystatechange=x(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void xn(this,t)}t=n||"";var i,o=new Be(this.headers);r&&ze(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Vn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=O.FormData&&t instanceof O.FormData,0<=q(Pn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{jn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=x(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){xn(this,t)}},A.xa=function(){void 0!==S&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,jt(this,"timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,jt(this,"complete"),jt(this,"abort"),Fn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Fn(this,!0)),Cn.X.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Mn(this):this.Ua())},A.Ua=function(){Mn(this)},A.W=function(){try{return 2<qn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Ln(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=zn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ce(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=$n(this,n,e),en(i=Ye(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Qn(this,i),this.i&&r&&Hn(i,this.i,r),In(this.b,n),this.Ia&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Ve(n,i,null)):Ve(n,i,e),this.v=2}}else 3==this.v&&(t?Yn(this,t):0==this.g.length||_n(this.b)||Yn(this))},A.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=_e(x(this.Ta,this),t))},A.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Kn(this),nr(this))},A.Sa=function(){null!=this.m&&(this.m=null,Kn(this),tr(this),we(19))},A.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(A=hr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ja=function(){},fr.prototype.a=function(t,e){return new lr(t,e)},F(lr,Ft),lr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Xn(t)},lr.prototype.close=function(){Bn(this.a)},lr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Wn(this.a,e)):this.l?((e={}).__data__=Ht(t),Wn(this.a,e)):Wn(this.a,t)},lr.prototype.G=function(){this.a.f=null,delete this.f,Bn(this.a),delete this.a,lr.X.G.call(this)},F(pr,Oe),F(dr,De),F(yr,hr),yr.prototype.ta=function(){jt(this.a,"a")},yr.prototype.sa=function(t){jt(this.a,new pr(t))},yr.prototype.ra=function(t){jt(this.a,new dr)},yr.prototype.qa=function(){jt(this.a,"b")},fr.prototype.createWebChannel=fr.prototype.a,lr.prototype.send=lr.prototype.h,lr.prototype.open=lr.prototype.g,Ee.NO_ERROR=0,Ee.TIMEOUT=8,Ee.HTTP_ERROR=6,Te.COMPLETE="complete",(Ne.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",Ft.prototype.listen=Ft.prototype.va,Cn.prototype.listenOnce=Cn.prototype.wa,Cn.prototype.getLastError=Cn.prototype.Qa,Cn.prototype.getLastErrorCode=Cn.prototype.ua,Cn.prototype.getStatus=Cn.prototype.W,Cn.prototype.getResponseJson=Cn.prototype.Pa,Cn.prototype.getResponseText=Cn.prototype.$,Cn.prototype.send=Cn.prototype.ba;var vr=ye,gr=Ee,mr=Te,wr=pe,br=10,_r=11,Er=Ne,Tr=Cn,Ir="8.2.5-2021026232412",Ar=new o("@firebase/firestore");function Nr(){return Ar.logLevel}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.DEBUG&&(e=n.map(Lr),Ar.debug.apply(Ar,l(["Firestore ("+Ir+"): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.ERROR&&(e=n.map(Lr),Ar.error.apply(Ar,l(["Firestore ("+Ir+"): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.WARN&&(e=n.map(Lr),Ar.warn.apply(Ar,l(["Firestore ("+Ir+"): "+t],e)))}function Lr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Cr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+Ir+") INTERNAL ASSERTION FAILED: "+t;throw Or(t),new Error(t)}function Rr(t){t||Cr()}var kr=(Pr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Pr);function Pr(){}function Vr(t,e){return t<e?-1:e<t?1:0}function xr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var Ur=(Mr.fromBase64String=function(t){return new Mr(atob(t))},Mr.fromUint8Array=function(t){return new Mr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Mr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},Mr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},Mr.prototype.o=function(){return 2*this.i.length},Mr.prototype.u=function(t){return Vr(this.i,t.i)},Mr.prototype.isEqual=function(t){return this.i===t.i},Mr);function Mr(t){this.i=t}Ur.h=new Ur("");var Fr,jr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},qr=(f(Br,Fr=Error),Br),Hr=(zr.fromBase64String=function(t){try{return new zr(Ur.fromBase64String(t))}catch(t){throw new qr(jr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},zr.fromUint8Array=function(t){return new zr(Ur.fromUint8Array(t))},zr.prototype.toBase64=function(){return this.l.toBase64()},zr.prototype.toUint8Array=function(){return this.l.toUint8Array()},zr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},zr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},zr),Gr=function(t){this._=t};function zr(t){this.l=t}function Br(t,e){var n=this;return(n=Fr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Kr(){if("undefined"==typeof Uint8Array)throw new qr(jr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Jr(){if("undefined"==typeof atob)throw new qr(jr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Wr,Xr=(f(ei,Wr=Gr),ei.fromBase64String=function(t){return Jr(),new ei(Hr.fromBase64String(t))},ei.fromUint8Array=function(t){return Kr(),new ei(Hr.fromUint8Array(t))},ei.prototype.toBase64=function(){return Jr(),this._.toBase64()},ei.prototype.toUint8Array=function(){return Kr(),this._.toUint8Array()},ei.prototype.isEqual=function(t){return this._.isEqual(t._)},ei.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},ei),Yr=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.I=o},Qr=(Object.defineProperty(ti.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),ti.prototype.isEqual=function(t){return t instanceof ti&&t.projectId===this.projectId&&t.database===this.database},ti),$r=(Zr.prototype.A=function(){return null!=this.uid},Zr.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},Zr.prototype.isEqual=function(t){return t.uid===this.uid},Zr);function Zr(t){this.uid=t}function ti(t,e){this.projectId=t,this.database=e||"(default)"}function ei(){return null!==Wr&&Wr.apply(this,arguments)||this}$r.UNAUTHENTICATED=new $r(null),$r.P=new $r("google-credentials-uid"),$r.g=new $r("first-party-uid");function ni(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t}var ri=(li.prototype.getToken=function(){return Promise.resolve(null)},li.prototype.v=function(){},li.prototype.S=function(t){(this.p=t)($r.UNAUTHENTICATED)},li.prototype.D=function(){this.p=null},li),ii=(fi.prototype.getToken=function(){var e=this,n=this.F,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.F!==n?(Sr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Rr("string"==typeof t.accessToken),new ni(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},fi.prototype.v=function(){this.forceRefresh=!0},fi.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},fi.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},fi.prototype.O=function(){var t=this.auth&&this.auth.getUid();return Rr(null===t||"string"==typeof t),new $r(t)},fi),oi=(Object.defineProperty(hi.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),hi),si=(ci.prototype.getToken=function(){return Promise.resolve(new oi(this.k,this.M))},ci.prototype.S=function(t){t($r.g)},ci.prototype.D=function(){},ci.prototype.v=function(){},ci),ui=(ai.prototype.L=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ai.prototype.next=function(){var t=++this.previousValue;return this.B&&this.B(t),t},ai);function ai(t,e){var n=this;this.previousValue=t,e&&(e.$=function(t){return n.L(t)},this.B=function(t){return e.q(t)})}function ci(t,e){this.k=t,this.M=e}function hi(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=$r.g}function fi(t){var e=this;this.C=null,this.currentUser=$r.UNAUTHENTICATED,this.N=!1,this.F=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.F++,e.currentUser=e.O(),e.N=!0,e.p&&e.p(e.currentUser)},this.F=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}function li(){this.p=null}ui.U=-1;var pi,di,yi=(Ni.now=function(){return Ni.fromMillis(Date.now())},Ni.fromDate=function(t){return Ni.fromMillis(t.getTime())},Ni.fromMillis=function(t){var e=Math.floor(t/1e3);return new Ni(e,1e6*(t-1e3*e))},Ni.prototype.toDate=function(){return new Date(this.toMillis())},Ni.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Ni.prototype.K=function(t){return this.seconds===t.seconds?Vr(this.nanoseconds,t.nanoseconds):Vr(this.seconds,t.seconds)},Ni.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Ni.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Ni.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Ni.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Ni),vi=(Ai.W=function(t){return new Ai(t)},Ai.min=function(){return new Ai(new yi(0,0))},Ai.prototype.u=function(t){return this.timestamp.K(t.timestamp)},Ai.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Ai.prototype.j=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Ai.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Ai.prototype.G=function(){return this.timestamp},Ai),Te=(Object.defineProperty(Ii.prototype,"length",{get:function(){return this.H},enumerable:!1,configurable:!0}),Ii.prototype.isEqual=function(t){return 0===Ii.J(this,t)},Ii.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Ii?t.forEach(function(t){e.push(t)}):e.push(t),this.Y(e)},Ii.prototype.limit=function(){return this.offset+this.length},Ii.prototype.X=function(t){return t=void 0===t?1:t,this.Y(this.segments,this.offset+t,this.length-t)},Ii.prototype.Z=function(){return this.Y(this.segments,this.offset,this.length-1)},Ii.prototype.tt=function(){return this.segments[this.offset]},Ii.prototype.et=function(){return this.get(this.length-1)},Ii.prototype.get=function(t){return this.segments[this.offset+t]},Ii.prototype.nt=function(){return 0===this.length},Ii.prototype.st=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Ii.prototype.it=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Ii.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Ii.prototype.rt=function(){return this.segments.slice(this.offset,this.limit())},Ii.J=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Ii),gi=(f(Ti,di=Te),Ti.prototype.Y=function(t,e,n){return new Ti(t,e,n)},Ti.prototype.ot=function(){return this.rt().join("/")},Ti.prototype.toString=function(){return this.ot()},Ti.ct=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new qr(jr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Ti(n)},Ti.at=function(){return new Ti([])},Ti),mi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,wi=(f(Ei,pi=Te),Ei.prototype.Y=function(t,e,n){return new Ei(t,e,n)},Ei.ut=function(t){return mi.test(t)},Ei.prototype.ot=function(){return this.rt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ei.ut(t)||(t="`"+t+"`"),t}).join(".")},Ei.prototype.toString=function(){return this.ot()},Ei.prototype.ht=function(){return 1===this.length&&"__name__"===this.get(0)},Ei.lt=function(){return new Ei(["__name__"])},Ei._t=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new qr(jr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new qr(jr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new qr(jr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new qr(jr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ei(e)},Ei.at=function(){return new Ei([])},Ei),bi=(_i.ft=function(t){return new _i(gi.ct(t))},_i.dt=function(t){return new _i(gi.ct(t).X(5))},_i.prototype.wt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},_i.prototype.isEqual=function(t){return null!==t&&0===gi.J(this.path,t.path)},_i.prototype.toString=function(){return this.path.toString()},_i.J=function(t,e){return gi.J(t.path,e.path)},_i.Et=function(t){return t.length%2==0},_i.Tt=function(t){return new _i(new gi(t.slice()))},_i);function _i(t){this.path=t}function Ei(){return null!==pi&&pi.apply(this,arguments)||this}function Ti(){return null!==di&&di.apply(this,arguments)||this}function Ii(t,e,n){void 0===e?e=0:e>t.length&&Cr(),void 0===n?n=t.length-e:n>t.length-e&&Cr(),this.segments=t,this.offset=e,this.H=n}function Ai(t){this.timestamp=t}function Ni(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new qr(jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new qr(jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new qr(jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new qr(jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Si(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Oi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Di(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Li=(Ri.prototype.It=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].st(t))return!0;return!1},Ri.prototype.isEqual=function(t){return xr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ri),Ci=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ri(t){(this.fields=t).sort(wi.J)}function ki(t){if(Rr(!!t),"string"!=typeof t)return{seconds:Pi(t.seconds),nanos:Pi(t.nanos)};var e=0,n=Ci.exec(t);Rr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Pi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Vi(t){return"string"==typeof t?Ur.fromBase64String(t):Ur.fromUint8Array(t)}function xi(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Ui(t){t=ki(t.mapValue.fields.__local_write_time__.timestampValue);return new yi(t.seconds,t.nanos)}function Mi(t){return null==t}function Fi(t){return 0===t&&1/t==-1/0}function ji(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?xi(t)?4:10:Cr()}function qi(r,i){var t,e=ji(r);if(e!==ji(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Ui(r).isEqual(Ui(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=ki(r.timestampValue),t=ki(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Vi(r.bytesValue).isEqual(Vi(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Pi((t=r).geoPointValue.latitude)===Pi(e.geoPointValue.latitude)&&Pi(t.geoPointValue.longitude)===Pi(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Pi(t.integerValue)===Pi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Pi(t.doubleValue),e=Pi(e.doubleValue);return t===e?Fi(t)===Fi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return xr(r.arrayValue.values||[],i.arrayValue.values||[],qi);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Si(e)!==Si(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!qi(e[t],n[t])))return!1;return!0}();default:return Cr()}}function Hi(t,e){return void 0!==(t.values||[]).find(function(t){return qi(t,e)})}function Gi(t,e){var n,r,i=ji(t),o=ji(e);if(i!==o)return Vr(i,o);switch(i){case 0:return 0;case 1:return Vr(t.booleanValue,e.booleanValue);case 2:return n=e,r=Pi(t.integerValue||t.doubleValue),n=Pi(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return zi(t.timestampValue,e.timestampValue);case 4:return zi(Ui(t),Ui(e));case 5:return Vr(t.stringValue,e.stringValue);case 6:return function(t,e){t=Vi(t),e=Vi(e);return t.u(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Vr(n[i],r[i]);if(0!==o)return o}return Vr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=Vr(Pi(i.latitude),Pi(r.latitude)))?n:Vr(Pi(i.longitude),Pi(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Gi(n[i],r[i]);if(o)return o}return Vr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Vr(r[s],o[s]);if(0!==u)return u;u=Gi(n[r[s]],i[o[s]]);if(0!==u)return u}return Vr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Cr()}}function zi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Vr(t,e);var n=ki(t),t=ki(e),e=Vr(n.seconds,t.seconds);return 0!==e?e:Vr(n.nanos,t.nanos)}function Bi(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=ki(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Vi(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,bi.dt(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Cr();var e}(t)}function Ki(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.ot()}}function Ji(t){return t&&"integerValue"in t}function Wi(t){return!!t&&"arrayValue"in t}function Xi(t){return t&&"nullValue"in t}function Yi(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Qi(t){return t&&"mapValue"in t}var $i=(eo.empty=function(){return new eo({mapValue:{}})},eo.prototype.field=function(t){if(t.nt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Qi(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.et()])||null},eo.prototype.isEqual=function(t){return qi(this.proto,t.proto)},eo),Zi=(to.prototype.set=function(t,e){return this.Pt(t,e),this},to.prototype.delete=function(t){return this.Pt(t,null),this},to.prototype.Pt=function(t,e){for(var n=this.Rt,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===ji(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.et(),e)},to.prototype.yt=function(){var t=this.gt(wi.at(),this.Rt);return null!=t?new $i(t):this.At},to.prototype.gt=function(r,t){var i=this,o=!1,e=this.At.field(r),s=Qi(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.gt(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},to);function to(t){void 0===t&&(t=$i.empty()),this.At=t,this.Rt=new Map}function eo(t){this.proto=t}var no,ro,io,o=function(t,e){this.key=t,this.version=e},oo=(f(fo,io=o),fo.prototype.field=function(t){return this.Vt.field(t)},fo.prototype.data=function(){return this.Vt},fo.prototype.vt=function(){return this.Vt.proto},fo.prototype.isEqual=function(t){return t instanceof fo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.bt===t.bt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Vt.isEqual(t.Vt)},fo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Vt.toString()+", {hasLocalMutations: "+this.bt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(fo.prototype,"hasPendingWrites",{get:function(){return this.bt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),fo),so=(f(ho,ro=o),ho.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(ho.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),ho.prototype.isEqual=function(t){return t instanceof ho&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},ho),uo=(f(co,no=o),co.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(co.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),co.prototype.isEqual=function(t){return t instanceof co&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},co),ao=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.St=null};function co(){return null!==no&&no.apply(this,arguments)||this}function ho(t,e,n){var r=this;return(r=ro.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function fo(t,e,n,r){var i=this;return(i=io.call(this,t,e)||this).Vt=n,i.bt=!!r.bt,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function lo(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ao(t,e,n,r,i,o,s)}function po(t){var e=t;return null===e.St&&(t=e.path.ot(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.ot()+t.op.toString()+Bi(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.ot()+t.dir}).join(","),Mi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Go(e.startAt)),e.endAt&&(t+="|ub:",t+=Go(e.endAt)),e.St=t),e.St}function yo(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!qi(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ko(t.startAt,e.startAt)&&Ko(t.endAt,e.endAt)}function vo(t){return bi.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}var go,mo=(f(wo,go=function(){}),wo.create=function(t,e,n){return t.ht()?"in"===e||"not-in"===e?this.Dt(t,e,n):new To(t,e,n):"array-contains"===e?new Po(t,n):"in"===e?new Vo(t,n):"not-in"===e?new xo(t,n):"array-contains-any"===e?new Uo(t,n):new wo(t,e,n)},wo.Dt=function(t,e,n){return new("in"===e?Io:Ao)(t,n)},wo.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.Ct(Gi(t,this.value)):null!==t&&ji(this.value)===ji(t)&&this.Ct(Gi(t,this.value))},wo.prototype.Ct=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Cr()}},wo.prototype.xt=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},wo);function wo(t,e,n){var r=this;return(r=go.call(this)||this).field=t,r.op=e,r.value=n,r}var bo,_o,Eo,To=(f(Oo,Eo=mo),Oo.prototype.matches=function(t){t=bi.J(t.key,this.key);return this.Ct(t)},Oo),Io=(f(So,_o=mo),So.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},So),Ao=(f(No,bo=mo),No.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},No);function No(t,e){var n=this;return(n=bo.call(this,t,"not-in",e)||this).keys=Do(0,e),n}function So(t,e){var n=this;return(n=_o.call(this,t,"in",e)||this).keys=Do(0,e),n}function Oo(t,e,n){var r=this;return(r=Eo.call(this,t,e,n)||this).key=bi.dt(n.referenceValue),r}function Do(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return bi.dt(t.referenceValue)})}var Lo,Co,Ro,ko,Po=(f(Ho,ko=mo),Ho.prototype.matches=function(t){t=t.field(this.field);return Wi(t)&&Hi(t.arrayValue,this.value)},Ho),Vo=(f(qo,Ro=mo),qo.prototype.matches=function(t){t=t.field(this.field);return null!==t&&Hi(this.value.arrayValue,t)},qo),xo=(f(jo,Co=mo),jo.prototype.matches=function(t){if(Hi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!Hi(this.value.arrayValue,t)},jo),Uo=(f(Fo,Lo=mo),Fo.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!Wi(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Hi(e.value.arrayValue,t)})},Fo),Mo=function(t,e){this.position=t,this.before=e};function Fo(t,e){return Lo.call(this,t,"array-contains-any",e)||this}function jo(t,e){return Co.call(this,t,"not-in",e)||this}function qo(t,e){return Ro.call(this,t,"in",e)||this}function Ho(t,e){return ko.call(this,t,"array-contains",e)||this}function Go(t){return(t.before?"b":"a")+":"+t.position.map(Bi).join(",")}var zo=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Bo(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.ht()?bi.J(bi.dt(s.referenceValue),n.key):Gi(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Ko(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!qi(t.position[n],e.position[n]))return!1;return!0}var Jo=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Nt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Ft=null,this.Ot=null,this.startAt,this.endAt};function Wo(t){return new Jo(t)}function Xo(t){return!Mi(t.limit)&&"F"===t.limitType}function Yo(t){return!Mi(t.limit)&&"L"===t.limitType}function Qo(t){return 0<t.Nt.length?t.Nt[0].field:null}function $o(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.xt())return r.field}return null}function Zo(t){return null!==t.collectionGroup}function ts(t){var e=t;if(null===e.Ft){e.Ft=[];var n=$o(e),t=Qo(e);if(null!==n&&null===t)n.ht()||e.Ft.push(new zo(n)),e.Ft.push(new zo(wi.lt(),"asc"));else{for(var r=!1,i=0,o=e.Nt;i<o.length;i++){var s=o[i];e.Ft.push(s),s.field.ht()&&(r=!0)}r||(n=0<e.Nt.length?e.Nt[e.Nt.length-1].dir:"asc",e.Ft.push(new zo(wi.lt(),n)))}}return e.Ft}function es(t){var e=t;if(!e.Ot)if("F"===e.limitType)e.Ot=lo(e.path,e.collectionGroup,ts(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ts(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new zo(o.field,s))}var u=e.endAt?new Mo(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Mo(e.startAt.position,!e.startAt.before):null;e.Ot=lo(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Ot}function ns(t,e,n){return new Jo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function rs(t,e){return yo(es(t),es(e))&&t.limitType===e.limitType}function is(t){return po(es(t))+"|lt:"+t.limitType}function os(t){return"Query(target="+(e=es(t),n=e.path.ot(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.ot()+" "+t.op+" "+Bi(t.value)}).join(", ")+"]"),Mi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.ot()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Go(e.startAt)),e.endAt&&(n+=", endAt: "+Go(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function ss(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.wt(e.collectionGroup)&&e.path.st(n):bi.Et(e.path)?e.path.isEqual(n):e.path.it(n))&&function(t){for(var e=0,n=i.Nt;e<n.length;e++){var r=n[e];if(!r.field.ht()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Bo(t.startAt,ts(t),n))&&(!t.endAt||!Bo(t.endAt,ts(t),n)));var e,n}function us(u){return function(t,e){for(var n=!1,r=0,i=ts(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.ht()?bi.J(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?Gi(n,t):Cr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Cr()}}(o,t,e);if(0!==s)return s;n=n||o.field.ht()}return 0}}var as=(cs.prototype.$t=function(t){return new cs(this.target,this.targetId,this.kt,t,this.Mt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},cs.prototype.Lt=function(t,e){return new cs(this.target,this.targetId,this.kt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},cs.prototype.Bt=function(t){return new cs(this.target,this.targetId,this.kt,this.sequenceNumber,this.Mt,t,this.resumeToken)},cs);function cs(t,e,n,r,i,o,s){void 0===i&&(i=vi.min()),void 0===o&&(o=vi.min()),void 0===s&&(s=Ur.h),this.target=t,this.targetId=e,this.kt=n,this.sequenceNumber=r,this.Mt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function hs(t,e){if(t.qt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fi(e)?"-0":e}}function fs(t){return{integerValue:""+t}}function ls(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!Fi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?fs(e):hs(t,e);var n}Te=function(){this.Ut=void 0};function ps(t,e){return t instanceof Ns?Ji(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var ds,ys,vs=(f(ws,ys=Te),ws),gs=(f(ms,ds=Te),ms);function ms(t){var e=this;return(e=ds.call(this)||this).elements=t,e}function ws(){return null!==ys&&ys.apply(this,arguments)||this}function bs(t,e){for(var n=Ds(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return qi(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var _s,Es=(f(Ts,_s=Te),Ts);function Ts(t){var e=this;return(e=_s.call(this)||this).elements=t,e}function Is(t,e){for(var n=Ds(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!qi(t,e)})}(i[r]);return{arrayValue:{values:n}}}var As,Ns=(f(Ss,As=Te),Ss);function Ss(t,e){var n=this;return(n=As.call(this)||this).Kt=t,n.Qt=e,n}function Os(t){return Pi(t.integerValue||t.doubleValue)}function Ds(t){return Wi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Ls(t,e){this.field=t,this.transform=e}function Cs(t,e){this.version=t,this.transformResults=e}var Rs=(ks.Wt=function(){return new ks},ks.exists=function(t){return new ks(void 0,t)},ks.updateTime=function(t){return new ks(t)},Object.defineProperty(ks.prototype,"jt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ks.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ks);function ks(t,e){this.updateTime=t,this.exists=e}function Ps(t,e){return void 0!==t.updateTime?e instanceof oo&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof oo}o=function(){};function Vs(t,e,n,r){return t instanceof js?function(t,e,n){if(!Ps(t.Gt,e))return e;var r=t.value,n=Ks(t.fieldTransforms,n,e),r=Js(t.fieldTransforms,r,n),e=Us(e);return new oo(t.key,e,r,{bt:!0})}(t,e,r):t instanceof qs?function(t,e,n){if(!Ps(t.Gt,e))return e;var r=Us(e),e=zs(t,e,Ks(t.fieldTransforms,n,e));return new oo(t.key,r,e,{bt:!0})}(t,e,r):(e=e,Ps((t=t).Gt,e)?new so(t.key,vi.min()):e)}function xs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gt.isEqual(e.Gt)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&xr(n,r,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof gs&&e instanceof gs||t instanceof Es&&e instanceof Es?xr(t.elements,e.elements,qi):t instanceof Ns&&e instanceof Ns?qi(t.Qt,e.Qt):t instanceof vs&&e instanceof vs)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.zt.isEqual(e.zt));var n,r}function Us(t){return t instanceof oo?t.version:vi.min()}var Ms,Fs,js=(f(Gs,Fs=o),Gs),qs=(f(Hs,Ms=o),Hs);function Hs(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=Ms.call(this)||this).key=t,o.data=e,o.zt=n,o.Gt=r,o.fieldTransforms=i,o.type=1,o}function Gs(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=Fs.call(this)||this).key=t,i.value=e,i.Gt=n,i.fieldTransforms=r,i.type=0,i}function zs(t,e,n){var r,i,o;return i=t,e=r=e instanceof oo?e.data():$i.empty(),o=new Zi(e),i.zt.fields.forEach(function(t){var e;t.nt()||(null!==(e=i.data.field(t))?o.set(t,e):o.delete(t))}),r=o.yt(),Js(t.fieldTransforms,r,n)}function Bs(t,e,n){var r=[];Rr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof oo&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof gs?bs(o,s):o instanceof Es?Is(o,s):u))}return r}function Ks(t,e,n){for(var r,i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof oo&&(c=n.field(u.field)),i.push((r=c,u=e,c=void 0,(a=a)instanceof vs?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:u.seconds,nanos:u.nanoseconds}}}},r&&(c.fields.__previous_value__=r),{mapValue:c}):a instanceof gs?bs(a,r):a instanceof Es?Is(a,r):(a=ps(c=a,r),r=Os(a)+Os(c.Qt),Ji(a)&&Ji(c.Qt)?fs(r):hs(c.Kt,r))))}return i}function Js(t,e,n){for(var r=new Zi(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.yt()}function Ws(t){this.count=t}var Xs,Ys,Qs,$s=(f(eu,Qs=o),eu),Zs=(f(tu,Ys=o),tu);function tu(t,e){var n=this;return(n=Ys.call(this)||this).key=t,n.Gt=e,n.type=3,n.fieldTransforms=[],n}function eu(t,e){var n=this;return(n=Qs.call(this)||this).key=t,n.Gt=e,n.type=2,n.fieldTransforms=[],n}function nu(t){switch(t){case jr.OK:return Cr(),0;case jr.CANCELLED:case jr.UNKNOWN:case jr.DEADLINE_EXCEEDED:case jr.RESOURCE_EXHAUSTED:case jr.INTERNAL:case jr.UNAVAILABLE:case jr.UNAUTHENTICATED:return;case jr.INVALID_ARGUMENT:case jr.NOT_FOUND:case jr.ALREADY_EXISTS:case jr.PERMISSION_DENIED:case jr.FAILED_PRECONDITION:case jr.ABORTED:case jr.OUT_OF_RANGE:case jr.UNIMPLEMENTED:case jr.DATA_LOSS:return 1;default:return Cr(),0}}function ru(t){if(void 0===t)return Or("GRPC error has no .code"),jr.UNKNOWN;switch(t){case Xs.OK:return jr.OK;case Xs.CANCELLED:return jr.CANCELLED;case Xs.UNKNOWN:return jr.UNKNOWN;case Xs.DEADLINE_EXCEEDED:return jr.DEADLINE_EXCEEDED;case Xs.RESOURCE_EXHAUSTED:return jr.RESOURCE_EXHAUSTED;case Xs.INTERNAL:return jr.INTERNAL;case Xs.UNAVAILABLE:return jr.UNAVAILABLE;case Xs.UNAUTHENTICATED:return jr.UNAUTHENTICATED;case Xs.INVALID_ARGUMENT:return jr.INVALID_ARGUMENT;case Xs.NOT_FOUND:return jr.NOT_FOUND;case Xs.ALREADY_EXISTS:return jr.ALREADY_EXISTS;case Xs.PERMISSION_DENIED:return jr.PERMISSION_DENIED;case Xs.FAILED_PRECONDITION:return jr.FAILED_PRECONDITION;case Xs.ABORTED:return jr.ABORTED;case Xs.OUT_OF_RANGE:return jr.OUT_OF_RANGE;case Xs.UNIMPLEMENTED:return jr.UNIMPLEMENTED;case Xs.DATA_LOSS:return jr.DATA_LOSS;default:return Cr()}}(Te=Xs=Xs||{})[Te.OK=0]="OK",Te[Te.CANCELLED=1]="CANCELLED",Te[Te.UNKNOWN=2]="UNKNOWN",Te[Te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Te[Te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Te[Te.NOT_FOUND=5]="NOT_FOUND",Te[Te.ALREADY_EXISTS=6]="ALREADY_EXISTS",Te[Te.PERMISSION_DENIED=7]="PERMISSION_DENIED",Te[Te.UNAUTHENTICATED=16]="UNAUTHENTICATED",Te[Te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Te[Te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Te[Te.ABORTED=10]="ABORTED",Te[Te.OUT_OF_RANGE=11]="OUT_OF_RANGE",Te[Te.UNIMPLEMENTED=12]="UNIMPLEMENTED",Te[Te.INTERNAL=13]="INTERNAL",Te[Te.UNAVAILABLE=14]="UNAVAILABLE",Te[Te.DATA_LOSS=15]="DATA_LOSS";var iu=(cu.prototype.Ht=function(t,e){return new cu(this.J,this.root.Ht(t,e,this.J).copy(null,null,su.Jt,null,null))},cu.prototype.remove=function(t){return new cu(this.J,this.root.remove(t,this.J).copy(null,null,su.Jt,null,null))},cu.prototype.get=function(t){for(var e=this.root;!e.nt();){var n=this.J(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},cu.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.nt();){var r=this.J(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},cu.prototype.nt=function(){return this.root.nt()},Object.defineProperty(cu.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),cu.prototype.Yt=function(){return this.root.Yt()},cu.prototype.Xt=function(){return this.root.Xt()},cu.prototype.Zt=function(t){return this.root.Zt(t)},cu.prototype.forEach=function(n){this.Zt(function(t,e){return n(t,e),!1})},cu.prototype.toString=function(){var n=[];return this.Zt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},cu.prototype.te=function(t){return this.root.te(t)},cu.prototype.ee=function(){return new ou(this.root,null,this.J,!1)},cu.prototype.ne=function(t){return new ou(this.root,t,this.J,!1)},cu.prototype.se=function(){return new ou(this.root,null,this.J,!0)},cu.prototype.ie=function(t){return new ou(this.root,t,this.J,!0)},cu),ou=(au.prototype.ce=function(){var t=this.oe.pop(),e={key:t.key,value:t.value};if(this.re)for(t=t.left;!t.nt();)this.oe.push(t),t=t.right;else for(t=t.right;!t.nt();)this.oe.push(t),t=t.left;return e},au.prototype.ae=function(){return 0<this.oe.length},au.prototype.ue=function(){if(0===this.oe.length)return null;var t=this.oe[this.oe.length-1];return{key:t.key,value:t.value}},au),su=(uu.prototype.copy=function(t,e,n,r,i){return new uu(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},uu.prototype.nt=function(){return!1},uu.prototype.Zt=function(t){return this.left.Zt(t)||t(this.key,this.value)||this.right.Zt(t)},uu.prototype.te=function(t){return this.right.te(t)||t(this.key,this.value)||this.left.te(t)},uu.prototype.min=function(){return this.left.nt()?this:this.left.min()},uu.prototype.Yt=function(){return this.min().key},uu.prototype.Xt=function(){return this.right.nt()?this.key:this.right.Xt()},uu.prototype.Ht=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ht(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ht(t,e,n))).he()},uu.prototype.le=function(){if(this.left.nt())return uu.EMPTY;var t=this;return t.left._e()||t.left.left._e()||(t=t.fe()),(t=t.copy(null,null,null,t.left.le(),null)).he()},uu.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.nt()||r.left._e()||r.left.left._e()||(r=r.fe()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left._e()&&(r=r.de()),r.right.nt()||r.right._e()||r.right.left._e()||(r=r.we()),0===e(t,r.key)){if(r.right.nt())return uu.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.le())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.he()},uu.prototype._e=function(){return this.color},uu.prototype.he=function(){var t=this;return t.right._e()&&!t.left._e()&&(t=t.Ee()),t.left._e()&&t.left.left._e()&&(t=t.de()),t.left._e()&&t.right._e()&&(t=t.Te()),t},uu.prototype.fe=function(){var t=this.Te();return t.right.left._e()&&(t=(t=(t=t.copy(null,null,null,null,t.right.de())).Ee()).Te()),t},uu.prototype.we=function(){var t=this.Te();return t.left.left._e()&&(t=(t=t.de()).Te()),t},uu.prototype.Ee=function(){var t=this.copy(null,null,uu.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},uu.prototype.de=function(){var t=this.copy(null,null,uu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},uu.prototype.Te=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},uu.prototype.Ie=function(){var t=this.me();return Math.pow(2,t)<=this.size+1},uu.prototype.me=function(){if(this._e()&&this.left._e())throw Cr();if(this.right._e())throw Cr();var t=this.left.me();if(t!==this.right.me())throw Cr();return t+(this._e()?0:1)},uu);function uu(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:uu.RED,this.left=null!=r?r:uu.EMPTY,this.right=null!=i?i:uu.EMPTY,this.size=this.left.size+1+this.right.size}function au(t,e,n,r){this.re=r,this.oe=[];for(var i=1;!t.nt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.re?t.left:t.right;else{if(0===i){this.oe.push(t);break}this.oe.push(t),t=this.re?t.right:t.left}}function cu(t,e){this.J=t,this.root=e||su.EMPTY}function hu(){this.size=0}su.EMPTY=null,su.RED=!0,su.Jt=!1,su.EMPTY=(Object.defineProperty(hu.prototype,"key",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(hu.prototype,"value",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(hu.prototype,"color",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(hu.prototype,"left",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(hu.prototype,"right",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),hu.prototype.copy=function(t,e,n,r,i){return this},hu.prototype.Ht=function(t,e,n){return new su(t,e)},hu.prototype.remove=function(t,e){return this},hu.prototype.nt=function(){return!0},hu.prototype.Zt=function(t){return!1},hu.prototype.te=function(t){return!1},hu.prototype.Yt=function(){return null},hu.prototype.Xt=function(){return null},hu.prototype._e=function(){return!1},hu.prototype.Ie=function(){return!0},hu.prototype.me=function(){return 0},new hu);var fu=(yu.prototype.has=function(t){return null!==this.data.get(t)},yu.prototype.first=function(){return this.data.Yt()},yu.prototype.last=function(){return this.data.Xt()},Object.defineProperty(yu.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),yu.prototype.indexOf=function(t){return this.data.indexOf(t)},yu.prototype.forEach=function(n){this.data.Zt(function(t,e){return n(t),!1})},yu.prototype.Ae=function(t,e){for(var n=this.data.ne(t[0]);n.ae();){var r=n.ce();if(0<=this.J(r.key,t[1]))return;e(r.key)}},yu.prototype.Re=function(t,e){for(var n=void 0!==e?this.data.ne(e):this.data.ee();n.ae();)if(!t(n.ce().key))return},yu.prototype.Pe=function(t){t=this.data.ne(t);return t.ae()?t.ce().key:null},yu.prototype.ee=function(){return new lu(this.data.ee())},yu.prototype.ne=function(t){return new lu(this.data.ne(t))},yu.prototype.add=function(t){return this.copy(this.data.remove(t).Ht(t,!0))},yu.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},yu.prototype.nt=function(){return this.data.nt()},yu.prototype.ye=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},yu.prototype.isEqual=function(t){if(!(t instanceof yu))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ee(),n=t.data.ee();e.ae();){var r=e.ce().key,i=n.ce().key;if(0!==this.J(r,i))return!1}return!0},yu.prototype.rt=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},yu.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},yu.prototype.copy=function(t){var e=new yu(this.J);return e.data=t,e},yu),lu=(du.prototype.ce=function(){return this.ge.ce().key},du.prototype.ae=function(){return this.ge.ae()},du),pu=new iu(bi.J);function du(t){this.ge=t}function yu(t){this.J=t,this.data=new iu(this.J)}var vu=new iu(bi.J);var gu=new iu(bi.J);var mu=new fu(bi.J);function wu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=mu,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var bu=new fu(Vr);var _u=(Uu.be=function(t){return new Uu(t.J)},Uu.prototype.has=function(t){return null!=this.Ve.get(t)},Uu.prototype.get=function(t){return this.Ve.get(t)},Uu.prototype.first=function(){return this.pe.Yt()},Uu.prototype.last=function(){return this.pe.Xt()},Uu.prototype.nt=function(){return this.pe.nt()},Uu.prototype.indexOf=function(t){t=this.Ve.get(t);return t?this.pe.indexOf(t):-1},Object.defineProperty(Uu.prototype,"size",{get:function(){return this.pe.size},enumerable:!1,configurable:!0}),Uu.prototype.forEach=function(n){this.pe.Zt(function(t,e){return n(t),!1})},Uu.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ve.Ht(t.key,t),e.pe.Ht(t,null))},Uu.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ve.remove(t),this.pe.remove(e)):this},Uu.prototype.isEqual=function(t){if(!(t instanceof Uu))return!1;if(this.size!==t.size)return!1;for(var e=this.pe.ee(),n=t.pe.ee();e.ae();){var r=e.ce().key,i=n.ce().key;if(!r.isEqual(i))return!1}return!0},Uu.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Uu.prototype.copy=function(t,e){var n=new Uu;return n.J=this.J,n.Ve=t,n.pe=e,n},Uu),Eu=(xu.prototype.track=function(t){var e=t.doc.key,n=this.ve.get(e);!n||0!==t.type&&3===n.type?this.ve=this.ve.Ht(e,t):3===t.type&&1!==n.type?this.ve=this.ve.Ht(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ve=this.ve.Ht(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ve=this.ve.remove(e):1===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):Cr()},xu.prototype.Se=function(){var n=[];return this.ve.Zt(function(t,e){n.push(e)}),n},xu),Tu=(Vu.Fe=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Vu(t,e,_u.be(e),i,n,r,!0,!1)},Object.defineProperty(Vu.prototype,"hasPendingWrites",{get:function(){return!this.Ce.nt()},enumerable:!1,configurable:!0}),Vu.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.xe===t.xe&&this.Ce.isEqual(t.Ce)&&rs(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.De.isEqual(t.De)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Vu),Iu=(Pu.Le=function(t,e){var n=new Map;return n.set(t,Au.Be(t,e)),new Pu(vi.min(),n,bu,pu,wu())},Pu),Au=(ku.Be=function(t,e){return new ku(Ur.h,e,wu(),wu(),wu())},ku),Nu=function(t,e,n,r){this.We=t,this.removedTargetIds=e,this.key=n,this.je=r},Su=function(t,e){this.targetId=t,this.Ge=e},Ou=function(t,e,n,r){void 0===n&&(n=Ur.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Du=(Object.defineProperty(Ru.prototype,"qe",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Object.defineProperty(Ru.prototype,"resumeToken",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(Ru.prototype,"Ze",{get:function(){return 0!==this.ze},enumerable:!1,configurable:!0}),Object.defineProperty(Ru.prototype,"tn",{get:function(){return this.Xe},enumerable:!1,configurable:!0}),Ru.prototype.en=function(t){0<t.o()&&(this.Xe=!0,this.Je=t)},Ru.prototype.nn=function(){var n=wu(),r=wu(),i=wu();return this.He.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Cr()}}),new Au(this.Je,this.Ye,n,r,i)},Ru.prototype.sn=function(){this.Xe=!1,this.He=Fu()},Ru.prototype.rn=function(t,e){this.Xe=!0,this.He=this.He.Ht(t,e)},Ru.prototype.on=function(t){this.Xe=!0,this.He=this.He.remove(t)},Ru.prototype.cn=function(){this.ze+=1},Ru.prototype.an=function(){--this.ze},Ru.prototype.un=function(){this.Xe=!0,this.Ye=!0},Ru),Lu=(Cu.prototype.wn=function(t){for(var e=0,n=t.We;e<n.length;e++){var r=n[e];t.je instanceof oo?this.En(r,t.je):t.je instanceof so&&this.Tn(r,t.key,t.je)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Tn(r,t.key,t.je)},Cu.prototype.In=function(n){var r=this;this.mn(n,function(t){var e=r.An(t);switch(n.state){case 0:r.Rn(t)&&e.en(n.resumeToken);break;case 1:e.an(),e.Ze||e.sn(),e.en(n.resumeToken);break;case 2:e.an(),e.Ze||r.removeTarget(t);break;case 3:r.Rn(t)&&(e.un(),e.en(n.resumeToken));break;case 4:r.Rn(t)&&(r.Pn(t),e.en(n.resumeToken));break;default:Cr()}})},Cu.prototype.mn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ln.forEach(function(t,e){r.Rn(e)&&n(e)})},Cu.prototype.yn=function(t){var e=t.targetId,n=t.Ge.count,t=this.gn(e);t&&(vo(t=t.target)?0===n?(t=new bi(t.path),this.Tn(e,t,new so(t,vi.min()))):Rr(1===n):this.Vn(e)!==n&&(this.Pn(e),this.dn=this.dn.add(e)))},Cu.prototype.pn=function(r){var i=this,o=new Map;this.ln.forEach(function(t,e){var n=i.gn(e);n&&(t.qe&&vo(n.target)&&(n=new bi(n.target.path),null!==i._n.get(n)||i.bn(e,n)||i.Tn(e,n,new so(n,r))),t.tn&&(o.set(e,t.nn()),t.sn()))});var s=wu();this.fn.forEach(function(t,e){var n=!0;e.Re(function(t){t=i.gn(t);return!t||2===t.kt||(n=!1)}),n&&(s=s.add(t))});var t=new Iu(r,o,this.dn,this._n,s);return this._n=pu,this.fn=Mu(),this.dn=new fu(Vr),t},Cu.prototype.En=function(t,e){var n;this.Rn(t)&&(n=this.bn(t,e.key)?2:0,this.An(t).rn(e.key,n),this._n=this._n.Ht(e.key,e),this.fn=this.fn.Ht(e.key,this.vn(e.key).add(t)))},Cu.prototype.Tn=function(t,e,n){var r;this.Rn(t)&&(r=this.An(t),this.bn(t,e)?r.rn(e,1):r.on(e),this.fn=this.fn.Ht(e,this.vn(e).delete(t)),n&&(this._n=this._n.Ht(e,n)))},Cu.prototype.removeTarget=function(t){this.ln.delete(t)},Cu.prototype.Vn=function(t){var e=this.An(t).nn();return this.hn.Sn(t).size+e.Ue.size-e.Ke.size},Cu.prototype.cn=function(t){this.An(t).cn()},Cu.prototype.An=function(t){var e=this.ln.get(t);return e||(e=new Du,this.ln.set(t,e)),e},Cu.prototype.vn=function(t){var e=this.fn.get(t);return e||(e=new fu(Vr),this.fn=this.fn.Ht(t,e)),e},Cu.prototype.Rn=function(t){var e=null!==this.gn(t);return e||Sr("WatchChangeAggregator","Detected inactive target",t),e},Cu.prototype.gn=function(t){var e=this.ln.get(t);return e&&e.Ze?null:this.hn.Dn(t)},Cu.prototype.Pn=function(e){var n=this;this.ln.set(e,new Du),this.hn.Sn(e).forEach(function(t){n.Tn(e,t,null)})},Cu.prototype.bn=function(t,e){return this.hn.Sn(t).has(e)},Cu);function Cu(t){this.hn=t,this.ln=new Map,this._n=pu,this.fn=Mu(),this.dn=new fu(Vr)}function Ru(){this.ze=0,this.He=Fu(),this.Je=Ur.h,this.Ye=!1,this.Xe=!0}function ku(t,e,n,r,i){this.resumeToken=t,this.qe=e,this.Ue=n,this.Qe=r,this.Ke=i}function Pu(t,e,n,r,i){this.Mt=t,this.Oe=e,this.ke=n,this.Me=r,this.$e=i}function Vu(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.De=n,this.docChanges=r,this.Ce=i,this.fromCache=o,this.xe=s,this.Ne=u}function xu(){this.ve=new iu(bi.J)}function Uu(n){this.J=n?function(t,e){return n(t,e)||bi.J(t.key,e.key)}:function(t,e){return bi.J(t.key,e.key)},this.Ve=vu,this.pe=new iu(this.J)}function Mu(){return new iu(bi.J)}function Fu(){return new iu(bi.J)}var ju={asc:"ASCENDING",desc:"DESCENDING"},qu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Hu=function(t,e){this.T=t,this.qt=e};function Gu(t,e){return t.qt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function zu(t,e){return t.qt?e.toBase64():e.toUint8Array()}function Bu(t){return Rr(!!t),vi.W((t=ki(t),new yi(t.seconds,t.nanos)))}function Ku(t,e){return new gi(["projects",t.projectId,"databases",t.database]).child("documents").child(e).ot()}function Ju(t){t=gi.ct(t);return Rr(aa(t)),t}function Wu(t,e){return Ku(t.T,e.path)}function Xu(t,e){e=Ju(e);if(e.get(1)!==t.T.projectId)throw new qr(jr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.T.projectId);if(e.get(3)!==t.T.database)throw new qr(jr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.T.database);return new bi($u(e))}function Yu(t,e){return Ku(t.T,e)}function Qu(t){return new gi(["projects",t.T.projectId,"databases",t.T.database]).ot()}function $u(t){return Rr(4<t.length&&"documents"===t.get(4)),t.X(5)}function Zu(t,e,n){return{name:Wu(t,e),fields:n.proto.mapValue.fields}}function ta(t,e){var n,r,i;if(e instanceof js)n={update:Zu(t,e.key,e.value)};else if(e instanceof $s)n={delete:Wu(t,e.key)};else if(e instanceof qs)n={update:Zu(t,e.key,e.data),updateMask:(i=e.zt,r=[],i.fields.forEach(function(t){return r.push(t.ot())}),{fieldPaths:r})};else{if(!(e instanceof Zs))return Cr();n={verify:Wu(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof vs)return{fieldPath:t.field.ot(),setToServerValue:"REQUEST_TIME"};if(e instanceof gs)return{fieldPath:t.field.ot(),appendMissingElements:{values:e.elements}};if(e instanceof Es)return{fieldPath:t.field.ot(),removeAllFromArray:{values:e.elements}};if(e instanceof Ns)return{fieldPath:t.field.ot(),increment:e.Qt};throw Cr()})),e.Gt.jt||(n.currentDocument=void 0!==(i=e.Gt).updateTime?{updateTime:(e=t,t=i.updateTime,Gu(e,t.G()))}:void 0!==i.exists?{exists:i.exists}:Cr()),n}function ea(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Yu(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Yu(t,r.Z()),n.structuredQuery.from=[{collectionId:r.et()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Yi(t.value))return{unaryFilter:{field:oa(t.field),op:"IS_NAN"}};if(Xi(t.value))return{unaryFilter:{field:oa(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Yi(t.value))return{unaryFilter:{field:oa(t.field),op:"IS_NOT_NAN"}};if(Xi(t.value))return{unaryFilter:{field:oa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:oa(t.field),op:(e=t.op,qu[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:oa((t=t).field),direction:(t=t.dir,ju[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.qt||Mi(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=ra(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ra(e.endAt)),n}function na(t){var e=4===(o=Ju(t.parent)).length?gi.at():$u(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Rr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[ua(t)]:void 0!==t.fieldFilter?[(n=t,mo.create(sa(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Cr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Cr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new zo(sa((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=Mi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=ia(n.startAt));var u=null;return n.endAt&&(u=ia(n.endAt)),new Jo(e,i,t,o,r,"F",s,u)}function ra(t){return{before:t.before,values:t.position}}function ia(t){var e=!!t.before,t=t.values||[];return new Mo(t,e)}function oa(t){return{fieldPath:t.ot()}}function sa(t){return wi._t(t.fieldPath)}function ua(t){switch(t.unaryFilter.op){case"IS_NAN":var e=sa(t.unaryFilter.field);return mo.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=sa(t.unaryFilter.field);return mo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=sa(t.unaryFilter.field);return mo.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=sa(t.unaryFilter.field);return mo.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Cr()}}function aa(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var ca=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},ha=(fa.prototype.catch=function(t){return this.next(void 0,t)},fa.prototype.next=function(r,i){var o=this;return this.Fn&&Cr(),this.Fn=!0,this.Nn?this.error?this.On(i,this.error):this.kn(r,this.result):new fa(function(e,n){o.Cn=function(t){o.kn(r,t).next(e,n)},o.xn=function(t){o.On(i,t).next(e,n)}})},fa.prototype.Mn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},fa.prototype.$n=function(t){try{var e=t();return e instanceof fa?e:fa.resolve(e)}catch(t){return fa.reject(t)}},fa.prototype.kn=function(t,e){return t?this.$n(function(){return t(e)}):fa.resolve(e)},fa.prototype.On=function(t,e){return t?this.$n(function(){return t(e)}):fa.reject(e)},fa.resolve=function(n){return new fa(function(t,e){t(n)})},fa.reject=function(n){return new fa(function(t,e){e(n)})},fa.Ln=function(t){return new fa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},fa.Bn=function(t){for(var n=fa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?fa.resolve(t):e()})}(r[e]);return n},fa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Ln(i)},fa);function fa(t){var e=this;this.Cn=null,this.xn=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.Fn=!1,t(function(t){e.Nn=!0,e.result=t,e.Cn&&e.Cn(t)},function(t){e.Nn=!0,e.error=t,e.xn&&e.xn(t)})}function la(t){return"IndexedDbTransactionError"===t.name}var pa=(da.Is=function(t,e,n,r,i){i=new da(t,e,Date.now()+n,r,i);return i.start(n),i},da.prototype.start=function(t){var e=this;this.As=setTimeout(function(){return e.Rs()},t)},da.prototype.Ps=function(){return this.Rs()},da.prototype.cancel=function(t){null!==this.As&&(this.clearTimeout(),this.Ts.reject(new qr(jr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},da.prototype.Rs=function(){var e=this;this.fs.ys(function(){return null!==e.As?(e.clearTimeout(),e.op().then(function(t){return e.Ts.resolve(t)})):Promise.resolve()})},da.prototype.clearTimeout=function(){null!==this.As&&(this.Es(this),clearTimeout(this.As),this.As=null)},da);function da(t,e,n,r,i){this.fs=t,this.ds=e,this.ws=n,this.op=r,this.Es=i,this.Ts=new ca,this.then=this.Ts.promise.then.bind(this.Ts.promise),this.Ts.promise.catch(function(t){})}function ya(t,e){if(Or("AsyncQueue",e+": "+t),la(t))return new qr(jr.UNAVAILABLE,e+": "+t);throw t}function va(t){this.ks=t}var o=(_a.prototype.Vs=function(t){this.gs.push(t)},_a.prototype.ps=function(){this.gs.forEach(function(t){return t()})},_a),ga=(ba.prototype.Ds=function(t,e,n){for(var r,i,o,s,u,a,c=n.Cs,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,i=e,o=c[h],f=a=u=s=void 0,e=r instanceof js?(u=o,f=(s=r).value,u.transformResults&&(a=Bs(s.fieldTransforms,i,u.transformResults),f=Js(s.fieldTransforms,f,a)),new oo(s.key,u.version,f,{hasCommittedMutations:!0})):r instanceof qs?function(t,e,n){if(!Ps(t.Gt,e))return new uo(t.key,n.version);e=zs(t,e,n.transformResults?Bs(t.fieldTransforms,e,n.transformResults):[]);return new oo(t.key,n.version,e,{hasCommittedMutations:!0})}(r,i,o):new so(r.key,o.version,{hasCommittedMutations:!0}))}return e},ba.prototype.xs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(i=r[n]).key.isEqual(t)&&(e=Vs(i,e,0,this.Ss));for(var i,o=0,s=this.mutations;o<s.length;o++){(i=s[o]).key.isEqual(t)&&(e=Vs(i,e,0,this.Ss))}return e},ba.prototype.Ns=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.xs(t.key,n.get(t.key));e&&(i=i.Ht(t.key,e))}),i},ba.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},wu())},ba.prototype.isEqual=function(t){return this.batchId===t.batchId&&xr(this.mutations,t.mutations,xs)&&xr(this.baseMutations,t.baseMutations,xs)},ba),ma=(wa.from=function(t,e,n){Rr(t.mutations.length===n.length);for(var r=gu,i=t.mutations,o=0;o<i.length;o++)r=r.Ht(i[o].key,n[o].version);return new wa(t,e,n,r)},wa);function wa(t,e,n,r){this.batch=t,this.Fs=e,this.Cs=n,this.Os=r}function ba(t,e,n,r){this.batchId=t,this.Ss=e,this.baseMutations=n,this.mutations=r}function _a(){this.gs=[]}function Ea(t){var e=na({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?ns(e,e.limit,"L"):e}var Ta=(Na.prototype.Us=function(t,e){return this.qs.add(e),ha.resolve()},Na.prototype.Qs=function(t,e){return ha.resolve(this.qs.getEntries(e))},Na),Ia=(Aa.prototype.add=function(t){var e=t.et(),n=t.Z(),r=this.index[e]||new fu(gi.J),t=!r.has(n);return this.index[e]=r.add(n),t},Aa.prototype.has=function(t){var e=t.et(),t=t.Z(),e=this.index[e];return e&&e.has(t)},Aa.prototype.getEntries=function(t){return(this.index[t]||new fu(gi.J)).rt()},Aa);function Aa(){this.index={}}function Na(){this.qs=new Ia}function Sa(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==jr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Sr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Oa(t,e){this.progress=t,this.zo=e}var Da=(qa.prototype.get=function(t){var e=this.si(t),e=this.ri[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.ii(o,t))return i}},qa.prototype.has=function(t){return void 0!==this.get(t)},qa.prototype.set=function(t,e){var n=this.si(t),r=this.ri[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.ii(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ri[n]=[[t,e]]},qa.prototype.delete=function(t){var e=this.si(t),n=this.ri[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.ii(n[r][0],t))return 1===n.length?delete this.ri[e]:n.splice(r,1),!0;return!1},qa.prototype.forEach=function(s){Oi(this.ri,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},qa.prototype.nt=function(){return Di(this.ri)},qa),Te=(ja.prototype.ai=function(t){t=this.oi.get(t);return t?t.readTime:vi.min()},ja.prototype.ui=function(t,e){this.hi(),this.oi.set(t.key,{li:t,readTime:e})},ja.prototype._i=function(t,e){void 0===e&&(e=null),this.hi(),this.oi.set(t,{li:null,readTime:e})},ja.prototype.fi=function(t,e){this.hi();var n=this.oi.get(e);return void 0!==n?ha.resolve(n.li):this.di(t,e)},ja.prototype.getEntries=function(t,e){return this.wi(t,e)},ja.prototype.apply=function(t){return this.hi(),this.ci=!0,this.Ei(t)},ja.prototype.hi=function(){},ja),La=(Fa.prototype.next=function(){return this.$i+=2,this.$i},Fa.Li=function(){return new Fa(0)},Fa.Bi=function(){return new Fa(-1)},Fa),Ca=(Ma.prototype.Jo=function(e,n){var r=this;return this.Ho.vi(e,n).next(function(t){return r.Yo(e,n,t)})},Ma.prototype.Yo=function(t,r,i){return this.wo.fi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].xs(r,t);return t})},Ma.prototype.Xo=function(t,e,i){var o=pu;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].xs(t,e);o=o.Ht(t,e)}),o},Ma.prototype.Zo=function(e,t){var n=this;return this.wo.getEntries(e,t).next(function(t){return n.tc(e,t)})},Ma.prototype.tc=function(e,r){var i=this;return this.Ho.Si(e,r).next(function(t){var t=i.Xo(e,r,t),n=pu;return t.forEach(function(t,e){e=e||new so(t,vi.min()),n=n.Ht(t,e)}),n})},Ma.prototype.Wr=function(t,e,n){return r=e,bi.Et(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ec(t,e.path):Zo(e)?this.nc(t,e,n):this.sc(t,e,n);var r},Ma.prototype.ec=function(t,e){return this.Jo(t,new bi(e)).next(function(t){var e=vu;return t instanceof oo&&(e=e.Ht(t.key,t)),e})},Ma.prototype.nc=function(n,r,i){var o=this,s=r.collectionGroup,u=vu;return this.Ti.Qs(n,s).next(function(t){return ha.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new Jo(t,null,e.Nt.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.sc(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Ht(t,e)})})}).next(function(){return u})})},Ma.prototype.sc=function(e,n,t){var a,c,r=this;return this.wo.Wr(e,n,t).next(function(t){return a=t,r.Ho.Ci(e,n)}).next(function(t){return c=t,r.ic(e,c,a).next(function(t){a=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=Vs(s,a.get(u),0,r.Ss);a=s instanceof oo?a.Ht(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){ss(n,e)||(a=a.remove(t))}),a})},Ma.prototype.ic=function(t,e,n){for(var r=wu(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof qs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.wo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof oo&&(c=c.Ht(t,e))}),c})},Ma),Ra=(Ua.cc=function(t,e){for(var n=wu(),r=wu(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Ua(t,e.fromCache,n,r)},Ua),ka=(xa.prototype.ac=function(t){this.uc=t},xa.prototype.Wr=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.Nt.length||1===r.Nt.length&&r.Nt[0].field.ht())||i.isEqual(vi.min())?this.hc(e,r):this.uc.Zo(e,o).next(function(t){var n=s.lc(r,t);return(Xo(r)||Yo(r))&&s._c(r.limitType,n,o,i)?s.hc(e,r):(Nr()<=u.DEBUG&&Sr("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),os(r)),s.uc.Wr(e,r,i).next(function(e){return n.forEach(function(t){e=e.Ht(t.key,t)}),e}))})},xa.prototype.lc=function(n,t){var r=new fu(us(n));return t.forEach(function(t,e){e instanceof oo&&ss(n,e)&&(r=r.add(e))}),r},xa.prototype._c=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.u(r))},xa.prototype.hc=function(t,e){return Nr()<=u.DEBUG&&Sr("QueryEngine","Using full collection scan to execute query:",os(e)),this.uc.Wr(t,e,vi.min())},xa),Pa=(Va.prototype.mr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.pr(t,n.dc)})},Va);function Va(t,e,n,r){this.persistence=t,this.fc=e,this.Kt=r,this.dc=new iu(Vr),this.wc=new Da(po,yo),this.Ec=vi.min(),this.Ho=t.Ko(n),this.Tc=t.Or(),this.fo=t.Dr(),this.Ic=new Ca(this.Tc,this.Ho,this.persistence.Wo()),this.Eo=t.jo(),this.fc.ac(this.Ic)}function xa(){}function Ua(t,e,n,r){this.targetId=t,this.fromCache=e,this.rc=n,this.oc=r}function Ma(t,e,n){this.wo=t,this.Ho=e,this.Ti=n}function Fa(t){this.$i=t}function ja(){this.oi=new Da(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.ci=!1}function qa(t,e){this.si=t,this.ii=e,this.ri={}}function Ha(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Ho,m=e.Ic,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Ho.bi(v).next(function(t){return g=t,n=e.persistence.Ko(o),m=new Ca(e.Tc,n,e.persistence.Wo()),n.bi(v)}).next(function(t){for(var e=[],n=[],r=wu(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Zo(v,r).next(function(t){return{mc:t,Ac:e,Rc:n}})})})];case 1:return r=t.sent(),[2,(e.Ho=n,e.Ic=m,e.fc.ac(e.Ic),r)]}})})}function Ga(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.Tc.Fr({jr:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=ha.resolve(),n.forEach(function(n){u=u.next(function(){return o.fi(r,n)}).next(function(t){var e=t,t=i.Os.get(n);Rr(null!==t),(!e||e.version.u(t)<0)&&(e=s.Ds(n,e,i))&&o.ui(e,i.Fs)})}),u.next(function(){return e.Ho.xi(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.Ho.Oi(t)}).next(function(){return f.Ic.Zo(t,a)})})}function za(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.fo.Ki(t)})}function Ba(t,r){var a=t,c=r.Mt,h=a.dc;return a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.Tc.Fr({jr:!0});h=a.dc;var u=[];r.Oe.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a.fo.ir(s,t.Ke,e).next(function(){return a.fo.nr(s,t.Ue,e)})),0<(i=t.resumeToken).o()&&(n=o.Lt(i,c).$t(s.vs),h=h.Ht(e,n),r=o,i=t,Rr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.Mt.j()-r.Mt.j()||0<i.Ue.size+i.Qe.size+i.Ke.size)&&u.push(a.fo.Ji(s,n))))});var e,n=pu;return r.Me.forEach(function(t,e){r.$e.has(t)&&u.push(a.persistence.Ii.kr(s,t))}),u.push(Ka(s,t,r.Me,c,void 0).next(function(t){n=t})),c.isEqual(vi.min())||(e=a.fo.Ki(s).next(function(t){return a.fo.ji(s,s.vs,c)}),u.push(e)),ha.Ln(u).next(function(){return t.apply(s)}).next(function(){return a.Ic.tc(s,n)})}).then(function(t){return a.dc=h,t})}function Ka(t,s,e,u,a){var n=wu();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=pu;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof so&&e.version.isEqual(vi.min())?(s._i(t,r),o=o.Ht(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(s.ui(e,r),o=o.Ht(t,e)):Sr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function Ja(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.fo.er(e,r).next(function(t){return t?(n=t,ha.resolve(n)):i.fo.qi(e).next(function(t){return n=new as(r,t,0,e.vs),i.fo.Gi(e,n).next(function(){return n})})})}).then(function(t){var e=i.dc.get(t.targetId);return(null===e||0<t.Mt.u(e.Mt))&&(i.dc=i.dc.Ht(t.targetId,t),i.wc.set(r,t.targetId)),t})}function Wa(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).dc.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Ii.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!la(r=t.sent()))throw r;return Sr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.dc=e.dc.remove(o),e.wc.delete(n.target),[2]}})})}function Xa(t,o,s){var u=t,a=vi.min(),c=wu();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=es(o),(void 0!==(t=(i=t).wc.get(r))?ha.resolve(i.dc.get(t)):i.fo.er(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.fo.cr(e,t.targetId).next(function(t){c=t})}).next(function(){return u.fc.Wr(e,o,s?a:vi.min(),s?c:wu())}).next(function(t){return{documents:t,Pc:c}});var t,n,r,i})}var Ya,Qa,$a,Za=(Rc.prototype.Ms=function(t,e){return ha.resolve(this.bc.get(e))},Rc.prototype.$s=function(t,e){return this.bc.set(e.id,{id:e.id,version:e.version,createTime:Bu(e.createTime)}),ha.resolve()},Rc.prototype.Ls=function(t,e){return ha.resolve(this.vc.get(e))},Rc.prototype.Bs=function(t,e){return this.vc.set(e.name,{name:(e=e).name,query:Ea(e.bundledQuery),readTime:Bu(e.readTime)}),ha.resolve()},Rc),tc=(Cc.prototype.nt=function(){return this.Sc.nt()},Cc.prototype.sr=function(t,e){e=new ec(t,e);this.Sc=this.Sc.add(e),this.Cc=this.Cc.add(e)},Cc.prototype.Nc=function(t,e){var n=this;t.forEach(function(t){return n.sr(t,e)})},Cc.prototype.rr=function(t,e){this.Fc(new ec(t,e))},Cc.prototype.Oc=function(t,e){var n=this;t.forEach(function(t){return n.rr(t,e)})},Cc.prototype.kc=function(t){var e=this,n=new bi(new gi([])),r=new ec(n,t),t=new ec(n,t+1),i=[];return this.Cc.Ae([r,t],function(t){e.Fc(t),i.push(t.key)}),i},Cc.prototype.Mc=function(){var e=this;this.Sc.forEach(function(t){return e.Fc(t)})},Cc.prototype.Fc=function(t){this.Sc=this.Sc.delete(t),this.Cc=this.Cc.delete(t)},Cc.prototype.$c=function(t){var e=new bi(new gi([])),n=new ec(e,t),t=new ec(e,t+1),r=wu();return this.Cc.Ae([n,t],function(t){r=r.add(t.key)}),r},Cc.prototype.ki=function(t){var e=new ec(t,0),e=this.Sc.Pe(e);return null!==e&&t.isEqual(e.key)},Cc),ec=(Lc.Dc=function(t,e){return bi.J(t.key,e.key)||Vr(t.Lc,e.Lc)},Lc.xc=function(t,e){return Vr(t.Lc,e.Lc)||bi.J(t.key,e.key)},Lc),nc=(Dc.prototype.Ri=function(t){return ha.resolve(0===this.Ho.length)},Dc.prototype.Pi=function(t,e,n,r){var i=this.Bc;this.Bc++,0<this.Ho.length&&this.Ho[this.Ho.length-1];n=new ga(i,e,n,r);this.Ho.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.qc=this.qc.add(new ec(u.key,i)),this.Ti.Us(t,u.key.path.Z())}return ha.resolve(n)},Dc.prototype.yi=function(t,e){return ha.resolve(this.Uc(e))},Dc.prototype.Vi=function(t,e){e+=1,e=this.Qc(e),e=e<0?0:e;return ha.resolve(this.Ho.length>e?this.Ho[e]:null)},Dc.prototype.pi=function(){return ha.resolve(0===this.Ho.length?-1:this.Bc-1)},Dc.prototype.bi=function(t){return ha.resolve(this.Ho.slice())},Dc.prototype.vi=function(t,e){var n=this,r=new ec(e,0),e=new ec(e,Number.POSITIVE_INFINITY),i=[];return this.qc.Ae([r,e],function(t){t=n.Uc(t.Lc);i.push(t)}),ha.resolve(i)},Dc.prototype.Si=function(t,e){var n=this,r=new fu(Vr);return e.forEach(function(t){var e=new ec(t,0),t=new ec(t,Number.POSITIVE_INFINITY);n.qc.Ae([e,t],function(t){r=r.add(t.Lc)})}),ha.resolve(this.Kc(r))},Dc.prototype.Ci=function(t,e){var n=e.path,r=n.length+1,e=n;bi.Et(e)||(e=e.child(""));var e=new ec(new bi(e),0),i=new fu(Vr);return this.qc.Re(function(t){var e=t.key.path;return!!n.st(e)&&(e.length===r&&(i=i.add(t.Lc)),!0)},e),ha.resolve(this.Kc(i))},Dc.prototype.Kc=function(t){var e=this,n=[];return t.forEach(function(t){t=e.Uc(t);null!==t&&n.push(t)}),n},Dc.prototype.xi=function(n,r){var i=this;Rr(0===this.Wc(r.batchId,"removed")),this.Ho.shift();var o=this.qc;return ha.forEach(r.mutations,function(t){var e=new ec(t.key,r.batchId);return o=o.delete(e),i.Ii.Fi(n,t.key)}).next(function(){i.qc=o})},Dc.prototype.Ni=function(t){},Dc.prototype.ki=function(t,e){var n=new ec(e,0),n=this.qc.Pe(n);return ha.resolve(e.isEqual(n&&n.key))},Dc.prototype.Oi=function(t){return this.Ho.length,ha.resolve()},Dc.prototype.Wc=function(t,e){return this.Qc(t)},Dc.prototype.Qc=function(t){return 0===this.Ho.length?0:t-this.Ho[0].batchId},Dc.prototype.Uc=function(t){t=this.Qc(t);return t<0||t>=this.Ho.length?null:this.Ho[t]},Dc),rc=(Oc.prototype.ui=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.jc(e);return this.docs=this.docs.Ht(r,{li:e,size:i,readTime:n}),this.size+=i-o,this.Ti.Us(t,r.path.Z())},Oc.prototype._i=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Oc.prototype.fi=function(t,e){e=this.docs.get(e);return ha.resolve(e?e.li:null)},Oc.prototype.getEntries=function(t,e){var n=this,r=pu;return e.forEach(function(t){var e=n.docs.get(t);r=r.Ht(t,e?e.li:null)}),ha.resolve(r)},Oc.prototype.Wr=function(t,e,n){for(var r=vu,i=new bi(e.path.child("")),o=this.docs.ne(i);o.ae();){var s=o.ce(),u=s.key,a=s.value,s=a.li,a=a.readTime;if(!e.path.st(u.path))break;a.u(n)<=0||s instanceof oo&&ss(e,s)&&(r=r.Ht(s.key,s))}return ha.resolve(r)},Oc.prototype.Gc=function(t,e){return ha.forEach(this.docs,function(t){return e(t)})},Oc.prototype.Fr=function(t){return new ic(this)},Oc.prototype.Mr=function(t){return ha.resolve(this.size)},Oc),ic=(f(Sc,$a=Te),Sc.prototype.Ei=function(n){var r=this,i=[];return this.oi.forEach(function(t,e){e&&e.li?i.push(r.Gr.ui(n,e.li,r.ai(t))):r.Gr._i(t)}),ha.Ln(i)},Sc.prototype.di=function(t,e){return this.Gr.fi(t,e)},Sc.prototype.wi=function(t,e){return this.Gr.getEntries(t,e)},Sc),oc=(Nc.prototype.mn=function(t,n){return this.zc.forEach(function(t,e){return n(e)}),ha.resolve()},Nc.prototype.Ki=function(t){return ha.resolve(this.lastRemoteSnapshotVersion)},Nc.prototype.Wi=function(t){return ha.resolve(this.Hc)},Nc.prototype.qi=function(t){return this.highestTargetId=this.Yc.next(),ha.resolve(this.highestTargetId)},Nc.prototype.ji=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hc&&(this.Hc=e),ha.resolve()},Nc.prototype.zi=function(t){this.zc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yc=new La(e),this.highestTargetId=e),t.sequenceNumber>this.Hc&&(this.Hc=t.sequenceNumber)},Nc.prototype.Gi=function(t,e){return this.zi(e),this.targetCount+=1,ha.resolve()},Nc.prototype.Ji=function(t,e){return this.zi(e),ha.resolve()},Nc.prototype.Yi=function(t,e){return this.zc.delete(e.target),this.Jc.kc(e.targetId),--this.targetCount,ha.resolve()},Nc.prototype.Zi=function(n,r,i){var o=this,s=0,u=[];return this.zc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.zc.delete(t),u.push(o.Xi(n,e.targetId)),s++)}),ha.Ln(u).next(function(){return s})},Nc.prototype.tr=function(t){return ha.resolve(this.targetCount)},Nc.prototype.er=function(t,e){e=this.zc.get(e)||null;return ha.resolve(e)},Nc.prototype.nr=function(t,e,n){return this.Jc.Nc(e,n),ha.resolve()},Nc.prototype.ir=function(e,t,n){this.Jc.Oc(t,n);var r=this.persistence.Ii,i=[];return r&&t.forEach(function(t){i.push(r.Fi(e,t))}),ha.Ln(i)},Nc.prototype.Xi=function(t,e){return this.Jc.kc(e),ha.resolve()},Nc.prototype.cr=function(t,e){e=this.Jc.$c(e);return ha.resolve(e)},Nc.prototype.ki=function(t,e){return ha.resolve(this.Jc.ki(e))},Nc),sc=(Ac.prototype.start=function(){return Promise.resolve()},Ac.prototype.$o=function(){return this.ro=!1,Promise.resolve()},Object.defineProperty(Ac.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),Ac.prototype.yo=function(){},Ac.prototype.Vo=function(){},Ac.prototype.Wo=function(){return this.Ti},Ac.prototype.Ko=function(t){var e=this.Xc[t.R()];return e||(e=new nc(this.Ti,this.Ii),this.Xc[t.R()]=e),e},Ac.prototype.Dr=function(){return this.fo},Ac.prototype.Or=function(){return this.wo},Ac.prototype.jo=function(){return this.Eo},Ac.prototype.runTransaction=function(t,e,n){var r=this;Sr("MemoryPersistence","Starting transaction:",t);var i=new uc(this.io.next());return this.Ii.ta(),n(i).next(function(t){return r.Ii.ea(i).next(function(){return t})}).Mn().then(function(t){return i.ps(),t})},Ac.prototype.na=function(e,n){return ha.Bn(Object.values(this.Xc).map(function(t){return function(){return t.ki(e,n)}}))},Ac),uc=(f(Ic,Qa=o),Ic),ac=(Tc.ra=function(t){return new Tc(t)},Object.defineProperty(Tc.prototype,"oa",{get:function(){if(this.ia)return this.ia;throw Cr()},enumerable:!1,configurable:!0}),Tc.prototype.sr=function(t,e,n){return this.sa.sr(n,e),this.oa.delete(n.toString()),ha.resolve()},Tc.prototype.rr=function(t,e,n){return this.sa.rr(n,e),this.oa.add(n.toString()),ha.resolve()},Tc.prototype.Fi=function(t,e){return this.oa.add(e.toString()),ha.resolve()},Tc.prototype.removeTarget=function(t,e){var n=this;this.sa.kc(e.targetId).forEach(function(t){return n.oa.add(t.toString())});var r=this.persistence.Dr();return r.cr(t,e.targetId).next(function(t){t.forEach(function(t){return n.oa.add(t.toString())})}).next(function(){return r.Yi(t,e)})},Tc.prototype.ta=function(){this.ia=new Set},Tc.prototype.ea=function(n){var r=this,i=this.persistence.Or().Fr();return ha.forEach(this.oa,function(t){var e=bi.ft(t);return r.ca(n,e).next(function(t){t||i._i(e)})}).next(function(){return r.ia=null,i.apply(n)})},Tc.prototype.kr=function(t,e){var n=this;return this.ca(t,e).next(function(t){t?n.oa.delete(e.toString()):n.oa.add(e.toString())})},Tc.prototype.Zc=function(t){return 0},Tc.prototype.ca=function(t,e){var n=this;return ha.Bn([function(){return ha.resolve(n.sa.ki(e))},function(){return n.persistence.Dr().ki(t,e)},function(){return n.persistence.na(t,e)}])},Tc),cc=(Ec.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Ec.prototype.la=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Ec.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.rt(),updateTimeMs:Date.now()};return JSON.stringify(t)},Ec),hc=(_c.prototype.xa=function(t){},_c.prototype.Fa=function(t,e,n){},_c.prototype.ka=function(t){return this.ru.ha(t),this.ou[t]||"not-current"},_c.prototype.qa=function(t,e,n){this.ou[t]=e},_c.prototype.$a=function(t){this.ru.la(t)},_c.prototype.La=function(t){return this.ru.activeTargetIds.has(t)},_c.prototype.Ba=function(t){delete this.ou[t]},_c.prototype.Sa=function(){return this.ru.activeTargetIds},_c.prototype.Ca=function(t){return this.ru.activeTargetIds.has(t)},_c.prototype.start=function(){return this.ru=new cc,Promise.resolve()},_c.prototype.Qa=function(t,e,n){},_c.prototype.Ka=function(t){},_c.prototype.$o=function(){},_c.prototype.q=function(t){},_c.prototype.ja=function(){},_c),fc=(bc.prototype.cu=function(t){},bc.prototype.$o=function(){},bc),lc=(wc.prototype.cu=function(t){this._u.push(t)},wc.prototype.$o=function(){window.removeEventListener("online",this.au),window.removeEventListener("offline",this.hu)},wc.prototype.fu=function(){window.addEventListener("online",this.au),window.addEventListener("offline",this.hu)},wc.prototype.uu=function(){Sr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(0)},wc.prototype.lu=function(){Sr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(1)},wc.Wn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},wc),pc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},dc=(mc.prototype.Eu=function(t){this.Tu=t},mc.prototype.Iu=function(t){this.mu=t},mc.prototype.onMessage=function(t){this.Au=t},mc.prototype.close=function(){this.wu()},mc.prototype.send=function(t){this.du(t)},mc.prototype.Ru=function(){this.Tu()},mc.prototype.Pu=function(t){this.mu(t)},mc.prototype.yu=function(t){this.Au(t)},mc),yc=(gc.prototype.bu=function(e,t,n,r){var i=this.vu(e,t);Sr("RestConnection","Sending: ",i,n);t={};return this.Su(t,r),this.Du(e,i,t,n).then(function(t){return Sr("RestConnection","Received: ",t),t},function(t){throw Dr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},gc.prototype.Cu=function(t,e,n,r){return this.bu(t,e,n,r)},gc.prototype.Su=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.5-2021026232412",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},gc.prototype.vu=function(t,e){t=pc[t];return this.Vu+"/v1/"+e+":"+t},f(vc,Ya=gc),vc.prototype.Du=function(o,e,s,u){return new Promise(function(n,r){var i=new Tr;i.listenOnce(mr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case gr.NO_ERROR:var t=i.getResponseJson();Sr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case gr.TIMEOUT:Sr("Connection",'RPC "'+o+'" timed out'),r(new qr(jr.DEADLINE_EXCEEDED,"Request time out"));break;case gr.HTTP_ERROR:var e=i.getStatus();Sr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(jr).indexOf(e)?e:jr.UNKNOWN,r(new qr(e,t.message))):r(new qr(jr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new qr(jr.UNAVAILABLE,"Connection failed."));break;default:Cr()}}finally{Sr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},vc.prototype.xu=function(t,e){var n,r=[this.Vu,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new fr,o=vr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.I};this.Su(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Sr("Connection","Creating WebChannel: "+r,t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new dc({du:function(t){a?Sr("Connection","Not sending because WebChannel is closed:",t):(u||(Sr("Connection","Opening WebChannel transport."),s.open(),u=!0),Sr("Connection","WebChannel sending:",t),s.send(t))},wu:function(){return s.close()}}),t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(s,Er.EventType.OPEN,function(){a||Sr("Connection","WebChannel transport opened.")}),t(s,Er.EventType.CLOSE,function(){a||(a=!0,Sr("Connection","WebChannel transport closed"),c.Pu())}),t(s,Er.EventType.ERROR,function(t){a||(a=!0,Dr("Connection","WebChannel transport errored:",t),c.Pu(new qr(jr.UNAVAILABLE,"The operation could not be completed")))}),t(s,Er.EventType.MESSAGE,function(t){var e,n,r,i;a||(Rr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Sr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Xs[r];if(void 0!==t)return ru(t)}(),i=n.message,void 0===t&&(t=jr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.Pu(new qr(t,i)),s.close()):(Sr("Connection","WebChannel received:",e),c.yu(e)))}),t(o,wr.STAT_EVENT,function(t){t.stat===br?Sr("Connection","Detected buffering proxy"):t.stat===_r&&Sr("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Ru()},0),c},vc);function vc(t){var e=this;return(e=Ya.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.I=t.I,e}function gc(t){this.gu=t,this.T=t.T;var e=t.ssl?"https":"http";this.Vu=e+"://"+t.host,this.pu="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}function mc(t){this.du=t.du,this.wu=t.wu}function wc(){var t=this;this.au=function(){return t.uu()},this.hu=function(){return t.lu()},this._u=[],this.fu()}function bc(){}function _c(){this.ru=new cc,this.ou={},this.da=null,this.$=null}function Ec(){this.activeTargetIds=bu}function Tc(t){this.persistence=t,this.sa=new tc,this.ia=null}function Ic(t){var e=this;return(e=Qa.call(this)||this).vs=t,e}function Ac(t,e){var n=this;this.Xc={},this.io=new ui(0),this.ro=!1,this.ro=!0,this.Ii=t(this),this.fo=new oc(this),this.Ti=new Ta,this.wo=(t=this.Ti,new rc(t,function(t){return n.Ii.Zc(t)})),this.Kt=new va(e),this.Eo=new Za(this.Kt)}function Nc(t){this.persistence=t,this.zc=new Da(po,yo),this.lastRemoteSnapshotVersion=vi.min(),this.highestTargetId=0,this.Hc=0,this.Jc=new tc,this.targetCount=0,this.Yc=La.Li()}function Sc(t){var e=this;return(e=$a.call(this)||this).Gr=t,e}function Oc(t,e){this.Ti=t,this.jc=e,this.docs=new iu(bi.J),this.size=0}function Dc(t,e){this.Ti=t,this.Ii=e,this.Ho=[],this.Bc=1,this.qc=new fu(ec.Dc)}function Lc(t,e){this.key=t,this.Lc=e}function Cc(){this.Sc=new fu(ec.Dc),this.Cc=new fu(ec.xc)}function Rc(t){this.Kt=t,this.bc=new Map,this.vc=new Map}function kc(){return"undefined"!=typeof document?document:null}function Pc(t){return new Hu(t,!0)}function Vc(t,e,n,r,i){var o=this;this.Sh=t,this.Dh=e,this.fs=n,this.Ch={},this.xh=[],this.Nh=new Map,this.Fh=new Set,this.Oh=[],this.kh=i,this.kh.cu(function(t){n.ys(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return ih(this)?(Sr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Fh.add(4),[4,Qc(e)];case 1:return t.sent(),e.Mh.set("Unknown"),e.Fh.delete(4),[4,Yc(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Mh=new Gc(n,r)}var xc,Uc,Mc,Fc=(Xc.prototype.reset=function(){this.ku=0},Xc.prototype.Lu=function(){this.ku=this.Ou},Xc.prototype.Bu=function(t){var e=this;this.cancel();var n=Math.floor(this.ku+this.qu()),r=Math.max(0,Date.now()-this.$u),i=Math.max(0,n-r);0<i&&Sr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ku+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Mu=this.eo.Ir(this.ds,i,function(){return e.$u=Date.now(),t()}),this.ku*=this.Fu,this.ku<this.Nu&&(this.ku=this.Nu),this.ku>this.Ou&&(this.ku=this.Ou)},Xc.prototype.Uu=function(){null!==this.Mu&&(this.Mu.Ps(),this.Mu=null)},Xc.prototype.cancel=function(){null!==this.Mu&&(this.Mu.cancel(),this.Mu=null)},Xc.prototype.qu=function(){return(Math.random()-.5)*this.ku},Xc),Te=(Wc.prototype.Hu=function(){return 1===this.state||2===this.state||4===this.state},Wc.prototype.Ju=function(){return 2===this.state},Wc.prototype.start=function(){3!==this.state?this.auth():this.Yu()},Wc.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Wc.prototype.Xu=function(){this.state=0,this.zu.reset()},Wc.prototype.Zu=function(){var t=this;this.Ju()&&null===this.Gu&&(this.Gu=this.eo.Ir(this.Qu,6e4,function(){return t.th()}))},Wc.prototype.eh=function(t){this.nh(),this.stream.send(t)},Wc.prototype.th=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Ju()?[2,this.close(0)]:[2]})})},Wc.prototype.nh=function(){this.Gu&&(this.Gu.cancel(),this.Gu=null)},Wc.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.nh(),this.zu.cancel(),this.ju++,3!==e?this.zu.reset():n&&n.code===jr.RESOURCE_EXHAUSTED?(Or(n.toString()),Or("Using maximum backoff delay to prevent overloading the backend."),this.zu.Lu()):n&&n.code===jr.UNAUTHENTICATED&&this.Wu.v(),null!==this.stream&&(this.sh(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Iu(n)];case 1:return t.sent(),[2]}})})},Wc.prototype.sh=function(){},Wc.prototype.auth=function(){var n=this;this.state=1;var t=this.ih(this.ju),e=this.ju;this.Wu.getToken().then(function(t){n.ju===e&&n.rh(t)},function(e){t(function(){var t=new qr(jr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.oh(t)})})},Wc.prototype.rh=function(t){var e=this,n=this.ih(this.ju);this.stream=this.ah(t),this.stream.Eu(function(){n(function(){return e.state=2,e.listener.Eu()})}),this.stream.Iu(function(t){n(function(){return e.oh(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Wc.prototype.Yu=function(){var t=this;this.state=4,this.zu.Bu(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Wc.prototype.oh=function(t){return Sr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Wc.prototype.ih=function(e){var n=this;return function(t){n.eo.ys(function(){return n.ju===e?t():(Sr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Wc),jc=(f(Jc,Mc=Te),Jc.prototype.ah=function(t){return this.Ku.xu("Listen",t)},Jc.prototype.onMessage=function(t){this.zu.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Cr(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.qt?(Rr(void 0===s||"string"==typeof s),Ur.fromBase64String(s||"")):(Rr(void 0===s||s instanceof Uint8Array),Ur.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?jr.UNKNOWN:ru(c.code),new qr(a,c.message||"")),s=new Ou(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=Xu(t,n.document.name),i=Bu(n.document.updateTime);var u=new $i({mapValue:{fields:n.document.fields}}),a=(o=new oo(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[];s=new Nu(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=Xu(t,n.document),i=n.readTime?Bu(n.readTime):vi.min(),u=new so(r,i),o=n.removedTargetIds||[],s=new Nu([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=Xu(t,n.document),i=n.removedTargetIds||[],s=new Nu([],i,r,null);else{if(!("filter"in e))return Cr();e.filter;e=e.filter;e.targetId,n=e.count||0,r=new Ws(n),i=e.targetId,s=new Su(i,r)}return s}(this.Kt,t),t=function(t){if(!("targetChange"in t))return vi.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?Bu(t.readTime):vi.min()}(t);return this.listener.uh(e,t)},Jc.prototype.hh=function(t){var e,n,r,i={};i.database=Qu(this.Kt),i.addTarget=(e=this.Kt,(r=vo(r=(n=t).target)?{documents:{documents:[Yu(e,r.path)]}}:{query:ea(e,r)}).targetId=n.targetId,0<n.resumeToken.o()?r.resumeToken=zu(e,n.resumeToken):0<n.Mt.u(vi.min())&&(r.readTime=Gu(e,n.Mt.G())),r);var o,t=(this.Kt,o=t,null==(t=function(){switch(o.kt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Cr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.eh(i)},Jc.prototype.lh=function(t){var e={};e.database=Qu(this.Kt),e.removeTarget=t,this.eh(e)},Jc),qc=(f(Kc,Uc=Te),Object.defineProperty(Kc.prototype,"fh",{get:function(){return this._h},enumerable:!1,configurable:!0}),Kc.prototype.start=function(){this._h=!1,this.lastStreamToken=void 0,Uc.prototype.start.call(this)},Kc.prototype.sh=function(){this._h&&this.dh([])},Kc.prototype.ah=function(t){return this.Ku.xu("Write",t)},Kc.prototype.onMessage=function(t){if(Rr(!!t.streamToken),this.lastStreamToken=t.streamToken,this._h){this.zu.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Rr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?Bu(t.updateTime):Bu(e);n.isEqual(vi.min())&&(n=Bu(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Cs(n,e)}(t,r)})):[]),n=Bu(t.commitTime);return this.listener.wh(n,e)}var n,r;return Rr(!t.writeResults||0===t.writeResults.length),this._h=!0,this.listener.Eh()},Kc.prototype.Th=function(){var t={};t.database=Qu(this.Kt),this.eh(t)},Kc.prototype.dh=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return ta(e.Kt,t)})};this.eh(t)},Kc),Hc=(f(Bc,xc=function(){}),Bc.prototype.mh=function(){if(this.Ih)throw new qr(jr.FAILED_PRECONDITION,"The client has already been terminated.")},Bc.prototype.bu=function(e,n,r){var i=this;return this.mh(),this.credentials.getToken().then(function(t){return i.Ku.bu(e,n,r,t)}).catch(function(t){throw t.code===jr.UNAUTHENTICATED&&i.credentials.v(),t})},Bc.prototype.Cu=function(e,n,r){var i=this;return this.mh(),this.credentials.getToken().then(function(t){return i.Ku.Cu(e,n,r,t)}).catch(function(t){throw t.code===jr.UNAUTHENTICATED&&i.credentials.v(),t})},Bc.prototype.terminate=function(){this.Ih=!1},Bc),Gc=(zc.prototype.yh=function(){var t=this;0===this.Ah&&(this.gh("Unknown"),this.Rh=this.fs.Ir("online_state_timeout",1e4,function(){return t.Rh=null,t.Vh("Backend didn't respond within 10 seconds."),t.gh("Offline"),Promise.resolve()}))},zc.prototype.ph=function(t){"Online"===this.state?this.gh("Unknown"):(this.Ah++,1<=this.Ah&&(this.bh(),this.Vh("Connection failed 1 times. Most recent error: "+t.toString()),this.gh("Offline")))},zc.prototype.set=function(t){this.bh(),this.Ah=0,"Online"===t&&(this.Ph=!1),this.gh(t)},zc.prototype.gh=function(t){t!==this.state&&(this.state=t,this.da(t))},zc.prototype.Vh=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ph?(Or(t),this.Ph=!1):Sr("OnlineStateTracker",t)},zc.prototype.bh=function(){null!==this.Rh&&(this.Rh.cancel(),this.Rh=null)},zc);function zc(t,e){this.fs=t,this.da=e,this.state="Unknown",this.Ah=0,this.Rh=null,this.Ph=!0}function Bc(t,e,n){var r=this;return(r=xc.call(this)||this).credentials=t,r.Ku=e,r.Kt=n,r.Ih=!1,r}function Kc(t,e,n,r,i){var o=this;return(o=Uc.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).Kt=r,o._h=!1,o}function Jc(t,e,n,r,i){var o=this;return(o=Mc.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).Kt=r,o}function Wc(t,e,n,r,i,o){this.eo=t,this.Qu=n,this.Ku=r,this.Wu=i,this.listener=o,this.state=0,this.ju=0,this.Gu=null,this.stream=null,this.zu=new Fc(t,e)}function Xc(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.eo=t,this.ds=e,this.Nu=n,this.Fu=r,this.Ou=i,this.ku=0,this.Mu=null,this.$u=Date.now(),this.reset()}function Yc(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!ih(r))return[3,4];e=0,n=r.Oh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Qc(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Oh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function $c(t,e){t.Nh.has(e.targetId)||(t.Nh.set(e.targetId,e),rh(t)?nh(t):lh(t).Ju()&&th(t,e))}function Zc(t,e){var n=t,t=lh(n);n.Nh.delete(e),t.Ju()&&eh(n,e),0===n.Nh.size&&(t.Ju()?t.Zu():ih(n)&&n.Mh.set("Unknown"))}function th(t,e){t.$h.cn(e.targetId),lh(t).hh(e)}function eh(t,e){t.$h.cn(e),lh(t).lh(e)}function nh(e){e.$h=new Lu({Sn:function(t){return e.Ch.Sn(t)},Dn:function(t){return e.Nh.get(t)||null}}),lh(e).start(),e.Mh.yh()}function rh(t){return ih(t)&&!lh(t).Hu()&&0<t.Nh.size}function ih(t){return 0===t.Fh.size}function oh(t){t.$h=void 0}function sh(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Mh.set("Online"),!(u instanceof Ou&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Nh.has(i)?[4,o.Ch.Lh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Nh.delete(i),o.$h.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Sr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,uh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Nu?s.$h.wn(u):u instanceof Su?s.$h.yn(u):s.$h.In(u),a.isEqual(vi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,za(s.Sh)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).$h.pn(i)).Oe.forEach(function(t,e){var n;0<t.resumeToken.o()&&((n=r.Nh.get(e))&&r.Nh.set(e,n.Lt(t.resumeToken,i)))}),e.ke.forEach(function(t){var e=r.Nh.get(t);e&&(r.Nh.set(t,e.Lt(Ur.h,e.Mt)),eh(r,t),e=new as(e.target,t,1,e.sequenceNumber),th(r,e))}),r.Ch.Bh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Sr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,uh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function uh(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!la(r))throw r;return n.Fh.add(1),[4,Qc(n)];case 1:return t.sent(),n.Mh.set("Offline"),i=i||function(){return za(n.Sh)},n.fs.bo(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Sr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Fh.delete(1),[4,Yc(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function ah(e,n){return n().catch(function(t){return uh(e,t,n)})}function ch(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=ph(i=a),s=0<i.xh.length?i.xh[i.xh.length-1].batchId:-1,t.label=1;case 1:if(!(ih(i)&&i.xh.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Sh,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.Ho.Vi(t,n)}))];case 3:return null===(u=t.sent())?(0===i.xh.length&&o.Zu(),[3,7]):(s=u.batchId,function(t,e){t.xh.push(e);t=ph(t);t.Ju()&&t.fh&&t.dh(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,uh(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return hh(i)&&fh(i),[2]}var e,n,r})})}function hh(t){return ih(t)&&!ph(t).Hu()&&0<t.xh.length}function fh(t){ph(t).start()}function lh(n){var t,e,r,i=this;return n.Qh||(n.Qh=(t=n.Dh,e=n.fs,r={Eu:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Nh.forEach(function(t,e){th(n,t)}),[2]})})}.bind(null,n),Iu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return oh(e),rh(e)?(e.Mh.ph(n),nh(e)):e.Mh.set("Unknown"),[2]})})}.bind(null,n),uh:sh.bind(null,n)},t.mh(),new jc(e,t.Ku,t.credentials,t.Kt,r)),n.Oh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Qh.Xu(),rh(n)?nh(n):n.Mh.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Qh.stop()];case 2:t.sent(),oh(n),t.label=3;case 3:return[2]}})})})),n.Qh}function ph(n){var t,e,r,i=this;return n.Kh||(n.Kh=(t=n.Dh,e=n.fs,r={Eu:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return ph(e).Th(),[2]})})}.bind(null,n),Iu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&ph(e).fh?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return nu(n=i.code)&&n!==jr.ABORTED?(e=r.xh.shift(),ph(r).Xu(),[4,ah(r,function(){return r.Ch.Uh(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,ch(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return hh(e)&&fh(e),[2]}})})}.bind(null,n),Eh:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=ph(o),n=0,r=o.xh;n<r.length;n++)i=r[n],e.dh(i.mutations);return[2]})})}.bind(null,n),wh:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.xh.shift(),n=ma.from(e,i,o),[4,ah(r,function(){return r.Ch.qh(n)})];case 1:return t.sent(),[4,ch(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.mh(),new qc(e,t.Ku,t.credentials,t.Kt,r)),n.Oh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Kh.Xu(),[4,ch(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Kh.stop()];case 3:t.sent(),0<n.xh.length&&(Sr("RemoteStore","Stopping write stream with "+n.xh.length+" pending writes"),n.xh=[]),t.label=4;case 4:return[2]}})})})),n.Kh}function dh(){this.queries=new Da(is,rs),this.onlineState="Unknown",this.jh=new Set}var yh=function(){this.Wh=void 0,this.listeners=[]};function vh(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new yh),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Gh(n)];case 2:return o.Wh=t.sent(),[3,4];case 3:return o=t.sent(),o=ya(o,"Initialization of query '"+os(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.zh(e.onlineState),i.Wh&&u.Hh(i.Wh)&&mh(e),[2]}})})}function gh(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Jh(n))]:[2]})})}function mh(t){t.jh.forEach(function(t){t.next()})}var wh=(Nh.prototype.Hh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Tu(t.query,t.docs,t.De,e,t.Ce,t.fromCache,t.xe,!0)}var o=!1;return this.Xh?this.tl(t)&&(this.Yh.next(t),o=!0):this.el(t,this.onlineState)&&(this.nl(t),o=!0),this.Zh=t,o},Nh.prototype.onError=function(t){this.Yh.error(t)},Nh.prototype.zh=function(t){this.onlineState=t;var e=!1;return this.Zh&&!this.Xh&&this.el(this.Zh,t)&&(this.nl(this.Zh),e=!0),e},Nh.prototype.el=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.sl&&n||t.docs.nt()&&"Offline"!==e)},Nh.prototype.tl=function(t){if(0<t.docChanges.length)return!0;var e=this.Zh&&this.Zh.hasPendingWrites!==t.hasPendingWrites;return!(!t.xe&&!e)&&!0===this.options.includeMetadataChanges},Nh.prototype.nl=function(t){t=Tu.Fe(t.query,t.docs,t.Ce,t.fromCache),this.Xh=!0,this.Yh.next(t)},Nh),bh=(Ah.prototype.il=function(){return"metadata"in this.payload},Ah),_h=(Ih.prototype.yc=function(t){return Xu(this.Kt,t)},Ih.prototype.gc=function(t){return t.metadata.exists?(e=this.Kt,n=t.document,r=Xu(e,n.name),e=Bu(n.updateTime),n=new $i({mapValue:{fields:n.fields}}),new oo(r,e,n,{hasCommittedMutations:!1})):new so(this.yc(t.metadata.name),this.Vc(t.metadata.readTime));var e,n,r},Ih.prototype.Vc=Bu,Ih),Eh=(Th.prototype.ol=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},Th.prototype.cl=function(t){for(var e=new Map,n=new _h(this.Kt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.yc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||wu()).add(s);e.set(c,h)}}return e},Th.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,l,p,d){return y(this,void 0,void 0,function(){var n,r,i,o,e,s,u,a,c,h;return v(this,function(t){switch(t.label){case 0:for(n=f,r=wu(),i=pu,o=gu,e=0,s=p;e<s.length;e++)u=s[e],a=l.yc(u.metadata.name),u.document&&(r=r.add(a)),i=i.Ht(a,l.gc(u)),o=o.Ht(a,l.Vc(u.metadata.readTime));return c=n.Tc.Fr({jr:!0}),[4,Ja(n,es(Wo(gi.ct("__bundle__/docs/"+d))))];case 1:return h=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return Ka(e,c,i,vi.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n.fo.Xi(e,h.targetId).next(function(){return n.fo.nr(e,r,h.targetId)}).next(function(){return n.Ic.tc(e,t)})})})]}})})}(this.Sh,new _h(this.Kt),this.documents,this.rl.id)];case 1:e=t.sent(),n=this.cl(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=wu()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,Ja(e,es(Ea(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=Bu(i.readTime);if(0<=n.Mt.u(e))return r.Eo.Bs(t,i);e=n.Lt(Ur.h,e);return r.dc=r.dc.Ht(e.targetId,e),r.fo.Ji(t,e).next(function(){return r.fo.Xi(t,n.targetId)}).next(function(){return r.fo.nr(t,o,n.targetId)}).next(function(){return r.Eo.Bs(t,i)})})]}})})}(this.Sh,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Oa(Object.assign({},this.progress),e))]}})})},Th);function Th(t,e,n){this.rl=t,this.Sh=e,this.Kt=n,this.queries=[],this.documents=[],this.progress=Sh(t)}function Ih(t){this.Kt=t}function Ah(t,e){this.payload=t,this.byteLength=e}function Nh(t,e,n){this.query=t,this.Yh=e,this.Xh=!1,this.Zh=null,this.onlineState="Unknown",this.options=n||{}}function Sh(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Oh=function(t){this.key=t},Dh=function(t){this.key=t},Lh=(Object.defineProperty(Vh.prototype,"fl",{get:function(){return this.al},enumerable:!1,configurable:!0}),Vh.prototype.dl=function(t,e){var s=this,u=e?e.wl:new Eu,a=(e||this)._l,c=(e||this).Ce,h=a,f=!1,l=Xo(this.query)&&a.size===this.query.limit?a.last():null,p=Yo(this.query)&&a.size===this.query.limit?a.first():null;if(t.Zt(function(t,e){var n=a.get(t),r=(r=e instanceof oo?e:null)&&(ss(s.query,r)?r:null),i=!!n&&s.Ce.has(n.key),o=!!r&&(r.bt||s.Ce.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.El(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.ll(r,l)||p&&s.ll(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),Xo(this.query)||Yo(this.query))for(;h.size>this.query.limit;){var n=Xo(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{_l:h,wl:u,_c:f,Ce:c}},Vh.prototype.El=function(t,e){return t.bt&&e.hasCommittedMutations&&!e.bt},Vh.prototype.Ei=function(t,e,n){var o=this,r=this._l;this._l=t._l,this.Ce=t.Ce;var i=t.wl.Se();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.ll(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Cr()}}var r,i}),this.Tl(n);var s=e?this.Il():[],n=0===this.hl.size&&this.qe?1:0,e=n!==this.ul;return this.ul=n,0!==i.length||e?{snapshot:new Tu(this.query,t._l,r,i,t.Ce,0==n,e,!1),ml:s}:{ml:s}},Vh.prototype.zh=function(t){return this.qe&&"Offline"===t?(this.qe=!1,this.Ei({_l:this._l,wl:new Eu,Ce:this.Ce,_c:!1},!1)):{ml:[]}},Vh.prototype.Al=function(t){return!this.al.has(t)&&!!this._l.has(t)&&!this._l.get(t).bt},Vh.prototype.Tl=function(t){var e=this;t&&(t.Ue.forEach(function(t){return e.al=e.al.add(t)}),t.Qe.forEach(function(t){}),t.Ke.forEach(function(t){return e.al=e.al.delete(t)}),this.qe=t.qe)},Vh.prototype.Il=function(){var e=this;if(!this.qe)return[];var n=this.hl;this.hl=wu(),this._l.forEach(function(t){e.Al(t.key)&&(e.hl=e.hl.add(t.key))});var r=[];return n.forEach(function(t){e.hl.has(t)||r.push(new Dh(t))}),this.hl.forEach(function(t){n.has(t)||r.push(new Oh(t))}),r},Vh.prototype.Rl=function(t){this.al=t.Pc,this.hl=wu();t=this.dl(t.documents);return this.Ei(t,!0)},Vh.prototype.Pl=function(){return Tu.Fe(this.query,this._l,this.Ce,0===this.ul)},Vh),Ch=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Rh=function(t){this.key=t,this.yl=!1},kh=(Object.defineProperty(Ph.prototype,"Ll",{get:function(){return!0===this.$l},enumerable:!1,configurable:!0}),Ph);function Ph(t,e,n,r,i,o){this.Sh=t,this.gl=e,this.Vl=n,this.pl=r,this.currentUser=i,this.bl=o,this.vl={},this.Sl=new Da(is,rs),this.Dl=new Map,this.Cl=[],this.xl=new iu(bi.J),this.Nl=new Map,this.Fl=new tc,this.Ol={},this.kl=new Map,this.Ml=La.Bi(),this.onlineState="Unknown",this.$l=void 0}function Vh(t,e){this.query=t,this.al=e,this.ul=null,this.qe=!1,this.hl=wu(),this.Ce=wu(),this.ll=us(t),this._l=new _u(this.ll)}function xh(u,a){return y(this,void 0,void 0,function(){var n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return(e=u).gl.Ch.Bh=Mh.bind(null,e),e.gl.Ch.Sn=function(t,e){var n=t,t=n.Nl.get(e);if(t&&t.yl)return wu().add(t.key);var r=wu(),e=n.Dl.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.Sl.get(s);r=r.ye(s.view.fl)}return r}.bind(null,e),e.gl.Ch.Lh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).pl.qa(s,"rejected",u),i=e.Nl.get(s),(n=i&&i.key)?(r=(r=new iu(bi.J)).Ht(n,new so(n,vi.min())),i=wu().add(n),i=new Iu(vi.min(),new Map,new fu(Vr),r,i),[4,Mh(e,i)]):[3,2];case 1:return t.sent(),e.xl=e.xl.remove(n),e.Nl.delete(s),Kh(e),[3,4];case 2:return[4,Wa(e.Sh,s,!1).then(function(){return Gh(e,s,u)}).catch(Sa)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.vl.uh=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Hh(s)&&(r=!0);u.Wh=s}}r&&mh(n)}.bind(null,e.Vl),e.vl.ql=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.Vl),(s=(n=e).Sl.get(a))?(r=s.targetId,n.pl.ka(r),i=s.view.Pl(),[3,4]):[3,1];case 1:return[4,Ja(n.Sh,es(a))];case 2:return o=t.sent(),s=n.pl.ka(o.targetId),r=o.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Bl=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.dl(o))._c?[4,Xa(r.Sh,i.query,!1).then(function(t){t=t.documents;return i.view.dl(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Oe.get(i.targetId),n=i.view.Ei(e,r.Ll,n),[2,(Bh(r,i.targetId,n.ml),n.snapshot)]}})})}(i,t,e,n)},[4,Xa(i.Sh,o,!0)];case 1:return n=t.sent(),r=new Lh(o,n.Pc),e=r.dl(n.documents),n=Au.Be(s,u&&"Offline"!==i.onlineState),n=r.Ei(e,i.Ll,n),Bh(i,s,n.ml),r=new Ch(o,s,r),[2,(i.Sl.set(o,r),i.Dl.has(s)?i.Dl.get(s).push(o):i.Dl.set(s,[o]),n.snapshot)]}})})}(n,a,r,"current"===s)];case 3:i=t.sent(),n.Ll&&$c(n.gl,o),t.label=4;case 4:return[2,i]}var e})})}function Uh(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=l).gl.Ch.qh=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Ga(e.Sh,o)];case 2:return r=t.sent(),Hh(e,n,null),qh(e,n),e.pl.Fa(n,"acknowledged"),[4,Jh(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Sa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.gl.Ch.Uh=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Sh,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Ho.yi(e,r).next(function(t){return Rr(null!==t),n=t.keys(),i.Ho.xi(e,t)}).next(function(){return i.Ho.Oi(e)}).next(function(){return i.Ic.Zo(e,n)})}))];case 2:return o=t.sent(),Hh(n,u,a),qh(n,u),n.pl.Fa(u,"rejected",a),[4,Jh(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Sa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.Sh,a=p,h=r,f=yi.now(),i=a.reduce(function(t,e){return t.add(e.key)},wu()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Ic.Zo(u,i).next(function(t){c=t;for(var e,n=[],r=0,i=a;r<i.length;r++){var o=i[r],s=(e=o,s=c.get(o.key),function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof oo?e.field(o.field):void 0,s=ps(o.transform,s||null);null!=s&&(n=(null==n?new Zi:n).set(o.field,s))}return n?n.yt():null}(e.fieldTransforms,s));null!=s&&n.push(new qs(o.key,s,function s(t){var u=[];return Oi(t.fields||{},function(t,e){var n=new wi([t]);if(Qi(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Li(u)}(s.proto.mapValue),Rs.exists(!0)))}return h.Ho.Pi(u,f,n,a)})}).then(function(t){var e=t.Ns(c);return{batchId:t.batchId,oi:e}}))];case 2:return s=t.sent(),u.pl.xa(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.Ol[e.currentUser.R()])||new iu(Vr)).Ht(n,o),e.Ol[e.currentUser.R()]=r,[4,Jh(u,s.oi)];case 3:return t.sent(),[4,ch(u.gl)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=ya(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,c,h,f,i,o})})}function Mh(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Ba(n.Sh,i)];case 2:return e=t.sent(),i.Oe.forEach(function(t,e){e=n.Nl.get(e);e&&(Rr(t.Ue.size+t.Qe.size+t.Ke.size<=1),0<t.Ue.size?e.yl=!0:0<t.Qe.size?Rr(e.yl):0<t.Ke.size&&(Rr(e.yl),e.yl=!1))}),[4,Jh(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Sa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function Fh(t,n,e){var r,t=t;(t.Ll&&0===e||!t.Ll&&1===e)&&(r=[],t.Sl.forEach(function(t,e){e=e.view.zh(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].zh(i)&&(o=!0)}),o&&mh(t)}(t.Vl,n),r.length&&t.vl.uh(r),t.onlineState=n,t.Ll&&t.pl.Ka(n))}function jh(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:ih((n=o).gl)||Sr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Sh).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ho.pi(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.kl.get(r)||[]).push(s),n.kl.set(r,i),[3,4]);case 3:return i=t.sent(),i=ya(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function qh(t,e){(t.kl.get(e)||[]).forEach(function(t){t.resolve()}),t.kl.delete(e)}function Hh(t,e,n){var r=t,i=r.Ol[r.currentUser.R()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Ol[r.currentUser.R()]=i)}function Gh(e,t,n){void 0===n&&(n=null),e.pl.$a(t);for(var r=0,i=e.Dl.get(t);r<i.length;r++){var o=i[r];e.Sl.delete(o),n&&e.vl.ql(o,n)}e.Dl.delete(t),e.Ll&&e.Fl.kc(t).forEach(function(t){e.Fl.ki(t)||zh(e,t)})}function zh(t,e){var n=t.xl.get(e);null!==n&&(Zc(t.gl,n),t.xl=t.xl.remove(e),t.Nl.delete(n),Kh(t))}function Bh(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Oh?(t.Fl.sr(o.key,e),function(t,e){e=e.key;t.xl.get(e)||(Sr("SyncEngine","New document in limbo: "+e),t.Cl.push(e),Kh(t))}(t,o)):o instanceof Dh?(Sr("SyncEngine","Document no longer in limbo: "+o.key),t.Fl.rr(o.key,e),t.Fl.ki(o.key)||zh(t,o.key)):Cr()}}function Kh(t){for(;0<t.Cl.length&&t.xl.size<t.bl;){var e=t.Cl.shift(),n=t.Ml.next();t.Nl.set(n,new Rh(e)),t.xl=t.xl.Ht(e,n),$c(t.gl,new as(es(Wo(e.path)),n,2,ui.U))}}function Jh(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Sl.nt()?[3,3]:(n.Sl.forEach(function(t,e){o.push(n.Bl(e,s,u).then(function(t){t&&(n.Ll&&n.pl.qa(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Ra.cc(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.vl.uh(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ha.forEach(c,function(e){return ha.forEach(e.rc,function(t){return r.persistence.Ii.sr(n,e.targetId,t)}).next(function(){return ha.forEach(e.oc,function(t){return r.persistence.Ii.rr(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!la(e=t.sent()))throw e;return Sr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.dc.get(o),u=s.Mt,u=s.Bt(u),r.dc=r.dc.Ht(o,u));return[2]}})})}(n.Sh,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Wh(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Sr("SyncEngine","User change. New user:",o.R()),[4,Ha(n.Sh,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).kl.forEach(function(t){t.forEach(function(t){t.reject(new qr(jr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.kl.clear(),n.pl.Qa(o,r.Ac,r.Rc),[4,Jh(n,r.mc)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function Xh(t,e,n){var r=t;(function(l,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=l.Sh,o=r,s=Bu((i=u).createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.Eo.Ms(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.u(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.Ul({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.Ql(Sh(u)),a=new Eh(u,l.Sh,p.Kt),[4,p.Kl()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.ol(c)]:[3,10];case 7:return(h=t.sent())&&d.Ql(h),[4,p.Kl()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return f=t.sent(),[4,Jh(l,f.zo,void 0)];case 12:return t.sent(),[4,(r=l.Sh,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.Eo.$s(t,e)}))];case 13:return t.sent(),d.Ul(f.progress),[3,15];case 14:return Dr("SyncEngine","Loading bundle failed with "+(f=t.sent())),d.Wl(f),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.pl.ja()})}var Yh=(Zh.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Kt=Pc(e.gu.T),this.pl=this.jl(e),this.persistence=this.Gl(e),[4,this.persistence.start()];case 1:return t.sent(),this.zl=this.Hl(e),this.Sh=this.Jl(e),[2]}})})},Zh.prototype.Hl=function(t){return null},Zh.prototype.Jl=function(t){return e=this.persistence,n=new ka,r=t.Yl,t=this.Kt,new Pa(e,n,r,t);var e,n,r},Zh.prototype.Gl=function(t){return new sc(ac.ra,this.Kt)},Zh.prototype.jl=function(t){return new hc},Zh.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.pl.$o()];case 1:return t.sent(),[4,this.persistence.$o()];case 2:return t.sent(),[2]}})})},Zh),Qh=($h.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Sh?[3,2]:(this.Sh=n.Sh,this.pl=n.pl,this.Dh=this.Zl(r),this.gl=this.t_(r),this.Vl=this.e_(r),this.fa=this.n_(r,!n.synchronizeTabs),this.pl.da=function(t){return Fh(e.fa,t,1)},this.gl.Ch.s_=Wh.bind(null,this.fa),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Fh.delete(2),[4,Yc(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Fh.add(2),[4,Qc(e)]);case 3:t.sent(),e.Mh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.gl,this.fa.Ll)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},$h.prototype.e_=function(t){return new dh},$h.prototype.Zl=function(t){var e=Pc(t.gu.T),n=(n=t.gu,new yc(n));return t=t.credentials,new Hc(t,n,e)},$h.prototype.t_=function(t){var e=this,n=this.Sh,r=this.Dh,i=t.fs,o=function(t){return Fh(e.fa,t,0)},t=new(lc.Wn()?lc:fc);return new Vc(n,r,i,o,t)},$h.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){o=new kh(t,e,n,r,i,o);return s&&(o.$l=!0),o}(this.Sh,this.gl,this.Vl,this.pl,t.Yl,t.bl,e)},$h.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Sr("RemoteStore","RemoteStore shutting down."),e.Fh.add(5),[4,Qc(e)];case 1:return t.sent(),e.kh.$o(),e.Mh.set("Unknown"),[2]}})})}(this.gl)},$h);function $h(){}function Zh(){this.synchronizeTabs=!1}function tf(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}var ef=(af.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},af.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},af.prototype.r_=function(){this.muted=!0},af.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},af),nf=(uf.prototype.close=function(){return this.o_.cancel()},uf.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},uf.prototype.Kl=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.a_())]}})})},uf.prototype.a_=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.u_()];case 1:return null===(e=t.sent())?[2,null]:(r=this.c_.decode(e),n=Number(r),isNaN(n)&&this.h_("length string ("+r+") is not valid number"),[4,this.l_(n)]);case 2:return r=t.sent(),[2,new bh(JSON.parse(r),e.length+n)]}})})},uf.prototype.__=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},uf.prototype.u_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.__()<0?[4,this.f_()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.__())<0&&this.h_("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},uf.prototype.l_=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.f_()]:[3,3];case 1:t.sent()&&this.h_("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.c_.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},uf.prototype.h_=function(t){throw this.o_.cancel(),new Error("Invalid bundle format: "+t)},uf.prototype.f_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.o_.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},uf),rf=(sf.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},sf),of=function(t){this._methodName=t};function sf(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new qr(jr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.d_=new wi(t)}function uf(t,e){var n=this;this.o_=t,this.Kt=e,this.metadata=new ca,this.buffer=new Uint8Array,this.c_=new TextDecoder("utf-8"),this.a_().then(function(t){t&&t.il()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function af(t){this.observer=t,this.muted=!1}function cf(t,e,n){if(!n)throw new qr(jr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function hf(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new qr(jr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function ff(t,e,n,r){if(!0===e&&!0===r)throw new qr(jr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function lf(t){if(!bi.Et(t))throw new qr(jr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function pf(t){if(bi.Et(t))throw new qr(jr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function df(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Cr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function yf(t,e){if("_delegate"in t&&(t=t._),t instanceof e)return t;if(e.name===t.constructor.name)throw new qr(jr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=df(t);throw new qr(jr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function vf(t,e){if(e<=0)throw new qr(jr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var gf,mf=(Of.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Of),wf=new Map,bf=(Object.defineProperty(Sf.prototype,"app",{get:function(){if(!this.A_)throw new qr(jr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(Sf.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(Sf.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),Sf.prototype.g_=function(t){if(this.T_)throw new qr(jr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new mf(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new ri;switch(t.type){case"gapi":var e=t.client;return Rr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new si(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new qr(jr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Sf.prototype.V_=function(){return this.E_},Sf.prototype.p_=function(){return this.T_=!0,this.E_},Sf.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},Sf.prototype.toJSON=function(){return{app:this.A_,T:this.I_,settings:this.E_}},Sf.prototype.b_=function(){return(t=wf.get(this))&&(Sr("ComponentProvider","Removing Datastore"),wf.delete(this),t.terminate()),Promise.resolve();var t},Sf),_f=(Object.defineProperty(Nf.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Nf.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(Nf.prototype,"path",{get:function(){return this.S_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(Nf.prototype,"parent",{get:function(){return new Tf(this.firestore,this.v_,this.S_.path.Z())},enumerable:!1,configurable:!0}),Nf.prototype.withConverter=function(t){return new Nf(this.firestore,t,this.S_)},Nf),Ef=(Af.prototype.withConverter=function(t){return new Af(this.firestore,t,this.C_)},Af),Tf=(f(If,gf=Ef),Object.defineProperty(If.prototype,"id",{get:function(){return this.C_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(If.prototype,"path",{get:function(){return this.C_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(If.prototype,"parent",{get:function(){var t=this.D_.Z();return t.nt()?null:new _f(this.firestore,null,new bi(t))},enumerable:!1,configurable:!0}),If.prototype.withConverter=function(t){return new If(this.firestore,t,this.D_)},If);function If(t,e,n){var r=this;return(r=gf.call(this,t,e,Wo(n))||this).firestore=t,r.D_=n,r.type="collection",r}function Af(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}function Nf(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}function Sf(t,e){this.w_="(lite)",this.E_=new mf({}),this.T_=!1,t instanceof Qr?(this.I_=t,this.m_=new ri):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new qr(jr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qr(t.options.projectId)}(t),this.m_=new ii(e))}function Of(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new qr(jr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new qr(jr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,ff("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Df(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Gr&&(t=t._),cf("collection","path",e),t instanceof bf)return pf(n=gi.ct.apply(gi,l([e],r))),new Tf(t,null,n);if(!(t instanceof _f||t instanceof Tf))throw new qr(jr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return pf(n=gi.ct.apply(gi,l([t.path],r)).child(gi.ct(e))),new Tf(t.firestore,null,n)}function Lf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Gr&&(t=t._),1===arguments.length&&(e=kr.t()),cf("doc","path",e),t instanceof bf)return lf(n=gi.ct.apply(gi,l([e],r))),new _f(t,null,new bi(n));if(!(t instanceof _f||t instanceof Tf))throw new qr(jr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return lf(n=t.D_.child(gi.ct.apply(gi,l([e],r)))),new _f(t.firestore,t instanceof Tf?t.v_:null,new bi(n))}function Cf(t,e){return t instanceof Gr&&(t=t._),e instanceof Gr&&(e=e._),(t instanceof _f||t instanceof Tf)&&(e instanceof _f||e instanceof Tf)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function Rf(t,e){return t instanceof Gr&&(t=t._),e instanceof Gr&&(e=e._),t instanceof Ef&&e instanceof Ef&&t.firestore===e.firestore&&rs(t.C_,e.C_)&&t.v_===e.v_}var kf=(Object.defineProperty(Ff.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(Ff.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),Ff.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},Ff.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},Ff.prototype.K=function(t){return Vr(this.x_,t.x_)||Vr(this.N_,t.N_)},Ff),Pf=/^__.*__$/,Vf=(Mf.prototype.F_=function(t,e){return null!==this.zt?new qs(t,this.data,this.zt,e,this.fieldTransforms):new js(t,this.data,e,this.fieldTransforms)},Mf),xf=(Uf.prototype.F_=function(t,e){return new qs(t,this.data,this.zt,e,this.fieldTransforms)},Uf);function Uf(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}function Mf(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}function Ff(t,e){if(!isFinite(t)||t<-90||90<t)throw new qr(jr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new qr(jr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}function jf(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Cr()}}var qf=(Object.defineProperty(zf.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(zf.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),zf.prototype.M_=function(t){return new zf(Object.assign(Object.assign({},this.settings),t),this.T,this.Kt,this.ignoreUndefinedProperties,this.fieldTransforms,this.zt)},zf.prototype.L_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.M_({path:e,B_:!1});return e.q_(t),e},zf.prototype.U_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.M_({path:t,B_:!1});return t.O_(),t},zf.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},zf.prototype.K_=function(t){return wl(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},zf.prototype.contains=function(e){return void 0!==this.zt.find(function(t){return e.st(t)})||void 0!==this.fieldTransforms.find(function(t){return e.st(t.field)})},zf.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},zf.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(jf(this.k_)&&Pf.test(t))throw this.K_('Document fields cannot begin and end with "__"')},zf),Hf=(Gf.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new qf({k_:t,methodName:e,j_:n,path:wi.at(),B_:!1,W_:r},this.T,this.Kt,this.ignoreUndefinedProperties)},Gf);function Gf(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.Kt=n||Pc(t)}function zf(t,e,n,r,i,o){this.settings=t,this.T=e,this.Kt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.zt=o||[]}function Bf(t){var e=t.p_(),n=Pc(t.I_);return new Hf(t.I_,!!e.ignoreUndefinedProperties,n)}function Kf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);yl("Data must be an object, but it was:",s,r);var u,a,r=pl(r,s);if(o.merge)u=new Li(s.zt),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=vl(e,f[h],n);if(!s.contains(l))throw new qr(jr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");bl(c,l)||c.push(l)}u=new Li(c),a=s.fieldTransforms.filter(function(t){return u.It(t.field)})}else u=null,a=s.fieldTransforms;return new Vf(new $i(r),u,a)}var Jf,Wf=(f(Xf,Jf=of),Xf.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.zt.push(t.path),null},Xf.prototype.isEqual=function(t){return t instanceof Xf},Xf);function Xf(){return null!==Jf&&Jf.apply(this,arguments)||this}function Yf(t,e,n){return new qf({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.T,e.Kt,e.ignoreUndefinedProperties)}var Qf,$f,Zf,tl,el=(f(al,tl=of),al.prototype.z_=function(t){return new Ls(t.path,new vs)},al.prototype.isEqual=function(t){return t instanceof al},al),nl=(f(ul,Zf=of),ul.prototype.z_=function(t){var e=Yf(this,t,!0),n=this.H_.map(function(t){return ll(t,e)}),n=new gs(n);return new Ls(t.path,n)},ul.prototype.isEqual=function(t){return this===t},ul),rl=(f(sl,$f=of),sl.prototype.z_=function(t){var e=Yf(this,t,!0),n=this.H_.map(function(t){return ll(t,e)}),n=new Es(n);return new Ls(t.path,n)},sl.prototype.isEqual=function(t){return this===t},sl),il=(f(ol,Qf=of),ol.prototype.z_=function(t){var e=new Ns(t.Kt,ls(t.Kt,this.J_));return new Ls(t.path,e)},ol.prototype.isEqual=function(t){return this===t},ol);function ol(t,e){var n=this;return(n=Qf.call(this,t)||this).J_=e,n}function sl(t,e){var n=this;return(n=$f.call(this,t)||this).H_=e,n}function ul(t,e){var n=this;return(n=Zf.call(this,t)||this).H_=e,n}function al(){return null!==tl&&tl.apply(this,arguments)||this}function cl(t,r,i,e){var o=t.G_(1,r,i);yl("Data must be an object, but it was:",o,e);var s=[],u=new Zi;Oi(e,function(t,e){var n=ml(r,t,i);e instanceof Gr&&(e=e._);t=o.U_(n);e instanceof Wf?s.push(n):null!=(t=ll(e,t))&&(s.push(n),u.set(n,t))});e=new Li(s);return new xf(u.yt(),e,o.fieldTransforms)}function hl(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[vl(e,r,n)],a=[i];if(o.length%2!=0)throw new qr(jr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(vl(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new Zi,y=u.length-1;0<=y;--y){bl(p,u[y])||(h=u[y],(f=a[y])instanceof Gr&&(f=f._),l=s.U_(h),f instanceof Wf?p.push(h):null!=(l=ll(f,l))&&(p.push(h),d.set(h,l)))}i=new Li(p);return new xf(d.yt(),i,s.fieldTransforms)}function fl(t,e,n,r){return void 0===r&&(r=!1),ll(n,t.G_(r?4:3,e))}function ll(s,t){if(s instanceof Gr&&(s=s._),dl(s))return yl("Unsupported field value:",t,s),pl(s,t);if(s instanceof of)return function(t,e){if(!jf(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");t=t.z_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.zt.push(t.path),s instanceof Array){if(t.settings.B_&&4!==t.k_)throw t.K_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=ll(i[r],t.Q_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Gr&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ls(e.Kt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=yi.fromDate(t);return{timestampValue:Gu(e.Kt,n)}}if(t instanceof yi)return n=new yi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Gu(e.Kt,n)};if(t instanceof kf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Hr)return{bytesValue:zu(e.Kt,t.l)};if(t instanceof _f){n=e.T;var r=t.firestore.I_;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Ku(t.firestore.I_||e.T,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+df(t))}(s,t)}function pl(t,n){var r={};return Di(t)?n.path&&0<n.path.length&&n.zt.push(n.path):Oi(t,function(t,e){e=ll(e,n.L_(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function dl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof yi||t instanceof kf||t instanceof Hr||t instanceof _f||t instanceof of)}function yl(t,e,n){if(!dl(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=df(n);throw"an object"===n?e.K_(t+" a custom object"):e.K_(t+" "+n)}var r}function vl(t,e,n){if(e instanceof Gr&&(e=e._),e instanceof rf)return e.d_;if("string"==typeof e)return ml(t,e);throw wl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var gl=new RegExp("[~\\*/\\[\\]]");function ml(e,n,r){if(0<=n.search(gl))throw wl("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(rf.bind.apply(rf,l([void 0],n.split("."))))).d_}catch(t){throw wl("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function wl(t,e,n,r,i){var o=r&&!r.nt(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new qr(jr.INVALID_ARGUMENT,(e+=". ")+t+n)}function bl(t,e){return t.some(function(t){return t.isEqual(e)})}var _l=(Nl.prototype.ef=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),0<this.mutations.length)throw new qr(jr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Qu((n=s).Kt)+"/documents",r={documents:u.map(function(t){return Wu(n.Kt,t)})},[4,n.Cu("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.Kt,"found"in(t=t)?function(t,e){Rr(!!e.found),e.found.name,e.found.updateTime;var n=Xu(t,e.found.name),t=Bu(e.found.updateTime),e=new $i({mapValue:{fields:e.found.fields}});return new oo(n,t,e,{})}(e,t):"missing"in t?function(t,e){Rr(!!e.missing),Rr(!!e.readTime);t=Xu(t,e.missing),e=Bu(e.readTime);return new so(t,e)}(e,t):Cr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Rr(!!t),o.push(t)}),o)]}})})}(this.Dh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof so||t instanceof oo?n.sf(t):Cr()}),e)]}})})},Nl.prototype.set=function(t,e){this.write(e.F_(t,this.Gt(t))),this.tf.add(t.toString())},Nl.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},Nl.prototype.delete=function(t){this.write(new $s(t,this.Gt(t))),this.tf.add(t.toString())},Nl.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return e=this.Y_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=bi.ft(e);n.mutations.push(new Zs(e,n.Gt(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Qu((e=i).Kt)+"/documents",r={writes:o.map(function(t){return ta(e.Kt,t)})},[4,e.bu("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Dh,this.mutations)];case 1:return t.sent(),this.X_=!0,[2]}})})},Nl.prototype.sf=function(t){var e;if(t instanceof oo)e=t.version;else{if(!(t instanceof so))throw Cr();e=vi.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new qr(jr.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},Nl.prototype.Gt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Rs.updateTime(e):Rs.Wt()},Nl.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(this.tf.has(t.toString())||!e)return Rs.exists(!0);if(e.isEqual(vi.min()))throw new qr(jr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Rs.updateTime(e)},Nl.prototype.write=function(t){this.nf(),this.mutations.push(t)},Nl.prototype.nf=function(){},Nl),El=(Al.prototype.run=function(){this.af()},Al.prototype.af=function(){var t=this;this.zu.Bu(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new _l(this.Dh),(n=this.uf(e))&&n.then(function(t){r.fs.ys(function(){return e.commit().then(function(){r.Ts.resolve(t)}).catch(function(t){r.hf(t)})})}).catch(function(t){r.hf(t)}),[2]})})})},Al.prototype.uf=function(t){try{var e=this.updateFunction(t);return!Mi(e)&&e.catch&&e.then?e:(this.Ts.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ts.reject(t),null}},Al.prototype.hf=function(t){var e=this;0<this.cf&&this.lf(t)?(--this.cf,this.fs.ys(function(){return e.af(),Promise.resolve()})):this.Ts.reject(t)},Al.prototype.lf=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!nu(t)},Al),Tl=(Il.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{fs:this.fs,gu:this.gu,clientId:this.clientId,credentials:this.credentials,Yl:this.user,bl:100})]}})})},Il.prototype.ff=function(t){var e=this;this._f=t,this.N.promise.then(function(){return e._f(e.user)})},Il.prototype.df=function(){if(this.fs.wf)throw new qr(jr.FAILED_PRECONDITION,"The client has already been terminated.")},Il.prototype.terminate=function(){var t=this;this.fs.Ef();var n=new ca;return this.fs.Tf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.D(),n.resolve(),[3,6];case 5:return e=t.sent(),e=ya(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Il);function Il(t,e,n){var r=this;this.credentials=t,this.fs=e,this.gu=n,this.user=$r.UNAUTHENTICATED,this.clientId=kr.t(),this._f=function(){},this.N=new ca,this.credentials.S(function(t){Sr("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.N.resolve()})}function Al(t,e,n,r){this.fs=t,this.Dh=e,this.updateFunction=n,this.Ts=r,this.cf=5,this.zu=new Fc(this.fs,"transaction_retry")}function Nl(t){this.Dh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}function Sl(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.mf?[3,2]:(Sr("FirestoreClient","Using default OfflineComponentProvider"),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return i.fs.Af(),Sr("FirestoreClient","Initializing OfflineComponentProvider"),[4,i.getConfiguration()];case 1:return e=t.sent(),[4,o.initialize(e)];case 2:return t.sent(),n=e.Yl,i.ff(function(e){n.isEqual(e)||(n=e,i.fs.bo(function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Ha(o.Sh,e)];case 1:return t.sent(),[2]}})})}))}),o.persistence.yo(function(){return i.terminate()}),i.mf=o,[2]}})})}(e,new Yh)]);case 1:t.sent(),t.label=2;case 2:return[2,e.mf]}})})}function Ol(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.If?[3,2]:(Sr("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.fs.Af(),[4,Sl(r)];case 1:return e=t.sent(),Sr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.ff(function(t){return r.fs.bo(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).fs.Af(),Sr("RemoteStore","RemoteStore received new credentials"),n=ih(e),e.Fh.add(3),[4,Qc(e)];case 1:return t.sent(),n&&e.Mh.set("Unknown"),[4,e.Ch.s_(i)];case 2:return t.sent(),e.Fh.delete(3),[4,Yc(e)];case 3:return t.sent(),[2]}})})}(i.gl,t)})}),r.If=i,[2]}})})}(e,new Qh)]);case 1:t.sent(),t.label=2;case 2:return[2,e.If]}})})}function Dl(t){return Sl(t).then(function(t){return t.persistence})}function Ll(t){return Sl(t).then(function(t){return t.Sh})}function Cl(t){return Ol(t).then(function(t){return t.gl})}function Rl(t){return Ol(t).then(function(t){return t.fa})}function kl(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Ol(r)];case 1:return e=t.sent(),[2,((n=e.Vl).Gh=xh.bind(null,e.fa),n.Jh=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Sl.get(o),1<(r=e.Dl.get(n.targetId)).length?[2,(e.Dl.set(n.targetId,r.filter(function(t){return!rs(t,o)})),void e.Sl.delete(o))]:e.Ll?(e.pl.$a(n.targetId),e.pl.Ca(n.targetId)?[3,2]:[4,Wa(e.Sh,n.targetId,!1).then(function(){e.pl.Ba(n.targetId),Zc(e.gl,n.targetId),Gh(e,n.targetId)}).catch(Sa)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Gh(e,n.targetId),[4,Wa(e.Sh,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.fa),n)]}})})}function Pl(n,r,i){var t=this;void 0===i&&(i={});var o=new ca;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new ef({next:function(t){r.ys(function(){return gh(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new qr(jr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new qr(jr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new wh(Wo(i.path),t,{includeMetadataChanges:!0,sl:!0});return vh(n,u)},[4,kl(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.fs,r,i,o])]}})})}),o.promise}function Vl(n,r,i){var t=this;void 0===i&&(i={});var o=new ca;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new ef({next:function(t){n.ys(function(){return gh(e,s)}),t.fromCache&&"server"===r.source?i.reject(new qr(jr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new wh(t,o,{includeMetadataChanges:!0,sl:!0});return vh(e,s)},[4,kl(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.fs,r,i,o])]}})})}),o.promise}var xl,Ul=(Object.defineProperty(jl.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),jl.prototype.ys=function(t){this.enqueue(t)},jl.prototype.Tf=function(t){this.Sf(),this.Df(t)},jl.prototype.Ef=function(){var t;this.yf||(this.yf=!0,(t=kc())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf))},jl.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},jl.prototype.bo=function(t){var e=this;this.ys(function(){return e.Pf.push(t),e.Cf()})},jl.prototype.Cf=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Pf.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return t.sent(),this.Pf.shift(),this.zu.reset(),[3,4];case 3:if(!la(e=t.sent()))throw e;return Sr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Pf.length&&this.zu.Bu(function(){return n.Cf()}),t.label=5;case 5:return[2]}})})},jl.prototype.Df=function(t){var r=this,e=this.Rf.then(function(){return r.pf=!0,t().catch(function(t){throw r.Vf=t,r.pf=!1,Or("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.pf=!1,t})});return this.Rf=e},jl.prototype.Ir=function(t,e,n){var r=this;this.Sf(),-1<this.bf.indexOf(t)&&(e=0);n=pa.Is(this,t,e,n,function(t){return r.xf(t)});return this.gf.push(n),n},jl.prototype.Sf=function(){this.Vf&&Cr()},jl.prototype.Af=function(){},jl.prototype.Nf=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Rf];case 1:t.sent(),t.label=2;case 2:if(e!==this.Rf)return[3,0];t.label=3;case 3:return[2]}})})},jl.prototype.Ff=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].ds===t)return!0;return!1},jl.prototype.Of=function(r){var i=this;return this.Nf().then(function(){i.gf.sort(function(t,e){return t.ws-e.ws});for(var t=0,e=i.gf;t<e.length;t++){var n=e[t];if(n.Ps(),"all"!==r&&n.ds===r)break}return i.Nf()})},jl.prototype.kf=function(t){this.bf.push(t)},jl.prototype.xf=function(t){t=this.gf.indexOf(t);this.gf.splice(t,1)},jl),Ml=(f(Fl,xl=bf),Fl.prototype.b_=function(){return this.$f||Hl(this),this.$f.terminate()},Fl);function Fl(t,e){var n=this;return(n=xl.call(this,t,e)||this).Mf=new Ul,n.w_="name"in t?t.name:"[DEFAULT]",n}function jl(){var e=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.zu=new Fc(this,"async_queue_retry"),this.vf=function(){var t=kc();t&&Sr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.zu.Uu()};var t=kc();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.vf)}function ql(t){return t.$f||Hl(t),t.$f.df(),t.$f}function Hl(t){var e,n,r=t.p_(),r=(e=t.I_,n=t.w_,new Yr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.$f=new Tl(t.m_,t.Mf,r)}var Gl,o=(Wl.prototype.Lf=function(t,e){switch(void 0===e&&(e="none"),ji(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Pi(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(Vi(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.Wf(t.arrayValue,e);case 10:return this.jf(t.mapValue,e);default:throw Cr()}},Wl.prototype.jf=function(t,n){var r=this,i={};return Oi(t.fields||{},function(t,e){i[t]=r.Lf(e,n)}),i},Wl.prototype.Kf=function(t){return new kf(Pi(t.latitude),Pi(t.longitude))},Wl.prototype.Wf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Lf(t,e)})},Wl.prototype.qf=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return xi(e)?t(e):e}(t);return null==n?null:this.Lf(n,e);case"estimate":return this.Bf(Ui(t));default:return null}},Wl.prototype.Bf=function(t){t=ki(t);return new yi(t.seconds,t.nanos)},Wl.prototype.Gf=function(t,e){var n=gi.ct(t);Rr(aa(n));t=new Qr(n.get(1),n.get(3)),n=new bi(n.X(5));return t.isEqual(e)||Or("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},Wl),zl=(Object.defineProperty(Jl.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(Jl.prototype,"ref",{get:function(){return new _f(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),Jl.prototype.exists=function(){return null!==this.Jf},Jl.prototype.data=function(){if(this.Jf){if(this.v_){var t=new Bl(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.Lf(this.Jf.vt())}},Jl.prototype.get=function(t){if(this.Jf){t=this.Jf.data().field(Xl("DocumentSnapshot.get",t));if(null!==t)return this.Hf.Lf(t)}},Jl),Bl=(f(Kl,Gl=zl),Kl.prototype.data=function(){return Gl.prototype.data.call(this)},Kl);function Kl(){return null!==Gl&&Gl.apply(this,arguments)||this}function Jl(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}function Wl(){}function Xl(t,e){return"string"==typeof e?ml(t,e):(e instanceof Gr?e._:e).d_}function Yl(t){if(Yo(t)&&0===t.Nt.length)throw new qr(jr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}Te=function(){};function Ql(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){t=i[r].Yf(t)}return t}var $l,Zl,tp,ep,np,rp=(f(lp,np=Te),lp.prototype.Yf=function(t){var e=Bf(t.firestore),e=function(t,e,n,r,i,o){if(r.ht()){if("array-contains"===i||"array-contains-any"===i)throw new qr(jr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){yp(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(dp(n,t,c))}h={arrayValue:{values:s}}}else h=dp(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||yp(o,i),h=fl(e,"where",o,"in"===i||"not-in"===i);var h=mo.create(r,i,h);return function(t,e){if(e.xt()){var n=$o(t);if(null!==n&&!n.isEqual(e.field))throw new qr(jr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=Qo(t);null!==n&&vp(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new qr(jr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new qr(jr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.C_,e,t.firestore.I_,this.Xf,this.Zf,this.td);return new Ef(t.firestore,t.v_,(t=t.C_,e=t.filters.concat([e]),new Jo(t.path,t.collectionGroup,t.Nt.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},lp),ip=(f(fp,ep=Te),fp.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new qr(jr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new qr(jr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new zo(e,n);return e=r,null!==Qo(n=t)||null!==(t=$o(n))&&vp(0,t,e.field),r}(t.C_,this.Xf,this.ed);return new Ef(t.firestore,t.v_,(t=t.C_,e=t.Nt.concat([e]),new Jo(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},fp),op=(f(hp,tp=Te),hp.prototype.Yf=function(t){return new Ef(t.firestore,t.v_,ns(t.C_,this.nd,this.sd))},hp),sp=(f(cp,Zl=Te),cp.prototype.Yf=function(t){var e=pp(t,this.type,this.rd,this.od);return new Ef(t.firestore,t.v_,(t=t.C_,e=e,new Jo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},cp),up=(f(ap,$l=Te),ap.prototype.Yf=function(t){var e=pp(t,this.type,this.rd,this.od);return new Ef(t.firestore,t.v_,(t=t.C_,e=e,new Jo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},ap);function ap(t,e,n){var r=this;return(r=$l.call(this)||this).type=t,r.rd=e,r.od=n,r}function cp(t,e,n){var r=this;return(r=Zl.call(this)||this).type=t,r.rd=e,r.od=n,r}function hp(t,e,n){var r=this;return(r=tp.call(this)||this).type=t,r.nd=e,r.sd=n,r}function fp(t,e){var n=this;return(n=ep.call(this)||this).Xf=t,n.ed=e,n.type="orderBy",n}function lp(t,e,n){var r=this;return(r=np.call(this)||this).Xf=t,r.Zf=e,r.td=n,r.type="where",r}function pp(t,c,e,n){if(e[0]instanceof Gr&&(e[0]=e[0]._),e[0]instanceof zl)return function(t,e,n,r){if(!n)throw new qr(jr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=ts(t);o<s.length;o++){var u=s[o];if(u.field.ht())i.push(Ki(e,n.key));else{var a=n.field(u.field);if(xi(a))throw new qr(jr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.ot();throw new qr(jr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Mo(i,r)}(t.C_,t.firestore.I_,e[0].Jf,n);var r=Bf(t.firestore);return function(t,e,n,r,i,o){var s=t.Nt;if(i.length>s.length)throw new qr(jr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ht()){if("string"!=typeof c)throw new qr(jr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Zo(t)&&-1!==c.indexOf("/"))throw new qr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(gi.ct(c));if(!bi.Et(h))throw new qr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new bi(h);u.push(Ki(e,h))}else{c=fl(n,r,c);u.push(c)}}return new Mo(u,o)}(t.C_,t.firestore.I_,r,c,e,n)}function dp(t,e,n){if(n instanceof Gr&&(n=n._),"string"==typeof n){if(""===n)throw new qr(jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Zo(e)&&-1!==n.indexOf("/"))throw new qr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(gi.ct(n));if(!bi.Et(e))throw new qr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Ki(t,new bi(e))}if(n instanceof _f)return Ki(t,n.S_);throw new qr(jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+df(n)+".")}function yp(t,e){if(!Array.isArray(t)||0===t.length)throw new qr(jr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new qr(jr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function vp(t,e,n){if(!n.isEqual(e))throw new qr(jr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function gp(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}function mp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var wp,bp,_p,Ep=(f(Cp,_p=o),Cp.prototype.Uf=function(t){return new Hr(t)},Cp.prototype.Qf=function(t){t=this.Gf(t,this.firestore.I_);return new _f(this.firestore,null,t)},Cp),Tp=(Lp.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Lp),Ip=(f(Dp,bp=zl),Dp.prototype.exists=function(){return bp.prototype.exists.call(this)},Dp.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new Ap(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.Lf(this.Jf.vt(),t.serverTimestamps)}},Dp.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf){t=this.Jf.data().field(Xl("DocumentSnapshot.get",t));if(null!==t)return this.Hf.Lf(t,e.serverTimestamps)}},Dp),Ap=(f(Op,wp=Ip),Op.prototype.data=function(t){return void 0===t&&(t={}),wp.prototype.data.call(this,t)},Op),Np=(Object.defineProperty(Sp.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Sp.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Sp.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Sp.prototype.forEach=function(e,n){var r=this;this.ud.docs.forEach(function(t){e.call(n,new Ap(r.zf,r.Hf,t.key,t,new Tp(r.ud.Ce.has(t.key),r.ud.fromCache),r.query.v_))})},Sp.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.ud.Ne)throw new qr(jr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===t||(this.hd=function(i,e){if(i.ud.De.nt()){var n=0;return i.ud.docChanges.map(function(t){var e=new Ap(i.zf,i.Hf,t.doc.key,t.doc,new Tp(i.ud.Ce.has(t.doc.key),i.ud.fromCache),i.query.v_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.ud.De;return i.ud.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Ap(i.zf,i.Hf,t.doc.key,t.doc,new Tp(i.ud.Ce.has(t.doc.key),i.ud.fromCache),i.query.v_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Cr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.ld=t),this.hd},Sp);function Sp(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new Tp(r.hasPendingWrites,r.fromCache),this.query=n}function Op(){return null!==wp&&wp.apply(this,arguments)||this}function Dp(t,e,n,r,i,o){var s=this;return(s=bp.call(this,t,e,n,r,o)||this).zf=t,s.ad=t,s.metadata=i,s}function Lp(t,e){this.hasPendingWrites=t,this.fromCache=e}function Cp(t){var e=this;return(e=_p.call(this)||this).firestore=t,e}function Rp(t,e){return t instanceof Ip&&e instanceof Ip?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof Np&&e instanceof Np&&t.zf===e.zf&&Rf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var kp,Pp=(f(Vp,kp=o),Vp.prototype.Uf=function(t){return new Hr(t)},Vp.prototype.Qf=function(t){t=this.Gf(t,this.firestore.I_);return new _f(this.firestore,null,t)},Vp);function Vp(t){var e=this;return(e=kp.call(this)||this).firestore=t,e}function xp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=yf(t,_f);var o=yf(t.firestore,Ml),s=Bf(o);return e instanceof Gr&&(e=e._),Mp(o,[("string"==typeof e||e instanceof rf?hl(s,"updateDoc",t.S_,e,n,r):cl(s,"updateDoc",t.S_,e)).F_(t.S_,Rs.exists(!0))])}function Up(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof Gr&&(e=e._);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||gp(n[i])||(r=n[i],i++);var o,s,u,a,c,h,f={includeMetadataChanges:r.includeMetadataChanges};return gp(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof _f?(u=yf(e.firestore,Ml),a=Wo(e.S_.path),h={next:function(t){n[i]&&n[i](Fp(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=yf(e,Ef),u=yf(s.firestore,Ml),a=s.C_,c=new Pp(u),h={next:function(t){n[i]&&n[i](new Np(u,c,s,t))},error:n[i+1],complete:n[i+2]},Yl(e.C_)),function(n,t,e){var r=this,i=new ef(h),o=new wh(t,i,e);return n.fs.ys(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=vh,[4,kl(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.r_(),n.fs.ys(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=gh,[4,kl(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(ql(u),a,f)}function Mp(t,e){return function(n,r){var t=this,i=new ca;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Uh,[4,Rl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(ql(t),e)}function Fp(t,e,n){var r=n.docs.get(e.S_),i=new Pp(t);return new Ip(t,i,e.S_,r,new Tp(n.hasPendingWrites,n.fromCache),e.v_)}var jp=(qp.prototype.set=function(t,e,n){this.Ed();t=Hp(t,this.zf),e=mp(t.v_,e,n),n=Kf(this.wd,"WriteBatch.set",t.S_,e,null!==t.v_,n);return this.fd.push(n.F_(t.S_,Rs.Wt())),this},qp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Ed();t=Hp(t,this.zf);return e instanceof Gr&&(e=e._),e="string"==typeof e||e instanceof rf?hl(this.wd,"WriteBatch.update",t.S_,e,n,r):cl(this.wd,"WriteBatch.update",t.S_,e),this.fd.push(e.F_(t.S_,Rs.exists(!0))),this},qp.prototype.delete=function(t){this.Ed();t=Hp(t,this.zf);return this.fd=this.fd.concat(new $s(t.S_,Rs.Wt())),this},qp.prototype.commit=function(){return this.Ed(),this.dd=!0,0<this.fd.length?this._d(this.fd):Promise.resolve()},qp.prototype.Ed=function(){if(this.dd)throw new qr(jr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},qp);function qp(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=Bf(t)}function Hp(t,e){if(t instanceof Gr&&(t=t._),t.firestore!==e)throw new qr(jr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Gp,zp,Bp,Kp=(ed.prototype.get=function(t){var e=this,n=Hp(t,this.zf),r=new Ep(this.zf);return this.Td.ef([n.S_]).then(function(t){if(!t||1!==t.length)return Cr();t=t[0];if(t instanceof so)return new zl(e.zf,r,n.S_,null,n.v_);if(t instanceof oo)return new zl(e.zf,r,t.key,t,n.v_);throw Cr()})},ed.prototype.set=function(t,e,n){t=Hp(t,this.zf),e=mp(t.v_,e,n),n=Kf(this.wd,"Transaction.set",t.S_,e,null!==t.v_,n);return this.Td.set(t.S_,n),this},ed.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Hp(t,this.zf);return e instanceof Gr&&(e=e._),e="string"==typeof e||e instanceof rf?hl(this.wd,"Transaction.update",t.S_,e,n,r):cl(this.wd,"Transaction.update",t.S_,e),this.Td.update(t.S_,e),this},ed.prototype.delete=function(t){t=Hp(t,this.zf);return this.Td.delete(t.S_),this},f(td,Bp=ed),td.prototype.get=function(t){var e=this,n=Hp(t,this.zf),r=new Pp(this.zf);return Bp.prototype.get.call(this,t).then(function(t){return new Ip(e.zf,r,n.S_,t.Jf,new Tp(!1,!1),n.v_)})},td),Jp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Wp=(Zp.prototype.enableIndexedDbPersistence=function(t,e){throw new qr(jr.FAILED_PRECONDITION,Jp)},Zp.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new qr(jr.FAILED_PRECONDITION,Jp)},Zp.prototype.clearIndexedDbPersistence=function(t){throw new qr(jr.FAILED_PRECONDITION,Jp)},Zp),Xp=(f($p,zp=Gr),Object.defineProperty($p.prototype,"I_",{get:function(){return this._.I_},enumerable:!1,configurable:!0}),$p.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.V_()),t)).merge,this._.g_(t)},$p.prototype.useEmulator=function(t,e){var n,r;n=this._,r=t,t=e,"firestore.googleapis.com"!==(e=(n=yf(n,bf)).V_()).host&&e.host!==r&&Dr("Host has been set in both settings() and useEmulator(), emulator host will be used"),n.g_(Object.assign(Object.assign({},e),{host:r+":"+t,ssl:!1}))},$p.prototype.enableNetwork=function(){return function(r){var t=this;return r.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Dl(r)];case 1:return e=t.sent(),[4,Cl(r)];case 2:return n=t.sent(),[2,(e.Vo(!0),(t=n).Fh.delete(0),Yc(t))]}})})})}(ql(yf(this._,Ml)))},$p.prototype.disableNetwork=function(){return function(r){var t=this;return r.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Dl(r)];case 1:return e=t.sent(),[4,Cl(r)];case 2:return n=t.sent(),[2,(e.Vo(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Fh.add(0),[4,Qc(e)];case 1:return t.sent(),e.Mh.set("Offline"),[2]}})})}(n))]}})})})}(ql(yf(this._,Ml)))},$p.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&ff("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},$p.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},$p.prototype.terminate=function(){return this.md&&(this.md._removeServiceInstance("firestore"),this.md._removeServiceInstance("firestore-exp")),this._._delete()},$p.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new ca;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=jh,[4,Rl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(ql(yf(this._,Ml)))},$p.prototype.onSnapshotsInSync=function(t){return e=this._,t=t,function(n,t){var e=this,r=new ef(t);return n.fs.ys(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.jh.add(e),e.next()},[4,kl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.r_(),n.fs.ys(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.jh.delete(e)},[4,kl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(ql(yf(e,Ml)),gp(t)?t:{next:t});var e},Object.defineProperty($p.prototype,"app",{get:function(){if(!this.md)throw new qr(jr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),$p.prototype.collection=function(t){try{return new Od(this,Df(this._,t))}catch(t){throw dd(t,"collection()","Firestore.collection()")}},$p.prototype.doc=function(t){try{return new ld(this,Lf(this._,t))}catch(t){throw dd(t,"doc()","Firestore.doc()")}},$p.prototype.collectionGroup=function(t){try{return new Ad(this,function(t,e){if(t=yf(t,bf),cf("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new qr(jr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Ef(t,null,(e=e,new Jo(gi.at(),e)))}(this._,t))}catch(t){throw dd(t,"collectionGroup()","Firestore.collectionGroup()")}},$p.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new ca;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Ol(n).then(function(t){return t.Dh})];case 1:return e=t.sent(),new El(n.fs,e,r,i).run(),[2]}})})}),i.promise}(ql(n=this._),function(t){return t=new Kp(n,t),e(new od(r,t))})},$p.prototype.batch=function(){var e=this;return ql(this._),new sd(new jp(this._,function(t){return Mp(e._,t)}))},$p.prototype.loadBundle=function(t){throw new qr(jr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},$p.prototype.namedQuery=function(t){throw new qr(jr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},$p),Yp=(f(Qp,Gp=o),Qp.prototype.Uf=function(t){return new Xr(new Hr(t))},Qp.prototype.Qf=function(t){t=this.Gf(t,this.firestore.I_);return ld.Ad(t,this.firestore,null)},Qp);function Qp(t){var e=this;return(e=Gp.call(this)||this).firestore=t,e}function $p(t,e,n){var r=this;return(r=zp.call(this,e)||this).Id=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Qr||(r.md=t),r}function Zp(){}function td(t,e){var n=this;return(n=Bp.call(this,t,e)||this).zf=t,n}function ed(t,e){this.zf=t,this.Td=e,this.wd=Bf(t)}var nd,rd,id,od=(f(hd,id=Gr),hd.prototype.get=function(t){var e=this,n=Vd(t);return this._.get(n).then(function(t){return new Td(e.zf,new Ip(e.zf._,e.Hf,t.S_,t.Jf,t.metadata,n.v_))})},hd.prototype.set=function(t,e,n){t=Vd(t);return n?(hf("Transaction.set",n),this._.set(t,e,n)):this._.set(t,e),this},hd.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Vd(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,l([o,e,n],r)),this},hd.prototype.delete=function(t){t=Vd(t);return this._.delete(t),this},hd),sd=(f(cd,rd=Gr),cd.prototype.set=function(t,e,n){t=Vd(t);return n?(hf("WriteBatch.set",n),this._.set(t,e,n)):this._.set(t,e),this},cd.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Vd(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,l([o,e,n],r)),this},cd.prototype.delete=function(t){t=Vd(t);return this._.delete(t),this},cd.prototype.commit=function(){return this._.commit()},cd),ud=(f(ad,nd=Gr),ad.prototype.fromFirestore=function(t,e){t=new Ap(this.zf._,this.Hf,t.S_,t.Jf,t.metadata,null);return this._.fromFirestore(new Id(this.zf,t),null!=e?e:{})},ad.prototype.toFirestore=function(t,e){return e?this._.toFirestore(t,e):this._.toFirestore(t)},ad.Rd=function(t,e){var n=ad.Pd,r=n.get(t);r||(r=new WeakMap,n.set(t,r));n=r.get(e);return n||(n=new ad(t,new Yp(t),e),r.set(e,n)),n},ad);function ad(t,e,n){var r=this;return(r=nd.call(this,n)||this).zf=t,r.Hf=e,r}function cd(){return null!==rd&&rd.apply(this,arguments)||this}function hd(t,e){var n=this;return(n=id.call(this,e)||this).zf=t,n.Hf=new Yp(t),n}ud.Pd=new WeakMap;var fd,ld=(f(pd,fd=Gr),pd.yd=function(t,e,n){if(t.length%2!=0)throw new qr(jr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.ot()+" has "+t.length);return new pd(e,new _f(e._,n,new bi(t)))},pd.Ad=function(t,e,n){return new pd(e,new _f(e._,n,t))},Object.defineProperty(pd.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"parent",{get:function(){return new Od(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),pd.prototype.collection=function(t){try{return new Od(this.firestore,Df(this._,t))}catch(t){throw dd(t,"collection()","DocumentReference.collection()")}},pd.prototype.isEqual=function(t){return t instanceof Gr&&(t=t._),t instanceof _f&&Cf(this._,t)},pd.prototype.set=function(t,e){e=hf("DocumentReference.set",e);try{return function(t,e,n){t=yf(t,_f);var r=yf(t.firestore,Ml),e=mp(t.v_,e,n);return Mp(r,[Kf(Bf(r),"setDoc",t.S_,e,null!==t.v_,n).F_(t.S_,Rs.Wt())])}(this._,t,e)}catch(t){throw dd(t,"setDoc()","DocumentReference.set()")}},pd.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?xp(this._,t):xp.apply(void 0,l([this._,t,e],n))}catch(t){throw dd(t,"updateDoc()","DocumentReference.update()")}},pd.prototype.delete=function(){return Mp(yf((t=this._).firestore,Ml),[new $s(t.S_,Rs.Wt())]);var t},pd.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=yd(t),i=vd(t,function(t){return new Td(e.firestore,new Ip(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))});return Up(this._,r,i)},pd.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=yf(e,_f);var n=yf(e.firestore,Ml),t=ql(n),r=new Pp(n);return function(n,r){var t=this,i=new ca;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(o,s,u){return y(this,void 0,void 0,function(){var r,i;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=s,(n=o).persistence.runTransaction("read document","readonly",function(t){return n.Ic.Jo(t,e)}))];case 1:return(i=t.sent())instanceof oo?u.resolve(i):i instanceof so?u.resolve(null):u.reject(new qr(jr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),i=ya(r,"Failed to get document '"+s+" from cache"),u.reject(i),[3,3];case 3:return[2]}var e,n})})},[4,Ll(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.S_).then(function(t){return new Ip(n,r,e.S_,t,new Tp(t instanceof oo&&t.bt,!0),e.v_)})}:"server"===(null==t?void 0:t.source)?function(e){e=yf(e,_f);var n=yf(e.firestore,Ml);return Pl(ql(n),e.S_,{source:"server"}).then(function(t){return Fp(n,e,t)})}:function(e){e=yf(e,_f);var n=yf(e.firestore,Ml);return Pl(ql(n),e.S_).then(function(t){return Fp(n,e,t)})})(this._).then(function(t){return new Td(e.firestore,new Ip(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))})},pd.prototype.withConverter=function(t){return new pd(this.firestore,this._.withConverter(ud.Rd(this.firestore,t)))},pd);function pd(t,e){var n=this;return(n=fd.call(this,e)||this).firestore=t,n.Hf=new Yp(t),n}function dd(t,e,n){return t.message=t.message.replace(e,n),t}function yd(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!gp(r))return r}return{}}function vd(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=gp(t[0])?t[0]:gp(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var gd,md,wd,bd,_d,Ed,Td=(f(Pd,Ed=Gr),Object.defineProperty(Pd.prototype,"ref",{get:function(){return new ld(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Pd.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Pd.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Pd.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),Pd.prototype.data=function(t){return this._.data(t)},Pd.prototype.get=function(t,e){return this._.get(t,e)},Pd.prototype.isEqual=function(t){return Rp(this._,t._)},Pd),Id=(f(kd,_d=Td),kd.prototype.data=function(t){return this._.data(t)},kd),Ad=(f(Rd,bd=Gr),Rd.prototype.where=function(t,e,n){try{return new Rd(this.firestore,Ql(this._,(r=n,i=e,o=Xl("where",t),new rp(o,i,r))))}catch(t){throw dd(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},Rd.prototype.orderBy=function(n,t){try{return new Rd(this.firestore,Ql(this._,function(t){void 0===t&&(t="asc");var e=t,t=Xl("orderBy",n);return new ip(t,e)}(t)))}catch(n){throw dd(n,/(orderBy|where)\(\)/,"Query.$1()")}},Rd.prototype.limit=function(t){try{return new Rd(this.firestore,Ql(this._,(vf("limit",e=t),new op("limit",e,"F"))))}catch(t){throw dd(t,"limit()","Query.limit()")}var e},Rd.prototype.limitToLast=function(t){try{return new Rd(this.firestore,Ql(this._,(vf("limitToLast",e=t),new op("limitToLast",e,"L"))))}catch(t){throw dd(t,"limitToLast()","Query.limitToLast()")}var e},Rd.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Rd(this.firestore,Ql(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new sp("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw dd(t,"startAt()","Query.startAt()")}},Rd.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Rd(this.firestore,Ql(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new sp("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw dd(t,"startAfter()","Query.startAfter()")}},Rd.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Rd(this.firestore,Ql(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new up("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw dd(t,"endBefore()","Query.endBefore()")}},Rd.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Rd(this.firestore,Ql(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new up("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw dd(t,"endAt()","Query.endAt()")}},Rd.prototype.isEqual=function(t){return Rf(this._,t._)},Rd.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=yf(e,Ef);var n=yf(e.firestore,Ml),t=ql(n),r=new Pp(n);return function(n,r){var t=this,i=new ca;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Xa(i,o,!0)];case 1:return r=t.sent(),e=new Lh(o,r.Pc),n=e.dl(r.documents),n=e.Ei(n,!1),s.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),r=ya(n,"Failed to execute query '"+o+" against cache"),s.reject(r),[3,3];case 3:return[2]}})})},[4,Ll(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.C_).then(function(t){return new Np(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=yf(e,Ef);var n=yf(e.firestore,Ml),t=ql(n),r=new Pp(n);return Vl(t,e.C_,{source:"server"}).then(function(t){return new Np(n,r,e,t)})}:function(e){e=yf(e,Ef);var n=yf(e.firestore,Ml),t=ql(n),r=new Pp(n);return Yl(e.C_),Vl(t,e.C_).then(function(t){return new Np(n,r,e,t)})})(this._).then(function(t){return new Sd(e.firestore,new Np(e.firestore._,e.Hf,e._,t.ud))})},Rd.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=yd(t),i=vd(t,function(t){return new Sd(e.firestore,new Np(e.firestore._,e.Hf,e._,t.ud))});return Up(this._,r,i)},Rd.prototype.withConverter=function(t){return new Rd(this.firestore,this._.withConverter(ud.Rd(this.firestore,t)))},Rd),Nd=(f(Cd,wd=Gr),Object.defineProperty(Cd.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(Cd.prototype,"doc",{get:function(){return new Id(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(Cd.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(Cd.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),Cd),Sd=(f(Ld,md=Gr),Object.defineProperty(Ld.prototype,"query",{get:function(){return new Ad(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"docs",{get:function(){var e=this;return this._.docs.map(function(t){return new Id(e.zf,t)})},enumerable:!1,configurable:!0}),Ld.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new Nd(e.zf,t)})},Ld.prototype.forEach=function(e,n){var r=this;this._.forEach(function(t){e.call(n,new Id(r.zf,t))})},Ld.prototype.isEqual=function(t){return Rp(this._,t._)},Ld),Od=(f(Dd,gd=Ad),Object.defineProperty(Dd.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Dd.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(Dd.prototype,"parent",{get:function(){var t=this._.parent;return t?new ld(this.firestore,t):null},enumerable:!1,configurable:!0}),Dd.prototype.doc=function(t){try{return new ld(this.firestore,void 0===t?Lf(this._):Lf(this._,t))}catch(t){throw dd(t,"doc()","CollectionReference.doc()")}},Dd.prototype.add=function(t){var e,n,r,i=this;return e=this._,n=t,t=yf(e.firestore,Ml),r=Lf(e),n=mp(e.v_,n),Mp(t,[Kf(Bf(e.firestore),"addDoc",r.S_,n,null!==e.v_,{}).F_(r.S_,Rs.exists(!1))]).then(function(){return r}).then(function(t){return new ld(i.firestore,t)})},Dd.prototype.isEqual=function(t){return Cf(this._,t._)},Dd.prototype.withConverter=function(t){return new Dd(this.firestore,this._.withConverter(ud.Rd(this.firestore,t)))},Dd);function Dd(t,e){var n=this;return(n=gd.call(this,t,e)||this).firestore=t,n._=e,n}function Ld(t,e){var n=this;return(n=md.call(this,e)||this).zf=t,n}function Cd(t,e){var n=this;return(n=wd.call(this,e)||this).zf=t,n}function Rd(t,e){var n=this;return(n=bd.call(this,e)||this).firestore=t,n.Hf=new Yp(t),n}function kd(){return null!==_d&&_d.apply(this,arguments)||this}function Pd(t,e){var n=this;return(n=Ed.call(this,e)||this).zf=t,n}function Vd(t){return t instanceof Gr&&(t=t._),yf(t,_f)}var xd,Ud,Te=(f(qd,Ud=Gr),qd.documentId=function(){return new qd(wi.lt().ot())},qd.prototype.isEqual=function(t){return t instanceof Gr&&(t=t._),t instanceof rf&&this._.d_.isEqual(t.d_)},qd),o=(f(jd,xd=Gr),jd.serverTimestamp=function(){var t=new el("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new jd(t)},jd.delete=function(){var t=new Wf("deleteField");return t._methodName="FieldValue.delete",new jd(t)},jd.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new nl("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new jd(n)},jd.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new rl("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new jd(n)},jd.increment=function(t){t=new il("increment",t);return t._methodName="FieldValue.increment",new jd(t)},jd.prototype.isEqual=function(t){return this._.isEqual(t._)},jd),Md=(Fd.prototype.onProgress=function(t,e,n){this.gd={next:t,error:e,complete:n}},Fd.prototype.catch=function(t){return this.Vd.promise.catch(t)},Fd.prototype.then=function(t,e){return this.Vd.promise.then(t,e)},Fd.prototype.Ul=function(t){this.Ql(t),this.gd.complete&&this.gd.complete(),this.Vd.resolve(t)},Fd.prototype.Wl=function(t){this.pd.taskState="Error",this.gd.next&&this.gd.next(this.pd),this.gd.error&&this.gd.error(t),this.Vd.reject(t)},Fd.prototype.Ql=function(t){this.pd=t,this.gd.next&&this.gd.next(t)},Fd);function Fd(){this.gd={},this.Vd=new ca,this.pd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function jd(){return null!==xd&&xd.apply(this,arguments)||this}function qd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Ud.call(this,new(rf.bind.apply(rf,l([void 0],t))))||this}function Hd(t,s){var e=new Md;return function(n,t,r){var e,i=this,o=(e=s,t=Pc(t),e=function(t){if(t instanceof Uint8Array)return tf(t,void 0);if(t instanceof ArrayBuffer)return tf(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),new nf(e,t));n.fs.ys(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Xh,[4,Rl(n)];case 1:return e.apply(void 0,[t.sent(),o,r]),[2]}})})})}(ql(t._),t.I_,e),e}var Gd=(zd.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},zd.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},zd.prototype.setServiceProps=function(t){return this.serviceProps=t,this},zd);function zd(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Bd,Kd,Jd={Firestore:Xp,GeoPoint:kf,Timestamp:yi,Blob:Xr,Transaction:od,WriteBatch:sd,DocumentReference:ld,DocumentSnapshot:Td,Query:Ad,QueryDocumentSnapshot:Id,QuerySnapshot:Sd,CollectionReference:Od,FieldPath:Te,FieldValue:o,setLogLevel:function(t){Ar.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(Bd=e.default).INTERNAL.registerComponent(new Gd("firestore",function(t){var e=t.getProvider("app").getImmediate();return e=e,t=t.getProvider("auth-internal"),new Xp(e,new Ml(e,t),new Wp)},"PUBLIC").setServiceProps(Object.assign({},Jd))),Bd.registerVersion("@firebase/firestore","2.1.4-2021026232412"),(Kd=Xp).prototype.loadBundle=function(t){return Hd(this,t)},Kd.prototype.namedQuery=function(t){return t=t,function(n,r){var t=this;return n.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.Eo.Ls(t,e)})},[4,Ll(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(ql((e=this)._),t).then(function(t){return t?new Ad(e,new Ef(e._,null,t.query)):null});var e}}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
