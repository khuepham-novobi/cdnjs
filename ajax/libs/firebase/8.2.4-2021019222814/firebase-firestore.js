!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Ag){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var l,e=t(Ag);function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(_e=l=l||{})[_e.DEBUG=0]="DEBUG",_e[_e.VERBOSE=1]="VERBOSE",_e[_e.INFO=2]="INFO",_e[_e.WARN=3]="WARN",_e[_e.ERROR=4]="ERROR",_e[_e.SILENT=5]="SILENT";function n(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=u[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var r={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},i=l.INFO,u=((Ee={})[l.DEBUG]="log",Ee[l.VERBOSE]="log",Ee[l.INFO]="info",Ee[l.WARN]="warn",Ee[l.ERROR]="error",Ee),o=(Object.defineProperty(a.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),a.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?r[t]:t},Object.defineProperty(a.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),a.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},a.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},a.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},a.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},a.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},a);function a(t){this.name=t,this._logLevel=i,this._logHandler=n,this._userLogHandler=null}var c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function h(t,e){function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function f(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(h(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(I.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(_,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},I);function I(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var _=/\{\$([^}]+)}/g,E=function(t,e){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,S="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},A={},x=S||self;function D(){}function k(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function O(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var L="closure_uid_"+(1e9*Math.random()>>>0),P=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function R(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:R).apply(null,arguments)}function M(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function U(){return Date.now()}function F(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,L)&&t[L]||(t[L]=++P))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},H=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(){return Array.prototype.concat.apply([],arguments)}function G(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var K,J=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function W(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var Y=x.navigator;if(Y){Y=Y.userAgent;if(Y){K=Y;break t}}K=""}function Q(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e,n={};for(e in t)n[e]=t[e];return n}var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=D;var nt,rt=W(K,"Opera"),it=W(K,"Trident")||W(K,"MSIE"),ot=W(K,"Edge"),st=ot||it,ut=W(K,"Gecko")&&!(W(K.toLowerCase(),"webkit")&&!W(K,"Edge"))&&!(W(K,"Trident")||W(K,"MSIE"))&&!W(K,"Edge"),at=W(K.toLowerCase(),"webkit")&&!W(K,"Edge");function ct(){var t=x.document;return t?t.documentMode:void 0}t:{var ht="",ft=(ft=K,ut?/rv:([^\);]+)(\)|;)/.exec(ft):ot?/Edge\/([\d\.]+)/.exec(ft):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):at?/WebKit\/(\S+)/.exec(ft):rt?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(ht=ft?ft[1]:""),it){ft=ct();if(null!=ft&&ft>parseFloat(ht)){nt=String(ft);break t}}nt=ht}var lt={};function pt(u){return t=u,e=function(){for(var t=0,e=J(String(nt)).split("."),n=J(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=lt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var dt=x.document&&it?ct()||(parseInt(nt,10)||void 0):void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!x.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{x.addEventListener("test",D,e),x.removeEventListener("test",D,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},F(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var It="closure_listenable_"+(1e6*Math.random()|0),_t=0;function Et(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++_t,this.Y=this.Z=!1}function Tt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Nt(t){this.src=t,this.a={},this.b=0}function St(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=q(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Tt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function At(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Nt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=At(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Et(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var xt="closure_lm_"+(1e6*Math.random()|0),Dt={};function kt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Ut(r);return e&&e[It]?e.wa(n,r,O(i)?!!i.capture:!!i,o):Ot(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)kt(t,e[o],n,r,i);return null}return n=Ut(n),t&&t[It]?t.va(e,n,O(r)?!!r.capture:!!r,i):Ot(t,e,n,!1,r,i)}function Ot(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=O(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,c=Vt(t);if(c||(t[xt]=c=new Nt(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Rt,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Pt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Lt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[It]?St(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Pt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Vt(e))?(St(n,t),0==n.b&&(n.src=null,e[xt]=null)):Tt(t)))}function Pt(t){return t in Dt?Dt[t]:Dt[t]="on"+t}function Ct(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Lt(t),n.call(r,e)}function Rt(t,e){if(t.Y)return!0;if(yt)return Ct(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=x,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ct(t,e=new wt(e,this))}function Vt(t){return(t=t[xt])instanceof Nt?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ut(e){return"function"==typeof e?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function Ft(){j.call(this),this.c=new Nt(this),(this.J=this).C=null}function jt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new mt(e,t):e instanceof mt?e.target=e.target||t:(s=e,tt(e=new mt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=qt(o,r,!0,e)&&s;if(s=qt(o=e.a=t,r,!0,e)&&s,s=qt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=qt(o=e.a=n[i],r,!1,e)&&s}function qt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&St(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}F(Ft,j),Ft.prototype[It]=!0,(N=Ft.prototype).addEventListener=function(t,e,n,r){kt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=O(i)?!!i.capture:!!i,r=Ut(r),e&&e[It]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=At(s=e.a[n],r,i,o))&&(Tt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Vt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=At(n,r,i,o)),(r=-1<e?n[e]:null)&&Lt(r))}(this,t,e,n,r)},N.G=function(){if(Ft.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Tt(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ht=x.JSON.stringify;function Bt(){this.b=this.a=null}var Gt,zt=(Kt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Kt(function(){return new Jt},function(t){t.reset()}));function Kt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Jt(){this.next=this.b=this.a=null}function Wt(t,e){var n;Gt||(n=x.Promise.resolve(void 0),Gt=function(){n.then(Qt)}),Xt||(Gt(),Xt=!0),Yt.add(t,e)}Bt.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Jt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Jt.prototype.reset=function(){this.next=this.b=this.a=null}),Yt=new Bt;function Qt(){for(var t,e;n=e=void 0,n=null,(e=Yt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){x.setTimeout(function(){throw t},0)}(t)}var n=zt;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function $t(t,e){Ft.call(this),this.b=t||1,this.a=e||x,this.f=V(this.Za,this),this.g=U()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==typeof t)n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:x.setTimeout(t,e||0)}F($t,Ft),(N=$t.prototype).aa=!1,N.M=null,N.Za=function(){var t;this.aa&&(0<(t=U()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),jt(this,"tick"),this.aa&&(Zt(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=U())},N.G=function(){$t.X.G.call(this),Zt(this),delete this.a};var ee,ne,re,ie=(E(ne=se,re=ee=j),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(x.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e){var n=ee.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ue(t){j.call(this),this.b=t,this.a={}}F(ue,j);var ae=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=kt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){Q(t.a,function(t,e){this.a.hasOwnProperty(e)&&Lt(t)},t),t.a={}}function fe(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Ht(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.X.G.call(this),he(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fe.prototype.info=function(){};var pe={},de=null;function ye(){return de=de||new Ft}function ve(t){mt.call(this,pe.Fa,t)}function ge(t){var e=ye();jt(e,new ve(e))}function me(t,e){mt.call(this,pe.STAT_EVENT,t),this.stat=e}function we(t){var e=ye();jt(e,new me(e,t))}function be(t){mt.call(this,pe.Ga,t)}function Ie(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return x.setTimeout(function(){t()},e)}pe.Fa="serverreachability",F(ve,mt),pe.STAT_EVENT="statevent",F(me,mt),pe.Ga="timingevent",F(be,mt);var _e={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Ee={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Te(){}function Ne(t){var e;return(e=t.a)||(e=t.a={}),e}function Se(){}Te.prototype.a=null;var Ae,S={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function xe(){mt.call(this,"d")}function De(){mt.call(this,"c")}function ke(){}function Oe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ue(this),this.P=Le,t=st?125:void 0,this.R=new $t(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}F(xe,mt),F(De,mt),F(ke,Te),Ae=new ke;var Le=45e3,Pe={},Ce={};function Re(t,e,n){t.H=1,t.i=nn(Ye(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=U(),Ue(t),t.l=Ye(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=cr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(V(t.Ca,t,t.a),t.O)),ce(t.J,t.a,"readystatechange",t.Xa),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Me(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Ce:(i=Number(u.substring(i,o)),isNaN(i)?Pe:(o+=1)+i>u.length?Ce:(u=u.substr(o,i),r.D=o+i,u)));if(u==Ce){4==e&&(t.h=4,we(14),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==Pe){t.h=4,we(15),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),Be(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(le(t.c,t.f,n,"[Invalid Chunked Response]"),He(t),qe(t))}function Ue(t){t.T=U()+t.P,Fe(t,t.P)}function Fe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ie(V(t.Va,t),e)}function je(t){t.o&&(x.clearTimeout(t.o),t.o=null)}function qe(t){0==t.g.v||t.A||ir(t.g,t)}function He(t){je(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Be(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||En(u.b,t)))if(u.I=t.N,!t.C&&En(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Kn(u)}tr(u),we(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=Ie(V(u.Sa,u),6e3));if(_n(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!z(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(W(r,"spdy")||W(r,"quic")||W(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Tn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=U()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(Nn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(je(o),Ue(o)),n.a=i):Zn(n),0<u.g.length&&Xn(u)):"stop"!=c[0]&&"close"!=c[0]||sr(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?sr(u,7):zn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ge(4)}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)H(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ze)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ke(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Je(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Je(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Je(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Oe.prototype).setTimeout=function(t){this.P=t},N.Xa=function(t){t=t.target;var e=this.F;e&&3==qn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=qn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),je(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),He(this),qe(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Be(this,s)}this.I?(Me(this,e,n),st&&this.b&&3==e&&(ce(this.J,this.R,"tick",this.Wa),this.R.start())):(le(this.c,this.f,n,null),Be(this,n)),4==e&&He(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,Ue(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),He(this),qe(this)}}}catch(t){}var u,a,c,h,f,l},N.Wa=function(){var t,e;this.a&&(t=qn(this.a),e=this.a.$(),this.D<e.length&&(je(this),Me(this,t,e),this.b&&4!=t&&Ue(this)))},N.cancel=function(){this.A=!0,He(this)},N.Va=function(){this.o=null;var t,e,n=U();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),He(this),this.h=2,qe(this)):Fe(this,this.T-n)},(N=ze.prototype).K=function(){Ke(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return Ke(this),this.a.concat()},N.get=function(t,e){return Je(this.b,t)?this.b[t]:e},N.set=function(t,e){Je(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var We=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Xe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Xe?(this.a=void 0!==e?e:t.a,Qe(this,t.f),this.j=t.j,$e(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new ze(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(We))?(this.a=!!e,Qe(this,n[1]||"",!0),this.j=rn(n[2]||""),$e(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Ye(t){return new Xe(t)}function Qe(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,hn)),t.b=new ln(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Xe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?cn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,fn)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,cn=/[#\?]/g,hn=/[#\?@]/g,fn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new ze,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),Je(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Je((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ke(t)))}function yn(t,e){return pn(t),e=gn(t,e),Je(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),G(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(N=ln.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){H(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=B(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},N.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=function(t,e){this.b=t,this.a=e};function wn(t){this.g=t||bn,t=x.PerformanceNavigationTiming?0<(t=x.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(x.ia&&x.ia.ya&&x.ia.ya()&&x.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var bn=10;function In(t){return t.b||t.a&&t.a.size>=t.f}function _n(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function Nn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Sn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return G(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function An(){}function xn(){this.a=new An}function Dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=Sn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},An.prototype.stringify=function(t){return x.JSON.stringify(t,void 0)},An.prototype.parse=function(t){return x.JSON.parse(t,void 0)};var kn=x.JSON.parse;function On(t){Ft.call(this),this.headers=new ze,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Ln,this.D=this.F=!1}F(On,Ft);var Ln="",Pn=/^https?$/i,Cn=["POST","PUT"];function Rn(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Mn(t),Fn(t)}function Mn(t){t.u||(t.u=!0,jt(t,"complete"),jt(t,"error"))}function Un(t){if(t.b&&void 0!==A&&(!t.s[1]||4!=qn(t)||2!=t.W()))if(t.l&&4==qn(t))te(t.za,0,t);else if(jt(t,"readystatechange"),4==qn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}(e=s)||((n=0===o)&&(!(i=String(t.B).match(We)[1]||null)&&x.self&&x.self.location&&(i=(r=x.self.location.protocol).substr(0,r.length-1)),n=!Pn.test(i?i.toLowerCase():"")),e=n);if(e)jt(t,"complete"),jt(t,"success");else{t.h=6;try{var u=2<qn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Mn(t)}}finally{Fn(t)}}}function Fn(t,e){if(t.a){jn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||jt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function jn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(x.clearTimeout(t.m),t.m=null)}function qn(t){return t.a?t.a.readyState:0}function Hn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Q(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function Bn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.pa=0,this.g=[],this.c=new fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Bn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Bn("baseRetryDelayMs",5e3,t),this.Ra=Bn("retryDelaySeedMs",1e4,t),this.Ma=Bn("forwardChannelMaxRetries",2,t),this.ma=Bn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new xn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function zn(t){var e,n;Jn(t),3==t.v&&(e=t.R++,en(n=Ye(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Qn(t,n),(e=new Oe(t,t.c,e,void 0)).H=2,e.i=nn(Ye(n)),n=!1,x.navigator&&x.navigator.sendBeacon&&(n=x.navigator.sendBeacon(e.i.toString(),"")),!n&&x.Image&&((new Image).src=e.i,n=!0),n||(e.a=cr(e.g,null),e.a.ba(e.i)),e.u=U(),Ue(e)),ur(t)}function Kn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Jn(t){Kn(t),t.j&&(x.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&x.clearTimeout(t.h),t.h=null)}function Wn(t,e){t.g.push(new mn(t.Oa++,e)),3==t.v&&Xn(t)}function Xn(t){In(t.b)||t.h||(t.h=!0,Wt(t.Ba,t),t.u=0)}function Yn(t,e){var n=e?e.f:t.R++,r=Ye(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Qn(t,r),t.i&&t.l&&Hn(r,t.i,t.l),n=new Oe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=$n(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Tn(t.b,n),Re(n,r,e)}function Qn(t,n){t.f&&Ge({},function(t,e){en(n,e,t)})}function $n(t,e,n){n=Math.min(t.g.length,n);var r=t.f?V(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{Ge(t,function(t,e){var n=t;O(t)&&(n=Ht(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.T=1,Wt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=Ie(V(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(x.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new Oe(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ye(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Qn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Hn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Ye(e)),n.j=null,n.I=!0,Ve(n,t)}function rr(t){null!=t.m&&(x.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!En(t.b,e))return;r=e.s,Nn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=U()-e.u,n=t.u,jt(i=ye(),new be(i)),Xn(t)):Zn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(_n(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)))return t.h=Ie(V(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=V(t.Ya,t),r||(r=new Xe("//www.google.com/images/cleardot.gif"),x.location&&"http"==x.location.protocol||Qe(r,"https"),nn(r)),n=r.toString(),r=o,o=new fe,x.Image?((i=new Image).onload=M(Dn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=M(Dn,o,i,"TestLoadImage: error",!1,r),i.onabort=M(Dn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=M(Dn,o,i,"TestLoadImage: timeout",!1,r),x.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Jn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==Sn(t.b).length&&0==t.g.length||(t.b.c.length=0,G(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Xe?Ye(s):new Xe(s,void 0);return""!=a.c?(e&&$e(a,e+"."+a.c),Ze(a,a.h)):(u=x.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Xe(null,void 0),r&&Qe(u,r),i&&$e(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.V&&Q(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Qn(t,a),a}function cr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.Na)).F=t.C,e}function hr(){}function fr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function lr(t,e){Ft.call(this),this.a=new Gn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new yr(this)}function pr(t){xe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){De.call(this),this.status=1}function yr(t){this.a=t}(N=On.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ne(this.H):Ne(Ae),this.a.onreadystatechange=V(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new ze(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Rn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=x.FormData&&t instanceof x.FormData,0<=q(Cn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{jn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},N.xa=function(){void 0!==A&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,jt(this,"timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,jt(this,"complete"),jt(this,"abort"),Fn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Fn(this,!0)),On.X.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Un(this):this.Ua())},N.Ua=function(){Un(this)},N.W=function(){try{return 2<qn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),kn(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Gn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Oe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=$n(this,n,e),en(i=Ye(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Qn(this,i),this.i&&r&&Hn(i,this.i,r),Tn(this.b,n),this.Ia&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Re(n,i,null)):Re(n,i,e),this.v=2}}else 3==this.v&&(t?Yn(this,t):0==this.g.length||In(this.b)||Yn(this))},N.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ie(V(this.Ta,this),t))},N.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Kn(this),nr(this))},N.Sa=function(){null!=this.m&&(this.m=null,Kn(this),tr(this),we(19))},N.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(N=hr.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ja=function(){},fr.prototype.a=function(t,e){return new lr(t,e)},F(lr,Ft),lr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Xn(t)},lr.prototype.close=function(){zn(this.a)},lr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Wn(this.a,e)):this.l?((e={}).__data__=Ht(t),Wn(this.a,e)):Wn(this.a,t)},lr.prototype.G=function(){this.a.f=null,delete this.f,zn(this.a),delete this.a,lr.X.G.call(this)},F(pr,xe),F(dr,De),F(yr,hr),yr.prototype.ta=function(){jt(this.a,"a")},yr.prototype.sa=function(t){jt(this.a,new pr(t))},yr.prototype.ra=function(t){jt(this.a,new dr)},yr.prototype.qa=function(){jt(this.a,"b")},fr.prototype.createWebChannel=fr.prototype.a,lr.prototype.send=lr.prototype.h,lr.prototype.open=lr.prototype.g,_e.NO_ERROR=0,_e.TIMEOUT=8,_e.HTTP_ERROR=6,Ee.COMPLETE="complete",(Se.EventType=S).OPEN="a",S.CLOSE="b",S.ERROR="c",S.MESSAGE="d",Ft.prototype.listen=Ft.prototype.va,On.prototype.listenOnce=On.prototype.wa,On.prototype.getLastError=On.prototype.Qa,On.prototype.getLastErrorCode=On.prototype.ua,On.prototype.getStatus=On.prototype.W,On.prototype.getResponseJson=On.prototype.Pa,On.prototype.getResponseText=On.prototype.$,On.prototype.send=On.prototype.ba;var vr=ye,gr=_e,mr=Ee,wr=pe,br=10,Ir=11,_r=Se,Er=On,Tr="8.2.4-2021019222814",Nr=new o("@firebase/firestore");function Sr(){return Nr.logLevel}function Ar(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=l.DEBUG&&(e=n.map(kr),Nr.debug.apply(Nr,f(["Firestore ("+Tr+"): "+t],e)))}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=l.ERROR&&(e=n.map(kr),Nr.error.apply(Nr,f(["Firestore ("+Tr+"): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=l.WARN&&(e=n.map(kr),Nr.warn.apply(Nr,f(["Firestore ("+Tr+"): "+t],e)))}function kr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Or(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+Tr+") INTERNAL ASSERTION FAILED: "+t;throw xr(t),new Error(t)}function Lr(t){t||Or()}var Pr=(Cr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Cr);function Cr(){}function Rr(t,e){return t<e?-1:e<t?1:0}function Vr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Mr(t){return t+"\0"}var Ur=(Fr.fromBase64String=function(t){return new Fr(atob(t))},Fr.fromUint8Array=function(t){return new Fr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Fr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},Fr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},Fr.prototype.o=function(){return 2*this.i.length},Fr.prototype.u=function(t){return Rr(this.i,t.i)},Fr.prototype.isEqual=function(t){return this.i===t.i},Fr);function Fr(t){this.i=t}Ur.h=new Ur("");var jr,qr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Hr=(h(Kr,jr=Error),Kr),Br=(zr.fromBase64String=function(t){try{return new zr(Ur.fromBase64String(t))}catch(t){throw new Hr(qr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},zr.fromUint8Array=function(t){return new zr(Ur.fromUint8Array(t))},zr.prototype.toBase64=function(){return this.l.toBase64()},zr.prototype.toUint8Array=function(){return this.l.toUint8Array()},zr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},zr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},zr),Gr=function(t){this._=t};function zr(t){this.l=t}function Kr(t,e){var n=this;return(n=jr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Jr(){if("undefined"==typeof Uint8Array)throw new Hr(qr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Wr(){if("undefined"==typeof atob)throw new Hr(qr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Xr,Yr=(h(ni,Xr=Gr),ni.fromBase64String=function(t){return Wr(),new ni(Br.fromBase64String(t))},ni.fromUint8Array=function(t){return Jr(),new ni(Br.fromUint8Array(t))},ni.prototype.toBase64=function(){return Wr(),this._.toBase64()},ni.prototype.toUint8Array=function(){return Jr(),this._.toUint8Array()},ni.prototype.isEqual=function(t){return this._.isEqual(t._)},ni.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},ni),Qr=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.I=o},$r=(Object.defineProperty(ei.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),ei.prototype.isEqual=function(t){return t instanceof ei&&t.projectId===this.projectId&&t.database===this.database},ei),Zr=(ti.prototype.A=function(){return null!=this.uid},ti.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},ti.prototype.isEqual=function(t){return t.uid===this.uid},ti);function ti(t){this.uid=t}function ei(t,e){this.projectId=t,this.database=e||"(default)"}function ni(){return null!==Xr&&Xr.apply(this,arguments)||this}Zr.UNAUTHENTICATED=new Zr(null),Zr.P=new Zr("google-credentials-uid"),Zr.g=new Zr("first-party-uid");function ri(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t}var ii=(pi.prototype.getToken=function(){return Promise.resolve(null)},pi.prototype.v=function(){},pi.prototype.S=function(t){(this.p=t)(Zr.UNAUTHENTICATED)},pi.prototype.D=function(){this.p=null},pi),oi=(li.prototype.getToken=function(){var e=this,n=this.F,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.F!==n?(Ar("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Lr("string"==typeof t.accessToken),new ri(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},li.prototype.v=function(){this.forceRefresh=!0},li.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},li.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},li.prototype.O=function(){var t=this.auth&&this.auth.getUid();return Lr(null===t||"string"==typeof t),new Zr(t)},li),si=(Object.defineProperty(fi.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),fi),ui=(hi.prototype.getToken=function(){return Promise.resolve(new si(this.k,this.M))},hi.prototype.S=function(t){t(Zr.g)},hi.prototype.D=function(){},hi.prototype.v=function(){},hi),ai=(ci.prototype.L=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ci.prototype.next=function(){var t=++this.previousValue;return this.B&&this.B(t),t},ci);function ci(t,e){var n=this;this.previousValue=t,e&&(e.$=function(t){return n.L(t)},this.B=function(t){return e.q(t)})}function hi(t,e){this.k=t,this.M=e}function fi(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=Zr.g}function li(t){var e=this;this.C=null,this.currentUser=Zr.UNAUTHENTICATED,this.N=!1,this.F=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.F++,e.currentUser=e.O(),e.N=!0,e.p&&e.p(e.currentUser)},this.F=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}function pi(){this.p=null}ai.U=-1;var di,yi,vi=(Ai.now=function(){return Ai.fromMillis(Date.now())},Ai.fromDate=function(t){return Ai.fromMillis(t.getTime())},Ai.fromMillis=function(t){var e=Math.floor(t/1e3);return new Ai(e,1e6*(t-1e3*e))},Ai.prototype.toDate=function(){return new Date(this.toMillis())},Ai.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Ai.prototype.K=function(t){return this.seconds===t.seconds?Rr(this.nanoseconds,t.nanoseconds):Rr(this.seconds,t.seconds)},Ai.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Ai.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Ai.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Ai.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Ai),gi=(Si.W=function(t){return new Si(t)},Si.min=function(){return new Si(new vi(0,0))},Si.prototype.u=function(t){return this.timestamp.K(t.timestamp)},Si.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Si.prototype.j=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Si.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Si.prototype.G=function(){return this.timestamp},Si),Ee=(Object.defineProperty(Ni.prototype,"length",{get:function(){return this.H},enumerable:!1,configurable:!0}),Ni.prototype.isEqual=function(t){return 0===Ni.J(this,t)},Ni.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Ni?t.forEach(function(t){e.push(t)}):e.push(t),this.Y(e)},Ni.prototype.limit=function(){return this.offset+this.length},Ni.prototype.X=function(t){return t=void 0===t?1:t,this.Y(this.segments,this.offset+t,this.length-t)},Ni.prototype.Z=function(){return this.Y(this.segments,this.offset,this.length-1)},Ni.prototype.tt=function(){return this.segments[this.offset]},Ni.prototype.et=function(){return this.get(this.length-1)},Ni.prototype.get=function(t){return this.segments[this.offset+t]},Ni.prototype.nt=function(){return 0===this.length},Ni.prototype.st=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Ni.prototype.it=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Ni.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Ni.prototype.rt=function(){return this.segments.slice(this.offset,this.limit())},Ni.J=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Ni),mi=(h(Ti,yi=Ee),Ti.prototype.Y=function(t,e,n){return new Ti(t,e,n)},Ti.prototype.ot=function(){return this.rt().join("/")},Ti.prototype.toString=function(){return this.ot()},Ti.ct=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Hr(qr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Ti(n)},Ti.at=function(){return new Ti([])},Ti),wi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,bi=(h(Ei,di=Ee),Ei.prototype.Y=function(t,e,n){return new Ei(t,e,n)},Ei.ut=function(t){return wi.test(t)},Ei.prototype.ot=function(){return this.rt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ei.ut(t)||(t="`"+t+"`"),t}).join(".")},Ei.prototype.toString=function(){return this.ot()},Ei.prototype.ht=function(){return 1===this.length&&"__name__"===this.get(0)},Ei.lt=function(){return new Ei(["__name__"])},Ei._t=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Hr(qr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Hr(qr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Hr(qr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Hr(qr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ei(e)},Ei.at=function(){return new Ei([])},Ei),Ii=(_i.ft=function(t){return new _i(mi.ct(t))},_i.dt=function(t){return new _i(mi.ct(t).X(5))},_i.prototype.wt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},_i.prototype.isEqual=function(t){return null!==t&&0===mi.J(this.path,t.path)},_i.prototype.toString=function(){return this.path.toString()},_i.J=function(t,e){return mi.J(t.path,e.path)},_i.Et=function(t){return t.length%2==0},_i.Tt=function(t){return new _i(new mi(t.slice()))},_i);function _i(t){this.path=t}function Ei(){return null!==di&&di.apply(this,arguments)||this}function Ti(){return null!==yi&&yi.apply(this,arguments)||this}function Ni(t,e,n){void 0===e?e=0:e>t.length&&Or(),void 0===n?n=t.length-e:n>t.length-e&&Or(),this.segments=t,this.offset=e,this.H=n}function Si(t){this.timestamp=t}function Ai(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Hr(qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Hr(qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Hr(qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Hr(qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function xi(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Di(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ki(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Oi=(Pi.prototype.It=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].st(t))return!0;return!1},Pi.prototype.isEqual=function(t){return Vr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Pi),Li=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Pi(t){(this.fields=t).sort(bi.J)}function Ci(t){if(Lr(!!t),"string"!=typeof t)return{seconds:Ri(t.seconds),nanos:Ri(t.nanos)};var e=0,n=Li.exec(t);Lr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Ri(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Vi(t){return"string"==typeof t?Ur.fromBase64String(t):Ur.fromUint8Array(t)}function Mi(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Ui(t){t=Ci(t.mapValue.fields.__local_write_time__.timestampValue);return new vi(t.seconds,t.nanos)}function Fi(t){return null==t}function ji(t){return 0===t&&1/t==-1/0}function qi(t){return"number"==typeof t&&Number.isInteger(t)&&!ji(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Hi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Mi(t)?4:10:Or()}function Bi(r,i){var t,e=Hi(r);if(e!==Hi(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Ui(r).isEqual(Ui(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Ci(r.timestampValue),t=Ci(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Vi(r.bytesValue).isEqual(Vi(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Ri((t=r).geoPointValue.latitude)===Ri(e.geoPointValue.latitude)&&Ri(t.geoPointValue.longitude)===Ri(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ri(t.integerValue)===Ri(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Ri(t.doubleValue),e=Ri(e.doubleValue);return t===e?ji(t)===ji(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Vr(r.arrayValue.values||[],i.arrayValue.values||[],Bi);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(xi(e)!==xi(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Bi(e[t],n[t])))return!1;return!0}();default:return Or()}}function Gi(t,e){return void 0!==(t.values||[]).find(function(t){return Bi(t,e)})}function zi(t,e){var n,r,i=Hi(t),o=Hi(e);if(i!==o)return Rr(i,o);switch(i){case 0:return 0;case 1:return Rr(t.booleanValue,e.booleanValue);case 2:return n=e,r=Ri(t.integerValue||t.doubleValue),n=Ri(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Ki(t.timestampValue,e.timestampValue);case 4:return Ki(Ui(t),Ui(e));case 5:return Rr(t.stringValue,e.stringValue);case 6:return function(t,e){t=Vi(t),e=Vi(e);return t.u(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Rr(n[i],r[i]);if(0!==o)return o}return Rr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=Rr(Ri(i.latitude),Ri(r.latitude)))?n:Rr(Ri(i.longitude),Ri(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=zi(n[i],r[i]);if(o)return o}return Rr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Rr(r[s],o[s]);if(0!==u)return u;u=zi(n[r[s]],i[o[s]]);if(0!==u)return u}return Rr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Or()}}function Ki(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Rr(t,e);var n=Ci(t),t=Ci(e),e=Rr(n.seconds,t.seconds);return 0!==e?e:Rr(n.nanos,t.nanos)}function Ji(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=Ci(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Vi(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,Ii.dt(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Or();var e}(t)}function Wi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.ot()}}function Xi(t){return t&&"integerValue"in t}function Yi(t){return!!t&&"arrayValue"in t}function Qi(t){return t&&"nullValue"in t}function $i(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Zi(t){return t&&"mapValue"in t}var to=(ro.empty=function(){return new ro({mapValue:{}})},ro.prototype.field=function(t){if(t.nt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Zi(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.et()])||null},ro.prototype.isEqual=function(t){return Bi(this.proto,t.proto)},ro),eo=(no.prototype.set=function(t,e){return this.Pt(t,e),this},no.prototype.delete=function(t){return this.Pt(t,null),this},no.prototype.Pt=function(t,e){for(var n=this.Rt,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Hi(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.et(),e)},no.prototype.yt=function(){var t=this.gt(bi.at(),this.Rt);return null!=t?new to(t):this.At},no.prototype.gt=function(r,t){var i=this,o=!1,e=this.At.field(r),s=Zi(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.gt(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},no);function no(t){void 0===t&&(t=to.empty()),this.At=t,this.Rt=new Map}function ro(t){this.proto=t}var io,oo,so,o=function(t,e){this.key=t,this.version=e},uo=(h(po,so=o),po.prototype.field=function(t){return this.Vt.field(t)},po.prototype.data=function(){return this.Vt},po.prototype.vt=function(){return this.Vt.proto},po.prototype.isEqual=function(t){return t instanceof po&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.bt===t.bt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Vt.isEqual(t.Vt)},po.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Vt.toString()+", {hasLocalMutations: "+this.bt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(po.prototype,"hasPendingWrites",{get:function(){return this.bt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),po),ao=(h(lo,oo=o),lo.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(lo.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),lo.prototype.isEqual=function(t){return t instanceof lo&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},lo),co=(h(fo,io=o),fo.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(fo.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),fo.prototype.isEqual=function(t){return t instanceof fo&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},fo),ho=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.St=null};function fo(){return null!==io&&io.apply(this,arguments)||this}function lo(t,e,n){var r=this;return(r=oo.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function po(t,e,n,r){var i=this;return(i=so.call(this,t,e)||this).Vt=n,i.bt=!!r.bt,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function yo(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ho(t,e,n,r,i,o,s)}function vo(t){var e=t;return null===e.St&&(t=e.path.ot(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.ot()+t.op.toString()+Ji(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.ot()+t.dir}).join(","),Fi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=zo(e.startAt)),e.endAt&&(t+="|ub:",t+=zo(e.endAt)),e.St=t),e.St}function go(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Bi(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Wo(t.startAt,e.startAt)&&Wo(t.endAt,e.endAt)}function mo(t){return Ii.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}var wo,bo=(h(Io,wo=function(){}),Io.create=function(t,e,n){return t.ht()?"in"===e||"not-in"===e?this.Dt(t,e,n):new No(t,e,n):"array-contains"===e?new Vo(t,n):"in"===e?new Mo(t,n):"not-in"===e?new Uo(t,n):"array-contains-any"===e?new Fo(t,n):new Io(t,e,n)},Io.Dt=function(t,e,n){return new("in"===e?So:Ao)(t,n)},Io.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.Ct(zi(t,this.value)):null!==t&&Hi(this.value)===Hi(t)&&this.Ct(zi(t,this.value))},Io.prototype.Ct=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Or()}},Io.prototype.xt=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Io);function Io(t,e,n){var r=this;return(r=wo.call(this)||this).field=t,r.op=e,r.value=n,r}var _o,Eo,To,No=(h(ko,To=bo),ko.prototype.matches=function(t){t=Ii.J(t.key,this.key);return this.Ct(t)},ko),So=(h(Do,Eo=bo),Do.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Do),Ao=(h(xo,_o=bo),xo.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},xo);function xo(t,e){var n=this;return(n=_o.call(this,t,"not-in",e)||this).keys=Oo(0,e),n}function Do(t,e){var n=this;return(n=Eo.call(this,t,"in",e)||this).keys=Oo(0,e),n}function ko(t,e,n){var r=this;return(r=To.call(this,t,e,n)||this).key=Ii.dt(n.referenceValue),r}function Oo(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Ii.dt(t.referenceValue)})}var Lo,Po,Co,Ro,Vo=(h(Go,Ro=bo),Go.prototype.matches=function(t){t=t.field(this.field);return Yi(t)&&Gi(t.arrayValue,this.value)},Go),Mo=(h(Bo,Co=bo),Bo.prototype.matches=function(t){t=t.field(this.field);return null!==t&&Gi(this.value.arrayValue,t)},Bo),Uo=(h(Ho,Po=bo),Ho.prototype.matches=function(t){if(Gi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!Gi(this.value.arrayValue,t)},Ho),Fo=(h(qo,Lo=bo),qo.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!Yi(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Gi(e.value.arrayValue,t)})},qo),jo=function(t,e){this.position=t,this.before=e};function qo(t,e){return Lo.call(this,t,"array-contains-any",e)||this}function Ho(t,e){return Po.call(this,t,"not-in",e)||this}function Bo(t,e){return Co.call(this,t,"in",e)||this}function Go(t,e){return Ro.call(this,t,"array-contains",e)||this}function zo(t){return(t.before?"b":"a")+":"+t.position.map(Ji).join(",")}var Ko=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Jo(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.ht()?Ii.J(Ii.dt(s.referenceValue),n.key):zi(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Wo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Bi(t.position[n],e.position[n]))return!1;return!0}var Xo=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Nt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Ft=null,this.Ot=null,this.startAt,this.endAt};function Yo(t,e,n,r,i,o,s,u){return new Xo(t,e,n,r,i,o,s,u)}function Qo(t){return new Xo(t)}function $o(t){return!Fi(t.limit)&&"F"===t.limitType}function Zo(t){return!Fi(t.limit)&&"L"===t.limitType}function ts(t){return 0<t.Nt.length?t.Nt[0].field:null}function es(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.xt())return r.field}return null}function ns(t){return null!==t.collectionGroup}function rs(t){var e=t;if(null===e.Ft){e.Ft=[];var n=es(e),t=ts(e);if(null!==n&&null===t)n.ht()||e.Ft.push(new Ko(n)),e.Ft.push(new Ko(bi.lt(),"asc"));else{for(var r=!1,i=0,o=e.Nt;i<o.length;i++){var s=o[i];e.Ft.push(s),s.field.ht()&&(r=!0)}r||(n=0<e.Nt.length?e.Nt[e.Nt.length-1].dir:"asc",e.Ft.push(new Ko(bi.lt(),n)))}}return e.Ft}function is(t){var e=t;if(!e.Ot)if("F"===e.limitType)e.Ot=yo(e.path,e.collectionGroup,rs(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=rs(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Ko(o.field,s))}var u=e.endAt?new jo(e.endAt.position,!e.endAt.before):null,t=e.startAt?new jo(e.startAt.position,!e.startAt.before):null;e.Ot=yo(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Ot}function os(t,e,n){return new Xo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ss(t,e){return go(is(t),is(e))&&t.limitType===e.limitType}function us(t){return vo(is(t))+"|lt:"+t.limitType}function as(t){return"Query(target="+(e=is(t),n=e.path.ot(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.ot()+" "+t.op+" "+Ji(t.value)}).join(", ")+"]"),Fi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.ot()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+zo(e.startAt)),e.endAt&&(n+=", endAt: "+zo(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function cs(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.wt(e.collectionGroup)&&e.path.st(n):Ii.Et(e.path)?e.path.isEqual(n):e.path.it(n))&&function(t){for(var e=0,n=i.Nt;e<n.length;e++){var r=n[e];if(!r.field.ht()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Jo(t.startAt,rs(t),n))&&(!t.endAt||!Jo(t.endAt,rs(t),n)));var e,n}function hs(u){return function(t,e){for(var n=!1,r=0,i=rs(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.ht()?Ii.J(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?zi(n,t):Or()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Or()}}(o,t,e);if(0!==s)return s;n=n||o.field.ht()}return 0}}var fs=(ls.prototype.$t=function(t){return new ls(this.target,this.targetId,this.kt,t,this.Mt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},ls.prototype.Lt=function(t,e){return new ls(this.target,this.targetId,this.kt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},ls.prototype.Bt=function(t){return new ls(this.target,this.targetId,this.kt,this.sequenceNumber,this.Mt,t,this.resumeToken)},ls);function ls(t,e,n,r,i,o,s){void 0===i&&(i=gi.min()),void 0===o&&(o=gi.min()),void 0===s&&(s=Ur.h),this.target=t,this.targetId=e,this.kt=n,this.sequenceNumber=r,this.Mt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function ps(t,e){if(t.qt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ji(e)?"-0":e}}function ds(t){return{integerValue:""+t}}function ys(t,e){return qi(e)?ds(e):ps(t,e)}Ee=function(){this.Ut=void 0};function vs(t,e){return t instanceof Ds?Xi(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var gs,ms,ws=(h(_s,ms=Ee),_s),bs=(h(Is,gs=Ee),Is);function Is(t){var e=this;return(e=gs.call(this)||this).elements=t,e}function _s(){return null!==ms&&ms.apply(this,arguments)||this}function Es(t,e){for(var n=Ls(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Bi(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Ts,Ns=(h(Ss,Ts=Ee),Ss);function Ss(t){var e=this;return(e=Ts.call(this)||this).elements=t,e}function As(t,e){for(var n=Ls(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Bi(t,e)})}(i[r]);return{arrayValue:{values:n}}}var xs,Ds=(h(ks,xs=Ee),ks);function ks(t,e){var n=this;return(n=xs.call(this)||this).Kt=t,n.Qt=e,n}function Os(t){return Ri(t.integerValue||t.doubleValue)}function Ls(t){return Yi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Ps(t,e){this.version=t,this.transformResults=e}var Cs=function(t,e){this.field=t,this.transform=e},Rs=(Vs.Wt=function(){return new Vs},Vs.exists=function(t){return new Vs(void 0,t)},Vs.updateTime=function(t){return new Vs(t)},Object.defineProperty(Vs.prototype,"jt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Vs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Vs);function Vs(t,e){this.updateTime=t,this.exists=e}function Ms(t,e){return void 0!==t.updateTime?e instanceof uo&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof uo}o=function(){};function Us(t,e,n,r){return t instanceof Bs?function(t,e,n){if(!Ms(t.Gt,e))return e;var r=t.value,n=Xs(t.fieldTransforms,n,e),r=Ys(t.fieldTransforms,r,n),e=js(e);return new uo(t.key,e,r,{bt:!0})}(t,e,r):t instanceof Gs?function(t,e,n){if(!Ms(t.Gt,e))return e;var r=js(e),e=Js(t,e,Xs(t.fieldTransforms,n,e));return new uo(t.key,r,e,{bt:!0})}(t,e,r):(e=e,Ms((t=t).Gt,e)?new ao(t.key,gi.min()):e)}function Fs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gt.isEqual(e.Gt)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Vr(n,r,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof bs&&e instanceof bs||t instanceof Ns&&e instanceof Ns?Vr(t.elements,e.elements,Bi):t instanceof Ds&&e instanceof Ds?Bi(t.Qt,e.Qt):t instanceof ws&&e instanceof ws)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.zt.isEqual(e.zt));var n,r}function js(t){return t instanceof uo?t.version:gi.min()}var qs,Hs,Bs=(h(Ks,Hs=o),Ks),Gs=(h(zs,qs=o),zs);function zs(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=qs.call(this)||this).key=t,o.data=e,o.zt=n,o.Gt=r,o.fieldTransforms=i,o.type=1,o}function Ks(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=Hs.call(this)||this).key=t,i.value=e,i.Gt=n,i.fieldTransforms=r,i.type=0,i}function Js(t,e,n){var r,i,o;return i=t,e=r=e instanceof uo?e.data():to.empty(),o=new eo(e),i.zt.fields.forEach(function(t){var e;t.nt()||(null!==(e=i.data.field(t))?o.set(t,e):o.delete(t))}),r=o.yt(),Ys(t.fieldTransforms,r,n)}function Ws(t,e,n){var r=[];Lr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof uo&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof bs?Es(o,s):o instanceof Ns?As(o,s):u))}return r}function Xs(t,e,n){for(var r,i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof uo&&(c=n.field(u.field)),i.push((r=c,u=e,c=void 0,(a=a)instanceof ws?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:u.seconds,nanos:u.nanoseconds}}}},r&&(c.fields.__previous_value__=r),{mapValue:c}):a instanceof bs?Es(a,r):a instanceof Ns?As(a,r):(a=vs(c=a,r),r=Os(a)+Os(c.Qt),Xi(a)&&Xi(c.Qt)?ds(r):ps(c.Kt,r))))}return i}function Ys(t,e,n){for(var r=new eo(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.yt()}function Qs(t){this.count=t}var $s,Zs,tu,eu=(h(iu,tu=o),iu),nu=(h(ru,Zs=o),ru);function ru(t,e){var n=this;return(n=Zs.call(this)||this).key=t,n.Gt=e,n.type=3,n.fieldTransforms=[],n}function iu(t,e){var n=this;return(n=tu.call(this)||this).key=t,n.Gt=e,n.type=2,n.fieldTransforms=[],n}function ou(t){switch(t){case qr.OK:return Or(),0;case qr.CANCELLED:case qr.UNKNOWN:case qr.DEADLINE_EXCEEDED:case qr.RESOURCE_EXHAUSTED:case qr.INTERNAL:case qr.UNAVAILABLE:case qr.UNAUTHENTICATED:return;case qr.INVALID_ARGUMENT:case qr.NOT_FOUND:case qr.ALREADY_EXISTS:case qr.PERMISSION_DENIED:case qr.FAILED_PRECONDITION:case qr.ABORTED:case qr.OUT_OF_RANGE:case qr.UNIMPLEMENTED:case qr.DATA_LOSS:return 1;default:return Or(),0}}function su(t){if(void 0===t)return xr("GRPC error has no .code"),qr.UNKNOWN;switch(t){case $s.OK:return qr.OK;case $s.CANCELLED:return qr.CANCELLED;case $s.UNKNOWN:return qr.UNKNOWN;case $s.DEADLINE_EXCEEDED:return qr.DEADLINE_EXCEEDED;case $s.RESOURCE_EXHAUSTED:return qr.RESOURCE_EXHAUSTED;case $s.INTERNAL:return qr.INTERNAL;case $s.UNAVAILABLE:return qr.UNAVAILABLE;case $s.UNAUTHENTICATED:return qr.UNAUTHENTICATED;case $s.INVALID_ARGUMENT:return qr.INVALID_ARGUMENT;case $s.NOT_FOUND:return qr.NOT_FOUND;case $s.ALREADY_EXISTS:return qr.ALREADY_EXISTS;case $s.PERMISSION_DENIED:return qr.PERMISSION_DENIED;case $s.FAILED_PRECONDITION:return qr.FAILED_PRECONDITION;case $s.ABORTED:return qr.ABORTED;case $s.OUT_OF_RANGE:return qr.OUT_OF_RANGE;case $s.UNIMPLEMENTED:return qr.UNIMPLEMENTED;case $s.DATA_LOSS:return qr.DATA_LOSS;default:return Or()}}(Ee=$s=$s||{})[Ee.OK=0]="OK",Ee[Ee.CANCELLED=1]="CANCELLED",Ee[Ee.UNKNOWN=2]="UNKNOWN",Ee[Ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ee[Ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ee[Ee.NOT_FOUND=5]="NOT_FOUND",Ee[Ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ee[Ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ee[Ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ee[Ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ee[Ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ee[Ee.ABORTED=10]="ABORTED",Ee[Ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ee[Ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ee[Ee.INTERNAL=13]="INTERNAL",Ee[Ee.UNAVAILABLE=14]="UNAVAILABLE",Ee[Ee.DATA_LOSS=15]="DATA_LOSS";var uu=(lu.prototype.Ht=function(t,e){return new lu(this.J,this.root.Ht(t,e,this.J).copy(null,null,cu.Jt,null,null))},lu.prototype.remove=function(t){return new lu(this.J,this.root.remove(t,this.J).copy(null,null,cu.Jt,null,null))},lu.prototype.get=function(t){for(var e=this.root;!e.nt();){var n=this.J(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},lu.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.nt();){var r=this.J(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},lu.prototype.nt=function(){return this.root.nt()},Object.defineProperty(lu.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),lu.prototype.Yt=function(){return this.root.Yt()},lu.prototype.Xt=function(){return this.root.Xt()},lu.prototype.Zt=function(t){return this.root.Zt(t)},lu.prototype.forEach=function(n){this.Zt(function(t,e){return n(t,e),!1})},lu.prototype.toString=function(){var n=[];return this.Zt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},lu.prototype.te=function(t){return this.root.te(t)},lu.prototype.ee=function(){return new au(this.root,null,this.J,!1)},lu.prototype.ne=function(t){return new au(this.root,t,this.J,!1)},lu.prototype.se=function(){return new au(this.root,null,this.J,!0)},lu.prototype.ie=function(t){return new au(this.root,t,this.J,!0)},lu),au=(fu.prototype.ce=function(){var t=this.oe.pop(),e={key:t.key,value:t.value};if(this.re)for(t=t.left;!t.nt();)this.oe.push(t),t=t.right;else for(t=t.right;!t.nt();)this.oe.push(t),t=t.left;return e},fu.prototype.ae=function(){return 0<this.oe.length},fu.prototype.ue=function(){if(0===this.oe.length)return null;var t=this.oe[this.oe.length-1];return{key:t.key,value:t.value}},fu),cu=(hu.prototype.copy=function(t,e,n,r,i){return new hu(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},hu.prototype.nt=function(){return!1},hu.prototype.Zt=function(t){return this.left.Zt(t)||t(this.key,this.value)||this.right.Zt(t)},hu.prototype.te=function(t){return this.right.te(t)||t(this.key,this.value)||this.left.te(t)},hu.prototype.min=function(){return this.left.nt()?this:this.left.min()},hu.prototype.Yt=function(){return this.min().key},hu.prototype.Xt=function(){return this.right.nt()?this.key:this.right.Xt()},hu.prototype.Ht=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ht(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ht(t,e,n))).he()},hu.prototype.le=function(){if(this.left.nt())return hu.EMPTY;var t=this;return t.left._e()||t.left.left._e()||(t=t.fe()),(t=t.copy(null,null,null,t.left.le(),null)).he()},hu.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.nt()||r.left._e()||r.left.left._e()||(r=r.fe()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left._e()&&(r=r.de()),r.right.nt()||r.right._e()||r.right.left._e()||(r=r.we()),0===e(t,r.key)){if(r.right.nt())return hu.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.le())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.he()},hu.prototype._e=function(){return this.color},hu.prototype.he=function(){var t=this;return t.right._e()&&!t.left._e()&&(t=t.Ee()),t.left._e()&&t.left.left._e()&&(t=t.de()),t.left._e()&&t.right._e()&&(t=t.Te()),t},hu.prototype.fe=function(){var t=this.Te();return t.right.left._e()&&(t=(t=(t=t.copy(null,null,null,null,t.right.de())).Ee()).Te()),t},hu.prototype.we=function(){var t=this.Te();return t.left.left._e()&&(t=(t=t.de()).Te()),t},hu.prototype.Ee=function(){var t=this.copy(null,null,hu.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},hu.prototype.de=function(){var t=this.copy(null,null,hu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},hu.prototype.Te=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},hu.prototype.Ie=function(){var t=this.me();return Math.pow(2,t)<=this.size+1},hu.prototype.me=function(){if(this._e()&&this.left._e())throw Or();if(this.right._e())throw Or();var t=this.left.me();if(t!==this.right.me())throw Or();return t+(this._e()?0:1)},hu);function hu(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:hu.RED,this.left=null!=r?r:hu.EMPTY,this.right=null!=i?i:hu.EMPTY,this.size=this.left.size+1+this.right.size}function fu(t,e,n,r){this.re=r,this.oe=[];for(var i=1;!t.nt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.re?t.left:t.right;else{if(0===i){this.oe.push(t);break}this.oe.push(t),t=this.re?t.right:t.left}}function lu(t,e){this.J=t,this.root=e||cu.EMPTY}function pu(){this.size=0}cu.EMPTY=null,cu.RED=!0,cu.Jt=!1,cu.EMPTY=(Object.defineProperty(pu.prototype,"key",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Object.defineProperty(pu.prototype,"value",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Object.defineProperty(pu.prototype,"color",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Object.defineProperty(pu.prototype,"left",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Object.defineProperty(pu.prototype,"right",{get:function(){throw Or()},enumerable:!1,configurable:!0}),pu.prototype.copy=function(t,e,n,r,i){return this},pu.prototype.Ht=function(t,e,n){return new cu(t,e)},pu.prototype.remove=function(t,e){return this},pu.prototype.nt=function(){return!0},pu.prototype.Zt=function(t){return!1},pu.prototype.te=function(t){return!1},pu.prototype.Yt=function(){return null},pu.prototype.Xt=function(){return null},pu.prototype._e=function(){return!1},pu.prototype.Ie=function(){return!0},pu.prototype.me=function(){return 0},new pu);var du=(mu.prototype.has=function(t){return null!==this.data.get(t)},mu.prototype.first=function(){return this.data.Yt()},mu.prototype.last=function(){return this.data.Xt()},Object.defineProperty(mu.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),mu.prototype.indexOf=function(t){return this.data.indexOf(t)},mu.prototype.forEach=function(n){this.data.Zt(function(t,e){return n(t),!1})},mu.prototype.Ae=function(t,e){for(var n=this.data.ne(t[0]);n.ae();){var r=n.ce();if(0<=this.J(r.key,t[1]))return;e(r.key)}},mu.prototype.Re=function(t,e){for(var n=void 0!==e?this.data.ne(e):this.data.ee();n.ae();)if(!t(n.ce().key))return},mu.prototype.Pe=function(t){t=this.data.ne(t);return t.ae()?t.ce().key:null},mu.prototype.ee=function(){return new yu(this.data.ee())},mu.prototype.ne=function(t){return new yu(this.data.ne(t))},mu.prototype.add=function(t){return this.copy(this.data.remove(t).Ht(t,!0))},mu.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},mu.prototype.nt=function(){return this.data.nt()},mu.prototype.ye=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},mu.prototype.isEqual=function(t){if(!(t instanceof mu))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ee(),n=t.data.ee();e.ae();){var r=e.ce().key,i=n.ce().key;if(0!==this.J(r,i))return!1}return!0},mu.prototype.rt=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},mu.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},mu.prototype.copy=function(t){var e=new mu(this.J);return e.data=t,e},mu),yu=(gu.prototype.ce=function(){return this.ge.ce().key},gu.prototype.ae=function(){return this.ge.ae()},gu),vu=new uu(Ii.J);function gu(t){this.ge=t}function mu(t){this.J=t,this.data=new uu(this.J)}var wu=new uu(Ii.J);var bu=new uu(Ii.J);var Iu=new du(Ii.J);function _u(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Iu,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Eu=new du(Rr);var Tu=(ju.be=function(t){return new ju(t.J)},ju.prototype.has=function(t){return null!=this.Ve.get(t)},ju.prototype.get=function(t){return this.Ve.get(t)},ju.prototype.first=function(){return this.pe.Yt()},ju.prototype.last=function(){return this.pe.Xt()},ju.prototype.nt=function(){return this.pe.nt()},ju.prototype.indexOf=function(t){t=this.Ve.get(t);return t?this.pe.indexOf(t):-1},Object.defineProperty(ju.prototype,"size",{get:function(){return this.pe.size},enumerable:!1,configurable:!0}),ju.prototype.forEach=function(n){this.pe.Zt(function(t,e){return n(t),!1})},ju.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ve.Ht(t.key,t),e.pe.Ht(t,null))},ju.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ve.remove(t),this.pe.remove(e)):this},ju.prototype.isEqual=function(t){if(!(t instanceof ju))return!1;if(this.size!==t.size)return!1;for(var e=this.pe.ee(),n=t.pe.ee();e.ae();){var r=e.ce().key,i=n.ce().key;if(!r.isEqual(i))return!1}return!0},ju.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ju.prototype.copy=function(t,e){var n=new ju;return n.J=this.J,n.Ve=t,n.pe=e,n},ju),Nu=(Fu.prototype.track=function(t){var e=t.doc.key,n=this.ve.get(e);!n||0!==t.type&&3===n.type?this.ve=this.ve.Ht(e,t):3===t.type&&1!==n.type?this.ve=this.ve.Ht(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ve=this.ve.Ht(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ve=this.ve.remove(e):1===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):Or()},Fu.prototype.Se=function(){var n=[];return this.ve.Zt(function(t,e){n.push(e)}),n},Fu),Su=(Uu.Fe=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Uu(t,e,Tu.be(e),i,n,r,!0,!1)},Object.defineProperty(Uu.prototype,"hasPendingWrites",{get:function(){return!this.Ce.nt()},enumerable:!1,configurable:!0}),Uu.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.xe===t.xe&&this.Ce.isEqual(t.Ce)&&ss(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.De.isEqual(t.De)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Uu),Au=(Mu.Le=function(t,e){var n=new Map;return n.set(t,xu.Be(t,e)),new Mu(gi.min(),n,Eu,vu,_u())},Mu),xu=(Vu.Be=function(t,e){return new Vu(Ur.h,e,_u(),_u(),_u())},Vu),Du=function(t,e,n,r){this.We=t,this.removedTargetIds=e,this.key=n,this.je=r},ku=function(t,e){this.targetId=t,this.Ge=e},Ou=function(t,e,n,r){void 0===n&&(n=Ur.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Lu=(Object.defineProperty(Ru.prototype,"qe",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Object.defineProperty(Ru.prototype,"resumeToken",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(Ru.prototype,"Ze",{get:function(){return 0!==this.ze},enumerable:!1,configurable:!0}),Object.defineProperty(Ru.prototype,"tn",{get:function(){return this.Xe},enumerable:!1,configurable:!0}),Ru.prototype.en=function(t){0<t.o()&&(this.Xe=!0,this.Je=t)},Ru.prototype.nn=function(){var n=_u(),r=_u(),i=_u();return this.He.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Or()}}),new xu(this.Je,this.Ye,n,r,i)},Ru.prototype.sn=function(){this.Xe=!1,this.He=Hu()},Ru.prototype.rn=function(t,e){this.Xe=!0,this.He=this.He.Ht(t,e)},Ru.prototype.on=function(t){this.Xe=!0,this.He=this.He.remove(t)},Ru.prototype.cn=function(){this.ze+=1},Ru.prototype.an=function(){--this.ze},Ru.prototype.un=function(){this.Xe=!0,this.Ye=!0},Ru),Pu=(Cu.prototype.wn=function(t){for(var e=0,n=t.We;e<n.length;e++){var r=n[e];t.je instanceof uo?this.En(r,t.je):t.je instanceof ao&&this.Tn(r,t.key,t.je)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Tn(r,t.key,t.je)},Cu.prototype.In=function(n){var r=this;this.mn(n,function(t){var e=r.An(t);switch(n.state){case 0:r.Rn(t)&&e.en(n.resumeToken);break;case 1:e.an(),e.Ze||e.sn(),e.en(n.resumeToken);break;case 2:e.an(),e.Ze||r.removeTarget(t);break;case 3:r.Rn(t)&&(e.un(),e.en(n.resumeToken));break;case 4:r.Rn(t)&&(r.Pn(t),e.en(n.resumeToken));break;default:Or()}})},Cu.prototype.mn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ln.forEach(function(t,e){r.Rn(e)&&n(e)})},Cu.prototype.yn=function(t){var e=t.targetId,n=t.Ge.count,t=this.gn(e);t&&(mo(t=t.target)?0===n?(t=new Ii(t.path),this.Tn(e,t,new ao(t,gi.min()))):Lr(1===n):this.Vn(e)!==n&&(this.Pn(e),this.dn=this.dn.add(e)))},Cu.prototype.pn=function(r){var i=this,o=new Map;this.ln.forEach(function(t,e){var n=i.gn(e);n&&(t.qe&&mo(n.target)&&(n=new Ii(n.target.path),null!==i._n.get(n)||i.bn(e,n)||i.Tn(e,n,new ao(n,r))),t.tn&&(o.set(e,t.nn()),t.sn()))});var s=_u();this.fn.forEach(function(t,e){var n=!0;e.Re(function(t){t=i.gn(t);return!t||2===t.kt||(n=!1)}),n&&(s=s.add(t))});var t=new Au(r,o,this.dn,this._n,s);return this._n=vu,this.fn=qu(),this.dn=new du(Rr),t},Cu.prototype.En=function(t,e){var n;this.Rn(t)&&(n=this.bn(t,e.key)?2:0,this.An(t).rn(e.key,n),this._n=this._n.Ht(e.key,e),this.fn=this.fn.Ht(e.key,this.vn(e.key).add(t)))},Cu.prototype.Tn=function(t,e,n){var r;this.Rn(t)&&(r=this.An(t),this.bn(t,e)?r.rn(e,1):r.on(e),this.fn=this.fn.Ht(e,this.vn(e).delete(t)),n&&(this._n=this._n.Ht(e,n)))},Cu.prototype.removeTarget=function(t){this.ln.delete(t)},Cu.prototype.Vn=function(t){var e=this.An(t).nn();return this.hn.Sn(t).size+e.Ue.size-e.Ke.size},Cu.prototype.cn=function(t){this.An(t).cn()},Cu.prototype.An=function(t){var e=this.ln.get(t);return e||(e=new Lu,this.ln.set(t,e)),e},Cu.prototype.vn=function(t){var e=this.fn.get(t);return e||(e=new du(Rr),this.fn=this.fn.Ht(t,e)),e},Cu.prototype.Rn=function(t){var e=null!==this.gn(t);return e||Ar("WatchChangeAggregator","Detected inactive target",t),e},Cu.prototype.gn=function(t){var e=this.ln.get(t);return e&&e.Ze?null:this.hn.Dn(t)},Cu.prototype.Pn=function(e){var n=this;this.ln.set(e,new Lu),this.hn.Sn(e).forEach(function(t){n.Tn(e,t,null)})},Cu.prototype.bn=function(t,e){return this.hn.Sn(t).has(e)},Cu);function Cu(t){this.hn=t,this.ln=new Map,this._n=vu,this.fn=qu(),this.dn=new du(Rr)}function Ru(){this.ze=0,this.He=Hu(),this.Je=Ur.h,this.Ye=!1,this.Xe=!0}function Vu(t,e,n,r,i){this.resumeToken=t,this.qe=e,this.Ue=n,this.Qe=r,this.Ke=i}function Mu(t,e,n,r,i){this.Mt=t,this.Oe=e,this.ke=n,this.Me=r,this.$e=i}function Uu(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.De=n,this.docChanges=r,this.Ce=i,this.fromCache=o,this.xe=s,this.Ne=u}function Fu(){this.ve=new uu(Ii.J)}function ju(n){this.J=n?function(t,e){return n(t,e)||Ii.J(t.key,e.key)}:function(t,e){return Ii.J(t.key,e.key)},this.Ve=wu,this.pe=new uu(this.J)}function qu(){return new uu(Ii.J)}function Hu(){return new uu(Ii.J)}var Bu={asc:"ASCENDING",desc:"DESCENDING"},Gu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},zu=function(t,e){this.T=t,this.qt=e};function Ku(t,e){return t.qt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ju(t,e){return t.qt?e.toBase64():e.toUint8Array()}function Wu(t){return Lr(!!t),gi.W((t=Ci(t),new vi(t.seconds,t.nanos)))}function Xu(t,e){return new mi(["projects",t.projectId,"databases",t.database]).child("documents").child(e).ot()}function Yu(t){t=mi.ct(t);return Lr(ya(t)),t}function Qu(t,e){return Xu(t.T,e.path)}function $u(t,e){e=Yu(e);if(e.get(1)!==t.T.projectId)throw new Hr(qr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.T.projectId);if(e.get(3)!==t.T.database)throw new Hr(qr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.T.database);return new Ii(na(e))}function Zu(t,e){return Xu(t.T,e)}function ta(t){t=Yu(t);return 4===t.length?mi.at():na(t)}function ea(t){return new mi(["projects",t.T.projectId,"databases",t.T.database]).ot()}function na(t){return Lr(4<t.length&&"documents"===t.get(4)),t.X(5)}function ra(t,e,n){return{name:Qu(t,e),fields:n.proto.mapValue.fields}}function ia(t,e,n){var r=$u(t,e.name),t=Wu(e.updateTime),e=new to({mapValue:{fields:e.fields}});return new uo(r,t,e,{hasCommittedMutations:!!n})}function oa(t,e){var n,r,i;if(e instanceof Bs)n={update:ra(t,e.key,e.value)};else if(e instanceof eu)n={delete:Qu(t,e.key)};else if(e instanceof Gs)n={update:ra(t,e.key,e.data),updateMask:(i=e.zt,r=[],i.fields.forEach(function(t){return r.push(t.ot())}),{fieldPaths:r})};else{if(!(e instanceof nu))return Or();n={verify:Qu(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof ws)return{fieldPath:t.field.ot(),setToServerValue:"REQUEST_TIME"};if(e instanceof bs)return{fieldPath:t.field.ot(),appendMissingElements:{values:e.elements}};if(e instanceof Ns)return{fieldPath:t.field.ot(),removeAllFromArray:{values:e.elements}};if(e instanceof Ds)return{fieldPath:t.field.ot(),increment:e.Qt};throw Or()})),e.Gt.jt||(n.currentDocument=void 0!==(i=e.Gt).updateTime?{updateTime:(e=t,t=i.updateTime,Ku(e,t.G()))}:void 0!==i.exists?{exists:i.exists}:Or()),n}function sa(e,t){var n=t.currentDocument?void 0!==(s=t.currentDocument).updateTime?Rs.updateTime(Wu(s.updateTime)):void 0!==s.exists?Rs.exists(s.exists):Rs.Wt():Rs.Wt(),r=t.updateTransforms?t.updateTransforms.map(function(t){return function(t,e){var n,r=null;"setToServerValue"in e?(Lr("REQUEST_TIME"===e.setToServerValue),r=new ws):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new bs(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new Ns(n)):"increment"in e?r=new Ds(t,e.increment):Or();e=bi._t(e.fieldPath);return new Cs(e,r)}(e,t)}):[];if(t.update){t.update.name;var i=$u(e,t.update.name),o=new to({mapValue:{fields:t.update.fields}});if(t.updateMask){var s=(s=t.updateMask.fieldPaths||[],new Oi(s.map(function(t){return bi._t(t)})));return new Gs(i,o,s,n,r)}return new Bs(i,o,n,r)}if(t.delete){r=$u(e,t.delete);return new eu(r,n)}if(t.verify){t=$u(e,t.verify);return new nu(t,n)}return Or()}function ua(t,e){return{documents:[Zu(t,e.path)]}}function aa(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Zu(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Zu(t,r.Z()),n.structuredQuery.from=[{collectionId:r.et()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if($i(t.value))return{unaryFilter:{field:la(t.field),op:"IS_NAN"}};if(Qi(t.value))return{unaryFilter:{field:la(t.field),op:"IS_NULL"}}}else if("!="===t.op){if($i(t.value))return{unaryFilter:{field:la(t.field),op:"IS_NOT_NAN"}};if(Qi(t.value))return{unaryFilter:{field:la(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:la(t.field),op:(e=t.op,Gu[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:la((t=t).field),direction:(t=t.dir,Bu[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.qt||Fi(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=ha(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ha(e.endAt)),n}function ca(t){var e=ta(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Lr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[da(t)]:void 0!==t.fieldFilter?[(n=t,bo.create(pa(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Or()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Or():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new Ko(pa((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=Fi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=fa(n.startAt));var u=null;return n.endAt&&(u=fa(n.endAt)),Yo(e,i,t,o,r,"F",s,u)}function ha(t){return{before:t.before,values:t.position}}function fa(t){var e=!!t.before,t=t.values||[];return new jo(t,e)}function la(t){return{fieldPath:t.ot()}}function pa(t){return bi._t(t.fieldPath)}function da(t){switch(t.unaryFilter.op){case"IS_NAN":var e=pa(t.unaryFilter.field);return bo.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=pa(t.unaryFilter.field);return bo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=pa(t.unaryFilter.field);return bo.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=pa(t.unaryFilter.field);return bo.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Or()}}function ya(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var va,ga=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},ma=(Aa.prototype.catch=function(t){return this.next(void 0,t)},Aa.prototype.next=function(r,i){var o=this;return this.Fn&&Or(),this.Fn=!0,this.Nn?this.error?this.On(i,this.error):this.kn(r,this.result):new Aa(function(e,n){o.Cn=function(t){o.kn(r,t).next(e,n)},o.xn=function(t){o.On(i,t).next(e,n)}})},Aa.prototype.Mn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Aa.prototype.$n=function(t){try{var e=t();return e instanceof Aa?e:Aa.resolve(e)}catch(t){return Aa.reject(t)}},Aa.prototype.kn=function(t,e){return t?this.$n(function(){return t(e)}):Aa.resolve(e)},Aa.prototype.On=function(t,e){return t?this.$n(function(){return t(e)}):Aa.reject(e)},Aa.resolve=function(n){return new Aa(function(t,e){t(n)})},Aa.reject=function(n){return new Aa(function(t,e){e(n)})},Aa.Ln=function(t){return new Aa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Aa.Bn=function(t){for(var n=Aa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Aa.resolve(t):e()})}(r[e]);return n},Aa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Ln(i)},Aa),wa=(Sa.open=function(t,e,n,r){try{return new Sa(e,t.transaction(r,n))}catch(t){throw new _a(e,t)}},Object.defineProperty(Sa.prototype,"Un",{get:function(){return this.qn.promise},enumerable:!1,configurable:!0}),Sa.prototype.abort=function(t){t&&this.qn.reject(t),this.aborted||(Ar("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Sa.prototype.store=function(t){t=this.transaction.objectStore(t);return new Da(t)},Sa),ba=(Na.delete=function(t){return Ar("SimpleDb","Removing database:",t),Oa(window.indexedDB.deleteDatabase(t)).Mn()},Na.Wn=function(){if("undefined"==typeof indexedDB)return!1;if(Na.jn())return!0;var t=p(),e=Na.Kn(t),n=0<e&&e<10,e=Na.Gn(t),e=0<e&&e<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||e)},Na.jn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.zn)},Na.Hn=function(t,e){return t.store(e)},Na.Kn=function(t){t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),t=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(t)},Na.Gn=function(t){t=t.match(/Android ([\d.]+)/i),t=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(t)},Na.prototype.Jn=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Ar("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result;e(t)},r.onblocked=function(){n(new _a(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){t=t.target.error;"VersionError"===t.name?n(new Hr(qr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new _a(o,t))},r.onupgradeneeded=function(t){Ar("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Qn.Yn(e,r.transaction,t.oldVersion,i.version).next(function(){Ar("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Xn&&(this.db.onversionchange=function(t){return i.Xn(t)}),this.db)]}})})},Na.prototype.Zn=function(e){this.Xn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},Na.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Jn(u)];case 2:return s.db=t.sent(),e=wa.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),ma.reject(t)}).Mn(),r={},n.catch(function(){}),[4,e.Un];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Ar("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Na.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},Na),Ia=(Object.defineProperty(Ta.prototype,"Nn",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(Ta.prototype,"ss",{get:function(){return this.ns},enumerable:!1,configurable:!0}),Object.defineProperty(Ta.prototype,"cursor",{set:function(t){this.ts=t},enumerable:!1,configurable:!0}),Ta.prototype.done=function(){this.es=!0},Ta.prototype.rs=function(t){this.ns=t},Ta.prototype.delete=function(){return Oa(this.ts.delete())},Ta),_a=(h(Ea,va=Hr),Ea);function Ea(t,e){var n=this;return(n=va.call(this,qr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function Ta(t){this.ts=t,this.es=!1,this.ns=null}function Na(t,e,n){this.name=t,this.version=e,this.Qn=n,12.2===Na.Kn(p())&&xr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Sa(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.qn=new ga,this.transaction.oncomplete=function(){n.qn.resolve()},this.transaction.onabort=function(){t.error?n.qn.reject(new _a(e,t.error)):n.qn.resolve()},this.transaction.onerror=function(t){t=Pa(t.target.error);n.qn.reject(new _a(e,t))}}function Aa(t){var e=this;this.Cn=null,this.xn=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.Fn=!1,t(function(t){e.Nn=!0,e.result=t,e.Cn&&e.Cn(t)},function(t){e.Nn=!0,e.error=t,e.xn&&e.xn(t)})}function xa(t){return"IndexedDbTransactionError"===t.name}var Da=(ka.prototype.put=function(t,e){t=void 0!==e?(Ar("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Ar("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return Oa(t)},ka.prototype.add=function(t){return Ar("SimpleDb","ADD",this.store.name,t,t),Oa(this.store.add(t))},ka.prototype.get=function(e){var n=this;return Oa(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Ar("SimpleDb","GET",n.store.name,e,t),t})},ka.prototype.delete=function(t){return Ar("SimpleDb","DELETE",this.store.name,t),Oa(this.store.delete(t))},ka.prototype.count=function(){return Ar("SimpleDb","COUNT",this.store.name),Oa(this.store.count())},ka.prototype.os=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.cs(e,function(t,e){n.push(e)}).next(function(){return n})},ka.prototype.us=function(t,e){Ar("SimpleDb","DELETE ALL",this.store.name);e=this.options(t,e);e.hs=!1;e=this.cursor(e);return this.cs(e,function(t,e,n){return n.delete()})},ka.prototype.ls=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.cs(n,e)},ka.prototype._s=function(r){var t=this.cursor({});return new ma(function(n,e){t.onerror=function(t){t=Pa(t.target.error);e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},ka.prototype.cs=function(t,i){var o=[];return new ma(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new Ia(n),(t=i(n.primaryKey,n.value,e))instanceof ma&&(t=t.catch(function(t){return e.done(),ma.reject(t)}),o.push(t)),e.Nn?r():null===e.ss?n.continue():n.continue(e.ss)):r()}}).next(function(){return ma.Ln(o)})},ka.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},ka.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.hs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},ka);function ka(t){this.store=t}function Oa(t){return new ma(function(e,n){t.onsuccess=function(t){t=t.target.result;e(t)},t.onerror=function(t){t=Pa(t.target.error);n(t)}})}var La=!1;function Pa(t){var e=ba.Kn(p());if(12.2<=e&&e<13){e="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(e)){var n=new Hr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return La||(La=!0,setTimeout(function(){throw n},0)),n}}return t}var Ca=(Ra.Is=function(t,e,n,r,i){i=new Ra(t,e,Date.now()+n,r,i);return i.start(n),i},Ra.prototype.start=function(t){var e=this;this.As=setTimeout(function(){return e.Rs()},t)},Ra.prototype.Ps=function(){return this.Rs()},Ra.prototype.cancel=function(t){null!==this.As&&(this.clearTimeout(),this.Ts.reject(new Hr(qr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ra.prototype.Rs=function(){var e=this;this.fs.ys(function(){return null!==e.As?(e.clearTimeout(),e.op().then(function(t){return e.Ts.resolve(t)})):Promise.resolve()})},Ra.prototype.clearTimeout=function(){null!==this.As&&(this.Es(this),clearTimeout(this.As),this.As=null)},Ra);function Ra(t,e,n,r,i){this.fs=t,this.ds=e,this.ws=n,this.op=r,this.Es=i,this.Ts=new ga,this.then=this.Ts.promise.then.bind(this.Ts.promise),this.Ts.promise.catch(function(t){})}function Va(t,e){if(xr("AsyncQueue",e+": "+t),xa(t))return new Hr(qr.UNAVAILABLE,e+": "+t);throw t}var Ma="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",o=(Ua.prototype.Vs=function(t){this.gs.push(t)},Ua.prototype.ps=function(){this.gs.forEach(function(t){return t()})},Ua);function Ua(){this.gs=[]}function Fa(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=ja(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}(t.get(n),e);return ja(e)}function ja(t){return t+"\x01\x01"}function qa(t){var e=t.length;if(Lr(2<=e),2===e)return Lr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),mi.at();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||n<s)&&Or(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Or()}o=s+2}return new mi(r)}function Ha(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}var Ba=function(t,e){this.seconds=t,this.nanoseconds=e};Ha.store="owner",Ha.key="owner";function Ga(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}Ga.store="mutationQueues",Ga.keyPath="userId";function za(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}za.store="mutations",za.keyPath="batchId",za.userMutationsIndex="userMutationsIndex",za.userMutationsKeyPath=["userId","batchId"];var Ka=(Ja.prefixForUser=function(t){return[t]},Ja.prefixForPath=function(t,e){return[t,Fa(e)]},Ja.key=function(t,e,n){return[t,Fa(e),n]},Ja);function Ja(){}Ka.store="documentMutations",Ka.PLACEHOLDER=new Ka;function Wa(t,e){this.path=t,this.readTime=e}function Xa(t,e){this.path=t,this.version=e}var Ya=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Ya.store="remoteDocuments",Ya.readTimeIndex="readTimeIndex",Ya.readTimeIndexPath="readTime",Ya.collectionReadTimeIndex="collectionReadTimeIndex",Ya.collectionReadTimeIndexPath=["parentPath","readTime"];function Qa(t){this.byteSize=t}Qa.store="remoteDocumentGlobal",Qa.key="remoteDocumentGlobalKey";function $a(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s}$a.store="targets",$a.keyPath="targetId",$a.queryTargetsIndexName="queryTargetsIndex",$a.queryTargetsKeyPath=["canonicalId","targetId"];var Za=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Za.store="targetDocuments",Za.keyPath=["targetId","path"],Za.documentTargetsIndex="documentTargetsIndex",Za.documentTargetsKeyPath=["path","targetId"];function tc(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}tc.key="targetGlobalKey",tc.store="targetGlobal";function ec(t,e){this.collectionId=t,this.parent=e}ec.store="collectionParents",ec.keyPath=["collectionId","parent"];function nc(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}nc.store="clientMetadata",nc.keyPath="clientId";function rc(t,e,n){this.bundleId=t,this.createTime=e,this.version=n}rc.store="bundles",rc.keyPath="bundleId";function ic(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n}ic.store="namedQueries",ic.keyPath="name";var oc,sc=f(f(f(f([Ga.store,za.store,Ka.store,Ya.store,$a.store,Ha.store,tc.store,Za.store],[nc.store]),[Qa.store]),[ec.store]),[rc.store,ic.store]),uc=(h(ac,oc=o),ac);function ac(t,e){var n=this;return(n=oc.call(this)||this).bs=t,n.vs=e,n}function cc(t,e){return ba.Hn(t.bs,e)}var hc=(dc.prototype.Ds=function(t,e,n){for(var r,i,o,s,u,a,c=n.Cs,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,i=e,o=c[h],f=a=u=s=void 0,e=r instanceof Bs?(u=o,f=(s=r).value,u.transformResults&&(a=Ws(s.fieldTransforms,i,u.transformResults),f=Ys(s.fieldTransforms,f,a)),new uo(s.key,u.version,f,{hasCommittedMutations:!0})):r instanceof Gs?function(t,e,n){if(!Ms(t.Gt,e))return new co(t.key,n.version);e=Js(t,e,n.transformResults?Ws(t.fieldTransforms,e,n.transformResults):[]);return new uo(t.key,n.version,e,{hasCommittedMutations:!0})}(r,i,o):new ao(r.key,o.version,{hasCommittedMutations:!0}))}return e},dc.prototype.xs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(i=r[n]).key.isEqual(t)&&(e=Us(i,e,0,this.Ss));for(var i,o=0,s=this.mutations;o<s.length;o++){(i=s[o]).key.isEqual(t)&&(e=Us(i,e,0,this.Ss))}return e},dc.prototype.Ns=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.xs(t.key,n.get(t.key));e&&(i=i.Ht(t.key,e))}),i},dc.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},_u())},dc.prototype.isEqual=function(t){return this.batchId===t.batchId&&Vr(this.mutations,t.mutations,Fs)&&Vr(this.baseMutations,t.baseMutations,Fs)},dc),fc=(pc.from=function(t,e,n){Lr(t.mutations.length===n.length);for(var r=bu,i=t.mutations,o=0;o<i.length;o++)r=r.Ht(i[o].key,n[o].version);return new pc(t,e,n,r)},pc),lc=function(t){this.ks=t};function pc(t,e,n,r){this.batch=t,this.Fs=e,this.Cs=n,this.Os=r}function dc(t,e,n,r){this.batchId=t,this.Ss=e,this.baseMutations=n,this.mutations=r}function yc(t,e){if(e.document)return ia(t.ks,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Ii.Tt(e.noDocument.path),r=bc(e.noDocument.readTime);return new ao(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){n=Ii.Tt(e.unknownDocument.path),r=bc(e.unknownDocument.version);return new co(n,r)}return Or()}function vc(t,e,n){var r=gc(n),n=e.key.path.Z().rt();if(e instanceof uo){var i={name:Qu(o=t.ks,(s=e).key),fields:s.vt().mapValue.fields,updateTime:Ku(o,s.version.G())},o=e.hasCommittedMutations;return new Ya(null,null,i,o,r,n)}if(e instanceof ao){var s=e.key.path.rt(),i=wc(e.version),o=e.hasCommittedMutations;return new Ya(null,new Wa(s,i),null,o,r,n)}if(e instanceof co){o=e.key.path.rt(),e=wc(e.version);return new Ya(new Xa(o,e),null,null,!0,r,n)}return Or()}function gc(t){t=t.G();return[t.seconds,t.nanoseconds]}function mc(t){t=new vi(t[0],t[1]);return gi.W(t)}function wc(t){t=t.G();return new Ba(t.seconds,t.nanoseconds)}function bc(t){t=new vi(t.seconds,t.nanoseconds);return gi.W(t)}function Ic(e,t){for(var n=(t.baseMutations||[]).map(function(t){return sa(e.ks,t)}),r=t.mutations.length-1;0<=r;--r){var i=t.mutations[r];void 0!==(null==i?void 0:i.transform)&&(t.mutations[r-1].updateTransforms=i.transform.fieldTransforms,t.mutations.splice(r,1),--r)}var o=t.mutations.map(function(t){return sa(e.ks,t)}),s=vi.fromMillis(t.localWriteTimeMs);return new hc(t.batchId,s,n,o)}function _c(t){var e=bc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?bc(t.lastLimboFreeSnapshotVersion):gi.min(),r=void 0!==t.query.documents?(Lr(1===(r=t.query).documents.length),is(Qo(ta(r.documents[0])))):is(ca(t.query));return new fs(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Ur.fromBase64String(t.resumeToken))}function Ec(t,e){var n=wc(e.Mt),r=wc(e.lastLimboFreeSnapshotVersion),i=(mo(e.target)?ua:aa)(t.ks,e.target),t=e.resumeToken.toBase64();return new $a(e.targetId,vo(e.target),n,t,e.sequenceNumber,r,i)}function Tc(t){var e=ca({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?os(e,e.limit,"L"):e}var Nc=(Sc.prototype.Ms=function(t,e){return Ac(t).get(e).next(function(t){if(t)return{id:(t=t).bundleId,createTime:bc(t.createTime),version:t.version}})},Sc.prototype.$s=function(t,e){return Ac(t).put({bundleId:(e=e).id,createTime:wc(Wu(e.createTime)),version:e.version})},Sc.prototype.Ls=function(t,e){return xc(t).get(e).next(function(t){if(t)return{name:(t=t).name,query:Tc(t.bundledQuery),readTime:bc(t.readTime)}})},Sc.prototype.Bs=function(t,e){return xc(t).put({name:(e=e).name,readTime:wc(Wu(e.readTime)),bundledQuery:e.bundledQuery})},Sc);function Sc(){}function Ac(t){return cc(t,rc.store)}function xc(t){return cc(t,ic.store)}var Dc=(Cc.prototype.Us=function(t,e){return this.qs.add(e),ma.resolve()},Cc.prototype.Qs=function(t,e){return ma.resolve(this.qs.getEntries(e))},Cc),kc=(Pc.prototype.add=function(t){var e=t.et(),n=t.Z(),r=this.index[e]||new du(mi.J),t=!r.has(n);return this.index[e]=r.add(n),t},Pc.prototype.has=function(t){var e=t.et(),t=t.Z(),e=this.index[e];return e&&e.has(t)},Pc.prototype.getEntries=function(t){return(this.index[t]||new du(mi.J)).rt()},Pc),Oc=(Lc.prototype.Us=function(t,e){var n=this;if(this.Ks.has(e))return ma.resolve();var r=e.et(),i=e.Z();t.Vs(function(){n.Ks.add(e)});i={collectionId:r,parent:Fa(i)};return Rc(t).put(i)},Lc.prototype.Qs=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Mr(i),""],!1,!0);return Rc(t).os(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(qa(r.parent))}return o})},Lc);function Lc(){this.Ks=new kc}function Pc(){this.index={}}function Cc(){this.qs=new kc}function Rc(t){return cc(t,ec.store)}var Vc={Ws:!1,js:0,Gs:0,zs:0},Mc=(Uc.Xs=function(t){return new Uc(t,Uc.Zs,Uc.ti)},Uc);function Uc(t,e,n){this.Hs=t,this.Js=e,this.Ys=n}function Fc(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==qr.FAILED_PRECONDITION||e.message!==Ma)throw e;return Ar("LocalStore","Unexpectedly lost primary lease"),[2]})})}Mc.Zs=10,Mc.ti=1e3,Mc.ei=new Mc(41943040,Mc.Zs,Mc.ti),Mc.ni=new Mc(-1,0,0);var jc=(Hc.prototype.get=function(t){var e=this.si(t),e=this.ri[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.ii(o,t))return i}},Hc.prototype.has=function(t){return void 0!==this.get(t)},Hc.prototype.set=function(t,e){var n=this.si(t),r=this.ri[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.ii(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ri[n]=[[t,e]]},Hc.prototype.delete=function(t){var e=this.si(t),n=this.ri[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.ii(n[r][0],t))return 1===n.length?delete this.ri[e]:n.splice(r,1),!0;return!1},Hc.prototype.forEach=function(s){Di(this.ri,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},Hc.prototype.nt=function(){return ki(this.ri)},Hc),Ee=(qc.prototype.ai=function(t){t=this.oi.get(t);return t?t.readTime:gi.min()},qc.prototype.ui=function(t,e){this.hi(),this.oi.set(t.key,{li:t,readTime:e})},qc.prototype._i=function(t,e){void 0===e&&(e=null),this.hi(),this.oi.set(t,{li:null,readTime:e})},qc.prototype.fi=function(t,e){this.hi();var n=this.oi.get(e);return void 0!==n?ma.resolve(n.li):this.di(t,e)},qc.prototype.getEntries=function(t,e){return this.wi(t,e)},qc.prototype.apply=function(t){return this.hi(),this.ci=!0,this.Ei(t)},qc.prototype.hi=function(){},qc);function qc(){this.oi=new jc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.ci=!1}function Hc(t,e){this.si=t,this.ii=e,this.ri={}}function Bc(t,e,n){var r=t.store(za.store),i=t.store(Ka.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.ls({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Lr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=Ka.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return ma.Ln(o).next(function(){return u})}function Gc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Or();e=t.noDocument}return JSON.stringify(e).length}var zc=(Kc.Ai=function(t,e,n,r){return Lr(""!==t.uid),new Kc(t.A()?t.uid:"",e,n,r)},Kc.prototype.Ri=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Wc(t).ls({index:za.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},Kc.prototype.Pi=function(d,y,v,g){var m=this,w=Xc(d),b=Wc(d);return b.add({}).next(function(t){Lr("number"==typeof t);for(var e,n,r,i,o,s=new hc(t,y,v,g),u=(e=m.Kt,n=m.userId,i=(r=s).baseMutations.map(function(t){return oa(e.ks,t)}),o=r.mutations.map(function(t){return oa(e.ks,t)}),new za(n,r.batchId,r.Ss.toMillis(),i,o)),a=[],c=new du(function(t,e){return Rr(t.ot(),e.ot())}),h=0,f=g;h<f.length;h++){var l=f[h],p=Ka.key(m.userId,l.key.path,t),c=c.add(l.key.path.Z());a.push(b.put(u)),a.push(w.put(p,Ka.PLACEHOLDER))}return c.forEach(function(t){a.push(m.Ti.Us(d,t))}),d.Vs(function(){m.mi[t]=s.keys()}),ma.Ln(a).next(function(){return s})})},Kc.prototype.yi=function(t,e){var n=this;return Wc(t).get(e).next(function(t){return t?(Lr(t.userId===n.userId),Ic(n.Kt,t)):null})},Kc.prototype.gi=function(t,e){var n=this;return this.mi[e]?ma.resolve(this.mi[e]):this.yi(t,e).next(function(t){if(t){t=t.keys();return n.mi[e]=t}return null})},Kc.prototype.Vi=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Wc(t).ls({index:za.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Lr(e.batchId>=i),o=Ic(r.Kt,e)),n.done()}).next(function(){return o})},Kc.prototype.pi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Wc(t).ls({index:za.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},Kc.prototype.bi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Wc(t).os(za.userMutationsIndex,n).next(function(t){return t.map(function(t){return Ic(e.Kt,t)})})},Kc.prototype.vi=function(o,s){var u=this,t=Ka.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Xc(o).ls({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=qa(i);if(r===u.userId&&s.path.isEqual(i))return Wc(o).get(t).next(function(t){if(!t)throw Or();Lr(t.userId===u.userId),a.push(Ic(u.Kt,t))});n.done()}).next(function(){return a})},Kc.prototype.Si=function(e,t){var s=this,u=new du(Rr),n=[];return t.forEach(function(o){var t=Ka.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Xc(e).ls({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=qa(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),ma.Ln(n).next(function(){return s.Di(e,u)})},Kc.prototype.Ci=function(t,e){var o=this,s=e.path,u=s.length+1,e=Ka.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new du(Rr);return Xc(t).ls({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=qa(i);r===o.userId&&s.st(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Di(t,a)})},Kc.prototype.Di=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Wc(e).get(t).next(function(t){if(null===t)throw Or();Lr(t.userId===n.userId),r.push(Ic(n.Kt,t))}))}),ma.Ln(i).next(function(){return r})},Kc.prototype.xi=function(e,n){var r=this;return Bc(e.bs,this.userId,n).next(function(t){return e.Vs(function(){r.Ni(n.batchId)}),ma.forEach(t,function(t){return r.Ii.Fi(e,t)})})},Kc.prototype.Ni=function(t){delete this.mi[t]},Kc.prototype.Oi=function(e){var i=this;return this.Ri(e).next(function(t){if(!t)return ma.resolve();var t=IDBKeyRange.lowerBound(Ka.prefixForUser(i.userId)),r=[];return Xc(e).ls({range:t},function(t,e,n){t[0]===i.userId?(t=qa(t[1]),r.push(t)):n.done()}).next(function(){Lr(0===r.length)})})},Kc.prototype.ki=function(t,e){return Jc(t,this.userId,e)},Kc.prototype.Mi=function(t){var e=this;return Yc(t).get(this.userId).next(function(t){return t||new Ga(e.userId,-1,"")})},Kc);function Kc(t,e,n,r){this.userId=t,this.Kt=e,this.Ti=n,this.Ii=r,this.mi={}}function Jc(t,o,e){var e=Ka.prefixForPath(o,e.path),s=e[1],e=IDBKeyRange.lowerBound(e),u=!1;return Xc(t).ls({range:e,hs:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function Wc(t){return cc(t,za.store)}function Xc(t){return cc(t,Ka.store)}function Yc(t){return cc(t,Ga.store)}var Qc=(th.prototype.next=function(){return this.$i+=2,this.$i},th.Li=function(){return new th(0)},th.Bi=function(){return new th(-1)},th),$c=(Zc.prototype.qi=function(n){var r=this;return this.Ui(n).next(function(t){var e=new Qc(t.highestTargetId);return t.highestTargetId=e.next(),r.Qi(n,t).next(function(){return t.highestTargetId})})},Zc.prototype.Ki=function(t){return this.Ui(t).next(function(t){return gi.W(new vi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Zc.prototype.Wi=function(t){return this.Ui(t).next(function(t){return t.highestListenSequenceNumber})},Zc.prototype.ji=function(e,n,r){var i=this;return this.Ui(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.G()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Qi(e,t)})},Zc.prototype.Gi=function(e,n){var r=this;return this.zi(e,n).next(function(){return r.Ui(e).next(function(t){return t.targetCount+=1,r.Hi(n,t),r.Qi(e,t)})})},Zc.prototype.Ji=function(t,e){return this.zi(t,e)},Zc.prototype.Yi=function(e,t){var n=this;return this.Xi(e,t.targetId).next(function(){return eh(e).delete(t.targetId)}).next(function(){return n.Ui(e)}).next(function(t){return Lr(0<t.targetCount),--t.targetCount,n.Qi(e,t)})},Zc.prototype.Zi=function(n,r,i){var o=this,s=0,u=[];return eh(n).ls(function(t,e){e=_c(e);e.sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.Yi(n,e)))}).next(function(){return ma.Ln(u)}).next(function(){return s})},Zc.prototype.mn=function(t,n){return eh(t).ls(function(t,e){e=_c(e);n(e)})},Zc.prototype.Ui=function(t){return nh(t).get(tc.key).next(function(t){return Lr(null!==t),t})},Zc.prototype.Qi=function(t,e){return nh(t).put(tc.key,e)},Zc.prototype.zi=function(t,e){return eh(t).put(Ec(this.Kt,e))},Zc.prototype.Hi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Zc.prototype.tr=function(t){return this.Ui(t).next(function(t){return t.targetCount})},Zc.prototype.er=function(t,r){var e=vo(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return eh(t).ls({range:e,index:$a.queryTargetsIndexName},function(t,e,n){e=_c(e);go(r,e.target)&&(i=e,n.done())}).next(function(){return i})},Zc.prototype.nr=function(n,t,r){var i=this,o=[],s=rh(n);return t.forEach(function(t){var e=Fa(t.path);o.push(s.put(new Za(r,e))),o.push(i.Ii.sr(n,r,t))}),ma.Ln(o)},Zc.prototype.ir=function(n,t,r){var i=this,o=rh(n);return ma.forEach(t,function(t){var e=Fa(t.path);return ma.Ln([o.delete([r,e]),i.Ii.rr(n,r,t)])})},Zc.prototype.Xi=function(t,e){t=rh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0);return t.delete(e)},Zc.prototype.cr=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=rh(t),r=_u();return t.ls({range:e,hs:!0},function(t,e,n){t=qa(t[1]),t=new Ii(t);r=r.add(t)}).next(function(){return r})},Zc.prototype.ki=function(t,e){var e=Fa(e.path),e=IDBKeyRange.bound([e],[Mr(e)],!1,!0),i=0;return rh(t).ls({index:Za.documentTargetsIndex,hs:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Zc.prototype.Dn=function(t,e){return eh(t).get(e).next(function(t){return t?_c(t):null})},Zc);function Zc(t,e){this.Ii=t,this.Kt=e}function th(t){this.$i=t}function eh(t){return cc(t,$a.store)}function nh(t){return cc(t,tc.store)}function rh(t){return cc(t,Za.store)}function ih(t,e){var n=t[0],r=t[1],t=e[0],e=e[1],t=Rr(n,t);return 0===t?Rr(r,e):t}var oh=(lh.prototype.hr=function(){return++this.ur},lh.prototype.lr=function(t){var e=[t,this.hr()];this.buffer.size<this.ar?this.buffer=this.buffer.add(e):ih(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(lh.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),lh),sh=(fh.prototype.start=function(t){-1!==this._r.params.Hs&&this.Er(t)},fh.prototype.stop=function(){this.wr&&(this.wr.cancel(),this.wr=null)},Object.defineProperty(fh.prototype,"Tr",{get:function(){return null!==this.wr},enumerable:!1,configurable:!0}),fh.prototype.Er=function(n){var t=this,e=this.dr?3e5:6e4;Ar("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.wr=this.fs.Ir("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.wr=null,this.dr=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.mr(this._r)];case 2:return t.sent(),[3,7];case 3:return xa(e=t.sent())?(Ar("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Fc(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Er(n)];case 8:return t.sent(),[2]}})})})},fh),uh=(hh.prototype.Rr=function(t,e){return this.Ar.Pr(t).next(function(t){return Math.floor(e/100*t)})},hh.prototype.yr=function(t,e){var n=this;if(0===e)return ma.resolve(ai.U);var r=new oh(e);return this.Ar.mn(t,function(t){return r.lr(t.sequenceNumber)}).next(function(){return n.Ar.gr(t,function(t){return r.lr(t)})}).next(function(){return r.maxValue})},hh.prototype.Zi=function(t,e,n){return this.Ar.Zi(t,e,n)},hh.prototype.Vr=function(t,e){return this.Ar.Vr(t,e)},hh.prototype.pr=function(e,n){var r=this;return-1===this.params.Hs?(Ar("LruGarbageCollector","Garbage collection skipped; disabled"),ma.resolve(Vc)):this.br(e).next(function(t){return t<r.params.Hs?(Ar("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Hs),Vc):r.vr(e,n)})},hh.prototype.br=function(t){return this.Ar.br(t)},hh.prototype.vr=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Rr(e,this.params.Js).next(function(t){return i=t>h.params.Ys?(Ar("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Ys+" from "+t),h.params.Ys):t,s=Date.now(),h.yr(e,i)}).next(function(t){return r=t,u=Date.now(),h.Zi(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.Vr(e,r)}).next(function(t){return c=Date.now(),Sr()<=l.DEBUG&&Ar("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),ma.resolve({Ws:!0,js:i,Gs:o,zs:t})})},hh),ah=(ch.prototype.Pr=function(t){var n=this.Sr(t);return this.db.Dr().tr(t).next(function(e){return n.next(function(t){return e+t})})},ch.prototype.Sr=function(t){var e=0;return this.gr(t,function(t){e++}).next(function(){return e})},ch.prototype.mn=function(t,e){return this.db.Dr().mn(t,e)},ch.prototype.gr=function(t,n){return this.Cr(t,function(t,e){return n(e)})},ch.prototype.sr=function(t,e,n){return ph(t,n)},ch.prototype.rr=function(t,e,n){return ph(t,n)},ch.prototype.Zi=function(t,e,n){return this.db.Dr().Zi(t,e,n)},ch.prototype.Fi=ph,ch.prototype.Nr=function(t,e){return r=e,i=!1,Yc(n=t)._s(function(t){return Jc(n,t,r).next(function(t){return t&&(i=!0),ma.resolve(!t)})}).next(function(){return i});var n,r,i},ch.prototype.Vr=function(n,r){var i=this,o=this.db.Or().Fr(),s=[],u=0;return this.Cr(n,function(e,t){t<=r&&(t=i.Nr(n,e).next(function(t){if(!t)return u++,o.fi(n,e).next(function(){return o._i(e),rh(n).delete([0,Fa(e.path)])})}),s.push(t))}).next(function(){return ma.Ln(s)}).next(function(){return o.apply(n)}).next(function(){return u})},ch.prototype.removeTarget=function(t,e){e=e.$t(t.vs);return this.db.Dr().Ji(t,e)},ch.prototype.kr=ph,ch.prototype.Cr=function(t,r){var i,t=rh(t),o=ai.U;return t.ls({index:Za.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==ai.U&&r(new Ii(qa(i)),o),o=e,i=t):o=ai.U}).next(function(){o!==ai.U&&r(new Ii(qa(i)),o)})},ch.prototype.br=function(t){return this.db.Or().Mr(t)},ch);function ch(t,e){this.db=t,this._r=new uh(this,e)}function hh(t,e){this.Ar=t,this.params=e}function fh(t,e){this._r=t,this.fs=e,this.dr=!1,this.wr=null}function lh(t){this.ar=t,this.buffer=new du(ih),this.ur=0}function ph(t,e){return rh(t).put((t=t.vs,new Za(0,Fa(e.path),t)))}var dh,yh=(mh.prototype.ui=function(t,e,n){return bh(t).put(Ih(e),n)},mh.prototype._i=function(t,e){t=bh(t),e=Ih(e);return t.delete(e)},mh.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.$r(e,t)})},mh.prototype.fi=function(t,e){var n=this;return bh(t).get(Ih(e)).next(function(t){return n.Lr(t)})},mh.prototype.Br=function(t,e){var n=this;return bh(t).get(Ih(e)).next(function(t){var e=n.Lr(t);return e?{li:e,size:Gc(t)}:null})},mh.prototype.getEntries=function(t,e){var n=this,r=vu;return this.qr(t,e,function(t,e){e=n.Lr(e);r=r.Ht(t,e)}).next(function(){return r})},mh.prototype.Ur=function(t,e){var r=this,i=vu,o=new uu(Ii.J);return this.qr(t,e,function(t,e){var n=r.Lr(e);o=n?(i=i.Ht(t,n),o.Ht(t,Gc(e))):(i=i.Ht(t,null),o.Ht(t,0))}).next(function(){return{Qr:i,Kr:o}})},mh.prototype.qr=function(t,e,i){if(e.nt())return ma.resolve();var n=IDBKeyRange.bound(e.first().path.rt(),e.last().path.rt()),o=e.ee(),s=o.ce();return bh(t).ls({range:n},function(t,e,n){for(var r=Ii.Tt(t);s&&Ii.J(s,r)<0;)i(s,null),s=o.ce();s&&s.isEqual(r)&&(i(s,e),s=o.ae()?o.ce():null),s?n.rs(s.path.rt()):n.done()}).next(function(){for(;s;)i(s,null),s=o.ae()?o.ce():null})},mh.prototype.Wr=function(t,r,e){var n,i=this,o=wu,s=r.path.length+1,u={};return e.isEqual(gi.min())?(n=r.path.rt(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.rt(),e=gc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=Ya.collectionReadTimeIndex),bh(t).ls(u,function(t,e,n){t.length===s&&(e=yc(i.Kt,e),r.path.st(e.key.path)?e instanceof uo&&cs(r,e)&&(o=o.Ht(e.key,e)):n.done())}).next(function(){return o})},mh.prototype.Fr=function(t){return new vh(this,!!t&&t.jr)},mh.prototype.Mr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},mh.prototype.getMetadata=function(t){return wh(t).get(Qa.key).next(function(t){return Lr(!!t),t})},mh.prototype.$r=function(t,e){return wh(t).put(Qa.key,e)},mh.prototype.Lr=function(t){if(t){t=yc(this.Kt,t);return t instanceof ao&&t.version.isEqual(gi.min())?null:t}return null},mh),vh=(h(gh,dh=Ee),gh.prototype.Ei=function(i){var o=this,s=[],u=0,a=new du(function(t,e){return Rr(t.ot(),e.ot())});return this.oi.forEach(function(t,e){var n,r=o.zr.get(t);e.li?(n=vc(o.Gr.Kt,e.li,o.ai(t)),a=a.add(t.path.Z()),e=Gc(n),u+=e-r,s.push(o.Gr.ui(i,t,n))):(u-=r,o.jr?(r=vc(o.Gr.Kt,new ao(t,gi.min()),o.ai(t)),s.push(o.Gr.ui(i,t,r))):s.push(o.Gr._i(i,t)))}),a.forEach(function(t){s.push(o.Gr.Ti.Us(i,t))}),s.push(this.Gr.updateMetadata(i,u)),ma.Ln(s)},gh.prototype.di=function(t,e){var n=this;return this.Gr.Br(t,e).next(function(t){return null===t?(n.zr.set(e,0),null):(n.zr.set(e,t.size),t.li)})},gh.prototype.wi=function(t,e){var n=this;return this.Gr.Ur(t,e).next(function(t){var e=t.Qr;return t.Kr.forEach(function(t,e){n.zr.set(t,e)}),e})},gh);function gh(t,e){var n=this;return(n=dh.call(this)||this).Gr=t,n.jr=e,n.zr=new jc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function mh(t,e){this.Kt=t,this.Ti=e}function wh(t){return cc(t,Qa.store)}function bh(t){return cc(t,Ya.store)}function Ih(t){return t.path.rt()}var _h=(Eh.prototype.Yn=function(e,n,t,r){var i=this;Lr(t<r&&0<=t&&r<=11);var o=new wa("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(Ha.store),(s=e).createObjectStore(Ga.store,{keyPath:Ga.keyPath}),s.createObjectStore(za.store,{keyPath:za.keyPath,autoIncrement:!0}).createIndex(za.userMutationsIndex,za.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Ka.store),Th(e),e.createObjectStore(Ya.store));var s,u=ma.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(Za.store),s.deleteObjectStore($a.store),s.deleteObjectStore(tc.store),Th(e)),u=u.next(function(){return t=o.store(tc.store),e=new tc(0,0,gi.min().G(),0),t.put(tc.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(za.store).os().next(function(t){n.deleteObjectStore(za.store),n.createObjectStore(za.store,{keyPath:za.keyPath,autoIncrement:!0}).createIndex(za.userMutationsIndex,za.userMutationsKeyPath,{unique:!0});var e=r.store(za.store),t=t.map(function(t){return e.put(t)});return ma.Ln(t)});var n,r})),u=u.next(function(){e.createObjectStore(nc.store,{keyPath:nc.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.Hr(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(Qa.store),i.Jr(o)})),t<7&&7<=r&&(u=u.next(function(){return i.Yr(o)})),t<8&&8<=r&&(u=u.next(function(){return i.Xr(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(Ya.store)).createIndex(Ya.readTimeIndex,Ya.readTimeIndexPath,{unique:!1}),t.createIndex(Ya.collectionReadTimeIndex,Ya.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.Zr(o)})),t<11&&11<=r&&(u=u.next(function(){e.createObjectStore(rc.store,{keyPath:rc.keyPath}),e.createObjectStore(ic.store,{keyPath:ic.keyPath})})),u},Eh.prototype.Jr=function(e){var n=0;return e.store(Ya.store).ls(function(t,e){n+=Gc(e)}).next(function(){var t=new Qa(n);return e.store(Qa.store).put(Qa.key,t)})},Eh.prototype.Hr=function(n){var r=this,t=n.store(Ga.store),i=n.store(za.store);return t.os().next(function(t){return ma.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.os(za.userMutationsIndex,t).next(function(t){return ma.forEach(t,function(t){Lr(t.userId===e.userId);t=Ic(r.Kt,t);return Bc(n,e.userId,t).next(function(){})})})})})},Eh.prototype.Yr=function(t){var o=t.store(Za.store),e=t.store(Ya.store);return t.store(tc.store).get(tc.key).next(function(r){var i=[];return e.ls(function(t,e){var n=new mi(t),t=[0,Fa(n)];i.push(o.get(t).next(function(t){return t?ma.resolve():o.put(new Za(0,Fa(n),r.highestListenSequenceNumber))}))}).next(function(){return ma.Ln(i)})})},Eh.prototype.Xr=function(t,e){t.createObjectStore(ec.store,{keyPath:ec.keyPath});function r(t){if(i.add(t)){var e=t.et(),t=t.Z();return n.put({collectionId:e,parent:Fa(t)})}}var n=e.store(ec.store),i=new kc;return e.store(Ya.store).ls({hs:!0},function(t,e){t=new mi(t);return r(t.Z())}).next(function(){return e.store(Ka.store).ls({hs:!0},function(t,e){t[0];var n=t[1],n=(t[2],qa(n));return r(n.Z())})})},Eh.prototype.Zr=function(t){var n=this,r=t.store($a.store);return r.ls(function(t,e){e=_c(e),e=Ec(n.Kt,e);return r.put(e)})},Eh);function Eh(t){this.Kt=t}function Th(t){t.createObjectStore(Za.store,{keyPath:Za.keyPath}).createIndex(Za.documentTargetsIndex,Za.documentTargetsKeyPath,{unique:!0}),t.createObjectStore($a.store,{keyPath:$a.keyPath}).createIndex($a.queryTargetsIndexName,$a.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(tc.store)}var Nh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Sh=(Ah.prototype.start=function(){var e=this;return this.Io().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Hr(qr.FAILED_PRECONDITION,Nh);return e.mo(),e.Ao(),e.Ro(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.fo.Wi(t)})}).then(function(t){e.io=new ai(t,e.no)}).then(function(){e.ro=!0}).catch(function(t){return e._o&&e._o.close(),Promise.reject(t)})},Ah.prototype.Po=function(n){var t=this;return this.ho=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.Tr?[2,n(e)]:[2]})})},n(this.isPrimary)},Ah.prototype.yo=function(n){var t=this;this._o.Zn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Ah.prototype.Vo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.eo.ys(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Tr?[4,this.Io()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Ah.prototype.Io=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Dh(e).put(new nc(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.po(e).next(function(t){t||(n.isPrimary=!1,n.eo.bo(function(){return n.ho(!1)}))})}).next(function(){return n.vo(e)}).next(function(t){return n.isPrimary&&!t?n.So(e).next(function(){return!1}):!!t&&n.Do(e).next(function(){return!0})})}).catch(function(t){if(xa(t))return Ar("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Ar("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.eo.bo(function(){return n.ho(t)}),n.isPrimary=t})},Ah.prototype.po=function(t){var e=this;return xh(t).get(Ha.key).next(function(t){return ma.resolve(e.Co(t))})},Ah.prototype.xo=function(t){return Dh(t).delete(this.clientId)},Ah.prototype.No=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Fo(this.uo,18e5)?[3,2]:(this.uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=cc(t,nc.store);return r.os().next(function(t){var e=o.Oo(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return ma.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.To)for(n=0,r=e;n<r.length;n++)i=r[n],this.To.removeItem(this.ko(i.clientId));t.label=2;case 2:return[2]}})})},Ah.prototype.Ro=function(){var t=this;this.ao=this.eo.Ir("client_metadata_refresh",4e3,function(){return t.Io().then(function(){return t.No()}).then(function(){return t.Ro()})})},Ah.prototype.Co=function(t){return!!t&&t.ownerId===this.clientId},Ah.prototype.vo=function(e){var r=this;return this.so?ma.resolve(!0):xh(e).get(Ha.key).next(function(t){if(null!==t&&r.Fo(t.leaseTimestampMs,5e3)&&!r.Mo(t.ownerId)){if(r.Co(t)&&r.networkEnabled)return!0;if(!r.Co(t)){if(!t.allowTabSynchronization)throw new Hr(qr.FAILED_PRECONDITION,Nh);return!1}}return!(!r.networkEnabled||!r.inForeground)||Dh(e).os().next(function(t){return void 0===r.Oo(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Ar("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Ah.prototype.$o=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.ro=!1,this.Lo(),this.ao&&(this.ao.cancel(),this.ao=null),this.Bo(),this.qo(),[4,this._o.runTransaction("shutdown","readwrite",[Ha.store,nc.store],function(t){var e=new uc(t,ai.U);return n.So(e).next(function(){return n.xo(e)})})];case 1:return t.sent(),this._o.close(),this.Uo(),[2]}})})},Ah.prototype.Oo=function(t,e){var n=this;return t.filter(function(t){return n.Fo(t.updateTimeMs,e)&&!n.Mo(t.clientId)})},Ah.prototype.Qo=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Dh(t).os().next(function(t){return e.Oo(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Ah.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),Ah.prototype.Ko=function(t){return zc.Ai(t,this.Kt,this.Ti,this.Ii)},Ah.prototype.Dr=function(){return this.fo},Ah.prototype.Or=function(){return this.wo},Ah.prototype.Wo=function(){return this.Ti},Ah.prototype.jo=function(){return this.Eo},Ah.prototype.runTransaction=function(e,n,r){var i=this;Ar("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this._o.runTransaction(e,t,sc,function(t){return o=new uc(t,i.io?i.io.next():ai.U),"readwrite-primary"===n?i.po(o).next(function(t){return!!t||i.vo(o)}).next(function(t){if(!t)throw xr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.eo.bo(function(){return i.ho(!1)}),new Hr(qr.FAILED_PRECONDITION,Ma);return r(o)}).next(function(t){return i.Do(o).next(function(){return t})}):i.Go(o).next(function(){return r(o)})}).then(function(t){return o.ps(),t})},Ah.prototype.Go=function(t){var e=this;return xh(t).get(Ha.key).next(function(t){if(null!==t&&e.Fo(t.leaseTimestampMs,5e3)&&!e.Mo(t.ownerId)&&!e.Co(t)&&!(e.so||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Hr(qr.FAILED_PRECONDITION,Nh)})},Ah.prototype.Do=function(t){var e=new Ha(this.clientId,this.allowTabSynchronization,Date.now());return xh(t).put(Ha.key,e)},Ah.Wn=function(){return ba.Wn()},Ah.prototype.So=function(t){var e=this,n=xh(t);return n.get(Ha.key).next(function(t){return e.Co(t)?(Ar("IndexedDbPersistence","Releasing primary lease."),n.delete(Ha.key)):ma.resolve()})},Ah.prototype.Fo=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(xr("Detected an update time that is in the future: "+t+" > "+n),1))},Ah.prototype.mo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.co=function(){t.eo.ys(function(){return t.inForeground="visible"===t.document.visibilityState,t.Io()})},this.document.addEventListener("visibilitychange",this.co),this.inForeground="visible"===this.document.visibilityState)},Ah.prototype.Bo=function(){this.co&&(this.document.removeEventListener("visibilitychange",this.co),this.co=null)},Ah.prototype.Ao=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.oo=function(){e.Lo(),e.eo.ys(function(){return e.$o()})},this.window.addEventListener("unload",this.oo))},Ah.prototype.qo=function(){this.oo&&(this.window.removeEventListener("unload",this.oo),this.oo=null)},Ah.prototype.Mo=function(t){try{var e=null!==(null===(e=this.To)||void 0===e?void 0:e.getItem(this.ko(t)));return Ar("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return xr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Ah.prototype.Lo=function(){if(this.To)try{this.To.setItem(this.ko(this.clientId),String(Date.now()))}catch(t){xr("Failed to set zombie client id.",t)}},Ah.prototype.Uo=function(){if(this.To)try{this.To.removeItem(this.ko(this.clientId))}catch(t){}},Ah.prototype.ko=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Ah);function Ah(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.eo=i,this.window=o,this.document=s,this.no=a,this.so=c,this.io=null,this.ro=!1,this.isPrimary=!1,this.networkEnabled=!0,this.oo=null,this.inForeground=!1,this.co=null,this.ao=null,this.uo=Number.NEGATIVE_INFINITY,this.ho=function(t){return Promise.resolve()},!Ah.Wn())throw new Hr(qr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ii=new ah(this,r),this.lo=e+"main",this.Kt=new lc(u),this._o=new ba(this.lo,11,new _h(this.Kt)),this.fo=new $c(this.Ii,this.Kt),this.Ti=new Oc,this.wo=(e=this.Kt,u=this.Ti,new yh(e,u)),this.Eo=new Nc,this.window&&this.window.localStorage?this.To=this.window.localStorage:(this.To=null,!1===c&&xr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function xh(t){return cc(t,Ha.store)}function Dh(t){return cc(t,nc.store)}function kh(t,e){var n=t.projectId;return t.m||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}function Oh(t,e){this.progress=t,this.zo=e}var Lh=(Fh.prototype.Jo=function(e,n){var r=this;return this.Ho.vi(e,n).next(function(t){return r.Yo(e,n,t)})},Fh.prototype.Yo=function(t,r,i){return this.wo.fi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].xs(r,t);return t})},Fh.prototype.Xo=function(t,e,i){var o=vu;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].xs(t,e);o=o.Ht(t,e)}),o},Fh.prototype.Zo=function(e,t){var n=this;return this.wo.getEntries(e,t).next(function(t){return n.tc(e,t)})},Fh.prototype.tc=function(e,r){var i=this;return this.Ho.Si(e,r).next(function(t){var t=i.Xo(e,r,t),n=vu;return t.forEach(function(t,e){e=e||new ao(t,gi.min()),n=n.Ht(t,e)}),n})},Fh.prototype.Wr=function(t,e,n){return r=e,Ii.Et(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ec(t,e.path):ns(e)?this.nc(t,e,n):this.sc(t,e,n);var r},Fh.prototype.ec=function(t,e){return this.Jo(t,new Ii(e)).next(function(t){var e=wu;return t instanceof uo&&(e=e.Ht(t.key,t)),e})},Fh.prototype.nc=function(n,r,i){var o=this,s=r.collectionGroup,u=wu;return this.Ti.Qs(n,s).next(function(t){return ma.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new Xo(t,null,e.Nt.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.sc(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Ht(t,e)})})}).next(function(){return u})})},Fh.prototype.sc=function(e,n,t){var a,c,r=this;return this.wo.Wr(e,n,t).next(function(t){return a=t,r.Ho.Ci(e,n)}).next(function(t){return c=t,r.ic(e,c,a).next(function(t){a=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=Us(s,a.get(u),0,r.Ss);a=s instanceof uo?a.Ht(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){cs(n,e)||(a=a.remove(t))}),a})},Fh.prototype.ic=function(t,e,n){for(var r=_u(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Gs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.wo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof uo&&(c=c.Ht(t,e))}),c})},Fh),Ph=(Uh.cc=function(t,e){for(var n=_u(),r=_u(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Uh(t,e.fromCache,n,r)},Uh),Ch=(Mh.prototype.ac=function(t){this.uc=t},Mh.prototype.Wr=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.Nt.length||1===r.Nt.length&&r.Nt[0].field.ht())||i.isEqual(gi.min())?this.hc(e,r):this.uc.Zo(e,o).next(function(t){var n=s.lc(r,t);return($o(r)||Zo(r))&&s._c(r.limitType,n,o,i)?s.hc(e,r):(Sr()<=l.DEBUG&&Ar("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),as(r)),s.uc.Wr(e,r,i).next(function(e){return n.forEach(function(t){e=e.Ht(t.key,t)}),e}))})},Mh.prototype.lc=function(n,t){var r=new du(hs(n));return t.forEach(function(t,e){e instanceof uo&&cs(n,e)&&(r=r.add(e))}),r},Mh.prototype._c=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.u(r))},Mh.prototype.hc=function(t,e){return Sr()<=l.DEBUG&&Ar("QueryEngine","Using full collection scan to execute query:",as(e)),this.uc.Wr(t,e,gi.min())},Mh),Rh=(Vh.prototype.mr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.pr(t,n.dc)})},Vh);function Vh(t,e,n,r){this.persistence=t,this.fc=e,this.Kt=r,this.dc=new uu(Rr),this.wc=new jc(vo,go),this.Ec=gi.min(),this.Ho=t.Ko(n),this.Tc=t.Or(),this.fo=t.Dr(),this.Ic=new Lh(this.Tc,this.Ho,this.persistence.Wo()),this.Eo=t.jo(),this.fc.ac(this.Ic)}function Mh(){}function Uh(t,e,n,r){this.targetId=t,this.fromCache=e,this.rc=n,this.oc=r}function Fh(t,e,n){this.wo=t,this.Ho=e,this.Ti=n}function jh(t,e,n,r){return new Rh(t,e,n,r)}function qh(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Ho,m=e.Ic,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Ho.bi(v).next(function(t){return g=t,n=e.persistence.Ko(o),m=new Lh(e.Tc,n,e.persistence.Wo()),n.bi(v)}).next(function(t){for(var e=[],n=[],r=_u(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Zo(v,r).next(function(t){return{mc:t,Ac:e,Rc:n}})})})];case 1:return r=t.sent(),[2,(e.Ho=n,e.Ic=m,e.fc.ac(e.Ic),r)]}})})}function Hh(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.Tc.Fr({jr:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=ma.resolve(),n.forEach(function(n){u=u.next(function(){return o.fi(r,n)}).next(function(t){var e=t,t=i.Os.get(n);Lr(null!==t),(!e||e.version.u(t)<0)&&(e=s.Ds(n,e,i))&&o.ui(e,i.Fs)})}),u.next(function(){return e.Ho.xi(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.Ho.Oi(t)}).next(function(){return f.Ic.Zo(t,a)})})}function Bh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.fo.Ki(t)})}function Gh(t,r){var a=t,c=r.Mt,h=a.dc;return a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.Tc.Fr({jr:!0});h=a.dc;var u=[];r.Oe.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a.fo.ir(s,t.Ke,e).next(function(){return a.fo.nr(s,t.Ue,e)})),0<(i=t.resumeToken).o()&&(n=o.Lt(i,c).$t(s.vs),h=h.Ht(e,n),r=o,i=t,Lr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.Mt.j()-r.Mt.j()||0<i.Ue.size+i.Qe.size+i.Ke.size)&&u.push(a.fo.Ji(s,n))))});var e,n=vu;return r.Me.forEach(function(t,e){r.$e.has(t)&&u.push(a.persistence.Ii.kr(s,t))}),u.push(zh(s,t,r.Me,c,void 0).next(function(t){n=t})),c.isEqual(gi.min())||(e=a.fo.Ki(s).next(function(t){return a.fo.ji(s,s.vs,c)}),u.push(e)),ma.Ln(u).next(function(){return t.apply(s)}).next(function(){return a.Ic.tc(s,n)})}).then(function(t){return a.dc=h,t})}function zh(t,s,e,u,a){var n=_u();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=vu;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof ao&&e.version.isEqual(gi.min())?(s._i(t,r),o=o.Ht(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(s.ui(e,r),o=o.Ht(t,e)):Ar("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function Kh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.fo.er(e,r).next(function(t){return t?(n=t,ma.resolve(n)):i.fo.qi(e).next(function(t){return n=new fs(r,t,0,e.vs),i.fo.Gi(e,n).next(function(){return n})})})}).then(function(t){var e=i.dc.get(t.targetId);return(null===e||0<t.Mt.u(e.Mt))&&(i.dc=i.dc.Ht(t.targetId,t),i.wc.set(r,t.targetId)),t})}function Jh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).dc.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Ii.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!xa(r=t.sent()))throw r;return Ar("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.dc=e.dc.remove(o),e.wc.delete(n.target),[2]}})})}function Wh(t,o,s){var u=t,a=gi.min(),c=_u();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=is(o),(void 0!==(t=(i=t).wc.get(r))?ma.resolve(i.dc.get(t)):i.fo.er(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.fo.cr(e,t.targetId).next(function(t){c=t})}).next(function(){return u.fc.Wr(e,o,s?a:gi.min(),s?c:_u())}).next(function(t){return{documents:t,Pc:c}});var t,n,r,i})}function Xh(t,e){var n=t,r=n.fo,t=n.dc.get(e);return t?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Dn(t,e).next(function(t){return t?t.target:null})})}function Yh(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Tc,n=t,t=s.Ec,r=e,i=vu,o=gc(t),t=bh(n),n=IDBKeyRange.lowerBound(o,!0),t.ls({index:Ya.readTimeIndex,range:n},function(t,e){var n=yc(r.Kt,e);i=i.Ht(n.key,n),o=e.readTime}).next(function(){return{zo:i,readTime:mc(o)}});var e,n,r,i,o}).then(function(t){var e=t.zo,t=t.readTime;return s.Ec=t,e})}function Qh(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=bh(t),r=gi.min(),t.ls({index:Ya.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=mc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.Ec=t})]})})}var $h,Zh,tf=(bf.prototype.Ms=function(t,e){return ma.resolve(this.bc.get(e))},bf.prototype.$s=function(t,e){return this.bc.set(e.id,{id:e.id,version:e.version,createTime:Wu(e.createTime)}),ma.resolve()},bf.prototype.Ls=function(t,e){return ma.resolve(this.vc.get(e))},bf.prototype.Bs=function(t,e){return this.vc.set(e.name,{name:(e=e).name,query:Tc(e.bundledQuery),readTime:Wu(e.readTime)}),ma.resolve()},bf),ef=(wf.prototype.nt=function(){return this.Sc.nt()},wf.prototype.sr=function(t,e){e=new nf(t,e);this.Sc=this.Sc.add(e),this.Cc=this.Cc.add(e)},wf.prototype.Nc=function(t,e){var n=this;t.forEach(function(t){return n.sr(t,e)})},wf.prototype.rr=function(t,e){this.Fc(new nf(t,e))},wf.prototype.Oc=function(t,e){var n=this;t.forEach(function(t){return n.rr(t,e)})},wf.prototype.kc=function(t){var e=this,n=new Ii(new mi([])),r=new nf(n,t),t=new nf(n,t+1),i=[];return this.Cc.Ae([r,t],function(t){e.Fc(t),i.push(t.key)}),i},wf.prototype.Mc=function(){var e=this;this.Sc.forEach(function(t){return e.Fc(t)})},wf.prototype.Fc=function(t){this.Sc=this.Sc.delete(t),this.Cc=this.Cc.delete(t)},wf.prototype.$c=function(t){var e=new Ii(new mi([])),n=new nf(e,t),t=new nf(e,t+1),r=_u();return this.Cc.Ae([n,t],function(t){r=r.add(t.key)}),r},wf.prototype.ki=function(t){var e=new nf(t,0),e=this.Sc.Pe(e);return null!==e&&t.isEqual(e.key)},wf),nf=(mf.Dc=function(t,e){return Ii.J(t.key,e.key)||Rr(t.Lc,e.Lc)},mf.xc=function(t,e){return Rr(t.Lc,e.Lc)||Ii.J(t.key,e.key)},mf),rf=(gf.prototype.Ri=function(t){return ma.resolve(0===this.Ho.length)},gf.prototype.Pi=function(t,e,n,r){var i=this.Bc;this.Bc++,0<this.Ho.length&&this.Ho[this.Ho.length-1];n=new hc(i,e,n,r);this.Ho.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.qc=this.qc.add(new nf(u.key,i)),this.Ti.Us(t,u.key.path.Z())}return ma.resolve(n)},gf.prototype.yi=function(t,e){return ma.resolve(this.Uc(e))},gf.prototype.Vi=function(t,e){e+=1,e=this.Qc(e),e=e<0?0:e;return ma.resolve(this.Ho.length>e?this.Ho[e]:null)},gf.prototype.pi=function(){return ma.resolve(0===this.Ho.length?-1:this.Bc-1)},gf.prototype.bi=function(t){return ma.resolve(this.Ho.slice())},gf.prototype.vi=function(t,e){var n=this,r=new nf(e,0),e=new nf(e,Number.POSITIVE_INFINITY),i=[];return this.qc.Ae([r,e],function(t){t=n.Uc(t.Lc);i.push(t)}),ma.resolve(i)},gf.prototype.Si=function(t,e){var n=this,r=new du(Rr);return e.forEach(function(t){var e=new nf(t,0),t=new nf(t,Number.POSITIVE_INFINITY);n.qc.Ae([e,t],function(t){r=r.add(t.Lc)})}),ma.resolve(this.Kc(r))},gf.prototype.Ci=function(t,e){var n=e.path,r=n.length+1,e=n;Ii.Et(e)||(e=e.child(""));var e=new nf(new Ii(e),0),i=new du(Rr);return this.qc.Re(function(t){var e=t.key.path;return!!n.st(e)&&(e.length===r&&(i=i.add(t.Lc)),!0)},e),ma.resolve(this.Kc(i))},gf.prototype.Kc=function(t){var e=this,n=[];return t.forEach(function(t){t=e.Uc(t);null!==t&&n.push(t)}),n},gf.prototype.xi=function(n,r){var i=this;Lr(0===this.Wc(r.batchId,"removed")),this.Ho.shift();var o=this.qc;return ma.forEach(r.mutations,function(t){var e=new nf(t.key,r.batchId);return o=o.delete(e),i.Ii.Fi(n,t.key)}).next(function(){i.qc=o})},gf.prototype.Ni=function(t){},gf.prototype.ki=function(t,e){var n=new nf(e,0),n=this.qc.Pe(n);return ma.resolve(e.isEqual(n&&n.key))},gf.prototype.Oi=function(t){return this.Ho.length,ma.resolve()},gf.prototype.Wc=function(t,e){return this.Qc(t)},gf.prototype.Qc=function(t){return 0===this.Ho.length?0:t-this.Ho[0].batchId},gf.prototype.Uc=function(t){t=this.Qc(t);return t<0||t>=this.Ho.length?null:this.Ho[t]},gf),of=(vf.prototype.ui=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.jc(e);return this.docs=this.docs.Ht(r,{li:e,size:i,readTime:n}),this.size+=i-o,this.Ti.Us(t,r.path.Z())},vf.prototype._i=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},vf.prototype.fi=function(t,e){e=this.docs.get(e);return ma.resolve(e?e.li:null)},vf.prototype.getEntries=function(t,e){var n=this,r=vu;return e.forEach(function(t){var e=n.docs.get(t);r=r.Ht(t,e?e.li:null)}),ma.resolve(r)},vf.prototype.Wr=function(t,e,n){for(var r=wu,i=new Ii(e.path.child("")),o=this.docs.ne(i);o.ae();){var s=o.ce(),u=s.key,a=s.value,s=a.li,a=a.readTime;if(!e.path.st(u.path))break;a.u(n)<=0||s instanceof uo&&cs(e,s)&&(r=r.Ht(s.key,s))}return ma.resolve(r)},vf.prototype.Gc=function(t,e){return ma.forEach(this.docs,function(t){return e(t)})},vf.prototype.Fr=function(t){return new sf(this)},vf.prototype.Mr=function(t){return ma.resolve(this.size)},vf),sf=(h(yf,Zh=Ee),yf.prototype.Ei=function(n){var r=this,i=[];return this.oi.forEach(function(t,e){e&&e.li?i.push(r.Gr.ui(n,e.li,r.ai(t))):r.Gr._i(t)}),ma.Ln(i)},yf.prototype.di=function(t,e){return this.Gr.fi(t,e)},yf.prototype.wi=function(t,e){return this.Gr.getEntries(t,e)},yf),uf=(df.prototype.mn=function(t,n){return this.zc.forEach(function(t,e){return n(e)}),ma.resolve()},df.prototype.Ki=function(t){return ma.resolve(this.lastRemoteSnapshotVersion)},df.prototype.Wi=function(t){return ma.resolve(this.Hc)},df.prototype.qi=function(t){return this.highestTargetId=this.Yc.next(),ma.resolve(this.highestTargetId)},df.prototype.ji=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hc&&(this.Hc=e),ma.resolve()},df.prototype.zi=function(t){this.zc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yc=new Qc(e),this.highestTargetId=e),t.sequenceNumber>this.Hc&&(this.Hc=t.sequenceNumber)},df.prototype.Gi=function(t,e){return this.zi(e),this.targetCount+=1,ma.resolve()},df.prototype.Ji=function(t,e){return this.zi(e),ma.resolve()},df.prototype.Yi=function(t,e){return this.zc.delete(e.target),this.Jc.kc(e.targetId),--this.targetCount,ma.resolve()},df.prototype.Zi=function(n,r,i){var o=this,s=0,u=[];return this.zc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.zc.delete(t),u.push(o.Xi(n,e.targetId)),s++)}),ma.Ln(u).next(function(){return s})},df.prototype.tr=function(t){return ma.resolve(this.targetCount)},df.prototype.er=function(t,e){e=this.zc.get(e)||null;return ma.resolve(e)},df.prototype.nr=function(t,e,n){return this.Jc.Nc(e,n),ma.resolve()},df.prototype.ir=function(e,t,n){this.Jc.Oc(t,n);var r=this.persistence.Ii,i=[];return r&&t.forEach(function(t){i.push(r.Fi(e,t))}),ma.Ln(i)},df.prototype.Xi=function(t,e){return this.Jc.kc(e),ma.resolve()},df.prototype.cr=function(t,e){e=this.Jc.$c(e);return ma.resolve(e)},df.prototype.ki=function(t,e){return ma.resolve(this.Jc.ki(e))},df),af=(pf.prototype.start=function(){return Promise.resolve()},pf.prototype.$o=function(){return this.ro=!1,Promise.resolve()},Object.defineProperty(pf.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),pf.prototype.yo=function(){},pf.prototype.Vo=function(){},pf.prototype.Wo=function(){return this.Ti},pf.prototype.Ko=function(t){var e=this.Xc[t.R()];return e||(e=new rf(this.Ti,this.Ii),this.Xc[t.R()]=e),e},pf.prototype.Dr=function(){return this.fo},pf.prototype.Or=function(){return this.wo},pf.prototype.jo=function(){return this.Eo},pf.prototype.runTransaction=function(t,e,n){var r=this;Ar("MemoryPersistence","Starting transaction:",t);var i=new cf(this.io.next());return this.Ii.ta(),n(i).next(function(t){return r.Ii.ea(i).next(function(){return t})}).Mn().then(function(t){return i.ps(),t})},pf.prototype.na=function(e,n){return ma.Bn(Object.values(this.Xc).map(function(t){return function(){return t.ki(e,n)}}))},pf),cf=(h(lf,$h=o),lf),hf=(ff.ra=function(t){return new ff(t)},Object.defineProperty(ff.prototype,"oa",{get:function(){if(this.ia)return this.ia;throw Or()},enumerable:!1,configurable:!0}),ff.prototype.sr=function(t,e,n){return this.sa.sr(n,e),this.oa.delete(n.toString()),ma.resolve()},ff.prototype.rr=function(t,e,n){return this.sa.rr(n,e),this.oa.add(n.toString()),ma.resolve()},ff.prototype.Fi=function(t,e){return this.oa.add(e.toString()),ma.resolve()},ff.prototype.removeTarget=function(t,e){var n=this;this.sa.kc(e.targetId).forEach(function(t){return n.oa.add(t.toString())});var r=this.persistence.Dr();return r.cr(t,e.targetId).next(function(t){t.forEach(function(t){return n.oa.add(t.toString())})}).next(function(){return r.Yi(t,e)})},ff.prototype.ta=function(){this.ia=new Set},ff.prototype.ea=function(n){var r=this,i=this.persistence.Or().Fr();return ma.forEach(this.oa,function(t){var e=Ii.ft(t);return r.ca(n,e).next(function(t){t||i._i(e)})}).next(function(){return r.ia=null,i.apply(n)})},ff.prototype.kr=function(t,e){var n=this;return this.ca(t,e).next(function(t){t?n.oa.delete(e.toString()):n.oa.add(e.toString())})},ff.prototype.Zc=function(t){return 0},ff.prototype.ca=function(t,e){var n=this;return ma.Bn([function(){return ma.resolve(n.sa.ki(e))},function(){return n.persistence.Dr().ki(t,e)},function(){return n.persistence.na(t,e)}])},ff);function ff(t){this.persistence=t,this.sa=new ef,this.ia=null}function lf(t){var e=this;return(e=$h.call(this)||this).vs=t,e}function pf(t,e){var n=this;this.Xc={},this.io=new ai(0),this.ro=!1,this.ro=!0,this.Ii=t(this),this.fo=new uf(this),this.Ti=new Dc,this.wo=(t=this.Ti,new of(t,function(t){return n.Ii.Zc(t)})),this.Kt=new lc(e),this.Eo=new tf(this.Kt)}function df(t){this.persistence=t,this.zc=new jc(vo,go),this.lastRemoteSnapshotVersion=gi.min(),this.highestTargetId=0,this.Hc=0,this.Jc=new ef,this.targetCount=0,this.Yc=Qc.Li()}function yf(t){var e=this;return(e=Zh.call(this)||this).Gr=t,e}function vf(t,e){this.Ti=t,this.jc=e,this.docs=new uu(Ii.J),this.size=0}function gf(t,e){this.Ti=t,this.Ii=e,this.Ho=[],this.Bc=1,this.qc=new du(nf.Dc)}function mf(t,e){this.key=t,this.Lc=e}function wf(){this.Sc=new du(nf.Dc),this.Cc=new du(nf.xc)}function bf(t){this.Kt=t,this.bc=new Map,this.vc=new Map}function If(t,e){return"firestore_clients_"+t+"_"+e}function _f(t,e,n){n="firestore_mutations_"+t+"_"+n;return e.A()&&(n+="_"+e.uid),n}function Ef(t,e){return"firestore_targets_"+t+"_"+e}var Tf,Nf=(Wf.aa=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Hr(r.error.code,r.error.message)),i?new Wf(t,e,r.state,o):(xr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Wf.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Wf),Sf=(Jf.aa=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Hr(n.error.code,n.error.message)),r?new Jf(t,n.state,i):(xr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Jf.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Jf),Af=(Kf.aa=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Eu,o=0;r&&o<n.activeTargetIds.length;++o)r=qi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Kf(t,i):(xr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Kf),xf=(zf.aa=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new zf(e.clientId,e.onlineState):(xr("SharedClientState","Failed to parse online state: "+t),null)},zf),Df=(Gf.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Gf.prototype.la=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Gf.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.rt(),updateTimeMs:Date.now()};return JSON.stringify(t)},Gf),kf=(Bf.Wn=function(t){return!(!t||!t.localStorage)},Bf.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.fa.Qo()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this._a&&(i=this.getItem(If(this.persistenceKey,r)))&&(o=Af.aa(r,i))&&(this.Ta=this.Ta.Ht(o.clientId,o));for(this.pa(),(s=this.storage.getItem(this.ga))&&(u=this.ba(s))&&this.va(u),a=0,c=this.Ia;a<c.length;a++)h=c[a],this.Ea(h);return this.Ia=[],this.window.addEventListener("unload",function(){return f.$o()}),this.Tr=!0,[2]}})})},Bf.prototype.q=function(t){this.setItem(this.Aa,JSON.stringify(t))},Bf.prototype.Sa=function(){return this.Da(this.Ta)},Bf.prototype.Ca=function(n){var r=!1;return this.Ta.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Bf.prototype.xa=function(t){this.Na(t,"pending")},Bf.prototype.Fa=function(t,e,n){this.Na(t,e,n),this.Oa(t)},Bf.prototype.ka=function(t){var e,n="not-current";return this.Ca(t)&&(!(e=this.storage.getItem(Ef(this.persistenceKey,t)))||(e=Sf.aa(t,e))&&(n=e.state)),this.Ma.ha(t),this.pa(),n},Bf.prototype.$a=function(t){this.Ma.la(t),this.pa()},Bf.prototype.La=function(t){return this.Ma.activeTargetIds.has(t)},Bf.prototype.Ba=function(t){this.removeItem(Ef(this.persistenceKey,t))},Bf.prototype.qa=function(t,e,n){this.Ua(t,e,n)},Bf.prototype.Qa=function(t,e,n){var r=this;e.forEach(function(t){r.Oa(t)}),this.currentUser=t,n.forEach(function(t){r.xa(t)})},Bf.prototype.Ka=function(t){this.Wa(t)},Bf.prototype.ja=function(){this.Ga()},Bf.prototype.$o=function(){this.Tr&&(this.window.removeEventListener("storage",this.wa),this.removeItem(this.ma),this.Tr=!1)},Bf.prototype.getItem=function(t){var e=this.storage.getItem(t);return Ar("SharedClientState","READ",t,e),e},Bf.prototype.setItem=function(t,e){Ar("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Bf.prototype.removeItem=function(t){Ar("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Bf.prototype.Ea=function(t){var e=this,o=t;if(o.storageArea===this.storage){if(Ar("SharedClientState","EVENT",o.key,o.newValue),o.key===this.ma)return void xr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.eo.bo(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.Tr){if(null!==o.key)if(this.Ra.test(o.key)){if(null==o.newValue)return e=this.za(o.key),[2,this.Ha(e,null)];if(e=this.Ja(o.key,o.newValue))return[2,this.Ha(e.clientId,e)]}else if(this.Pa.test(o.key)){if(null!==o.newValue&&(n=this.Ya(o.key,o.newValue)))return[2,this.Xa(n)]}else if(this.ya.test(o.key)){if(null!==o.newValue&&(r=this.Za(o.key,o.newValue)))return[2,this.tu(r)]}else if(o.key===this.ga){if(null!==o.newValue&&(i=this.ba(o.newValue)))return[2,this.va(i)]}else if(o.key===this.Aa)(i=function(t){var e=ai.U;if(null!=t)try{var n=JSON.parse(t);Lr("number"==typeof n),e=n}catch(t){xr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==ai.U&&this.$(i);else if(o.key===this.Va)return[2,this.fa.eu()]}else this.Ia.push(o);return[2]})})})}},Object.defineProperty(Bf.prototype,"Ma",{get:function(){return this.Ta.get(this._a)},enumerable:!1,configurable:!0}),Bf.prototype.pa=function(){this.setItem(this.ma,this.Ma.ua())},Bf.prototype.Na=function(t,e,n){n=new Nf(this.currentUser,t,e,n),t=_f(this.persistenceKey,this.currentUser,t);this.setItem(t,n.ua())},Bf.prototype.Oa=function(t){t=_f(this.persistenceKey,this.currentUser,t);this.removeItem(t)},Bf.prototype.Wa=function(t){t={clientId:this._a,onlineState:t};this.storage.setItem(this.ga,JSON.stringify(t))},Bf.prototype.Ua=function(t,e,n){var r=Ef(this.persistenceKey,t),n=new Sf(t,e,n);this.setItem(r,n.ua())},Bf.prototype.Ga=function(){this.setItem(this.Va,"value-not-used")},Bf.prototype.za=function(t){t=this.Ra.exec(t);return t?t[1]:null},Bf.prototype.Ja=function(t,e){t=this.za(t);return Af.aa(t,e)},Bf.prototype.Ya=function(t,e){var n=this.Pa.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return Nf.aa(new Zr(n),t,e)},Bf.prototype.Za=function(t,e){t=this.ya.exec(t),t=Number(t[1]);return Sf.aa(t,e)},Bf.prototype.ba=function(t){return xf.aa(t)},Bf.prototype.Xa=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.fa.nu(e.batchId,e.state,e.error)]:(Ar("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Bf.prototype.tu=function(t){return this.fa.su(t.targetId,t.state,t.error)},Bf.prototype.Ha=function(t,e){var n=this,r=e?this.Ta.Ht(t,e):this.Ta.remove(t),i=this.Da(this.Ta),o=this.Da(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fa.iu(s,u).then(function(){n.Ta=r})},Bf.prototype.va=function(t){this.Ta.get(t.clientId)&&this.da(t.onlineState)},Bf.prototype.Da=function(t){var n=Eu;return t.forEach(function(t,e){n=n.ye(e.activeTargetIds)}),n},Bf),Of=(Hf.prototype.xa=function(t){},Hf.prototype.Fa=function(t,e,n){},Hf.prototype.ka=function(t){return this.ru.ha(t),this.ou[t]||"not-current"},Hf.prototype.qa=function(t,e,n){this.ou[t]=e},Hf.prototype.$a=function(t){this.ru.la(t)},Hf.prototype.La=function(t){return this.ru.activeTargetIds.has(t)},Hf.prototype.Ba=function(t){delete this.ou[t]},Hf.prototype.Sa=function(){return this.ru.activeTargetIds},Hf.prototype.Ca=function(t){return this.ru.activeTargetIds.has(t)},Hf.prototype.start=function(){return this.ru=new Df,Promise.resolve()},Hf.prototype.Qa=function(t,e,n){},Hf.prototype.Ka=function(t){},Hf.prototype.$o=function(){},Hf.prototype.q=function(t){},Hf.prototype.ja=function(){},Hf),Lf=(qf.prototype.cu=function(t){},qf.prototype.$o=function(){},qf),Pf=(jf.prototype.cu=function(t){this._u.push(t)},jf.prototype.$o=function(){window.removeEventListener("online",this.au),window.removeEventListener("offline",this.hu)},jf.prototype.fu=function(){window.addEventListener("online",this.au),window.addEventListener("offline",this.hu)},jf.prototype.uu=function(){Ar("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(0)},jf.prototype.lu=function(){Ar("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(1)},jf.Wn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},jf),Cf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Rf=(Ff.prototype.Eu=function(t){this.Tu=t},Ff.prototype.Iu=function(t){this.mu=t},Ff.prototype.onMessage=function(t){this.Au=t},Ff.prototype.close=function(){this.wu()},Ff.prototype.send=function(t){this.du(t)},Ff.prototype.Ru=function(){this.Tu()},Ff.prototype.Pu=function(t){this.mu(t)},Ff.prototype.yu=function(t){this.Au(t)},Ff),Vf=(Uf.prototype.bu=function(e,t,n,r){var i=this.vu(e,t);Ar("RestConnection","Sending: ",i,n);t={};return this.Su(t,r),this.Du(e,i,t,n).then(function(t){return Ar("RestConnection","Received: ",t),t},function(t){throw Dr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Uf.prototype.Cu=function(t,e,n,r){return this.bu(t,e,n,r)},Uf.prototype.Su=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.4-2021019222814",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},Uf.prototype.vu=function(t,e){t=Cf[t];return this.Vu+"/v1/"+e+":"+t},h(Mf,Tf=Uf),Mf.prototype.Du=function(o,e,s,u){return new Promise(function(n,r){var i=new Er;i.listenOnce(mr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case gr.NO_ERROR:var t=i.getResponseJson();Ar("Connection","XHR received:",JSON.stringify(t)),n(t);break;case gr.TIMEOUT:Ar("Connection",'RPC "'+o+'" timed out'),r(new Hr(qr.DEADLINE_EXCEEDED,"Request time out"));break;case gr.HTTP_ERROR:var e=i.getStatus();Ar("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(qr).indexOf(e)?e:qr.UNKNOWN,r(new Hr(e,t.message))):r(new Hr(qr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Hr(qr.UNAVAILABLE,"Connection failed."));break;default:Or()}}finally{Ar("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Mf.prototype.xu=function(t,e){var n,r=[this.Vu,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new fr,o=vr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.I};this.Su(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Ar("Connection","Creating WebChannel: "+r,t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new Rf({du:function(t){a?Ar("Connection","Not sending because WebChannel is closed:",t):(u||(Ar("Connection","Opening WebChannel transport."),s.open(),u=!0),Ar("Connection","WebChannel sending:",t),s.send(t))},wu:function(){return s.close()}}),t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(s,_r.EventType.OPEN,function(){a||Ar("Connection","WebChannel transport opened.")}),t(s,_r.EventType.CLOSE,function(){a||(a=!0,Ar("Connection","WebChannel transport closed"),c.Pu())}),t(s,_r.EventType.ERROR,function(t){a||(a=!0,Dr("Connection","WebChannel transport errored:",t),c.Pu(new Hr(qr.UNAVAILABLE,"The operation could not be completed")))}),t(s,_r.EventType.MESSAGE,function(t){var e,n,r,i;a||(Lr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Ar("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=$s[r];if(void 0!==t)return su(t)}(),i=n.message,void 0===t&&(t=qr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.Pu(new Hr(t,i)),s.close()):(Ar("Connection","WebChannel received:",e),c.yu(e)))}),t(o,wr.STAT_EVENT,function(t){t.stat===br?Ar("Connection","Detected buffering proxy"):t.stat===Ir&&Ar("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Ru()},0),c},Mf);function Mf(t){var e=this;return(e=Tf.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.I=t.I,e}function Uf(t){this.gu=t,this.T=t.T;var e=t.ssl?"https":"http";this.Vu=e+"://"+t.host,this.pu="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}function Ff(t){this.du=t.du,this.wu=t.wu}function jf(){var t=this;this.au=function(){return t.uu()},this.hu=function(){return t.lu()},this._u=[],this.fu()}function qf(){}function Hf(){this.ru=new Df,this.ou={},this.da=null,this.$=null}function Bf(t,e,n,r,i){this.window=t,this.eo=e,this.persistenceKey=n,this._a=r,this.fa=null,this.da=null,this.$=null,this.wa=this.Ea.bind(this),this.Ta=new uu(Rr),this.Tr=!1,this.Ia=[];n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ma=If(this.persistenceKey,this._a),this.Aa="firestore_sequence_number_"+this.persistenceKey,this.Ta=this.Ta.Ht(this._a,new Df),this.Ra=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Pa=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.ya=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.ga="firestore_online_state_"+this.persistenceKey,this.Va="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.wa)}function Gf(){this.activeTargetIds=Eu}function zf(t,e){this.clientId=t,this.onlineState=e}function Kf(t,e){this.clientId=t,this.activeTargetIds=e}function Jf(t,e,n){this.targetId=t,this.state=e,this.error=n}function Wf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Xf(){return"undefined"!=typeof window?window:null}function Yf(){return"undefined"!=typeof document?document:null}function Qf(t){return new zu(t,!0)}function $f(t,e,n,r,i){var o=this;this.Sh=t,this.Dh=e,this.fs=n,this.Ch={},this.xh=[],this.Nh=new Map,this.Fh=new Set,this.Oh=[],this.kh=i,this.kh.cu(function(t){n.ys(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Il(this)?(Ar("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Fh.add(4),[4,dl(e)];case 1:return t.sent(),e.Mh.set("Unknown"),e.Fh.delete(4),[4,pl(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Mh=new sl(n,r)}var Zf,tl,el,nl=(ll.prototype.reset=function(){this.ku=0},ll.prototype.Lu=function(){this.ku=this.Ou},ll.prototype.Bu=function(t){var e=this;this.cancel();var n=Math.floor(this.ku+this.qu()),r=Math.max(0,Date.now()-this.$u),i=Math.max(0,n-r);0<i&&Ar("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ku+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Mu=this.eo.Ir(this.ds,i,function(){return e.$u=Date.now(),t()}),this.ku*=this.Fu,this.ku<this.Nu&&(this.ku=this.Nu),this.ku>this.Ou&&(this.ku=this.Ou)},ll.prototype.Uu=function(){null!==this.Mu&&(this.Mu.Ps(),this.Mu=null)},ll.prototype.cancel=function(){null!==this.Mu&&(this.Mu.cancel(),this.Mu=null)},ll.prototype.qu=function(){return(Math.random()-.5)*this.ku},ll),Ee=(fl.prototype.Hu=function(){return 1===this.state||2===this.state||4===this.state},fl.prototype.Ju=function(){return 2===this.state},fl.prototype.start=function(){3!==this.state?this.auth():this.Yu()},fl.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},fl.prototype.Xu=function(){this.state=0,this.zu.reset()},fl.prototype.Zu=function(){var t=this;this.Ju()&&null===this.Gu&&(this.Gu=this.eo.Ir(this.Qu,6e4,function(){return t.th()}))},fl.prototype.eh=function(t){this.nh(),this.stream.send(t)},fl.prototype.th=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Ju()?[2,this.close(0)]:[2]})})},fl.prototype.nh=function(){this.Gu&&(this.Gu.cancel(),this.Gu=null)},fl.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.nh(),this.zu.cancel(),this.ju++,3!==e?this.zu.reset():n&&n.code===qr.RESOURCE_EXHAUSTED?(xr(n.toString()),xr("Using maximum backoff delay to prevent overloading the backend."),this.zu.Lu()):n&&n.code===qr.UNAUTHENTICATED&&this.Wu.v(),null!==this.stream&&(this.sh(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Iu(n)];case 1:return t.sent(),[2]}})})},fl.prototype.sh=function(){},fl.prototype.auth=function(){var n=this;this.state=1;var t=this.ih(this.ju),e=this.ju;this.Wu.getToken().then(function(t){n.ju===e&&n.rh(t)},function(e){t(function(){var t=new Hr(qr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.oh(t)})})},fl.prototype.rh=function(t){var e=this,n=this.ih(this.ju);this.stream=this.ah(t),this.stream.Eu(function(){n(function(){return e.state=2,e.listener.Eu()})}),this.stream.Iu(function(t){n(function(){return e.oh(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},fl.prototype.Yu=function(){var t=this;this.state=4,this.zu.Bu(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},fl.prototype.oh=function(t){return Ar("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},fl.prototype.ih=function(e){var n=this;return function(t){n.eo.ys(function(){return n.ju===e?t():(Ar("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},fl),rl=(h(hl,el=Ee),hl.prototype.ah=function(t){return this.Ku.xu("Listen",t)},hl.prototype.onMessage=function(t){this.zu.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Or(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.qt?(Lr(void 0===s||"string"==typeof s),Ur.fromBase64String(s||"")):(Lr(void 0===s||s instanceof Uint8Array),Ur.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?qr.UNKNOWN:su(c.code),new Hr(a,c.message||"")),s=new Ou(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=$u(t,n.document.name),i=Wu(n.document.updateTime);var u=new to({mapValue:{fields:n.document.fields}}),a=(o=new uo(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[];s=new Du(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=$u(t,n.document),i=n.readTime?Wu(n.readTime):gi.min(),u=new ao(r,i),o=n.removedTargetIds||[],s=new Du([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=$u(t,n.document),i=n.removedTargetIds||[],s=new Du([],i,r,null);else{if(!("filter"in e))return Or();e.filter;e=e.filter;e.targetId,n=e.count||0,r=new Qs(n),i=e.targetId,s=new ku(i,r)}return s}(this.Kt,t),t=function(t){if(!("targetChange"in t))return gi.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?Wu(t.readTime):gi.min()}(t);return this.listener.uh(e,t)},hl.prototype.hh=function(t){var e,n,r,i={};i.database=ea(this.Kt),i.addTarget=(e=this.Kt,(r=mo(r=(n=t).target)?{documents:ua(e,r)}:{query:aa(e,r)}).targetId=n.targetId,0<n.resumeToken.o()?r.resumeToken=Ju(e,n.resumeToken):0<n.Mt.u(gi.min())&&(r.readTime=Ku(e,n.Mt.G())),r);var o,t=(this.Kt,o=t,null==(t=function(){switch(o.kt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Or()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.eh(i)},hl.prototype.lh=function(t){var e={};e.database=ea(this.Kt),e.removeTarget=t,this.eh(e)},hl),il=(h(cl,tl=Ee),Object.defineProperty(cl.prototype,"fh",{get:function(){return this._h},enumerable:!1,configurable:!0}),cl.prototype.start=function(){this._h=!1,this.lastStreamToken=void 0,tl.prototype.start.call(this)},cl.prototype.sh=function(){this._h&&this.dh([])},cl.prototype.ah=function(t){return this.Ku.xu("Write",t)},cl.prototype.onMessage=function(t){if(Lr(!!t.streamToken),this.lastStreamToken=t.streamToken,this._h){this.zu.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Lr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?Wu(t.updateTime):Wu(e);n.isEqual(gi.min())&&(n=Wu(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Ps(n,e)}(t,r)})):[]),n=Wu(t.commitTime);return this.listener.wh(n,e)}var n,r;return Lr(!t.writeResults||0===t.writeResults.length),this._h=!0,this.listener.Eh()},cl.prototype.Th=function(){var t={};t.database=ea(this.Kt),this.eh(t)},cl.prototype.dh=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return oa(e.Kt,t)})};this.eh(t)},cl),ol=(h(al,Zf=function(){}),al.prototype.mh=function(){if(this.Ih)throw new Hr(qr.FAILED_PRECONDITION,"The client has already been terminated.")},al.prototype.bu=function(e,n,r){var i=this;return this.mh(),this.credentials.getToken().then(function(t){return i.Ku.bu(e,n,r,t)}).catch(function(t){throw t.code===qr.UNAUTHENTICATED&&i.credentials.v(),t})},al.prototype.Cu=function(e,n,r){var i=this;return this.mh(),this.credentials.getToken().then(function(t){return i.Ku.Cu(e,n,r,t)}).catch(function(t){throw t.code===qr.UNAUTHENTICATED&&i.credentials.v(),t})},al.prototype.terminate=function(){this.Ih=!1},al),sl=(ul.prototype.yh=function(){var t=this;0===this.Ah&&(this.gh("Unknown"),this.Rh=this.fs.Ir("online_state_timeout",1e4,function(){return t.Rh=null,t.Vh("Backend didn't respond within 10 seconds."),t.gh("Offline"),Promise.resolve()}))},ul.prototype.ph=function(t){"Online"===this.state?this.gh("Unknown"):(this.Ah++,1<=this.Ah&&(this.bh(),this.Vh("Connection failed 1 times. Most recent error: "+t.toString()),this.gh("Offline")))},ul.prototype.set=function(t){this.bh(),this.Ah=0,"Online"===t&&(this.Ph=!1),this.gh(t)},ul.prototype.gh=function(t){t!==this.state&&(this.state=t,this.da(t))},ul.prototype.Vh=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ph?(xr(t),this.Ph=!1):Ar("OnlineStateTracker",t)},ul.prototype.bh=function(){null!==this.Rh&&(this.Rh.cancel(),this.Rh=null)},ul);function ul(t,e){this.fs=t,this.da=e,this.state="Unknown",this.Ah=0,this.Rh=null,this.Ph=!0}function al(t,e,n){var r=this;return(r=Zf.call(this)||this).credentials=t,r.Ku=e,r.Kt=n,r.Ih=!1,r}function cl(t,e,n,r,i){var o=this;return(o=tl.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).Kt=r,o._h=!1,o}function hl(t,e,n,r,i){var o=this;return(o=el.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).Kt=r,o}function fl(t,e,n,r,i,o){this.eo=t,this.Qu=n,this.Ku=r,this.Wu=i,this.listener=o,this.state=0,this.ju=0,this.Gu=null,this.stream=null,this.zu=new nl(t,e)}function ll(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.eo=t,this.ds=e,this.Nu=n,this.Fu=r,this.Ou=i,this.ku=0,this.Mu=null,this.$u=Date.now(),this.reset()}function pl(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Il(r))return[3,4];e=0,n=r.Oh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function dl(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Oh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function yl(t,e){t.Nh.has(e.targetId)||(t.Nh.set(e.targetId,e),bl(t)?wl(t):kl(t).Ju()&&gl(t,e))}function vl(t,e){var n=t,t=kl(n);n.Nh.delete(e),t.Ju()&&ml(n,e),0===n.Nh.size&&(t.Ju()?t.Zu():Il(n)&&n.Mh.set("Unknown"))}function gl(t,e){t.$h.cn(e.targetId),kl(t).hh(e)}function ml(t,e){t.$h.cn(e),kl(t).lh(e)}function wl(e){e.$h=new Pu({Sn:function(t){return e.Ch.Sn(t)},Dn:function(t){return e.Nh.get(t)||null}}),kl(e).start(),e.Mh.yh()}function bl(t){return Il(t)&&!kl(t).Hu()&&0<t.Nh.size}function Il(t){return 0===t.Fh.size}function _l(t){t.$h=void 0}function El(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Mh.set("Online"),!(u instanceof Ou&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Nh.has(i)?[4,o.Ch.Lh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Nh.delete(i),o.$h.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Ar("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Tl(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Du?s.$h.wn(u):u instanceof ku?s.$h.yn(u):s.$h.In(u),a.isEqual(gi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Bh(s.Sh)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).$h.pn(i)).Oe.forEach(function(t,e){var n;0<t.resumeToken.o()&&((n=r.Nh.get(e))&&r.Nh.set(e,n.Lt(t.resumeToken,i)))}),e.ke.forEach(function(t){var e=r.Nh.get(t);e&&(r.Nh.set(t,e.Lt(Ur.h,e.Mt)),ml(r,t),e=new fs(e.target,t,1,e.sequenceNumber),gl(r,e))}),r.Ch.Bh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Ar("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Tl(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function Tl(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!xa(r))throw r;return n.Fh.add(1),[4,dl(n)];case 1:return t.sent(),n.Mh.set("Offline"),i=i||function(){return Bh(n.Sh)},n.fs.bo(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Ar("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Fh.delete(1),[4,pl(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Nl(e,n){return n().catch(function(t){return Tl(e,t,n)})}function Sl(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Ol(i=a),s=0<i.xh.length?i.xh[i.xh.length-1].batchId:-1,t.label=1;case 1:if(!(Il(i)&&i.xh.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Sh,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.Ho.Vi(t,n)}))];case 3:return null===(u=t.sent())?(0===i.xh.length&&o.Zu(),[3,7]):(s=u.batchId,function(t,e){t.xh.push(e);t=Ol(t);t.Ju()&&t.fh&&t.dh(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,Tl(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Al(i)&&xl(i),[2]}var e,n,r})})}function Al(t){return Il(t)&&!Ol(t).Hu()&&0<t.xh.length}function xl(t){Ol(t).start()}function Dl(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Fh.delete(2),[4,pl(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Fh.add(2),[4,dl(e)]);case 3:t.sent(),e.Mh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function kl(n){var t,e,r,i=this;return n.Qh||(n.Qh=(t=n.Dh,e=n.fs,r={Eu:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Nh.forEach(function(t,e){gl(n,t)}),[2]})})}.bind(null,n),Iu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return _l(e),bl(e)?(e.Mh.ph(n),wl(e)):e.Mh.set("Unknown"),[2]})})}.bind(null,n),uh:El.bind(null,n)},t.mh(),new rl(e,t.Ku,t.credentials,t.Kt,r)),n.Oh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Qh.Xu(),bl(n)?wl(n):n.Mh.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Qh.stop()];case 2:t.sent(),_l(n),t.label=3;case 3:return[2]}})})})),n.Qh}function Ol(n){var t,e,r,i=this;return n.Kh||(n.Kh=(t=n.Dh,e=n.fs,r={Eu:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Ol(e).Th(),[2]})})}.bind(null,n),Iu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Ol(e).fh?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return ou(n=i.code)&&n!==qr.ABORTED?(e=r.xh.shift(),Ol(r).Xu(),[4,Nl(r,function(){return r.Ch.Uh(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Sl(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Al(e)&&xl(e),[2]}})})}.bind(null,n),Eh:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Ol(o),n=0,r=o.xh;n<r.length;n++)i=r[n],e.dh(i.mutations);return[2]})})}.bind(null,n),wh:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.xh.shift(),n=fc.from(e,i,o),[4,Nl(r,function(){return r.Ch.qh(n)})];case 1:return t.sent(),[4,Sl(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.mh(),new il(e,t.Ku,t.credentials,t.Kt,r)),n.Oh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Kh.Xu(),[4,Sl(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Kh.stop()];case 3:t.sent(),0<n.xh.length&&(Ar("RemoteStore","Stopping write stream with "+n.xh.length+" pending writes"),n.xh=[]),t.label=4;case 4:return[2]}})})})),n.Kh}function Ll(){this.queries=new jc(us,ss),this.onlineState="Unknown",this.jh=new Set}var Pl=function(){this.Wh=void 0,this.listeners=[]};function Cl(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Pl),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Gh(n)];case 2:return o.Wh=t.sent(),[3,4];case 3:return o=t.sent(),o=Va(o,"Initialization of query '"+as(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.zh(e.onlineState),i.Wh&&u.Hh(i.Wh)&&Vl(e),[2]}})})}function Rl(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Jh(n))]:[2]})})}function Vl(t){t.jh.forEach(function(t){t.next()})}var Ml=(Gl.prototype.Hh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Su(t.query,t.docs,t.De,e,t.Ce,t.fromCache,t.xe,!0)}var o=!1;return this.Xh?this.tl(t)&&(this.Yh.next(t),o=!0):this.el(t,this.onlineState)&&(this.nl(t),o=!0),this.Zh=t,o},Gl.prototype.onError=function(t){this.Yh.error(t)},Gl.prototype.zh=function(t){this.onlineState=t;var e=!1;return this.Zh&&!this.Xh&&this.el(this.Zh,t)&&(this.nl(this.Zh),e=!0),e},Gl.prototype.el=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.sl&&n||t.docs.nt()&&"Offline"!==e)},Gl.prototype.tl=function(t){if(0<t.docChanges.length)return!0;var e=this.Zh&&this.Zh.hasPendingWrites!==t.hasPendingWrites;return!(!t.xe&&!e)&&!0===this.options.includeMetadataChanges},Gl.prototype.nl=function(t){t=Su.Fe(t.query,t.docs,t.Ce,t.fromCache),this.Xh=!0,this.Yh.next(t)},Gl),Ul=(Bl.prototype.il=function(){return"metadata"in this.payload},Bl),Fl=(Hl.prototype.yc=function(t){return $u(this.Kt,t)},Hl.prototype.gc=function(t){return t.metadata.exists?ia(this.Kt,t.document,!1):new ao(this.yc(t.metadata.name),this.Vc(t.metadata.readTime))},Hl.prototype.Vc=Wu,Hl),jl=(ql.prototype.ol=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},ql.prototype.cl=function(t){for(var e=new Map,n=new Fl(this.Kt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.yc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||_u()).add(s);e.set(c,h)}}return e},ql.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,l,p,d){return y(this,void 0,void 0,function(){var n,r,i,o,e,s,u,a,c,h;return v(this,function(t){switch(t.label){case 0:for(n=f,r=_u(),i=vu,o=bu,e=0,s=p;e<s.length;e++)u=s[e],a=l.yc(u.metadata.name),u.document&&(r=r.add(a)),i=i.Ht(a,l.gc(u)),o=o.Ht(a,l.Vc(u.metadata.readTime));return c=n.Tc.Fr({jr:!0}),[4,Kh(n,is(Qo(mi.ct("__bundle__/docs/"+d))))];case 1:return h=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return zh(e,c,i,gi.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n.fo.Xi(e,h.targetId).next(function(){return n.fo.nr(e,r,h.targetId)}).next(function(){return n.Ic.tc(e,t)})})})]}})})}(this.Sh,new Fl(this.Kt),this.documents,this.rl.id)];case 1:e=t.sent(),n=this.cl(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=_u()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,Kh(e,is(Tc(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=Wu(i.readTime);if(0<=n.Mt.u(e))return r.Eo.Bs(t,i);e=n.Lt(Ur.h,e);return r.dc=r.dc.Ht(e.targetId,e),r.fo.Ji(t,e).next(function(){return r.fo.Xi(t,n.targetId)}).next(function(){return r.fo.nr(t,o,n.targetId)}).next(function(){return r.Eo.Bs(t,i)})})]}})})}(this.Sh,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Oh(Object.assign({},this.progress),e))]}})})},ql);function ql(t,e,n){this.rl=t,this.Sh=e,this.Kt=n,this.queries=[],this.documents=[],this.progress=zl(t)}function Hl(t){this.Kt=t}function Bl(t,e){this.payload=t,this.byteLength=e}function Gl(t,e,n){this.query=t,this.Yh=e,this.Xh=!1,this.Zh=null,this.onlineState="Unknown",this.options=n||{}}function zl(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Kl=function(t){this.key=t},Jl=function(t){this.key=t},Wl=(Object.defineProperty(Zl.prototype,"fl",{get:function(){return this.al},enumerable:!1,configurable:!0}),Zl.prototype.dl=function(t,e){var s=this,u=e?e.wl:new Nu,a=(e||this)._l,c=(e||this).Ce,h=a,f=!1,l=$o(this.query)&&a.size===this.query.limit?a.last():null,p=Zo(this.query)&&a.size===this.query.limit?a.first():null;if(t.Zt(function(t,e){var n=a.get(t),r=(r=e instanceof uo?e:null)&&(cs(s.query,r)?r:null),i=!!n&&s.Ce.has(n.key),o=!!r&&(r.bt||s.Ce.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.El(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.ll(r,l)||p&&s.ll(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),$o(this.query)||Zo(this.query))for(;h.size>this.query.limit;){var n=$o(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{_l:h,wl:u,_c:f,Ce:c}},Zl.prototype.El=function(t,e){return t.bt&&e.hasCommittedMutations&&!e.bt},Zl.prototype.Ei=function(t,e,n){var o=this,r=this._l;this._l=t._l,this.Ce=t.Ce;var i=t.wl.Se();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.ll(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Or()}}var r,i}),this.Tl(n);var s=e?this.Il():[],n=0===this.hl.size&&this.qe?1:0,e=n!==this.ul;return this.ul=n,0!==i.length||e?{snapshot:new Su(this.query,t._l,r,i,t.Ce,0==n,e,!1),ml:s}:{ml:s}},Zl.prototype.zh=function(t){return this.qe&&"Offline"===t?(this.qe=!1,this.Ei({_l:this._l,wl:new Nu,Ce:this.Ce,_c:!1},!1)):{ml:[]}},Zl.prototype.Al=function(t){return!this.al.has(t)&&!!this._l.has(t)&&!this._l.get(t).bt},Zl.prototype.Tl=function(t){var e=this;t&&(t.Ue.forEach(function(t){return e.al=e.al.add(t)}),t.Qe.forEach(function(t){}),t.Ke.forEach(function(t){return e.al=e.al.delete(t)}),this.qe=t.qe)},Zl.prototype.Il=function(){var e=this;if(!this.qe)return[];var n=this.hl;this.hl=_u(),this._l.forEach(function(t){e.Al(t.key)&&(e.hl=e.hl.add(t.key))});var r=[];return n.forEach(function(t){e.hl.has(t)||r.push(new Jl(t))}),this.hl.forEach(function(t){n.has(t)||r.push(new Kl(t))}),r},Zl.prototype.Rl=function(t){this.al=t.Pc,this.hl=_u();t=this.dl(t.documents);return this.Ei(t,!0)},Zl.prototype.Pl=function(){return Su.Fe(this.query,this._l,this.Ce,0===this.ul)},Zl),Xl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Yl=function(t){this.key=t,this.yl=!1},Ql=(Object.defineProperty($l.prototype,"Ll",{get:function(){return!0===this.$l},enumerable:!1,configurable:!0}),$l);function $l(t,e,n,r,i,o){this.Sh=t,this.gl=e,this.Vl=n,this.pl=r,this.currentUser=i,this.bl=o,this.vl={},this.Sl=new jc(us,ss),this.Dl=new Map,this.Cl=[],this.xl=new uu(Ii.J),this.Nl=new Map,this.Fl=new ef,this.Ol={},this.kl=new Map,this.Ml=Qc.Bi(),this.onlineState="Unknown",this.$l=void 0}function Zl(t,e){this.query=t,this.al=e,this.ul=null,this.qe=!1,this.hl=_u(),this.Ce=_u(),this.ll=hs(t),this._l=new Tu(this.ll)}function tp(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Bl=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.dl(o))._c?[4,Wh(r.Sh,i.query,!1).then(function(t){t=t.documents;return i.view.dl(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Oe.get(i.targetId),n=i.view.Ei(e,r.Ll,n),[2,(hp(r,i.targetId,n.ml),n.snapshot)]}})})}(i,t,e,n)},[4,Wh(i.Sh,o,!0)];case 1:return n=t.sent(),r=new Wl(o,n.Pc),e=r.dl(n.documents),n=xu.Be(s,u&&"Offline"!==i.onlineState),n=r.Ei(e,i.Ll,n),hp(i,s,n.ml),r=new Xl(o,s,r),[2,(i.Sl.set(o,r),i.Dl.has(s)?i.Dl.get(s).push(o):i.Dl.set(s,[o]),n.snapshot)]}})})}function ep(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=wp(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Sh,a=p,h=i,f=vi.now(),o=a.reduce(function(t,e){return t.add(e.key)},_u()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Ic.Zo(u,o).next(function(t){c=t;for(var e,n=[],r=0,i=a;r<i.length;r++){var o=i[r],s=(e=o,s=c.get(o.key),function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof uo?e.field(o.field):void 0,s=vs(o.transform,s||null);null!=s&&(n=(null==n?new eo:n).set(o.field,s))}return n?n.yt():null}(e.fieldTransforms,s));null!=s&&n.push(new Gs(o.key,s,function s(t){var u=[];return Di(t.fields||{},function(t,e){var n=new bi([t]);if(Zi(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Oi(u)}(s.proto.mapValue),Rs.exists(!0)))}return h.Ho.Pi(u,f,n,a)})}).then(function(t){var e=t.Ns(c);return{batchId:t.batchId,oi:e}}))];case 2:return s=t.sent(),u.pl.xa(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.Ol[e.currentUser.R()])||new uu(Rr)).Ht(n,r),e.Ol[e.currentUser.R()]=i,[4,lp(u,s.oi)];case 3:return t.sent(),[4,Sl(u.gl)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Va(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}function np(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Gh(n.Sh,i)];case 2:return e=t.sent(),i.Oe.forEach(function(t,e){e=n.Nl.get(e);e&&(Lr(t.Ue.size+t.Qe.size+t.Ke.size<=1),0<t.Ue.size?e.yl=!0:0<t.Qe.size?Lr(e.yl):0<t.Ke.size&&(Lr(e.yl),e.yl=!1))}),[4,lp(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Fc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function rp(t,n,e){var r,t=t;(t.Ll&&0===e||!t.Ll&&1===e)&&(r=[],t.Sl.forEach(function(t,e){e=e.view.zh(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].zh(i)&&(o=!0)}),o&&Vl(t)}(t.Vl,n),r.length&&t.vl.uh(r),t.onlineState=n,t.Ll&&t.pl.Ka(n))}function ip(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Sh,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Ho.yi(e,r).next(function(t){return Lr(null!==t),n=t.keys(),i.Ho.xi(e,t)}).next(function(){return i.Ho.Oi(e)}).next(function(){return i.Ic.Zo(e,n)})}))];case 2:return o=t.sent(),up(n,u,a),sp(n,u),n.pl.Fa(u,"rejected",a),[4,lp(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Fc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}function op(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Il((n=o).gl)||Ar("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Sh).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ho.pi(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.kl.get(r)||[]).push(s),n.kl.set(r,i),[3,4]);case 3:return i=t.sent(),i=Va(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function sp(t,e){(t.kl.get(e)||[]).forEach(function(t){t.resolve()}),t.kl.delete(e)}function up(t,e,n){var r=t,i=r.Ol[r.currentUser.R()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Ol[r.currentUser.R()]=i)}function ap(e,t,n){void 0===n&&(n=null),e.pl.$a(t);for(var r=0,i=e.Dl.get(t);r<i.length;r++){var o=i[r];e.Sl.delete(o),n&&e.vl.ql(o,n)}e.Dl.delete(t),e.Ll&&e.Fl.kc(t).forEach(function(t){e.Fl.ki(t)||cp(e,t)})}function cp(t,e){var n=t.xl.get(e);null!==n&&(vl(t.gl,n),t.xl=t.xl.remove(e),t.Nl.delete(n),fp(t))}function hp(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Kl?(t.Fl.sr(o.key,e),function(t,e){e=e.key;t.xl.get(e)||(Ar("SyncEngine","New document in limbo: "+e),t.Cl.push(e),fp(t))}(t,o)):o instanceof Jl?(Ar("SyncEngine","Document no longer in limbo: "+o.key),t.Fl.rr(o.key,e),t.Fl.ki(o.key)||cp(t,o.key)):Or()}}function fp(t){for(;0<t.Cl.length&&t.xl.size<t.bl;){var e=t.Cl.shift(),n=t.Ml.next();t.Nl.set(n,new Yl(e)),t.xl=t.xl.Ht(e,n),yl(t.gl,new fs(is(Qo(e.path)),n,2,ai.U))}}function lp(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Sl.nt()?[3,3]:(n.Sl.forEach(function(t,e){o.push(n.Bl(e,s,u).then(function(t){t&&(n.Ll&&n.pl.qa(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Ph.cc(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.vl.uh(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ma.forEach(c,function(e){return ma.forEach(e.rc,function(t){return r.persistence.Ii.sr(n,e.targetId,t)}).next(function(){return ma.forEach(e.oc,function(t){return r.persistence.Ii.rr(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!xa(e=t.sent()))throw e;return Ar("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.dc.get(o),u=s.Mt,u=s.Bt(u),r.dc=r.dc.Ht(o,u));return[2]}})})}(n.Sh,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function pp(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Ar("SyncEngine","User change. New user:",o.R()),[4,qh(n.Sh,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).kl.forEach(function(t){t.forEach(function(t){t.reject(new Hr(qr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.kl.clear(),n.pl.Qa(o,r.Ac,r.Rc),[4,lp(n,r.mc)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function dp(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Sh,n=a,i=(r=e).Ho,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.gi(e,n).next(function(t){return t?r.Ic.Zo(e,t):ma.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,Sl(o.gl)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(up(o,a,h||null),sp(o,a),o.Sh.Ho.Ni(a)):Or(),t.label=4;case 4:return[4,lp(o,s)];case 5:return t.sent(),[3,7];case 6:Ar("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function yp(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return mp(r=h),wp(r),!0!==f||!0===r.$l?[3,3]:(e=r.pl.Sa(),[4,vp(r,e.rt())]);case 1:return i=t.sent(),r.$l=!0,[4,Dl(r.gl,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],yl(r.gl,u);return[3,7];case 3:return!1!==f||!1===r.$l?[3,7]:(a=[],c=Promise.resolve(),r.Dl.forEach(function(t,e){r.pl.La(e)?a.push(e):c=c.then(function(){return ap(r,e),Jh(r.Sh,e,!0)}),vl(r.gl,e)}),[4,c]);case 4:return t.sent(),[4,vp(r,a)];case 5:return t.sent(),(n=r).Nl.forEach(function(t,e){vl(n.gl,e)}),n.Fl.Mc(),n.Nl=new Map,n.xl=new uu(Ii.J),r.$l=!1,[4,Dl(r.gl,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function vp(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.Dl.get(s))&&0!==a.length?[4,Kh(e.Sh,is(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Sl.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Wh((e=r).Sh,i.query,!0)];case 1:return n=t.sent(),n=i.view.Rl(n),[2,(e.Ll&&hp(e,i.targetId,n.ml),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Xh(e.Sh,s)];case 8:return l=t.sent(),[4,Kh(e.Sh,l)];case 9:return u=t.sent(),[4,tp(e,gp(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.vl.uh(r),n)]}})})}function gp(t){return Yo(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function mp(t){return t.gl.Ch.Bh=np.bind(null,t),t.gl.Ch.Sn=function(t,e){var n=t;if((t=n.Nl.get(e))&&t.yl)return _u().add(t.key);var r=_u();if(!(e=n.Dl.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Sl.get(s),r=r.ye(s.view.fl);return r}.bind(null,t),t.gl.Ch.Lh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).pl.qa(s,"rejected",u),i=e.Nl.get(s),(n=i&&i.key)?(r=(r=new uu(Ii.J)).Ht(n,new ao(n,gi.min())),i=_u().add(n),i=new Au(gi.min(),new Map,new du(Rr),r,i),[4,np(e,i)]):[3,2];case 1:return t.sent(),e.xl=e.xl.remove(n),e.Nl.delete(s),fp(e),[3,4];case 2:return[4,Jh(e.Sh,s,!1).then(function(){return ap(e,s,u)}).catch(Fc)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.vl.uh=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Hh(s)&&(r=!0);u.Wh=s}}r&&Vl(n)}.bind(null,t.Vl),t.vl.ql=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.Vl),t}function wp(t){return t.gl.Ch.qh=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Hh(e.Sh,o)];case 2:return r=t.sent(),up(e,n,null),sp(e,n),e.pl.Fa(n,"acknowledged"),[4,lp(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Fc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,t),t.gl.Ch.Uh=ip.bind(null,t),t}function bp(t,e,n){var r=t;(function(l,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=l.Sh,o=r,s=Wu((i=u).createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.Eo.Ms(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.u(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.Ul({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.Ql(zl(u)),a=new jl(u,l.Sh,p.Kt),[4,p.Kl()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.ol(c)]:[3,10];case 7:return(h=t.sent())&&d.Ql(h),[4,p.Kl()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return f=t.sent(),[4,lp(l,f.zo,void 0)];case 12:return t.sent(),[4,(r=l.Sh,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.Eo.$s(t,e)}))];case 13:return t.sent(),d.Ul(f.progress),[3,15];case 14:return Dr("SyncEngine","Loading bundle failed with "+(f=t.sent())),d.Wl(f),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.pl.ja()})}var Ip,_p,Ep=(kp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Kt=Qf(e.gu.T),this.pl=this.jl(e),this.persistence=this.Gl(e),[4,this.persistence.start()];case 1:return t.sent(),this.zl=this.Hl(e),this.Sh=this.Jl(e),[2]}})})},kp.prototype.Hl=function(t){return null},kp.prototype.Jl=function(t){return jh(this.persistence,new Ch,t.Yl,this.Kt)},kp.prototype.Gl=function(t){return new af(hf.ra,this.Kt)},kp.prototype.jl=function(t){return new Of},kp.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.pl.$o()];case 1:return t.sent(),[4,this.persistence.$o()];case 2:return t.sent(),[2]}})})},kp),Tp=(h(Dp,_p=Ep),Dp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,_p.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,Qh(this.Sh)];case 2:return t.sent(),[4,this.Xl.initialize(this,e)];case 3:return t.sent(),[4,wp(this.Xl.fa)];case 4:return t.sent(),[4,Sl(this.Xl.gl)];case 5:return t.sent(),[2]}})})},Dp.prototype.Jl=function(t){return jh(this.persistence,new Ch,t.Yl,this.Kt)},Dp.prototype.Hl=function(t){var e=this.persistence.Ii._r;return new sh(e,t.fs)},Dp.prototype.Gl=function(t){var e=kh(t.gu.T,t.gu.persistenceKey),n=void 0!==this.cacheSizeBytes?Mc.Xs(this.cacheSizeBytes):Mc.ei;return new Sh(this.synchronizeTabs,e,t.clientId,n,t.fs,Xf(),Yf(),this.Kt,this.pl,!!this.forceOwnership)},Dp.prototype.jl=function(t){return new Of},Dp),Np=(h(xp,Ip=Tp),xp.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,Ip.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Xl.fa,this.pl instanceof kf?(this.pl.fa={nu:dp.bind(null,e),su:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).$l?(Ar("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.Dl.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Yh(e.Sh)];case 3:return n=t.sent(),r=Au.Le(o,"current"===s),[4,lp(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,Jh(e.Sh,o,!0)];case 6:return t.sent(),ap(e,o,u),[3,8];case 7:Or(),t.label=8;case 8:return[2]}})})}.bind(null,e),iu:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=mp(c)).$l)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.Dl.has(r)?(Ar("SyncEngine","Adding an already active target "+r),[3,5]):[4,Xh(n.Sh,r)]):[3,6];case 2:return i=t.sent(),[4,Kh(n.Sh,i)];case 3:return o=t.sent(),[4,tp(n,gp(i),o.targetId,!1)];case 4:t.sent(),yl(n.gl,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.Dl.has(e)?[4,Jh(n.Sh,e,!1).then(function(){vl(n.gl,e),ap(n,e)}).catch(Fc)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),Qo:function(t){return t.Sh.persistence.Qo()}.bind(null,e),eu:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,Yh((e=n).Sh).then(function(t){return lp(e,t)})]})})}.bind(null,e)},[4,this.pl.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Po(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,yp(this.Xl.fa,e)];case 1:return t.sent(),this.zl&&(e&&!this.zl.Tr?this.zl.start(this.Sh):e||this.zl.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},xp.prototype.jl=function(t){var e=Xf();if(!kf.Wn(e))throw new Hr(qr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=kh(t.gu.T,t.gu.persistenceKey);return new kf(e,t.fs,n,t.clientId,t.Yl)},xp),Sp=(Ap.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Sh?[3,2]:(this.Sh=n.Sh,this.pl=n.pl,this.Dh=this.Zl(r),this.gl=this.t_(r),this.Vl=this.e_(r),this.fa=this.n_(r,!n.synchronizeTabs),this.pl.da=function(t){return rp(e.fa,t,1)},this.gl.Ch.s_=pp.bind(null,this.fa),[4,Dl(this.gl,this.fa.Ll)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ap.prototype.e_=function(t){return new Ll},Ap.prototype.Zl=function(t){var e=Qf(t.gu.T),n=(n=t.gu,new Vf(n));return t=t.credentials,new ol(t,n,e)},Ap.prototype.t_=function(t){var e=this,n=this.Sh,r=this.Dh,i=t.fs,o=function(t){return rp(e.fa,t,0)},t=new(Pf.Wn()?Pf:Lf);return new $f(n,r,i,o,t)},Ap.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){o=new Ql(t,e,n,r,i,o);return s&&(o.$l=!0),o}(this.Sh,this.gl,this.Vl,this.pl,t.Yl,t.bl,e)},Ap.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Ar("RemoteStore","RemoteStore shutting down."),e.Fh.add(5),[4,dl(e)];case 1:return t.sent(),e.kh.$o(),e.Mh.set("Unknown"),[2]}})})}(this.gl)},Ap);function Ap(){}function xp(t,e){var n=this;return(n=Ip.call(this,t,e,!1)||this).Xl=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function Dp(t,e,n){var r=this;return(r=_p.call(this)||this).Xl=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function kp(){this.synchronizeTabs=!1}function Op(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}var Lp=(Up.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},Up.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Up.prototype.r_=function(){this.muted=!0},Up.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Up),Pp=(Mp.prototype.close=function(){return this.o_.cancel()},Mp.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},Mp.prototype.Kl=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.a_())]}})})},Mp.prototype.a_=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.u_()];case 1:return null===(e=t.sent())?[2,null]:(r=this.c_.decode(e),n=Number(r),isNaN(n)&&this.h_("length string ("+r+") is not valid number"),[4,this.l_(n)]);case 2:return r=t.sent(),[2,new Ul(JSON.parse(r),e.length+n)]}})})},Mp.prototype.__=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},Mp.prototype.u_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.__()<0?[4,this.f_()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.__())<0&&this.h_("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},Mp.prototype.l_=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.f_()]:[3,3];case 1:t.sent()&&this.h_("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.c_.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},Mp.prototype.h_=function(t){throw this.o_.cancel(),new Error("Invalid bundle format: "+t)},Mp.prototype.f_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.o_.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},Mp),Cp=(Vp.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},Vp),Rp=function(t){this._methodName=t};function Vp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Hr(qr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.d_=new bi(t)}function Mp(t,e){var n=this;this.o_=t,this.Kt=e,this.metadata=new ga,this.buffer=new Uint8Array,this.c_=new TextDecoder("utf-8"),this.a_().then(function(t){t&&t.il()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function Up(t){this.observer=t,this.muted=!1}function Fp(t,e,n){if(!n)throw new Hr(qr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function jp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Hr(qr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function qp(t,e,n,r){if(!0===e&&!0===r)throw new Hr(qr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Hp(t){if(!Ii.Et(t))throw new Hr(qr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Bp(t){if(Ii.Et(t))throw new Hr(qr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Gp(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Or();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function zp(t,e){if("_delegate"in t&&(t=t._),t instanceof e)return t;if(e.name===t.constructor.name)throw new Hr(qr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=Gp(t);throw new Hr(qr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Kp(t,e){if(e<=0)throw new Hr(qr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Jp,Wp=(id.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},id),Xp=new Map,Yp=(Object.defineProperty(rd.prototype,"app",{get:function(){if(!this.A_)throw new Hr(qr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(rd.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(rd.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),rd.prototype.g_=function(t){if(this.T_)throw new Hr(qr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new Wp(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new ii;switch(t.type){case"gapi":var e=t.client;return Lr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ui(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Hr(qr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},rd.prototype.V_=function(){return this.E_},rd.prototype.p_=function(){return this.T_=!0,this.E_},rd.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},rd.prototype.b_=function(){return(t=Xp.get(this))&&(Ar("ComponentProvider","Removing Datastore"),Xp.delete(this),t.terminate()),Promise.resolve();var t},rd),Qp=(Object.defineProperty(nd.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(nd.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(nd.prototype,"path",{get:function(){return this.S_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(nd.prototype,"parent",{get:function(){return new Zp(this.firestore,this.v_,this.S_.path.Z())},enumerable:!1,configurable:!0}),nd.prototype.withConverter=function(t){return new nd(this.firestore,t,this.S_)},nd),$p=(ed.prototype.withConverter=function(t){return new ed(this.firestore,t,this.C_)},ed),Zp=(h(td,Jp=$p),Object.defineProperty(td.prototype,"id",{get:function(){return this.C_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"path",{get:function(){return this.C_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"parent",{get:function(){var t=this.D_.Z();return t.nt()?null:new Qp(this.firestore,null,new Ii(t))},enumerable:!1,configurable:!0}),td.prototype.withConverter=function(t){return new td(this.firestore,t,this.D_)},td);function td(t,e,n){var r=this;return(r=Jp.call(this,t,e,Qo(n))||this).firestore=t,r.D_=n,r.type="collection",r}function ed(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}function nd(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}function rd(t,e){this.w_="(lite)",this.E_=new Wp({}),this.T_=!1,t instanceof $r?(this.I_=t,this.m_=new ii):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Hr(qr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $r(t.options.projectId)}(t),this.m_=new oi(e))}function id(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Hr(qr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Hr(qr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,qp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function od(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Gr&&(t=t._),Fp("collection","path",e),t instanceof Yp)return Bp(n=mi.ct.apply(mi,f([e],r))),new Zp(t,null,n);if(!(t instanceof Qp||t instanceof Zp))throw new Hr(qr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Bp(n=mi.ct.apply(mi,f([t.path],r)).child(mi.ct(e))),new Zp(t.firestore,null,n)}function sd(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Gr&&(t=t._),1===arguments.length&&(e=Pr.t()),Fp("doc","path",e),t instanceof Yp)return Hp(n=mi.ct.apply(mi,f([e],r))),new Qp(t,null,new Ii(n));if(!(t instanceof Qp||t instanceof Zp))throw new Hr(qr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Hp(n=t.D_.child(mi.ct.apply(mi,f([e],r)))),new Qp(t.firestore,t instanceof Zp?t.v_:null,new Ii(n))}function ud(t,e){return t instanceof Gr&&(t=t._),e instanceof Gr&&(e=e._),(t instanceof Qp||t instanceof Zp)&&(e instanceof Qp||e instanceof Zp)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function ad(t,e){return t instanceof Gr&&(t=t._),e instanceof Gr&&(e=e._),t instanceof $p&&e instanceof $p&&t.firestore===e.firestore&&ss(t.C_,e.C_)&&t.v_===e.v_}var cd=(Object.defineProperty(yd.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(yd.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),yd.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},yd.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},yd.prototype.K=function(t){return Rr(this.x_,t.x_)||Rr(this.N_,t.N_)},yd),hd=/^__.*__$/,fd=(dd.prototype.F_=function(t,e){return null!==this.zt?new Gs(t,this.data,this.zt,e,this.fieldTransforms):new Bs(t,this.data,e,this.fieldTransforms)},dd),ld=(pd.prototype.F_=function(t,e){return new Gs(t,this.data,this.zt,e,this.fieldTransforms)},pd);function pd(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}function dd(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}function yd(t,e){if(!isFinite(t)||t<-90||90<t)throw new Hr(qr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Hr(qr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}function vd(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Or()}}var gd=(Object.defineProperty(bd.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(bd.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),bd.prototype.M_=function(t){return new bd(Object.assign(Object.assign({},this.settings),t),this.T,this.Kt,this.ignoreUndefinedProperties,this.fieldTransforms,this.zt)},bd.prototype.L_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.M_({path:e,B_:!1});return e.q_(t),e},bd.prototype.U_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.M_({path:t,B_:!1});return t.O_(),t},bd.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},bd.prototype.K_=function(t){return Xd(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},bd.prototype.contains=function(e){return void 0!==this.zt.find(function(t){return e.st(t)})||void 0!==this.fieldTransforms.find(function(t){return e.st(t.field)})},bd.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},bd.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(vd(this.k_)&&hd.test(t))throw this.K_('Document fields cannot begin and end with "__"')},bd),md=(wd.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new gd({k_:t,methodName:e,j_:n,path:bi.at(),B_:!1,W_:r},this.T,this.Kt,this.ignoreUndefinedProperties)},wd);function wd(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.Kt=n||Qf(t)}function bd(t,e,n,r,i,o){this.settings=t,this.T=e,this.Kt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.zt=o||[]}function Id(t){var e=t.p_(),n=Qf(t.I_);return new md(t.I_,!!e.ignoreUndefinedProperties,n)}function _d(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);zd("Data must be an object, but it was:",s,r);var u,a,r=Bd(r,s);if(o.merge)u=new Oi(s.zt),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=Kd(e,f[h],n);if(!s.contains(l))throw new Hr(qr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");Yd(c,l)||c.push(l)}u=new Oi(c),a=s.fieldTransforms.filter(function(t){return u.It(t.field)})}else u=null,a=s.fieldTransforms;return new fd(new to(r),u,a)}var Ed,Td=(h(Nd,Ed=Rp),Nd.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.zt.push(t.path),null},Nd.prototype.isEqual=function(t){return t instanceof Nd},Nd);function Nd(){return null!==Ed&&Ed.apply(this,arguments)||this}function Sd(t,e,n){return new gd({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.T,e.Kt,e.ignoreUndefinedProperties)}var Ad,xd,Dd,kd,Od=(h(Ud,kd=Rp),Ud.prototype.z_=function(t){return new Cs(t.path,new ws)},Ud.prototype.isEqual=function(t){return t instanceof Ud},Ud),Ld=(h(Md,Dd=Rp),Md.prototype.z_=function(t){var e=Sd(this,t,!0),n=this.H_.map(function(t){return Hd(t,e)}),n=new bs(n);return new Cs(t.path,n)},Md.prototype.isEqual=function(t){return this===t},Md),Pd=(h(Vd,xd=Rp),Vd.prototype.z_=function(t){var e=Sd(this,t,!0),n=this.H_.map(function(t){return Hd(t,e)}),n=new Ns(n);return new Cs(t.path,n)},Vd.prototype.isEqual=function(t){return this===t},Vd),Cd=(h(Rd,Ad=Rp),Rd.prototype.z_=function(t){var e=new Ds(t.Kt,ys(t.Kt,this.J_));return new Cs(t.path,e)},Rd.prototype.isEqual=function(t){return this===t},Rd);function Rd(t,e){var n=this;return(n=Ad.call(this,t)||this).J_=e,n}function Vd(t,e){var n=this;return(n=xd.call(this,t)||this).H_=e,n}function Md(t,e){var n=this;return(n=Dd.call(this,t)||this).H_=e,n}function Ud(){return null!==kd&&kd.apply(this,arguments)||this}function Fd(t,r,i,e){var o=t.G_(1,r,i);zd("Data must be an object, but it was:",o,e);var s=[],u=new eo;Di(e,function(t,e){var n=Wd(r,t,i);e instanceof Gr&&(e=e._);t=o.U_(n);e instanceof Td?s.push(n):null!=(t=Hd(e,t))&&(s.push(n),u.set(n,t))});e=new Oi(s);return new ld(u.yt(),e,o.fieldTransforms)}function jd(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[Kd(e,r,n)],a=[i];if(o.length%2!=0)throw new Hr(qr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Kd(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new eo,y=u.length-1;0<=y;--y){Yd(p,u[y])||(h=u[y],(f=a[y])instanceof Gr&&(f=f._),l=s.U_(h),f instanceof Td?p.push(h):null!=(l=Hd(f,l))&&(p.push(h),d.set(h,l)))}i=new Oi(p);return new ld(d.yt(),i,s.fieldTransforms)}function qd(t,e,n,r){return void 0===r&&(r=!1),Hd(n,t.G_(r?4:3,e))}function Hd(s,t){if(s instanceof Gr&&(s=s._),Gd(s))return zd("Unsupported field value:",t,s),Bd(s,t);if(s instanceof Rp)return function(t,e){if(!vd(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");t=t.z_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.zt.push(t.path),s instanceof Array){if(t.settings.B_&&4!==t.k_)throw t.K_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Hd(i[r],t.Q_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Gr&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ys(e.Kt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=vi.fromDate(t);return{timestampValue:Ku(e.Kt,n)}}if(t instanceof vi)return n=new vi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Ku(e.Kt,n)};if(t instanceof cd)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Br)return{bytesValue:Ju(e.Kt,t.l)};if(t instanceof Qp){n=e.T;var r=t.firestore.I_;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Xu(t.firestore.I_||e.T,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+Gp(t))}(s,t)}function Bd(t,n){var r={};return ki(t)?n.path&&0<n.path.length&&n.zt.push(n.path):Di(t,function(t,e){e=Hd(e,n.L_(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function Gd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof vi||t instanceof cd||t instanceof Br||t instanceof Qp||t instanceof Rp)}function zd(t,e,n){if(!Gd(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=Gp(n);throw"an object"===n?e.K_(t+" a custom object"):e.K_(t+" "+n)}var r}function Kd(t,e,n){if(e instanceof Gr&&(e=e._),e instanceof Cp)return e.d_;if("string"==typeof e)return Wd(t,e);throw Xd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Jd=new RegExp("[~\\*/\\[\\]]");function Wd(e,n,r){if(0<=n.search(Jd))throw Xd("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Cp.bind.apply(Cp,f([void 0],n.split("."))))).d_}catch(t){throw Xd("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Xd(t,e,n,r,i){var o=r&&!r.nt(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Hr(qr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Yd(t,e){return t.some(function(t){return t.isEqual(e)})}var Qd=(ny.prototype.ef=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),0<this.mutations.length)throw new Hr(qr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=ea((n=s).Kt)+"/documents",r={documents:u.map(function(t){return Qu(n.Kt,t)})},[4,n.Cu("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.Kt,"found"in(t=t)?function(t,e){Lr(!!e.found),e.found.name,e.found.updateTime;var n=$u(t,e.found.name),t=Wu(e.found.updateTime),e=new to({mapValue:{fields:e.found.fields}});return new uo(n,t,e,{})}(e,t):"missing"in t?function(t,e){Lr(!!e.missing),Lr(!!e.readTime);t=$u(t,e.missing),e=Wu(e.readTime);return new ao(t,e)}(e,t):Or());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Lr(!!t),o.push(t)}),o)]}})})}(this.Dh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof ao||t instanceof uo?n.sf(t):Or()}),e)]}})})},ny.prototype.set=function(t,e){this.write(e.F_(t,this.Gt(t))),this.tf.add(t.toString())},ny.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},ny.prototype.delete=function(t){this.write(new eu(t,this.Gt(t))),this.tf.add(t.toString())},ny.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return e=this.Y_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Ii.ft(e);n.mutations.push(new nu(e,n.Gt(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=ea((e=i).Kt)+"/documents",r={writes:o.map(function(t){return oa(e.Kt,t)})},[4,e.bu("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Dh,this.mutations)];case 1:return t.sent(),this.X_=!0,[2]}})})},ny.prototype.sf=function(t){var e;if(t instanceof uo)e=t.version;else{if(!(t instanceof ao))throw Or();e=gi.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Hr(qr.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},ny.prototype.Gt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Rs.updateTime(e):Rs.Wt()},ny.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(this.tf.has(t.toString())||!e)return Rs.exists(!0);if(e.isEqual(gi.min()))throw new Hr(qr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Rs.updateTime(e)},ny.prototype.write=function(t){this.nf(),this.mutations.push(t)},ny.prototype.nf=function(){},ny),$d=(ey.prototype.run=function(){this.af()},ey.prototype.af=function(){var t=this;this.zu.Bu(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Qd(this.Dh),(n=this.uf(e))&&n.then(function(t){r.fs.ys(function(){return e.commit().then(function(){r.Ts.resolve(t)}).catch(function(t){r.hf(t)})})}).catch(function(t){r.hf(t)}),[2]})})})},ey.prototype.uf=function(t){try{var e=this.updateFunction(t);return!Fi(e)&&e.catch&&e.then?e:(this.Ts.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ts.reject(t),null}},ey.prototype.hf=function(t){var e=this;0<this.cf&&this.lf(t)?(--this.cf,this.fs.ys(function(){return e.af(),Promise.resolve()})):this.Ts.reject(t)},ey.prototype.lf=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!ou(t)},ey),Zd=(ty.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{fs:this.fs,gu:this.gu,clientId:this.clientId,credentials:this.credentials,Yl:this.user,bl:100})]}})})},ty.prototype.ff=function(t){var e=this;this._f=t,this.N.promise.then(function(){return e._f(e.user)})},ty.prototype.df=function(){if(this.fs.wf)throw new Hr(qr.FAILED_PRECONDITION,"The client has already been terminated.")},ty.prototype.terminate=function(){var t=this;this.fs.Ef();var n=new ga;return this.fs.Tf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.D(),n.resolve(),[3,6];case 5:return e=t.sent(),e=Va(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},ty);function ty(t,e,n){var r=this;this.credentials=t,this.fs=e,this.gu=n,this.user=Zr.UNAUTHENTICATED,this.clientId=Pr.t(),this._f=function(){},this.N=new ga,this.credentials.S(function(t){Ar("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.N.resolve()})}function ey(t,e,n,r){this.fs=t,this.Dh=e,this.updateFunction=n,this.Ts=r,this.cf=5,this.zu=new nl(this.fs,"transaction_retry")}function ny(t){this.Dh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}function ry(i,o){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return i.fs.Af(),Ar("FirestoreClient","Initializing OfflineComponentProvider"),[4,i.getConfiguration()];case 1:return e=t.sent(),[4,o.initialize(e)];case 2:return t.sent(),n=e.Yl,i.ff(function(e){n.isEqual(e)||(n=e,i.fs.bo(function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,qh(o.Sh,e)];case 1:return t.sent(),[2]}})})}))}),o.persistence.yo(function(){return i.terminate()}),i.mf=o,[2]}})})}function iy(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.fs.Af(),[4,oy(r)];case 1:return e=t.sent(),Ar("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.ff(function(t){return r.fs.bo(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).fs.Af(),Ar("RemoteStore","RemoteStore received new credentials"),n=Il(e),e.Fh.add(3),[4,dl(e)];case 1:return t.sent(),n&&e.Mh.set("Unknown"),[4,e.Ch.s_(i)];case 2:return t.sent(),e.Fh.delete(3),[4,pl(e)];case 3:return t.sent(),[2]}})})}(i.gl,t)})}),r.If=i,[2]}})})}function oy(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.mf?[3,2]:(Ar("FirestoreClient","Using default OfflineComponentProvider"),[4,ry(e,new Ep)]);case 1:t.sent(),t.label=2;case 2:return[2,e.mf]}})})}function sy(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.If?[3,2]:(Ar("FirestoreClient","Using default OnlineComponentProvider"),[4,iy(e,new Sp)]);case 1:t.sent(),t.label=2;case 2:return[2,e.If]}})})}function uy(t){return oy(t).then(function(t){return t.persistence})}function ay(t){return oy(t).then(function(t){return t.Sh})}function cy(t){return sy(t).then(function(t){return t.gl})}function hy(t){return sy(t).then(function(t){return t.fa})}function fy(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,sy(r)];case 1:return e=t.sent(),[2,((n=e.Vl).Gh=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=mp(s),(o=e.Sl.get(u))?(n=o.targetId,e.pl.ka(n),r=o.view.Pl(),[3,4]):[3,1];case 1:return[4,Kh(e.Sh,is(u))];case 2:return i=t.sent(),o=e.pl.ka(i.targetId),n=i.targetId,[4,tp(e,u,n,"current"===o)];case 3:r=t.sent(),e.Ll&&yl(e.gl,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e.fa),n.Jh=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Sl.get(o),1<(r=e.Dl.get(n.targetId)).length?[2,(e.Dl.set(n.targetId,r.filter(function(t){return!ss(t,o)})),void e.Sl.delete(o))]:e.Ll?(e.pl.$a(n.targetId),e.pl.Ca(n.targetId)?[3,2]:[4,Jh(e.Sh,n.targetId,!1).then(function(){e.pl.Ba(n.targetId),vl(e.gl,n.targetId),ap(e,n.targetId)}).catch(Fc)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return ap(e,n.targetId),[4,Jh(e.Sh,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.fa),n)]}})})}function ly(n,r,i){var t=this;void 0===i&&(i={});var o=new ga;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new Lp({next:function(t){r.ys(function(){return Rl(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Hr(qr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Hr(qr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Ml(Qo(i.path),t,{includeMetadataChanges:!0,sl:!0});return Cl(n,u)},[4,fy(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.fs,r,i,o])]}})})}),o.promise}function py(n,r,i){var t=this;void 0===i&&(i={});var o=new ga;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new Lp({next:function(t){n.ys(function(){return Rl(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Hr(qr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Ml(t,o,{includeMetadataChanges:!0,sl:!0});return Cl(e,s)},[4,fy(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.fs,r,i,o])]}})})}),o.promise}var dy,yy=(Object.defineProperty(my.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),my.prototype.ys=function(t){this.enqueue(t)},my.prototype.Tf=function(t){this.Sf(),this.Df(t)},my.prototype.Ef=function(){var t;this.yf||(this.yf=!0,(t=Yf())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf))},my.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},my.prototype.bo=function(t){var e=this;this.ys(function(){return e.Pf.push(t),e.Cf()})},my.prototype.Cf=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Pf.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return t.sent(),this.Pf.shift(),this.zu.reset(),[3,4];case 3:if(!xa(e=t.sent()))throw e;return Ar("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Pf.length&&this.zu.Bu(function(){return n.Cf()}),t.label=5;case 5:return[2]}})})},my.prototype.Df=function(t){var r=this,e=this.Rf.then(function(){return r.pf=!0,t().catch(function(t){throw r.Vf=t,r.pf=!1,xr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.pf=!1,t})});return this.Rf=e},my.prototype.Ir=function(t,e,n){var r=this;this.Sf(),-1<this.bf.indexOf(t)&&(e=0);n=Ca.Is(this,t,e,n,function(t){return r.xf(t)});return this.gf.push(n),n},my.prototype.Sf=function(){this.Vf&&Or()},my.prototype.Af=function(){},my.prototype.Nf=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Rf];case 1:t.sent(),t.label=2;case 2:if(e!==this.Rf)return[3,0];t.label=3;case 3:return[2]}})})},my.prototype.Ff=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].ds===t)return!0;return!1},my.prototype.Of=function(r){var i=this;return this.Nf().then(function(){i.gf.sort(function(t,e){return t.ws-e.ws});for(var t=0,e=i.gf;t<e.length;t++){var n=e[t];if(n.Ps(),"all"!==r&&n.ds===r)break}return i.Nf()})},my.prototype.kf=function(t){this.bf.push(t)},my.prototype.xf=function(t){t=this.gf.indexOf(t);this.gf.splice(t,1)},my),vy=(h(gy,dy=Yp),gy.prototype.b_=function(){return this.$f||by(this),this.$f.terminate()},gy);function gy(t,e){var n=this;return(n=dy.call(this,t,e)||this).Mf=new yy,n.w_="name"in t?t.name:"[DEFAULT]",n}function my(){var e=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.zu=new nl(this,"async_queue_retry"),this.vf=function(){var t=Yf();t&&Ar("AsyncQueue","Visibility state changed to "+t.visibilityState),e.zu.Uu()};var t=Yf();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.vf)}function wy(t){return t.$f||by(t),t.$f.df(),t.$f}function by(t){var e,n,r=t.p_(),r=(e=t.I_,n=t.w_,new Qr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.$f=new Zd(t.m_,t.Mf,r)}function Iy(n,r,i){var t=this,o=new ga;return n.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,ry(n,i)];case 1:return t.sent(),[4,iy(n,r)];case 2:return t.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(t=e=t.sent()).name?t.code===qr.FAILED_PRECONDITION||t.code===qr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),o.reject(e),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function _y(t){if(t.R_||t.P_)throw new Hr(qr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Ey,o=(xy.prototype.Lf=function(t,e){switch(void 0===e&&(e="none"),Hi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ri(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(Vi(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.Wf(t.arrayValue,e);case 10:return this.jf(t.mapValue,e);default:throw Or()}},xy.prototype.jf=function(t,n){var r=this,i={};return Di(t.fields||{},function(t,e){i[t]=r.Lf(e,n)}),i},xy.prototype.Kf=function(t){return new cd(Ri(t.latitude),Ri(t.longitude))},xy.prototype.Wf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Lf(t,e)})},xy.prototype.qf=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return Mi(e)?t(e):e}(t);return null==n?null:this.Lf(n,e);case"estimate":return this.Bf(Ui(t));default:return null}},xy.prototype.Bf=function(t){t=Ci(t);return new vi(t.seconds,t.nanos)},xy.prototype.Gf=function(t,e){var n=mi.ct(t);Lr(ya(n));t=new $r(n.get(1),n.get(3)),n=new Ii(n.X(5));return t.isEqual(e)||xr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},xy),Ty=(Object.defineProperty(Ay.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(Ay.prototype,"ref",{get:function(){return new Qp(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),Ay.prototype.exists=function(){return null!==this.Jf},Ay.prototype.data=function(){if(this.Jf){if(this.v_){var t=new Ny(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.Lf(this.Jf.vt())}},Ay.prototype.get=function(t){if(this.Jf){t=this.Jf.data().field(Dy("DocumentSnapshot.get",t));if(null!==t)return this.Hf.Lf(t)}},Ay),Ny=(h(Sy,Ey=Ty),Sy.prototype.data=function(){return Ey.prototype.data.call(this)},Sy);function Sy(){return null!==Ey&&Ey.apply(this,arguments)||this}function Ay(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}function xy(){}function Dy(t,e){return"string"==typeof e?Wd(t,e):(e instanceof Gr?e._:e).d_}function ky(t){if(Zo(t)&&0===t.Nt.length)throw new Hr(qr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}Ee=function(){};function Oy(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){t=i[r].Yf(t)}return t}var Ly,Py,Cy,Ry,Vy,My=(h(Ky,Vy=Ee),Ky.prototype.Yf=function(t){var e=Id(t.firestore),e=function(t,e,n,r,i,o){if(r.ht()){if("array-contains"===i||"array-contains-any"===i)throw new Hr(qr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Xy(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(Wy(n,t,c))}h={arrayValue:{values:s}}}else h=Wy(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Xy(o,i),h=qd(e,"where",o,"in"===i||"not-in"===i);var h=bo.create(r,i,h);return function(t,e){if(e.xt()){var n=es(t);if(null!==n&&!n.isEqual(e.field))throw new Hr(qr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=ts(t);null!==n&&Yy(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Hr(qr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Hr(qr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.C_,e,t.firestore.I_,this.Xf,this.Zf,this.td);return new $p(t.firestore,t.v_,(t=t.C_,e=t.filters.concat([e]),new Xo(t.path,t.collectionGroup,t.Nt.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},Ky),Uy=(h(zy,Ry=Ee),zy.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Hr(qr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Hr(qr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Ko(e,n);return e=r,null!==ts(n=t)||null!==(t=es(n))&&Yy(0,t,e.field),r}(t.C_,this.Xf,this.ed);return new $p(t.firestore,t.v_,(t=t.C_,e=t.Nt.concat([e]),new Xo(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},zy),Fy=(h(Gy,Cy=Ee),Gy.prototype.Yf=function(t){return new $p(t.firestore,t.v_,os(t.C_,this.nd,this.sd))},Gy),jy=(h(By,Py=Ee),By.prototype.Yf=function(t){var e=Jy(t,this.type,this.rd,this.od);return new $p(t.firestore,t.v_,(t=t.C_,e=e,new Xo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},By),qy=(h(Hy,Ly=Ee),Hy.prototype.Yf=function(t){var e=Jy(t,this.type,this.rd,this.od);return new $p(t.firestore,t.v_,(t=t.C_,e=e,new Xo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},Hy);function Hy(t,e,n){var r=this;return(r=Ly.call(this)||this).type=t,r.rd=e,r.od=n,r}function By(t,e,n){var r=this;return(r=Py.call(this)||this).type=t,r.rd=e,r.od=n,r}function Gy(t,e,n){var r=this;return(r=Cy.call(this)||this).type=t,r.nd=e,r.sd=n,r}function zy(t,e){var n=this;return(n=Ry.call(this)||this).Xf=t,n.ed=e,n.type="orderBy",n}function Ky(t,e,n){var r=this;return(r=Vy.call(this)||this).Xf=t,r.Zf=e,r.td=n,r.type="where",r}function Jy(t,c,e,n){if(e[0]instanceof Gr&&(e[0]=e[0]._),e[0]instanceof Ty)return function(t,e,n,r){if(!n)throw new Hr(qr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=rs(t);o<s.length;o++){var u=s[o];if(u.field.ht())i.push(Wi(e,n.key));else{var a=n.field(u.field);if(Mi(a))throw new Hr(qr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.ot();throw new Hr(qr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new jo(i,r)}(t.C_,t.firestore.I_,e[0].Jf,n);var r=Id(t.firestore);return function(t,e,n,r,i,o){var s=t.Nt;if(i.length>s.length)throw new Hr(qr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ht()){if("string"!=typeof c)throw new Hr(qr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!ns(t)&&-1!==c.indexOf("/"))throw new Hr(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(mi.ct(c));if(!Ii.Et(h))throw new Hr(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new Ii(h);u.push(Wi(e,h))}else{c=qd(n,r,c);u.push(c)}}return new jo(u,o)}(t.C_,t.firestore.I_,r,c,e,n)}function Wy(t,e,n){if(n instanceof Gr&&(n=n._),"string"==typeof n){if(""===n)throw new Hr(qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ns(e)&&-1!==n.indexOf("/"))throw new Hr(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(mi.ct(n));if(!Ii.Et(e))throw new Hr(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Wi(t,new Ii(e))}if(n instanceof Qp)return Wi(t,n.S_);throw new Hr(qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Gp(n)+".")}function Xy(t,e){if(!Array.isArray(t)||0===t.length)throw new Hr(qr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Hr(qr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Yy(t,e,n){if(!n.isEqual(e))throw new Hr(qr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Qy(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}function $y(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Zy,tv,ev,nv=(h(fv,ev=o),fv.prototype.Uf=function(t){return new Br(t)},fv.prototype.Qf=function(t){t=this.Gf(t,this.firestore.I_);return new Qp(this.firestore,null,t)},fv),rv=(hv.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},hv),iv=(h(cv,tv=Ty),cv.prototype.exists=function(){return tv.prototype.exists.call(this)},cv.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new ov(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.Lf(this.Jf.vt(),t.serverTimestamps)}},cv.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf){t=this.Jf.data().field(Dy("DocumentSnapshot.get",t));if(null!==t)return this.Hf.Lf(t,e.serverTimestamps)}},cv),ov=(h(av,Zy=iv),av.prototype.data=function(t){return void 0===t&&(t={}),Zy.prototype.data.call(this,t)},av),sv=(Object.defineProperty(uv.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(uv.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(uv.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),uv.prototype.forEach=function(e,n){var r=this;this.ud.docs.forEach(function(t){e.call(n,new ov(r.zf,r.Hf,t.key,t,new rv(r.ud.Ce.has(t.key),r.ud.fromCache),r.query.v_))})},uv.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.ud.Ne)throw new Hr(qr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===t||(this.hd=function(i,e){if(i.ud.De.nt()){var n=0;return i.ud.docChanges.map(function(t){var e=new ov(i.zf,i.Hf,t.doc.key,t.doc,new rv(i.ud.Ce.has(t.doc.key),i.ud.fromCache),i.query.v_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.ud.De;return i.ud.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new ov(i.zf,i.Hf,t.doc.key,t.doc,new rv(i.ud.Ce.has(t.doc.key),i.ud.fromCache),i.query.v_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Or()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.ld=t),this.hd},uv);function uv(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new rv(r.hasPendingWrites,r.fromCache),this.query=n}function av(){return null!==Zy&&Zy.apply(this,arguments)||this}function cv(t,e,n,r,i,o){var s=this;return(s=tv.call(this,t,e,n,r,o)||this).zf=t,s.ad=t,s.metadata=i,s}function hv(t,e){this.hasPendingWrites=t,this.fromCache=e}function fv(t){var e=this;return(e=ev.call(this)||this).firestore=t,e}function lv(t,e){return t instanceof iv&&e instanceof iv?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof sv&&e instanceof sv&&t.zf===e.zf&&ad(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var pv,dv=(h(yv,pv=o),yv.prototype.Uf=function(t){return new Br(t)},yv.prototype.Qf=function(t){t=this.Gf(t,this.firestore.I_);return new Qp(this.firestore,null,t)},yv);function yv(t){var e=this;return(e=pv.call(this)||this).firestore=t,e}function vv(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=zp(t,Qp);var o=zp(t.firestore,vy),s=Id(o);return e instanceof Gr&&(e=e._),mv(o,[("string"==typeof e||e instanceof Cp?jd(s,"updateDoc",t.S_,e,n,r):Fd(s,"updateDoc",t.S_,e)).F_(t.S_,Rs.exists(!0))])}function gv(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof Gr&&(e=e._);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Qy(n[i])||(r=n[i],i++);var o,s,u,a,c,h,f={includeMetadataChanges:r.includeMetadataChanges};return Qy(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof Qp?(u=zp(e.firestore,vy),a=Qo(e.S_.path),h={next:function(t){n[i]&&n[i](wv(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=zp(e,$p),u=zp(s.firestore,vy),a=s.C_,c=new dv(u),h={next:function(t){n[i]&&n[i](new sv(u,c,s,t))},error:n[i+1],complete:n[i+2]},ky(e.C_)),function(n,t,e){var r=this,i=new Lp(h),o=new Ml(t,i,e);return n.fs.ys(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Cl,[4,fy(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.r_(),n.fs.ys(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Rl,[4,fy(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(wy(u),a,f)}function mv(t,e){return function(n,r){var t=this,i=new ga;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=ep,[4,hy(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(wy(t),e)}function wv(t,e,n){var r=n.docs.get(e.S_),i=new dv(t);return new iv(t,i,e.S_,r,new rv(n.hasPendingWrites,n.fromCache),e.v_)}var bv=(Iv.prototype.set=function(t,e,n){this.Ed();t=_v(t,this.zf),e=$y(t.v_,e,n),n=_d(this.wd,"WriteBatch.set",t.S_,e,null!==t.v_,n);return this.fd.push(n.F_(t.S_,Rs.Wt())),this},Iv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Ed();t=_v(t,this.zf);return e instanceof Gr&&(e=e._),e="string"==typeof e||e instanceof Cp?jd(this.wd,"WriteBatch.update",t.S_,e,n,r):Fd(this.wd,"WriteBatch.update",t.S_,e),this.fd.push(e.F_(t.S_,Rs.exists(!0))),this},Iv.prototype.delete=function(t){this.Ed();t=_v(t,this.zf);return this.fd=this.fd.concat(new eu(t.S_,Rs.Wt())),this},Iv.prototype.commit=function(){return this.Ed(),this.dd=!0,0<this.fd.length?this._d(this.fd):Promise.resolve()},Iv.prototype.Ed=function(){if(this.dd)throw new Hr(qr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Iv);function Iv(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=Id(t)}function _v(t,e){if(t instanceof Gr&&(t=t._),t.firestore!==e)throw new Hr(qr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Ev,Tv,Nv,Sv=(Cv.prototype.get=function(t){var e=this,n=_v(t,this.zf),r=new nv(this.zf);return this.Td.ef([n.S_]).then(function(t){if(!t||1!==t.length)return Or();t=t[0];if(t instanceof ao)return new Ty(e.zf,r,n.S_,null,n.v_);if(t instanceof uo)return new Ty(e.zf,r,t.key,t,n.v_);throw Or()})},Cv.prototype.set=function(t,e,n){t=_v(t,this.zf),e=$y(t.v_,e,n),n=_d(this.wd,"Transaction.set",t.S_,e,null!==t.v_,n);return this.Td.set(t.S_,n),this},Cv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=_v(t,this.zf);return e instanceof Gr&&(e=e._),e="string"==typeof e||e instanceof Cp?jd(this.wd,"Transaction.update",t.S_,e,n,r):Fd(this.wd,"Transaction.update",t.S_,e),this.Td.update(t.S_,e),this},Cv.prototype.delete=function(t){t=_v(t,this.zf);return this.Td.delete(t.S_),this},h(Pv,Nv=Cv),Pv.prototype.get=function(t){var e=this,n=_v(t,this.zf),r=new dv(this.zf);return Nv.prototype.get.call(this,t).then(function(t){return new iv(e.zf,r,n.S_,t.Jf,new rv(!1,!1),n.v_)})},Pv),Av=(Lv.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){_y(t=zp(t,vy));var n=wy(t),r=t.p_(),t=new Sp;return Iy(n,t,new Tp(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},Lv.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){_y(t=zp(t,vy));var e=wy(t),n=t.p_(),t=new Sp;return Iy(e,t,new Np(t,n.cacheSizeBytes))}(t._)},Lv.prototype.clearIndexedDbPersistence=function(t){return function(n){var t=this;if(n.R_&&!n.P_)throw new Hr(qr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new ga;return n.Mf.Tf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return ba.Wn()?(e=n+"main",[4,ba.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(kh(n.I_,n.w_))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}(t._)},Lv),xv=(h(Ov,Tv=Gr),Object.defineProperty(Ov.prototype,"I_",{get:function(){return this._.I_},enumerable:!1,configurable:!0}),Ov.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.V_()),t)).merge,this._.g_(t)},Ov.prototype.useEmulator=function(t,e){var n,r;n=this._,r=t,t=e,"firestore.googleapis.com"!==(e=(n=zp(n,Yp)).V_()).host&&e.host!==r&&Dr("Host has been set in both settings() and useEmulator(), emulator host will be used"),n.g_(Object.assign(Object.assign({},e),{host:r+":"+t,ssl:!1}))},Ov.prototype.enableNetwork=function(){return function(r){var t=this;return r.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,uy(r)];case 1:return e=t.sent(),[4,cy(r)];case 2:return n=t.sent(),[2,(e.Vo(!0),(t=n).Fh.delete(0),pl(t))]}})})})}(wy(zp(this._,vy)))},Ov.prototype.disableNetwork=function(){return function(r){var t=this;return r.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,uy(r)];case 1:return e=t.sent(),[4,cy(r)];case 2:return n=t.sent(),[2,(e.Vo(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Fh.add(0),[4,dl(e)];case 1:return t.sent(),e.Mh.set("Offline"),[2]}})})}(n))]}})})})}(wy(zp(this._,vy)))},Ov.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&qp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},Ov.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},Ov.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},Ov.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new ga;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=op,[4,hy(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(wy(zp(this._,vy)))},Ov.prototype.onSnapshotsInSync=function(t){return e=this._,t=t,function(n,t){var e=this,r=new Lp(t);return n.fs.ys(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.jh.add(e),e.next()},[4,fy(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.r_(),n.fs.ys(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.jh.delete(e)},[4,fy(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(wy(zp(e,vy)),Qy(t)?t:{next:t});var e},Object.defineProperty(Ov.prototype,"app",{get:function(){if(!this.md)throw new Hr(qr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),Ov.prototype.collection=function(t){try{return new ug(this,od(this._,t))}catch(t){throw Jv(t,"collection()","Firestore.collection()")}},Ov.prototype.doc=function(t){try{return new zv(this,sd(this._,t))}catch(t){throw Jv(t,"doc()","Firestore.doc()")}},Ov.prototype.collectionGroup=function(t){try{return new ig(this,function(t,e){if(t=zp(t,Yp),Fp("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Hr(qr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new $p(t,null,(e=e,new Xo(mi.at(),e)))}(this._,t))}catch(t){throw Jv(t,"collectionGroup()","Firestore.collectionGroup()")}},Ov.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new ga;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,sy(n).then(function(t){return t.Dh})];case 1:return e=t.sent(),new $d(n.fs,e,r,i).run(),[2]}})})}),i.promise}(wy(n=this._),function(t){return t=new Sv(n,t),e(new Uv(r,t))})},Ov.prototype.batch=function(){var e=this;return wy(this._),new Fv(new bv(this._,function(t){return mv(e._,t)}))},Ov.prototype.loadBundle=function(t){throw new Hr(qr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},Ov.prototype.namedQuery=function(t){throw new Hr(qr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},Ov),Dv=(h(kv,Ev=o),kv.prototype.Uf=function(t){return new Yr(new Br(t))},kv.prototype.Qf=function(t){t=this.Gf(t,this.firestore.I_);return zv.Ad(t,this.firestore,null)},kv);function kv(t){var e=this;return(e=Ev.call(this)||this).firestore=t,e}function Ov(t,e,n){var r=this;return(r=Tv.call(this,e)||this).Id=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof $r||(r.md=t),r}function Lv(){}function Pv(t,e){var n=this;return(n=Nv.call(this,t,e)||this).zf=t,n}function Cv(t,e){this.zf=t,this.Td=e,this.wd=Id(t)}var Rv,Vv,Mv,Uv=(h(Bv,Mv=Gr),Bv.prototype.get=function(t){var e=this,n=dg(t);return this._.get(n).then(function(t){return new ng(e.zf,new iv(e.zf._,e.Hf,t.S_,t.Jf,t.metadata,n.v_))})},Bv.prototype.set=function(t,e,n){t=dg(t);return n?(jp("Transaction.set",n),this._.set(t,e,n)):this._.set(t,e),this},Bv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=dg(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,f([o,e,n],r)),this},Bv.prototype.delete=function(t){t=dg(t);return this._.delete(t),this},Bv),Fv=(h(Hv,Vv=Gr),Hv.prototype.set=function(t,e,n){t=dg(t);return n?(jp("WriteBatch.set",n),this._.set(t,e,n)):this._.set(t,e),this},Hv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=dg(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,f([o,e,n],r)),this},Hv.prototype.delete=function(t){t=dg(t);return this._.delete(t),this},Hv.prototype.commit=function(){return this._.commit()},Hv),jv=(h(qv,Rv=Gr),qv.prototype.fromFirestore=function(t,e){t=new ov(this.zf._,this.Hf,t.S_,t.Jf,t.metadata,null);return this._.fromFirestore(new rg(this.zf,t),null!=e?e:{})},qv.prototype.toFirestore=function(t,e){return e?this._.toFirestore(t,e):this._.toFirestore(t)},qv.Rd=function(t,e){var n=qv.Pd,r=n.get(t);r||(r=new WeakMap,n.set(t,r));n=r.get(e);return n||(n=new qv(t,new Dv(t),e),r.set(e,n)),n},qv);function qv(t,e,n){var r=this;return(r=Rv.call(this,n)||this).zf=t,r.Hf=e,r}function Hv(){return null!==Vv&&Vv.apply(this,arguments)||this}function Bv(t,e){var n=this;return(n=Mv.call(this,e)||this).zf=t,n.Hf=new Dv(t),n}jv.Pd=new WeakMap;var Gv,zv=(h(Kv,Gv=Gr),Kv.yd=function(t,e,n){if(t.length%2!=0)throw new Hr(qr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.ot()+" has "+t.length);return new Kv(e,new Qp(e._,n,new Ii(t)))},Kv.Ad=function(t,e,n){return new Kv(e,new Qp(e._,n,t))},Object.defineProperty(Kv.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Kv.prototype,"parent",{get:function(){return new ug(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Kv.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Kv.prototype.collection=function(t){try{return new ug(this.firestore,od(this._,t))}catch(t){throw Jv(t,"collection()","DocumentReference.collection()")}},Kv.prototype.isEqual=function(t){return t instanceof Gr&&(t=t._),t instanceof Qp&&ud(this._,t)},Kv.prototype.set=function(t,e){e=jp("DocumentReference.set",e);try{return function(t,e,n){t=zp(t,Qp);var r=zp(t.firestore,vy),e=$y(t.v_,e,n);return mv(r,[_d(Id(r),"setDoc",t.S_,e,null!==t.v_,n).F_(t.S_,Rs.Wt())])}(this._,t,e)}catch(t){throw Jv(t,"setDoc()","DocumentReference.set()")}},Kv.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?vv(this._,t):vv.apply(void 0,f([this._,t,e],n))}catch(t){throw Jv(t,"updateDoc()","DocumentReference.update()")}},Kv.prototype.delete=function(){return mv(zp((t=this._).firestore,vy),[new eu(t.S_,Rs.Wt())]);var t},Kv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Wv(t),i=Xv(t,function(t){return new ng(e.firestore,new iv(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))});return gv(this._,r,i)},Kv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=zp(e,Qp);var n=zp(e.firestore,vy),t=wy(n),r=new dv(n);return function(n,r){var t=this,i=new ga;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(o,s,u){return y(this,void 0,void 0,function(){var r,i;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=s,(n=o).persistence.runTransaction("read document","readonly",function(t){return n.Ic.Jo(t,e)}))];case 1:return(i=t.sent())instanceof uo?u.resolve(i):i instanceof ao?u.resolve(null):u.reject(new Hr(qr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),i=Va(r,"Failed to get document '"+s+" from cache"),u.reject(i),[3,3];case 3:return[2]}var e,n})})},[4,ay(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.S_).then(function(t){return new iv(n,r,e.S_,t,new rv(t instanceof uo&&t.bt,!0),e.v_)})}:"server"===(null==t?void 0:t.source)?function(e){e=zp(e,Qp);var n=zp(e.firestore,vy);return ly(wy(n),e.S_,{source:"server"}).then(function(t){return wv(n,e,t)})}:function(e){e=zp(e,Qp);var n=zp(e.firestore,vy);return ly(wy(n),e.S_).then(function(t){return wv(n,e,t)})})(this._).then(function(t){return new ng(e.firestore,new iv(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))})},Kv.prototype.withConverter=function(t){return new Kv(this.firestore,this._.withConverter(jv.Rd(this.firestore,t)))},Kv);function Kv(t,e){var n=this;return(n=Gv.call(this,e)||this).firestore=t,n.Hf=new Dv(t),n}function Jv(t,e,n){return t.message=t.message.replace(e,n),t}function Wv(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Qy(r))return r}return{}}function Xv(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=Qy(t[0])?t[0]:Qy(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Yv,Qv,$v,Zv,tg,eg,ng=(h(pg,eg=Gr),Object.defineProperty(pg.prototype,"ref",{get:function(){return new zv(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(pg.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(pg.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(pg.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),pg.prototype.data=function(t){return this._.data(t)},pg.prototype.get=function(t,e){return this._.get(t,e)},pg.prototype.isEqual=function(t){return lv(this._,t._)},pg),rg=(h(lg,tg=ng),lg.prototype.data=function(t){return this._.data(t)},lg),ig=(h(fg,Zv=Gr),fg.prototype.where=function(t,e,n){try{return new fg(this.firestore,Oy(this._,(r=n,i=e,o=Dy("where",t),new My(o,i,r))))}catch(t){throw Jv(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},fg.prototype.orderBy=function(n,t){try{return new fg(this.firestore,Oy(this._,function(t){void 0===t&&(t="asc");var e=t,t=Dy("orderBy",n);return new Uy(t,e)}(t)))}catch(n){throw Jv(n,/(orderBy|where)\(\)/,"Query.$1()")}},fg.prototype.limit=function(t){try{return new fg(this.firestore,Oy(this._,(Kp("limit",e=t),new Fy("limit",e,"F"))))}catch(t){throw Jv(t,"limit()","Query.limit()")}var e},fg.prototype.limitToLast=function(t){try{return new fg(this.firestore,Oy(this._,(Kp("limitToLast",e=t),new Fy("limitToLast",e,"L"))))}catch(t){throw Jv(t,"limitToLast()","Query.limitToLast()")}var e},fg.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new fg(this.firestore,Oy(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new jy("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Jv(t,"startAt()","Query.startAt()")}},fg.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new fg(this.firestore,Oy(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new jy("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Jv(t,"startAfter()","Query.startAfter()")}},fg.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new fg(this.firestore,Oy(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new qy("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Jv(t,"endBefore()","Query.endBefore()")}},fg.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new fg(this.firestore,Oy(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new qy("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Jv(t,"endAt()","Query.endAt()")}},fg.prototype.isEqual=function(t){return ad(this._,t._)},fg.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=zp(e,$p);var n=zp(e.firestore,vy),t=wy(n),r=new dv(n);return function(n,r){var t=this,i=new ga;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Wh(i,o,!0)];case 1:return r=t.sent(),e=new Wl(o,r.Pc),n=e.dl(r.documents),n=e.Ei(n,!1),s.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),r=Va(n,"Failed to execute query '"+o+" against cache"),s.reject(r),[3,3];case 3:return[2]}})})},[4,ay(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.C_).then(function(t){return new sv(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=zp(e,$p);var n=zp(e.firestore,vy),t=wy(n),r=new dv(n);return py(t,e.C_,{source:"server"}).then(function(t){return new sv(n,r,e,t)})}:function(e){e=zp(e,$p);var n=zp(e.firestore,vy),t=wy(n),r=new dv(n);return ky(e.C_),py(t,e.C_).then(function(t){return new sv(n,r,e,t)})})(this._).then(function(t){return new sg(e.firestore,new sv(e.firestore._,e.Hf,e._,t.ud))})},fg.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Wv(t),i=Xv(t,function(t){return new sg(e.firestore,new sv(e.firestore._,e.Hf,e._,t.ud))});return gv(this._,r,i)},fg.prototype.withConverter=function(t){return new fg(this.firestore,this._.withConverter(jv.Rd(this.firestore,t)))},fg),og=(h(hg,$v=Gr),Object.defineProperty(hg.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(hg.prototype,"doc",{get:function(){return new rg(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(hg.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(hg.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),hg),sg=(h(cg,Qv=Gr),Object.defineProperty(cg.prototype,"query",{get:function(){return new ig(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(cg.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(cg.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(cg.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(cg.prototype,"docs",{get:function(){var e=this;return this._.docs.map(function(t){return new rg(e.zf,t)})},enumerable:!1,configurable:!0}),cg.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new og(e.zf,t)})},cg.prototype.forEach=function(e,n){var r=this;this._.forEach(function(t){e.call(n,new rg(r.zf,t))})},cg.prototype.isEqual=function(t){return lv(this._,t._)},cg),ug=(h(ag,Yv=ig),Object.defineProperty(ag.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(ag.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(ag.prototype,"parent",{get:function(){var t=this._.parent;return t?new zv(this.firestore,t):null},enumerable:!1,configurable:!0}),ag.prototype.doc=function(t){try{return new zv(this.firestore,void 0===t?sd(this._):sd(this._,t))}catch(t){throw Jv(t,"doc()","CollectionReference.doc()")}},ag.prototype.add=function(t){var e,n,r,i=this;return e=this._,n=t,t=zp(e.firestore,vy),r=sd(e),n=$y(e.v_,n),mv(t,[_d(Id(e.firestore),"addDoc",r.S_,n,null!==e.v_,{}).F_(r.S_,Rs.exists(!1))]).then(function(){return r}).then(function(t){return new zv(i.firestore,t)})},ag.prototype.isEqual=function(t){return ud(this._,t._)},ag.prototype.withConverter=function(t){return new ag(this.firestore,this._.withConverter(jv.Rd(this.firestore,t)))},ag);function ag(t,e){var n=this;return(n=Yv.call(this,t,e)||this).firestore=t,n._=e,n}function cg(t,e){var n=this;return(n=Qv.call(this,e)||this).zf=t,n}function hg(t,e){var n=this;return(n=$v.call(this,e)||this).zf=t,n}function fg(t,e){var n=this;return(n=Zv.call(this,e)||this).firestore=t,n.Hf=new Dv(t),n}function lg(){return null!==tg&&tg.apply(this,arguments)||this}function pg(t,e){var n=this;return(n=eg.call(this,e)||this).zf=t,n}function dg(t){return t instanceof Gr&&(t=t._),zp(t,Qp)}var yg,vg,Ee=(h(bg,vg=Gr),bg.documentId=function(){return new bg(bi.lt().ot())},bg.prototype.isEqual=function(t){return t instanceof Gr&&(t=t._),t instanceof Cp&&this._.d_.isEqual(t.d_)},bg),o=(h(wg,yg=Gr),wg.serverTimestamp=function(){var t=new Od("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new wg(t)},wg.delete=function(){var t=new Td("deleteField");return t._methodName="FieldValue.delete",new wg(t)},wg.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ld("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new wg(n)},wg.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Pd("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new wg(n)},wg.increment=function(t){t=new Cd("increment",t);return t._methodName="FieldValue.increment",new wg(t)},wg.prototype.isEqual=function(t){return this._.isEqual(t._)},wg),gg=(mg.prototype.onProgress=function(t,e,n){this.gd={next:t,error:e,complete:n}},mg.prototype.catch=function(t){return this.Vd.promise.catch(t)},mg.prototype.then=function(t,e){return this.Vd.promise.then(t,e)},mg.prototype.Ul=function(t){this.Ql(t),this.gd.complete&&this.gd.complete(),this.Vd.resolve(t)},mg.prototype.Wl=function(t){this.pd.taskState="Error",this.gd.next&&this.gd.next(this.pd),this.gd.error&&this.gd.error(t),this.Vd.reject(t)},mg.prototype.Ql=function(t){this.pd=t,this.gd.next&&this.gd.next(t)},mg);function mg(){this.gd={},this.Vd=new ga,this.pd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function wg(){return null!==yg&&yg.apply(this,arguments)||this}function bg(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return vg.call(this,new(Cp.bind.apply(Cp,f([void 0],t))))||this}function Ig(t,s){var e=new gg;return function(n,t,r){var e,i=this,o=(e=s,t=Qf(t),e=function(t){if(t instanceof Uint8Array)return Op(t,void 0);if(t instanceof ArrayBuffer)return Op(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),new Pp(e,t));n.fs.ys(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=bp,[4,hy(n)];case 1:return e.apply(void 0,[t.sent(),o,r]),[2]}})})})}(wy(t._),t.I_,e),e}var _g=(Eg.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Eg.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Eg.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Eg);function Eg(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Tg,Ng,Sg={Firestore:xv,GeoPoint:cd,Timestamp:vi,Blob:Yr,Transaction:Uv,WriteBatch:Fv,DocumentReference:zv,DocumentSnapshot:ng,Query:ig,QueryDocumentSnapshot:rg,QuerySnapshot:sg,CollectionReference:ug,FieldPath:Ee,FieldValue:o,setLogLevel:function(t){Nr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(Tg=e.default).INTERNAL.registerComponent(new _g("firestore",function(t){var e=t.getProvider("app").getImmediate();return e=e,t=t.getProvider("auth-internal"),new xv(e,new vy(e,t),new Av)},"PUBLIC").setServiceProps(Object.assign({},Sg))),Tg.registerVersion("@firebase/firestore","2.1.3-2021019222814"),(Ng=xv).prototype.loadBundle=function(t){return Ig(this,t)},Ng.prototype.namedQuery=function(t){return t=t,function(n,r){var t=this;return n.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.Eo.Ls(t,e)})},[4,ay(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(wy((e=this)._),t).then(function(t){return t?new ig(e,new $p(e._,null,t.query)):null});var e}}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
