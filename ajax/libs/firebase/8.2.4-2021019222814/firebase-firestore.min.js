!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(sg){"use strict";try{(function(){var l,t,e=(t=sg)&&"object"==typeof t&&"default"in t?t:{default:t};function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function n(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=u[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(ge=l=l||{})[ge.DEBUG=0]="DEBUG",ge[ge.VERBOSE=1]="VERBOSE",ge[ge.INFO=2]="INFO",ge[ge.WARN=3]="WARN",ge[ge.ERROR=4]="ERROR",ge[ge.SILENT=5]="SILENT";var r={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},i=l.INFO,u=((me={})[l.DEBUG]="log",me[l.VERBOSE]="log",me[l.INFO]="info",me[l.WARN]="warn",me[l.ERROR]="error",me),o=(Object.defineProperty(a.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),a.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?r[t]:t},Object.defineProperty(a.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),a.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},a.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},a.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},a.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},a.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},a);function a(t){this.name=t,this._logLevel=i,this._logHandler=n,this._userLogHandler=null}var c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function h(t,e){function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function f(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(h(w,d=Error),w);function w(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(I.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(_,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},I);function I(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var _=/\{\$([^}]+)}/g,E=function(t,e){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=N||self;function A(){}function x(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function D(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var k="closure_uid_"+(1e9*Math.random()>>>0),O=0;function L(t,e,n){return t.call.apply(t.bind,arguments)}function P(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?L:P).apply(null,arguments)}function R(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function V(){return Date.now()}function M(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function U(){this.j=this.j,this.i=this.i}U.prototype.j=!1,U.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,k)&&this[k]||(this[k]=++O))},U.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},j=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function q(){return Array.prototype.concat.apply([],arguments)}function H(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function B(t){return/^[\s\xa0]*$/.test(t)}var G=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function z(t,e){return-1!=t.indexOf(e)}function K(t,e){return t<e?-1:e<t?1:0}var J=S.navigator;function W(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function X(t){var e,n={};for(e in t)n[e]=t[e];return n}ut=(J=J&&J.userAgent)?J:"";var Y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Q(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Y.length;i++)e=Y[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function $(t){return $[" "](t),t}$[" "]=A;var Z,tt=z(ut,"Opera"),et=z(ut,"Trident")||z(ut,"MSIE"),nt=z(ut,"Edge"),rt=nt||et,it=z(ut,"Gecko")&&!(z(ut.toLowerCase(),"webkit")&&!z(ut,"Edge"))&&!(z(ut,"Trident")||z(ut,"MSIE"))&&!z(ut,"Edge"),ot=z(ut.toLowerCase(),"webkit")&&!z(ut,"Edge");function st(){var t=S.document;return t?t.documentMode:void 0}var J="",ut=(ut=ut,it?/rv:([^\);]+)(\)|;)/.exec(ut):nt?/Edge\/([\d\.]+)/.exec(ut):et?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):ot?/WebKit\/(\S+)/.exec(ut):tt?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);ut&&(J=ut?ut[1]:""),Z=et&&null!=(ut=st())&&ut>parseFloat(J)?String(ut):J;var at={};function ct(u){return t=u,e=function(){for(var t=0,e=G(String(Z)).split("."),n=G(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=K(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||K(0==o[2].length,0==s[2].length)||K(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=at,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var ht=S.document&&et&&(st()||parseInt(Z,10))||void 0,ft=!et||9<=Number(ht),lt=et&&!ct("9"),pt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",A,e),S.removeEventListener("test",A,e)}catch(t){}return t}();function dt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function yt(t,e){if(dt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(it){t:{try{$(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:vt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}dt.prototype.b=function(){this.defaultPrevented=!0},M(yt,dt);var vt={2:"touch",3:"pen",4:"mouse"};yt.prototype.b=function(){yt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,lt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var gt="closure_listenable_"+(1e6*Math.random()|0),mt=0;function wt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++mt,this.Y=this.Z=!1}function bt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function It(t){this.src=t,this.a={},this.b=0}function _t(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(bt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Et(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}It.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Et(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new wt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Tt="closure_lm_"+(1e6*Math.random()|0),Nt={};function St(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Ct(r),e&&e[gt]?e.wa(n,r,D(i)?!!i.capture:!!i,o):At(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)St(t,e[o],n,r,i);return null}return n=Ct(n),t&&t[gt]?t.va(e,n,D(r)?!!r.capture:!!r,i):At(t,e,n,!1,r,i)}function At(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=D(i)?!!i.capture:!!i;if(s&&!ft)return null;var u,a,c=Lt(t);if(c||(t[Tt]=c=new It(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Ot,r=a=ft?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)pt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Dt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function xt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[gt]?_t(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Dt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Lt(e))?(_t(n,t),0==n.b&&(n.src=null,e[Tt]=null)):bt(t)))}function Dt(t){return t in Nt?Nt[t]:Nt[t]="on"+t}function kt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&xt(t),n.call(r,e)}function Ot(t,e){if(t.Y)return!0;if(ft)return kt(t,new yt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return kt(t,e=new yt(e,this))}function Lt(t){return(t=t[Tt])instanceof It?t:null}var Pt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ct(e){return"function"==typeof e?e:(e[Pt]||(e[Pt]=function(t){return e.handleEvent(t)}),e[Pt])}function Rt(){U.call(this),this.c=new It(this),(this.J=this).C=null}function Vt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new dt(e,t):e instanceof dt?e.target=e.target||t:(s=e,Q(e=new dt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Mt(o,r,!0,e)&&s;if(s=Mt(o=e.a=t,r,!0,e)&&s,s=Mt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Mt(o=e.a=n[i],r,!1,e)&&s}function Mt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&_t(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}M(Rt,U),Rt.prototype[gt]=!0,(ut=Rt.prototype).addEventListener=function(t,e,n,r){St(this,t,e,n,r)},ut.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=D(i)?!!i.capture:!!i,r=Ct(r),e&&e[gt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Et(s=e.a[n],r,i,o))&&(bt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Lt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Et(n,r,i,o)),(r=-1<e?n[e]:null)&&xt(r))}(this,t,e,n,r)},ut.G=function(){if(Rt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)bt(n[r]);delete e.a[t],e.b--}}this.C=null},ut.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},ut.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ut=S.JSON.stringify;function Ft(){this.b=this.a=null}var jt,qt=(Ht.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Ht(function(){return new Bt},function(t){t.reset()}));function Ht(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Bt(){this.next=this.b=this.a=null}function Gt(t,e){var n;jt||(n=S.Promise.resolve(void 0),jt=function(){n.then(Jt)}),zt||(jt(),zt=!0),Kt.add(t,e)}Ft.prototype.add=function(t,e){var n=qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Bt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var zt=!(Bt.prototype.reset=function(){this.next=this.b=this.a=null}),Kt=new Ft;function Jt(){for(var t,e;n=e=void 0,n=null,(e=Kt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=qt;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}zt=!1}function Wt(t,e){Rt.call(this),this.b=t||1,this.a=e||S,this.f=C(this.Za,this),this.g=V()}function Xt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Yt(t,e,n){if("function"==typeof t)n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}M(Wt,Rt),(ut=Wt.prototype).aa=!1,ut.M=null,ut.Za=function(){var t;this.aa&&(0<(t=V()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Vt(this,"tick"),this.aa&&(Xt(this),this.start())))},ut.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=V())},ut.G=function(){Wt.X.G.call(this),Xt(this),delete this.a};var Qt,$t,Zt=(E($t=ee,J=Qt=U),$t.prototype=null===J?Object.create(J):(te.prototype=J.prototype,new te),ee.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Yt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ee.prototype.G=function(){Qt.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ee);function te(){this.constructor=$t}function ee(t,e){var n=Qt.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ne(t){U.call(this),this.b=t,this.a={}}M(ne,U);var re=[];function ie(t,e,n,r){Array.isArray(n)||(n&&(re[0]=n.toString()),n=re);for(var i=0;i<n.length;i++){var o=St(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function oe(t){W(t.a,function(t,e){this.a.hasOwnProperty(e)&&xt(t)},t),t.a={}}function se(){this.a=!0}function ue(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Ut(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ne.prototype.G=function(){ne.X.G.call(this),oe(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},se.prototype.info=function(){};var ae={},ce=null;function he(){return ce=ce||new Rt}function fe(t){dt.call(this,ae.Fa,t)}function le(){var t=he();Vt(t,new fe(t))}function pe(t,e){dt.call(this,ae.STAT_EVENT,t),this.stat=e}function de(t){var e=he();Vt(e,new pe(e,t))}function ye(t){dt.call(this,ae.Ga,t)}function ve(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}ae.Fa="serverreachability",M(fe,dt),ae.STAT_EVENT="statevent",M(pe,dt),ae.Ga="timingevent",M(ye,dt);var ge={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},me={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function we(){}function be(t){var e;return(e=t.a)||(e=t.a={}),e}function Ie(){}we.prototype.a=null;var _e,N={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Ee(){dt.call(this,"d")}function Te(){dt.call(this,"c")}function Ne(){}function Se(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ne(this),this.P=Ae,t=rt?125:void 0,this.R=new Wt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}M(Ee,dt),M(Te,dt),M(Ne,we),_e=new Ne;var Ae=45e3,xe={},De={};function ke(t,e,n){t.H=1,t.i=Qe(ze(e)),t.j=n,t.I=!0,Oe(t,null)}function Oe(t,e){t.u=V(),Pe(t),t.l=ze(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),fn(n.b,"t",r),t.D=0,t.a=ir(t.g,t.g.C?e:null),0<t.O&&(t.F=new Zt(C(t.Ca,t,t.a),t.O)),ie(t.J,t.a,"readystatechange",t.Xa),e=t.B?X(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),le(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Le(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?De:(i=Number(u.substring(i,o)),isNaN(i)?xe:(o+=1)+i>u.length?De:(u=u.substr(o,i),r.D=o+i,u)));if(u==De){4==e&&(t.h=4,de(14),s=!1),ue(t.c,t.f,null,"[Incomplete Response]");break}if(u==xe){t.h=4,de(15),ue(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}ue(t.c,t.f,u,null),Ue(t,u)}4==e&&0==n.length&&(t.h=1,de(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Yn(e),e.F=!0,de(11))):(ue(t.c,t.f,n,"[Invalid Chunked Response]"),Me(t),Ve(t))}function Pe(t){t.T=V()+t.P,Ce(t,t.P)}function Ce(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ve(C(t.Va,t),e)}function Re(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Ve(t){0==t.g.v||t.A||Zn(t.g,t)}function Me(t){Re(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Xt(t.R),oe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ue(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||mn(u.b,t)))if(u.I=t.N,!t.C&&mn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;$n(u),qn(u)}Xn(u),de(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=ve(C(u.Sa,u),6e3));if(gn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else er(u,11)}else if(!t.C&&u.a!=t||$n(u),!B(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(z(r,"spdy")||z(r,"quic")||z(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(wn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Ye(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=V()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=rr(n,n.C?n.ga:null,n.fa),i.C?(bn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Re(o),Pe(o)),n.a=i):Wn(n),0<u.g.length&&Gn(u)):"stop"!=c[0]&&"close"!=c[0]||er(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?er(u,7):jn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);le()}catch(t){}}function Fe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)j(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(x(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function je(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof je)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];He(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)He(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(ut=Se.prototype).setTimeout=function(t){this.P=t},ut.Xa=function(t){t=t.target;var e=this.F;e&&3==Vn(t)?e.f():this.Ca(t)},ut.Ca=function(t){try{if(t==this.a)t:{var e=Vn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!rt&&!this.a.$())){this.A||4!=e||7==n||le(),Re(this);var i=this.a.W();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,de(12),Me(this),Ve(this);break t}ue(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ue(this,s)}this.I?(Le(this,e,n),rt&&this.b&&3==e&&(ie(this.J,this.R,"tick",this.Wa),this.R.start())):(ue(this.c,this.f,n,null),Ue(this,n)),4==e&&Me(this),this.b&&!this.A&&(4==e?Zn(this.g,this):(this.b=!1,Pe(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,de(12)):(this.h=0,de(13)),Me(this),Ve(this)}}}catch(t){}var u,a,c,h,f,l},ut.Wa=function(){var t,e;this.a&&(t=Vn(this.a),e=this.a.$(),this.D<e.length&&(Re(this),Le(this,t,e),this.b&&4!=t&&Pe(this)))},ut.cancel=function(){this.A=!0,Me(this)},ut.Va=function(){this.o=null;var t,e,n=V();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(le(),de(17)),Me(this),this.h=2,Ve(this)):Ce(this,this.T-n)},(ut=je.prototype).K=function(){qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},ut.L=function(){return qe(this),this.a.concat()},ut.get=function(t,e){return He(this.b,t)?this.b[t]:e},ut.set=function(t,e){He(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},ut.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Be=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ge(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ge?(this.a=void 0!==e?e:t.a,Ke(this,t.f),this.j=t.j,Je(this,t.c),We(this,t.h),this.g=t.g,e=t.b,(n=new un).c=e.c,e.a&&(n.a=new je(e.a),n.b=e.b),Xe(this,n),this.i=t.i):t&&(n=String(t).match(Be))?(this.a=!!e,Ke(this,n[1]||"",!0),this.j=$e(n[2]||""),Je(this,n[3]||"",!0),We(this,n[4]),this.g=$e(n[5]||"",!0),Xe(this,n[6]||"",!0),this.i=$e(n[7]||"")):(this.a=!!e,this.b=new un(null,this.a))}function ze(t){return new Ge(t)}function Ke(t,e,n){t.f=n?$e(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?$e(e,!0):e}function We(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Xe(t,e,n){var r,i;e instanceof un?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(an(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(cn(this,e),fn(this,n,t))},r)),r.f=i):(n||(e=Ze(e,on)),t.b=new un(e,t.a))}function Ye(t,e,n){t.b.set(e,n)}function Qe(t){return Ye(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^V()).toString(36)),t}function $e(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ze(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ge.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ze(e,en,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(Ze(e,en,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ze(n,"/"==n.charAt(0)?rn:nn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Ze(n,sn)),t.join("")};var en=/[#\/\?@]/g,nn=/[#\?:]/g,rn=/[#\?]/g,on=/[#\?@]/g,sn=/#/g;function un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function an(o){o.a||(o.a=new je,o.b=0,o.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function cn(t,e){an(t),e=ln(t,e),He(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,He((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&qe(t)))}function hn(t,e){return an(t),e=ln(t,e),He(t.a.b,e)}function fn(t,e,n){cn(t,e),0<n.length&&(t.c=null,t.a.set(ln(t,e),H(n)),t.b+=n.length)}function ln(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(ut=un.prototype).add=function(t,e){an(this),this.c=null,t=ln(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},ut.forEach=function(n,r){an(this),this.a.forEach(function(t,e){j(t,function(t){n.call(r,t,e,this)},this)},this)},ut.L=function(){an(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},ut.K=function(t){an(this);var e=[];if("string"==typeof t)hn(this,t)&&(e=q(e,this.a.get(ln(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=q(e,t[n])}return e},ut.set=function(t,e){return an(this),this.c=null,hn(this,t=ln(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},ut.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},ut.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};function pn(t,e){this.b=t,this.a=e}function dn(t){this.g=t||yn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var yn=10;function vn(t){return t.b||t.a&&t.a.size>=t.f}function gn(t){return t.b?1:t.a?t.a.size:0}function mn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function wn(t,e){t.a?t.a.add(e):t.b=e}function bn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function In(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return H(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function _n(){}function En(){this.a=new _n}function Tn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}dn.prototype.cancel=function(){var t,e;if(this.c=In(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},_n.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},_n.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var Nn=S.JSON.parse;function Sn(t){Rt.call(this),this.headers=new je,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=An,this.D=this.F=!1}M(Sn,Rt);var An="",xn=/^https?$/i,Dn=["POST","PUT"];function kn(t){return"content-type"==t.toLowerCase()}function On(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Ln(t),Cn(t)}function Ln(t){t.u||(t.u=!0,Vt(t,"complete"),Vt(t,"error"))}function Pn(t){if(t.b&&(!t.s[1]||4!=Vn(t)||2!=t.W()))if(t.l&&4==Vn(t))Yt(t.za,0,t);else if(Vt(t,"readystatechange"),4==Vn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Be)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!xn.test(i?i.toLowerCase():"")),e=n),e)Vt(t,"complete"),Vt(t,"success");else{t.h=6;try{var u=2<Vn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Ln(t)}}finally{Cn(t)}}}function Cn(t,e){if(t.a){Rn(t);var n=t.a,r=t.s[0]?A:null;t.a=null,t.s=null,e||Vt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Rn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Vn(t){return t.a?t.a.readyState:0}function Mn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",W(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ye(t,e,n))}function Un(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Fn(t){this.pa=0,this.g=[],this.c=new se,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Un("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Un("baseRetryDelayMs",5e3,t),this.Ra=Un("retryDelaySeedMs",1e4,t),this.Ma=Un("forwardChannelMaxRetries",2,t),this.ma=Un("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new dn(t&&t.concurrentRequestLimit),this.ka=new En,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function jn(t){var e,n;Hn(t),3==t.v&&(e=t.R++,Ye(n=ze(t.B),"SID",t.J),Ye(n,"RID",e),Ye(n,"TYPE","terminate"),Kn(t,n),(e=new Se(t,t.c,e,void 0)).H=2,e.i=Qe(ze(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=ir(e.g,null),e.a.ba(e.i)),e.u=V(),Pe(e)),nr(t)}function qn(t){t.a&&(Yn(t),t.a.cancel(),t.a=null)}function Hn(t){qn(t),t.j&&(S.clearTimeout(t.j),t.j=null),$n(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Bn(t,e){t.g.push(new pn(t.Oa++,e)),3==t.v&&Gn(t)}function Gn(t){vn(t.b)||t.h||(t.h=!0,Gt(t.Ba,t),t.u=0)}function zn(t,e){var n=e?e.f:t.R++,r=ze(t.B);Ye(r,"SID",t.J),Ye(r,"RID",n),Ye(r,"AID",t.P),Kn(t,r),t.i&&t.l&&Mn(r,t.i,t.l),n=new Se(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),wn(t.b,n),ke(n,r,e)}function Kn(t,n){t.f&&Fe({},function(t,e){Ye(n,e,t)})}function Jn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?C(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{Fe(t,function(t,e){var n=t;D(t)&&(n=Ut(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Wn(t){t.a||t.j||(t.T=1,Gt(t.Aa,t),t.o=0)}function Xn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ve(C(t.Aa,t),tr(t,t.o)),t.o++,1)}function Yn(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function Qn(t){t.a=new Se(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=ze(t.la);Ye(e,"RID","rpc"),Ye(e,"SID",t.J),Ye(e,"CI",t.H?"0":"1"),Ye(e,"AID",t.P),Kn(t,e),Ye(e,"TYPE","xmlhttp"),t.i&&t.l&&Mn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Qe(ze(e)),n.j=null,n.I=!0,Oe(n,t)}function $n(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function Zn(t,e){var n,r,i,o=null;if(t.a==e){$n(t),Yn(t),t.a=null;var s=2}else{if(!mn(t.b,e))return;o=e.s,bn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=V()-e.u,n=t.u,Vt(s=he(),new ye(s)),Gn(t)):Wn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,gn((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.La?0:r.Ma)||(r.h=ve(C(r.Ba,r,i),tr(r,r.u)),r.u++,0))))&&(2!=s||!Xn(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function er(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=C(t.Ya,t),r||(r=new Ge("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Ke(r,"https"),Qe(r)),n=r.toString(),r=o,o=new se,S.Image?((i=new Image).onload=R(Tn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=R(Tn,o,i,"TestLoadImage: error",!1,r),i.onabort=R(Tn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=R(Tn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):de(2),t.v=0,t.f&&t.f.ra(e),nr(t),Hn(t)}function nr(t){t.v=0,t.I=-1,t.f&&(0==In(t.b).length&&0==t.g.length||(t.b.c.length=0,H(t.g),t.g.length=0),t.f.qa())}function rr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ge?ze(s):new Ge(s,void 0);return""!=a.c?(e&&Je(a,e+"."+a.c),We(a,a.h)):(r=(u=S.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ge(null,void 0),r&&Ke(u,r),i&&Je(u,i),o&&We(u,o),s&&(u.g=s),a=u),t.V&&W(t.V,function(t,e){Ye(a,e,t)}),e=t.A,n=t.na,e&&n&&Ye(a,e,n),Ye(a,"VER",t.ha),Kn(t,a),a}function ir(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Sn(t.Na)).F=t.C,e}function or(){}function sr(){if(et&&!(10<=Number(ht)))throw Error("Environmental error: no available transport.")}function ur(t,e){Rt.call(this),this.a=new Fn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!B(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!B(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new hr(this)}function ar(t){Ee.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function cr(){Te.call(this),this.status=1}function hr(t){this.a=t}(ut=Sn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?be(this.H):be(_e),this.a.onreadystatechange=C(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void On(this,t)}t=n||"";var i,o=new je(this.headers);r&&Fe(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=kn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=F(Dn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Rn(this),0<this.o&&((this.D=(i=this.a,et&&ct(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.xa,this)):this.m=Yt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){On(this,t)}},ut.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Vt(this,"timeout"),this.abort(8))},ut.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Vt(this,"complete"),Vt(this,"abort"),Cn(this))},ut.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Cn(this,!0)),Sn.X.G.call(this)},ut.za=function(){this.j||(this.A||this.l||this.g?Pn(this):this.Ua())},ut.Ua=function(){Pn(this)},ut.W=function(){try{return 2<Vn(this)?this.a.status:-1}catch(t){return-1}},ut.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},ut.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Nn(e)}},ut.ua=function(){return this.h},ut.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(ut=Fn.prototype).ha=8,ut.v=1,ut.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Se(this,this.c,t,void 0),r=this.l;if(this.O&&(r?Q(r=X(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),Ye(i=ze(this.B),"RID",t),Ye(i,"CVER",22),this.A&&Ye(i,"X-HTTP-Session-Id",this.A),Kn(this,i),this.i&&r&&Mn(i,this.i,r),wn(this.b,n),this.Ia&&Ye(i,"TYPE","init"),this.da?(Ye(i,"$req",e),Ye(i,"SID","null"),n.U=!0,ke(n,i,null)):ke(n,i,e),this.v=2}}else 3==this.v&&(t?zn(this,t):0==this.g.length||vn(this.b)||zn(this))},ut.Aa=function(){var t;this.j=null,Qn(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=ve(C(this.Ta,this),t))},ut.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,de(10),qn(this),Qn(this))},ut.Sa=function(){null!=this.m&&(this.m=null,qn(this),Xn(this),de(19))},ut.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),de(2)):(this.c.info("Failed to ping google.com"),de(1))},(ut=or.prototype).ta=function(){},ut.sa=function(){},ut.ra=function(){},ut.qa=function(){},ut.Ja=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},M(ur,Rt),ur.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;de(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=rr(t,null,t.fa),Gn(t)},ur.prototype.close=function(){jn(this.a)},ur.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Bn(this.a,e)):this.l?((e={}).__data__=Ut(t),Bn(this.a,e)):Bn(this.a,t)},ur.prototype.G=function(){this.a.f=null,delete this.f,jn(this.a),delete this.a,ur.X.G.call(this)},M(ar,Ee),M(cr,Te),M(hr,or),hr.prototype.ta=function(){Vt(this.a,"a")},hr.prototype.sa=function(t){Vt(this.a,new ar(t))},hr.prototype.ra=function(t){Vt(this.a,new cr)},hr.prototype.qa=function(){Vt(this.a,"b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.h,ur.prototype.open=ur.prototype.g,ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,me.COMPLETE="complete",(Ie.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",Rt.prototype.listen=Rt.prototype.va,Sn.prototype.listenOnce=Sn.prototype.wa,Sn.prototype.getLastError=Sn.prototype.Qa,Sn.prototype.getLastErrorCode=Sn.prototype.ua,Sn.prototype.getStatus=Sn.prototype.W,Sn.prototype.getResponseJson=Sn.prototype.Pa,Sn.prototype.getResponseText=Sn.prototype.$,Sn.prototype.send=Sn.prototype.ba;var fr=he,lr=ge,pr=me,dr=ae,yr=Ie,vr=Sn,gr="8.2.4-2021019222814",mr=new o("@firebase/firestore");function wr(){return mr.logLevel}function br(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];mr.logLevel<=l.DEBUG&&(e=n.map(Er),mr.debug.apply(mr,f(["Firestore ("+gr+"): "+t],e)))}function Ir(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];mr.logLevel<=l.ERROR&&(e=n.map(Er),mr.error.apply(mr,f(["Firestore ("+gr+"): "+t],e)))}function _r(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];mr.logLevel<=l.WARN&&(e=n.map(Er),mr.warn.apply(mr,f(["Firestore ("+gr+"): "+t],e)))}function Er(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Tr(t){throw void 0===t&&(t="Unexpected state"),Ir(t="FIRESTORE ("+gr+") INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Nr(t){t||Tr()}var Sr=(Ar.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Ar);function Ar(){}function xr(t,e){return t<e?-1:e<t?1:0}function Dr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function kr(t){return t+"\0"}var Or=(Lr.fromBase64String=function(t){return new Lr(atob(t))},Lr.fromUint8Array=function(t){return new Lr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Lr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},Lr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},Lr.prototype.o=function(){return 2*this.i.length},Lr.prototype.u=function(t){return xr(this.i,t.i)},Lr.prototype.isEqual=function(t){return this.i===t.i},Lr);function Lr(t){this.i=t}Or.h=new Or("");var Pr,Cr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Rr=(h(Fr,Pr=Error),Fr),Vr=(Ur.fromBase64String=function(t){try{return new Ur(Or.fromBase64String(t))}catch(t){throw new Rr(Cr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},Ur.fromUint8Array=function(t){return new Ur(Or.fromUint8Array(t))},Ur.prototype.toBase64=function(){return this.l.toBase64()},Ur.prototype.toUint8Array=function(){return this.l.toUint8Array()},Ur.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Ur.prototype.isEqual=function(t){return this.l.isEqual(t.l)},Ur),Mr=function(t){this._=t};function Ur(t){this.l=t}function Fr(t,e){var n=this;return(n=Pr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function jr(){if("undefined"==typeof Uint8Array)throw new Rr(Cr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function qr(){if("undefined"==typeof atob)throw new Rr(Cr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Hr,Br=(h(Xr,Hr=Mr),Xr.fromBase64String=function(t){return qr(),new Xr(Vr.fromBase64String(t))},Xr.fromUint8Array=function(t){return jr(),new Xr(Vr.fromUint8Array(t))},Xr.prototype.toBase64=function(){return qr(),this._.toBase64()},Xr.prototype.toUint8Array=function(){return jr(),this._.toUint8Array()},Xr.prototype.isEqual=function(t){return this._.isEqual(t._)},Xr.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Xr),Gr=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.I=o},zr=(Object.defineProperty(Wr.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Wr.prototype.isEqual=function(t){return t instanceof Wr&&t.projectId===this.projectId&&t.database===this.database},Wr),Kr=(Jr.prototype.A=function(){return null!=this.uid},Jr.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},Jr.prototype.isEqual=function(t){return t.uid===this.uid},Jr);function Jr(t){this.uid=t}function Wr(t,e){this.projectId=t,this.database=e||"(default)"}function Xr(){return null!==Hr&&Hr.apply(this,arguments)||this}function Yr(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t}Kr.UNAUTHENTICATED=new Kr(null),Kr.P=new Kr("google-credentials-uid"),Kr.g=new Kr("first-party-uid");var Qr=(si.prototype.getToken=function(){return Promise.resolve(null)},si.prototype.v=function(){},si.prototype.S=function(t){(this.p=t)(Kr.UNAUTHENTICATED)},si.prototype.D=function(){this.p=null},si),$r=(oi.prototype.getToken=function(){var e=this,n=this.F,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.F!==n?(br("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Nr("string"==typeof t.accessToken),new Yr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},oi.prototype.v=function(){this.forceRefresh=!0},oi.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},oi.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},oi.prototype.O=function(){var t=this.auth&&this.auth.getUid();return Nr(null===t||"string"==typeof t),new Kr(t)},oi),Zr=(Object.defineProperty(ii.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),ii),ti=(ri.prototype.getToken=function(){return Promise.resolve(new Zr(this.k,this.M))},ri.prototype.S=function(t){t(Kr.g)},ri.prototype.D=function(){},ri.prototype.v=function(){},ri),ei=(ni.prototype.L=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ni.prototype.next=function(){var t=++this.previousValue;return this.B&&this.B(t),t},ni);function ni(t,e){var n=this;this.previousValue=t,e&&(e.$=function(t){return n.L(t)},this.B=function(t){return e.q(t)})}function ri(t,e){this.k=t,this.M=e}function ii(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=Kr.g}function oi(t){var e=this;this.C=null,this.currentUser=Kr.UNAUTHENTICATED,this.N=!1,this.F=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.F++,e.currentUser=e.O(),e.N=!0,e.p&&e.p(e.currentUser)},this.F=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}function si(){this.p=null}ei.U=-1;var ui,ai,ci=(bi.now=function(){return bi.fromMillis(Date.now())},bi.fromDate=function(t){return bi.fromMillis(t.getTime())},bi.fromMillis=function(t){var e=Math.floor(t/1e3);return new bi(e,1e6*(t-1e3*e))},bi.prototype.toDate=function(){return new Date(this.toMillis())},bi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},bi.prototype.K=function(t){return this.seconds===t.seconds?xr(this.nanoseconds,t.nanoseconds):xr(this.seconds,t.seconds)},bi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},bi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},bi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},bi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},bi),hi=(wi.W=function(t){return new wi(t)},wi.min=function(){return new wi(new ci(0,0))},wi.prototype.u=function(t){return this.timestamp.K(t.timestamp)},wi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},wi.prototype.j=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},wi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},wi.prototype.G=function(){return this.timestamp},wi),me=(Object.defineProperty(mi.prototype,"length",{get:function(){return this.H},enumerable:!1,configurable:!0}),mi.prototype.isEqual=function(t){return 0===mi.J(this,t)},mi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof mi?t.forEach(function(t){e.push(t)}):e.push(t),this.Y(e)},mi.prototype.limit=function(){return this.offset+this.length},mi.prototype.X=function(t){return t=void 0===t?1:t,this.Y(this.segments,this.offset+t,this.length-t)},mi.prototype.Z=function(){return this.Y(this.segments,this.offset,this.length-1)},mi.prototype.tt=function(){return this.segments[this.offset]},mi.prototype.et=function(){return this.get(this.length-1)},mi.prototype.get=function(t){return this.segments[this.offset+t]},mi.prototype.nt=function(){return 0===this.length},mi.prototype.st=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},mi.prototype.it=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},mi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},mi.prototype.rt=function(){return this.segments.slice(this.offset,this.limit())},mi.J=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},mi),fi=(h(gi,ai=me),gi.prototype.Y=function(t,e,n){return new gi(t,e,n)},gi.prototype.ot=function(){return this.rt().join("/")},gi.prototype.toString=function(){return this.ot()},gi.ct=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Rr(Cr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new gi(n)},gi.at=function(){return new gi([])},gi),li=/^[_a-zA-Z][_a-zA-Z0-9]*$/,pi=(h(vi,ui=me),vi.prototype.Y=function(t,e,n){return new vi(t,e,n)},vi.ut=function(t){return li.test(t)},vi.prototype.ot=function(){return this.rt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),vi.ut(t)||(t="`"+t+"`"),t}).join(".")},vi.prototype.toString=function(){return this.ot()},vi.prototype.ht=function(){return 1===this.length&&"__name__"===this.get(0)},vi.lt=function(){return new vi(["__name__"])},vi._t=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Rr(Cr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Rr(Cr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Rr(Cr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new vi(e)},vi.at=function(){return new vi([])},vi),di=(yi.ft=function(t){return new yi(fi.ct(t))},yi.dt=function(t){return new yi(fi.ct(t).X(5))},yi.prototype.wt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},yi.prototype.isEqual=function(t){return null!==t&&0===fi.J(this.path,t.path)},yi.prototype.toString=function(){return this.path.toString()},yi.J=function(t,e){return fi.J(t.path,e.path)},yi.Et=function(t){return t.length%2==0},yi.Tt=function(t){return new yi(new fi(t.slice()))},yi);function yi(t){this.path=t}function vi(){return null!==ui&&ui.apply(this,arguments)||this}function gi(){return null!==ai&&ai.apply(this,arguments)||this}function mi(t,e,n){void 0===e?e=0:e>t.length&&Tr(),void 0===n?n=t.length-e:n>t.length-e&&Tr(),this.segments=t,this.offset=e,this.H=n}function wi(t){this.timestamp=t}function bi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Rr(Cr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Rr(Cr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Rr(Cr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Rr(Cr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Ii(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function _i(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ei(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ti=(Si.prototype.It=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].st(t))return!0;return!1},Si.prototype.isEqual=function(t){return Dr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Si),Ni=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Si(t){(this.fields=t).sort(pi.J)}function Ai(t){if(Nr(!!t),"string"!=typeof t)return{seconds:xi(t.seconds),nanos:xi(t.nanos)};var e=0,n=Ni.exec(t);return Nr(!!n),n[1]&&(n=(n[1]+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function xi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Di(t){return"string"==typeof t?Or.fromBase64String(t):Or.fromUint8Array(t)}function ki(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Oi(t){return t=Ai(t.mapValue.fields.__local_write_time__.timestampValue),new ci(t.seconds,t.nanos)}function Li(t){return null==t}function Pi(t){return 0===t&&1/t==-1/0}function Ci(t){return"number"==typeof t&&Number.isInteger(t)&&!Pi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Ri(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ki(t)?4:10:Tr()}function Vi(r,i){var t,e=Ri(r);if(e!==Ri(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Oi(r).isEqual(Oi(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Ai(r.timestampValue),t=Ai(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Di(r.bytesValue).isEqual(Di(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,xi((t=r).geoPointValue.latitude)===xi(e.geoPointValue.latitude)&&xi(t.geoPointValue.longitude)===xi(e.geoPointValue.longitude);case 2:return t=i,"integerValue"in(e=r)&&"integerValue"in t?xi(e.integerValue)===xi(t.integerValue):"doubleValue"in e&&"doubleValue"in t&&((e=xi(e.doubleValue))===(t=xi(t.doubleValue))?Pi(e)===Pi(t):isNaN(e)&&isNaN(t));case 9:return Dr(r.arrayValue.values||[],i.arrayValue.values||[],Vi);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Ii(e)!==Ii(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Vi(e[t],n[t])))return!1;return!0}();default:return Tr()}}function Mi(t,e){return void 0!==(t.values||[]).find(function(t){return Vi(t,e)})}function Ui(t,e){var n,r,i,o=Ri(t),s=Ri(e);if(o!==s)return xr(o,s);switch(o){case 0:return 0;case 1:return xr(t.booleanValue,e.booleanValue);case 2:return n=e,(r=xi(t.integerValue||t.doubleValue))<(n=xi(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Fi(t.timestampValue,e.timestampValue);case 4:return Fi(Oi(t),Oi(e));case 5:return xr(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,s=e.bytesValue,i=Di(i),s=Di(s),i.u(s);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=xr(n[i],r[i]);if(0!==o)return o}return xr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return o=t.geoPointValue,r=e.geoPointValue,0!==(n=xr(xi(o.latitude),xi(r.latitude)))?n:xr(xi(o.longitude),xi(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ui(n[i],r[i]);if(o)return o}return xr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=xr(r[s],o[s]);if(0!==u)return u;if(0!==(u=Ui(n[r[s]],i[o[s]])))return u}return xr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Tr()}}function Fi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return xr(t,e);var n=Ai(t),t=Ai(e);return 0!==(e=xr(n.seconds,t.seconds))?e:xr(n.nanos,t.nanos)}function ji(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Ai(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Di(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,di.dt(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Tr();var t,e}(t)}function qi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.ot()}}function Hi(t){return t&&"integerValue"in t}function Bi(t){return!!t&&"arrayValue"in t}function Gi(t){return t&&"nullValue"in t}function zi(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ki(t){return t&&"mapValue"in t}var Ji=(Yi.empty=function(){return new Yi({mapValue:{}})},Yi.prototype.field=function(t){if(t.nt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ki(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.et()])||null},Yi.prototype.isEqual=function(t){return Vi(this.proto,t.proto)},Yi),Wi=(Xi.prototype.set=function(t,e){return this.Pt(t,e),this},Xi.prototype.delete=function(t){return this.Pt(t,null),this},Xi.prototype.Pt=function(t,e){for(var n=this.Rt,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Ri(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.et(),e)},Xi.prototype.yt=function(){var t=this.gt(pi.at(),this.Rt);return null!=t?new Ji(t):this.At},Xi.prototype.gt=function(r,t){var i=this,o=!1,e=this.At.field(r),s=Ki(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.gt(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Xi);function Xi(t){void 0===t&&(t=Ji.empty()),this.At=t,this.Rt=new Map}function Yi(t){this.proto=t}var Qi,$i,Zi,to=(h(so,Zi=o=function(t,e){this.key=t,this.version=e}),so.prototype.field=function(t){return this.Vt.field(t)},so.prototype.data=function(){return this.Vt},so.prototype.vt=function(){return this.Vt.proto},so.prototype.isEqual=function(t){return t instanceof so&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.bt===t.bt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Vt.isEqual(t.Vt)},so.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Vt.toString()+", {hasLocalMutations: "+this.bt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(so.prototype,"hasPendingWrites",{get:function(){return this.bt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),so),eo=(h(oo,$i=o),oo.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(oo.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),oo.prototype.isEqual=function(t){return t instanceof oo&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},oo),no=(h(io,Qi=o),io.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(io.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),io.prototype.isEqual=function(t){return t instanceof io&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},io),ro=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.St=null};function io(){return null!==Qi&&Qi.apply(this,arguments)||this}function oo(t,e,n){var r=this;return(r=$i.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function so(t,e,n,r){var i=this;return(i=Zi.call(this,t,e)||this).Vt=n,i.bt=!!r.bt,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function uo(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ro(t,e,n,r,i,o,s)}function ao(t){var e=t;return null===e.St&&(t=e.path.ot(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return t.field.ot()+t.op.toString()+ji(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return t.field.ot()+t.dir}).join(","),Li(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Uo(e.startAt)),e.endAt&&(t+="|ub:",t+=Uo(e.endAt)),e.St=t),e.St}function co(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Vi(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!qo(t.startAt,e.startAt)&&qo(t.endAt,e.endAt)}function ho(t){return di.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}var fo,lo=(h(po,fo=function(){}),po.create=function(t,e,n){return t.ht()?"in"===e||"not-in"===e?this.Dt(t,e,n):new mo(t,e,n):"array-contains"===e?new Do(t,n):"in"===e?new ko(t,n):"not-in"===e?new Oo(t,n):"array-contains-any"===e?new Lo(t,n):new po(t,e,n)},po.Dt=function(t,e,n){return new("in"===e?wo:bo)(t,n)},po.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.Ct(Ui(t,this.value)):null!==t&&Ri(this.value)===Ri(t)&&this.Ct(Ui(t,this.value))},po.prototype.Ct=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Tr()}},po.prototype.xt=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},po);function po(t,e,n){var r=this;return(r=fo.call(this)||this).field=t,r.op=e,r.value=n,r}var yo,vo,go,mo=(h(Eo,go=lo),Eo.prototype.matches=function(t){return t=di.J(t.key,this.key),this.Ct(t)},Eo),wo=(h(_o,vo=lo),_o.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},_o),bo=(h(Io,yo=lo),Io.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Io);function Io(t,e){var n=this;return(n=yo.call(this,t,"not-in",e)||this).keys=To(0,e),n}function _o(t,e){var n=this;return(n=vo.call(this,t,"in",e)||this).keys=To(0,e),n}function Eo(t,e,n){var r=this;return(r=go.call(this,t,e,n)||this).key=di.dt(n.referenceValue),r}function To(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return di.dt(t.referenceValue)})}var No,So,Ao,xo,Do=(h(Mo,xo=lo),Mo.prototype.matches=function(t){return Bi(t=t.field(this.field))&&Mi(t.arrayValue,this.value)},Mo),ko=(h(Vo,Ao=lo),Vo.prototype.matches=function(t){return null!==(t=t.field(this.field))&&Mi(this.value.arrayValue,t)},Vo),Oo=(h(Ro,So=lo),Ro.prototype.matches=function(t){return!Mi(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!Mi(this.value.arrayValue,t))},Ro),Lo=(h(Co,No=lo),Co.prototype.matches=function(t){var e=this;return!(!Bi(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Mi(e.value.arrayValue,t)})},Co),Po=function(t,e){this.position=t,this.before=e};function Co(t,e){return No.call(this,t,"array-contains-any",e)||this}function Ro(t,e){return So.call(this,t,"not-in",e)||this}function Vo(t,e){return Ao.call(this,t,"in",e)||this}function Mo(t,e){return xo.call(this,t,"array-contains",e)||this}function Uo(t){return(t.before?"b":"a")+":"+t.position.map(ji).join(",")}var Fo=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function jo(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.ht()?di.J(di.dt(s.referenceValue),n.key):Ui(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function qo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Vi(t.position[n],e.position[n]))return!1;return!0}var Ho=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Nt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Ft=null,this.Ot=null,this.startAt,this.endAt};function Bo(t,e,n,r,i,o,s,u){return new Ho(t,e,n,r,i,o,s,u)}function Go(t){return new Ho(t)}function zo(t){return!Li(t.limit)&&"F"===t.limitType}function Ko(t){return!Li(t.limit)&&"L"===t.limitType}function Jo(t){return 0<t.Nt.length?t.Nt[0].field:null}function Wo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.xt())return r.field}return null}function Xo(t){return null!==t.collectionGroup}function Yo(t){var e=t;if(null===e.Ft){e.Ft=[];var n=Wo(e),t=Jo(e);if(null!==n&&null===t)n.ht()||e.Ft.push(new Fo(n)),e.Ft.push(new Fo(pi.lt(),"asc"));else{for(var r=!1,i=0,o=e.Nt;i<o.length;i++){var s=o[i];e.Ft.push(s),s.field.ht()&&(r=!0)}r||(n=0<e.Nt.length?e.Nt[e.Nt.length-1].dir:"asc",e.Ft.push(new Fo(pi.lt(),n)))}}return e.Ft}function Qo(t){var e=t;if(!e.Ot)if("F"===e.limitType)e.Ot=uo(e.path,e.collectionGroup,Yo(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Yo(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Fo(o.field,s))}var u=e.endAt?new Po(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Po(e.startAt.position,!e.startAt.before):null;e.Ot=uo(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Ot}function $o(t,e,n){return new Ho(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Zo(t,e){return co(Qo(t),Qo(e))&&t.limitType===e.limitType}function ts(t){return ao(Qo(t))+"|lt:"+t.limitType}function es(t){return"Query(target="+(n=(e=Qo(t)).path.ot(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return t.field.ot()+" "+t.op+" "+ji(t.value)}).join(", ")+"]"),Li(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return t.field.ot()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Uo(e.startAt)),e.endAt&&(n+=", endAt: "+Uo(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function ns(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.wt(e.collectionGroup)&&e.path.st(n):di.Et(e.path)?e.path.isEqual(n):e.path.it(n))&&function(t){for(var e=0,n=i.Nt;e<n.length;e++){var r=n[e];if(!r.field.ht()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||jo(t.startAt,Yo(t),n))&&(!t.endAt||!jo(t.endAt,Yo(t),n)));var e,n}function rs(u){return function(t,e){for(var n=!1,r=0,i=Yo(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i;switch(n=t.field.ht()?di.J(e.key,n.key):(r=t.field,i=n,e=e.field(r),r=i.field(r),null!==e&&null!==r?Ui(e,r):Tr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Tr()}}(o,t,e);if(0!==s)return s;n=n||o.field.ht()}return 0}}var is=(os.prototype.$t=function(t){return new os(this.target,this.targetId,this.kt,t,this.Mt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},os.prototype.Lt=function(t,e){return new os(this.target,this.targetId,this.kt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},os.prototype.Bt=function(t){return new os(this.target,this.targetId,this.kt,this.sequenceNumber,this.Mt,t,this.resumeToken)},os);function os(t,e,n,r,i,o,s){void 0===i&&(i=hi.min()),void 0===o&&(o=hi.min()),void 0===s&&(s=Or.h),this.target=t,this.targetId=e,this.kt=n,this.sequenceNumber=r,this.Mt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function ss(t,e){if(t.qt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pi(e)?"-0":e}}function us(t){return{integerValue:""+t}}function as(t,e){return Ci(e)?us(e):ss(t,e)}function cs(t,e){return t instanceof _s?Hi(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var hs,fs,ls=(h(ys,fs=me=function(){this.Ut=void 0}),ys),ps=(h(ds,hs=me),ds);function ds(t){var e=this;return(e=hs.call(this)||this).elements=t,e}function ys(){return null!==fs&&fs.apply(this,arguments)||this}function vs(t,e){for(var n=Ns(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Vi(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var gs,ms=(h(ws,gs=me),ws);function ws(t){var e=this;return(e=gs.call(this)||this).elements=t,e}function bs(t,e){for(var n=Ns(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Vi(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Is,_s=(h(Es,Is=me),Es);function Es(t,e){var n=this;return(n=Is.call(this)||this).Kt=t,n.Qt=e,n}function Ts(t){return xi(t.integerValue||t.doubleValue)}function Ns(t){return Bi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Ss(t,e){this.version=t,this.transformResults=e}var As=function(t,e){this.field=t,this.transform=e},xs=(Ds.Wt=function(){return new Ds},Ds.exists=function(t){return new Ds(void 0,t)},Ds.updateTime=function(t){return new Ds(t)},Object.defineProperty(Ds.prototype,"jt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ds.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ds);function Ds(t,e){this.updateTime=t,this.exists=e}function ks(t,e){return void 0!==t.updateTime?e instanceof to&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof to}function Os(t,e,n,r){return t instanceof Vs?function(t,e,n){if(!ks(t.Gt,e))return e;var r=t.value,n=Hs(t.fieldTransforms,n,e),r=Bs(t.fieldTransforms,r,n),e=Ps(e);return new to(t.key,e,r,{bt:!0})}(t,e,r):t instanceof Ms?function(t,e,n){if(!ks(t.Gt,e))return e;var r=Ps(e),e=js(t,e,Hs(t.fieldTransforms,n,e));return new to(t.key,r,e,{bt:!0})}(t,e,r):ks(t.Gt,e)?new eo(t.key,hi.min()):e}function Ls(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gt.isEqual(e.Gt)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Dr(n,r,function(t,e){return t.field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof ps&&e instanceof ps||t instanceof ms&&e instanceof ms?Dr(t.elements,e.elements,Vi):t instanceof _s&&e instanceof _s?Vi(t.Qt,e.Qt):t instanceof ls&&e instanceof ls)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.zt.isEqual(e.zt));var n,r}function Ps(t){return t instanceof to?t.version:hi.min()}var Cs,Rs,Vs=(h(Fs,Rs=o=function(){}),Fs),Ms=(h(Us,Cs=o),Us);function Us(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=Cs.call(this)||this).key=t,o.data=e,o.zt=n,o.Gt=r,o.fieldTransforms=i,o.type=1,o}function Fs(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=Rs.call(this)||this).key=t,i.value=e,i.Gt=n,i.fieldTransforms=r,i.type=0,i}function js(t,e,n){var r,i,o=t;return e=e instanceof to?e.data():Ji.empty(),i=new Wi(e),o.zt.fields.forEach(function(t){var e;t.nt()||(null!==(e=o.data.field(t))?i.set(t,e):i.delete(t))}),r=i.yt(),Bs(t.fieldTransforms,r,n)}function qs(t,e,n){var r=[];Nr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof to&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof ps?vs(o,s):o instanceof ms?bs(o,s):u))}return r}function Hs(t,e,n){for(var r,i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof to&&(c=n.field(u.field)),i.push((r=c,u=e,c=void 0,a instanceof ls?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:u.seconds,nanos:u.nanoseconds}}}},r&&(c.fields.__previous_value__=r),{mapValue:c}):a instanceof ps?vs(a,r):a instanceof ms?bs(a,r):(r=Ts(a=cs(c=a,r))+Ts(c.Qt),Hi(a)&&Hi(c.Qt)?us(r):ss(c.Kt,r))))}return i}function Bs(t,e,n){for(var r=new Wi(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.yt()}function Gs(t){this.count=t}var zs,Ks,Js,Ws=(h(Qs,Js=o),Qs),Xs=(h(Ys,Ks=o),Ys);function Ys(t,e){var n=this;return(n=Ks.call(this)||this).key=t,n.Gt=e,n.type=3,n.fieldTransforms=[],n}function Qs(t,e){var n=this;return(n=Js.call(this)||this).key=t,n.Gt=e,n.type=2,n.fieldTransforms=[],n}function $s(t){switch(t){case Cr.OK:return Tr(),0;case Cr.CANCELLED:case Cr.UNKNOWN:case Cr.DEADLINE_EXCEEDED:case Cr.RESOURCE_EXHAUSTED:case Cr.INTERNAL:case Cr.UNAVAILABLE:case Cr.UNAUTHENTICATED:return;case Cr.INVALID_ARGUMENT:case Cr.NOT_FOUND:case Cr.ALREADY_EXISTS:case Cr.PERMISSION_DENIED:case Cr.FAILED_PRECONDITION:case Cr.ABORTED:case Cr.OUT_OF_RANGE:case Cr.UNIMPLEMENTED:case Cr.DATA_LOSS:return 1;default:return Tr(),0}}function Zs(t){if(void 0===t)return Ir("GRPC error has no .code"),Cr.UNKNOWN;switch(t){case zs.OK:return Cr.OK;case zs.CANCELLED:return Cr.CANCELLED;case zs.UNKNOWN:return Cr.UNKNOWN;case zs.DEADLINE_EXCEEDED:return Cr.DEADLINE_EXCEEDED;case zs.RESOURCE_EXHAUSTED:return Cr.RESOURCE_EXHAUSTED;case zs.INTERNAL:return Cr.INTERNAL;case zs.UNAVAILABLE:return Cr.UNAVAILABLE;case zs.UNAUTHENTICATED:return Cr.UNAUTHENTICATED;case zs.INVALID_ARGUMENT:return Cr.INVALID_ARGUMENT;case zs.NOT_FOUND:return Cr.NOT_FOUND;case zs.ALREADY_EXISTS:return Cr.ALREADY_EXISTS;case zs.PERMISSION_DENIED:return Cr.PERMISSION_DENIED;case zs.FAILED_PRECONDITION:return Cr.FAILED_PRECONDITION;case zs.ABORTED:return Cr.ABORTED;case zs.OUT_OF_RANGE:return Cr.OUT_OF_RANGE;case zs.UNIMPLEMENTED:return Cr.UNIMPLEMENTED;case zs.DATA_LOSS:return Cr.DATA_LOSS;default:return Tr()}}(me=zs={})[me.OK=0]="OK",me[me.CANCELLED=1]="CANCELLED",me[me.UNKNOWN=2]="UNKNOWN",me[me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",me[me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",me[me.NOT_FOUND=5]="NOT_FOUND",me[me.ALREADY_EXISTS=6]="ALREADY_EXISTS",me[me.PERMISSION_DENIED=7]="PERMISSION_DENIED",me[me.UNAUTHENTICATED=16]="UNAUTHENTICATED",me[me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",me[me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",me[me.ABORTED=10]="ABORTED",me[me.OUT_OF_RANGE=11]="OUT_OF_RANGE",me[me.UNIMPLEMENTED=12]="UNIMPLEMENTED",me[me.INTERNAL=13]="INTERNAL",me[me.UNAVAILABLE=14]="UNAVAILABLE",me[me.DATA_LOSS=15]="DATA_LOSS";var tu=(ou.prototype.Ht=function(t,e){return new ou(this.J,this.root.Ht(t,e,this.J).copy(null,null,nu.Jt,null,null))},ou.prototype.remove=function(t){return new ou(this.J,this.root.remove(t,this.J).copy(null,null,nu.Jt,null,null))},ou.prototype.get=function(t){for(var e=this.root;!e.nt();){var n=this.J(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},ou.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.nt();){var r=this.J(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},ou.prototype.nt=function(){return this.root.nt()},Object.defineProperty(ou.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),ou.prototype.Yt=function(){return this.root.Yt()},ou.prototype.Xt=function(){return this.root.Xt()},ou.prototype.Zt=function(t){return this.root.Zt(t)},ou.prototype.forEach=function(n){this.Zt(function(t,e){return n(t,e),!1})},ou.prototype.toString=function(){var n=[];return this.Zt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},ou.prototype.te=function(t){return this.root.te(t)},ou.prototype.ee=function(){return new eu(this.root,null,this.J,!1)},ou.prototype.ne=function(t){return new eu(this.root,t,this.J,!1)},ou.prototype.se=function(){return new eu(this.root,null,this.J,!0)},ou.prototype.ie=function(t){return new eu(this.root,t,this.J,!0)},ou),eu=(iu.prototype.ce=function(){var t=this.oe.pop(),e={key:t.key,value:t.value};if(this.re)for(t=t.left;!t.nt();)this.oe.push(t),t=t.right;else for(t=t.right;!t.nt();)this.oe.push(t),t=t.left;return e},iu.prototype.ae=function(){return 0<this.oe.length},iu.prototype.ue=function(){if(0===this.oe.length)return null;var t=this.oe[this.oe.length-1];return{key:t.key,value:t.value}},iu),nu=(ru.prototype.copy=function(t,e,n,r,i){return new ru(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},ru.prototype.nt=function(){return!1},ru.prototype.Zt=function(t){return this.left.Zt(t)||t(this.key,this.value)||this.right.Zt(t)},ru.prototype.te=function(t){return this.right.te(t)||t(this.key,this.value)||this.left.te(t)},ru.prototype.min=function(){return this.left.nt()?this:this.left.min()},ru.prototype.Yt=function(){return this.min().key},ru.prototype.Xt=function(){return this.right.nt()?this.key:this.right.Xt()},ru.prototype.Ht=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ht(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ht(t,e,n))).he()},ru.prototype.le=function(){if(this.left.nt())return ru.EMPTY;var t=this;return t.left._e()||t.left.left._e()||(t=t.fe()),(t=t.copy(null,null,null,t.left.le(),null)).he()},ru.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.nt()||r.left._e()||r.left.left._e()||(r=r.fe()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left._e()&&(r=r.de()),r.right.nt()||r.right._e()||r.right.left._e()||(r=r.we()),0===e(t,r.key)){if(r.right.nt())return ru.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.le())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.he()},ru.prototype._e=function(){return this.color},ru.prototype.he=function(){var t=this;return t.right._e()&&!t.left._e()&&(t=t.Ee()),t.left._e()&&t.left.left._e()&&(t=t.de()),t.left._e()&&t.right._e()&&(t=t.Te()),t},ru.prototype.fe=function(){var t=this.Te();return t.right.left._e()&&(t=(t=(t=t.copy(null,null,null,null,t.right.de())).Ee()).Te()),t},ru.prototype.we=function(){var t=this.Te();return t.left.left._e()&&(t=(t=t.de()).Te()),t},ru.prototype.Ee=function(){var t=this.copy(null,null,ru.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},ru.prototype.de=function(){var t=this.copy(null,null,ru.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},ru.prototype.Te=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},ru.prototype.Ie=function(){var t=this.me();return Math.pow(2,t)<=this.size+1},ru.prototype.me=function(){if(this._e()&&this.left._e())throw Tr();if(this.right._e())throw Tr();var t=this.left.me();if(t!==this.right.me())throw Tr();return t+(this._e()?0:1)},ru);function ru(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:ru.RED,this.left=null!=r?r:ru.EMPTY,this.right=null!=i?i:ru.EMPTY,this.size=this.left.size+1+this.right.size}function iu(t,e,n,r){this.re=r,this.oe=[];for(var i=1;!t.nt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.re?t.left:t.right;else{if(0===i){this.oe.push(t);break}this.oe.push(t),t=this.re?t.right:t.left}}function ou(t,e){this.J=t,this.root=e||nu.EMPTY}function su(){this.size=0}nu.EMPTY=null,nu.RED=!0,nu.Jt=!1,nu.EMPTY=(Object.defineProperty(su.prototype,"key",{get:function(){throw Tr()},enumerable:!1,configurable:!0}),Object.defineProperty(su.prototype,"value",{get:function(){throw Tr()},enumerable:!1,configurable:!0}),Object.defineProperty(su.prototype,"color",{get:function(){throw Tr()},enumerable:!1,configurable:!0}),Object.defineProperty(su.prototype,"left",{get:function(){throw Tr()},enumerable:!1,configurable:!0}),Object.defineProperty(su.prototype,"right",{get:function(){throw Tr()},enumerable:!1,configurable:!0}),su.prototype.copy=function(t,e,n,r,i){return this},su.prototype.Ht=function(t,e,n){return new nu(t,e)},su.prototype.remove=function(t,e){return this},su.prototype.nt=function(){return!0},su.prototype.Zt=function(t){return!1},su.prototype.te=function(t){return!1},su.prototype.Yt=function(){return null},su.prototype.Xt=function(){return null},su.prototype._e=function(){return!1},su.prototype.Ie=function(){return!0},su.prototype.me=function(){return 0},new su);var uu=(fu.prototype.has=function(t){return null!==this.data.get(t)},fu.prototype.first=function(){return this.data.Yt()},fu.prototype.last=function(){return this.data.Xt()},Object.defineProperty(fu.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),fu.prototype.indexOf=function(t){return this.data.indexOf(t)},fu.prototype.forEach=function(n){this.data.Zt(function(t,e){return n(t),!1})},fu.prototype.Ae=function(t,e){for(var n=this.data.ne(t[0]);n.ae();){var r=n.ce();if(0<=this.J(r.key,t[1]))return;e(r.key)}},fu.prototype.Re=function(t,e){for(var n=void 0!==e?this.data.ne(e):this.data.ee();n.ae();)if(!t(n.ce().key))return},fu.prototype.Pe=function(t){return(t=this.data.ne(t)).ae()?t.ce().key:null},fu.prototype.ee=function(){return new au(this.data.ee())},fu.prototype.ne=function(t){return new au(this.data.ne(t))},fu.prototype.add=function(t){return this.copy(this.data.remove(t).Ht(t,!0))},fu.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},fu.prototype.nt=function(){return this.data.nt()},fu.prototype.ye=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},fu.prototype.isEqual=function(t){if(!(t instanceof fu))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ee(),n=t.data.ee();e.ae();){var r=e.ce().key,i=n.ce().key;if(0!==this.J(r,i))return!1}return!0},fu.prototype.rt=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},fu.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},fu.prototype.copy=function(t){var e=new fu(this.J);return e.data=t,e},fu),au=(hu.prototype.ce=function(){return this.ge.ce().key},hu.prototype.ae=function(){return this.ge.ae()},hu),cu=new tu(di.J);function hu(t){this.ge=t}function fu(t){this.J=t,this.data=new tu(this.J)}var lu=new tu(di.J),pu=new tu(di.J),du=new uu(di.J);function yu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=du,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var vu=new uu(xr),gu=(Pu.be=function(t){return new Pu(t.J)},Pu.prototype.has=function(t){return null!=this.Ve.get(t)},Pu.prototype.get=function(t){return this.Ve.get(t)},Pu.prototype.first=function(){return this.pe.Yt()},Pu.prototype.last=function(){return this.pe.Xt()},Pu.prototype.nt=function(){return this.pe.nt()},Pu.prototype.indexOf=function(t){return(t=this.Ve.get(t))?this.pe.indexOf(t):-1},Object.defineProperty(Pu.prototype,"size",{get:function(){return this.pe.size},enumerable:!1,configurable:!0}),Pu.prototype.forEach=function(n){this.pe.Zt(function(t,e){return n(t),!1})},Pu.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ve.Ht(t.key,t),e.pe.Ht(t,null))},Pu.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ve.remove(t),this.pe.remove(e)):this},Pu.prototype.isEqual=function(t){if(!(t instanceof Pu))return!1;if(this.size!==t.size)return!1;for(var e=this.pe.ee(),n=t.pe.ee();e.ae();){var r=e.ce().key,i=n.ce().key;if(!r.isEqual(i))return!1}return!0},Pu.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Pu.prototype.copy=function(t,e){var n=new Pu;return n.J=this.J,n.Ve=t,n.pe=e,n},Pu),mu=(Lu.prototype.track=function(t){var e=t.doc.key,n=this.ve.get(e);!n||0!==t.type&&3===n.type?this.ve=this.ve.Ht(e,t):3===t.type&&1!==n.type?this.ve=this.ve.Ht(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ve=this.ve.Ht(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ve=this.ve.remove(e):1===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):Tr()},Lu.prototype.Se=function(){var n=[];return this.ve.Zt(function(t,e){n.push(e)}),n},Lu),wu=(Ou.Fe=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Ou(t,e,gu.be(e),i,n,r,!0,!1)},Object.defineProperty(Ou.prototype,"hasPendingWrites",{get:function(){return!this.Ce.nt()},enumerable:!1,configurable:!0}),Ou.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.xe===t.xe&&this.Ce.isEqual(t.Ce)&&Zo(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.De.isEqual(t.De)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Ou),bu=(ku.Le=function(t,e){var n=new Map;return n.set(t,Iu.Be(t,e)),new ku(hi.min(),n,vu,cu,yu())},ku),Iu=(Du.Be=function(t,e){return new Du(Or.h,e,yu(),yu(),yu())},Du),_u=function(t,e,n,r){this.We=t,this.removedTargetIds=e,this.key=n,this.je=r},Eu=function(t,e){this.targetId=t,this.Ge=e},Tu=function(t,e,n,r){void 0===n&&(n=Or.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Nu=(Object.defineProperty(xu.prototype,"qe",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Object.defineProperty(xu.prototype,"resumeToken",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(xu.prototype,"Ze",{get:function(){return 0!==this.ze},enumerable:!1,configurable:!0}),Object.defineProperty(xu.prototype,"tn",{get:function(){return this.Xe},enumerable:!1,configurable:!0}),xu.prototype.en=function(t){0<t.o()&&(this.Xe=!0,this.Je=t)},xu.prototype.nn=function(){var n=yu(),r=yu(),i=yu();return this.He.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Tr()}}),new Iu(this.Je,this.Ye,n,r,i)},xu.prototype.sn=function(){this.Xe=!1,this.He=Ru()},xu.prototype.rn=function(t,e){this.Xe=!0,this.He=this.He.Ht(t,e)},xu.prototype.on=function(t){this.Xe=!0,this.He=this.He.remove(t)},xu.prototype.cn=function(){this.ze+=1},xu.prototype.an=function(){--this.ze},xu.prototype.un=function(){this.Xe=!0,this.Ye=!0},xu),Su=(Au.prototype.wn=function(t){for(var e=0,n=t.We;e<n.length;e++){var r=n[e];t.je instanceof to?this.En(r,t.je):t.je instanceof eo&&this.Tn(r,t.key,t.je)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Tn(r,t.key,t.je)},Au.prototype.In=function(n){var r=this;this.mn(n,function(t){var e=r.An(t);switch(n.state){case 0:r.Rn(t)&&e.en(n.resumeToken);break;case 1:e.an(),e.Ze||e.sn(),e.en(n.resumeToken);break;case 2:e.an(),e.Ze||r.removeTarget(t);break;case 3:r.Rn(t)&&(e.un(),e.en(n.resumeToken));break;case 4:r.Rn(t)&&(r.Pn(t),e.en(n.resumeToken));break;default:Tr()}})},Au.prototype.mn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ln.forEach(function(t,e){r.Rn(e)&&n(e)})},Au.prototype.yn=function(t){var e=t.targetId,n=t.Ge.count;(t=this.gn(e))&&(ho(t=t.target)?0===n?(t=new di(t.path),this.Tn(e,t,new eo(t,hi.min()))):Nr(1===n):this.Vn(e)!==n&&(this.Pn(e),this.dn=this.dn.add(e)))},Au.prototype.pn=function(r){var i=this,o=new Map;this.ln.forEach(function(t,e){var n=i.gn(e);n&&(t.qe&&ho(n.target)&&(n=new di(n.target.path),null!==i._n.get(n)||i.bn(e,n)||i.Tn(e,n,new eo(n,r))),t.tn&&(o.set(e,t.nn()),t.sn()))});var s=yu();this.fn.forEach(function(t,e){var n=!0;e.Re(function(t){return!(t=i.gn(t))||2===t.kt||(n=!1)}),n&&(s=s.add(t))});var t=new bu(r,o,this.dn,this._n,s);return this._n=cu,this.fn=Cu(),this.dn=new uu(xr),t},Au.prototype.En=function(t,e){var n;this.Rn(t)&&(n=this.bn(t,e.key)?2:0,this.An(t).rn(e.key,n),this._n=this._n.Ht(e.key,e),this.fn=this.fn.Ht(e.key,this.vn(e.key).add(t)))},Au.prototype.Tn=function(t,e,n){var r;this.Rn(t)&&(r=this.An(t),this.bn(t,e)?r.rn(e,1):r.on(e),this.fn=this.fn.Ht(e,this.vn(e).delete(t)),n&&(this._n=this._n.Ht(e,n)))},Au.prototype.removeTarget=function(t){this.ln.delete(t)},Au.prototype.Vn=function(t){var e=this.An(t).nn();return this.hn.Sn(t).size+e.Ue.size-e.Ke.size},Au.prototype.cn=function(t){this.An(t).cn()},Au.prototype.An=function(t){var e=this.ln.get(t);return e||(e=new Nu,this.ln.set(t,e)),e},Au.prototype.vn=function(t){var e=this.fn.get(t);return e||(e=new uu(xr),this.fn=this.fn.Ht(t,e)),e},Au.prototype.Rn=function(t){var e=null!==this.gn(t);return e||br("WatchChangeAggregator","Detected inactive target",t),e},Au.prototype.gn=function(t){var e=this.ln.get(t);return e&&e.Ze?null:this.hn.Dn(t)},Au.prototype.Pn=function(e){var n=this;this.ln.set(e,new Nu),this.hn.Sn(e).forEach(function(t){n.Tn(e,t,null)})},Au.prototype.bn=function(t,e){return this.hn.Sn(t).has(e)},Au);function Au(t){this.hn=t,this.ln=new Map,this._n=cu,this.fn=Cu(),this.dn=new uu(xr)}function xu(){this.ze=0,this.He=Ru(),this.Je=Or.h,this.Ye=!1,this.Xe=!0}function Du(t,e,n,r,i){this.resumeToken=t,this.qe=e,this.Ue=n,this.Qe=r,this.Ke=i}function ku(t,e,n,r,i){this.Mt=t,this.Oe=e,this.ke=n,this.Me=r,this.$e=i}function Ou(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.De=n,this.docChanges=r,this.Ce=i,this.fromCache=o,this.xe=s,this.Ne=u}function Lu(){this.ve=new tu(di.J)}function Pu(n){this.J=n?function(t,e){return n(t,e)||di.J(t.key,e.key)}:function(t,e){return di.J(t.key,e.key)},this.Ve=lu,this.pe=new tu(this.J)}function Cu(){return new tu(di.J)}function Ru(){return new tu(di.J)}var Vu={asc:"ASCENDING",desc:"DESCENDING"},Mu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Uu=function(t,e){this.T=t,this.qt=e};function Fu(t,e){return t.qt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ju(t,e){return t.qt?e.toBase64():e.toUint8Array()}function qu(t){return Nr(!!t),hi.W((t=Ai(t),new ci(t.seconds,t.nanos)))}function Hu(t,e){return new fi(["projects",t.projectId,"databases",t.database]).child("documents").child(e).ot()}function Bu(t){return Nr(ua(t=fi.ct(t))),t}function Gu(t,e){return Hu(t.T,e.path)}function zu(t,e){if((e=Bu(e)).get(1)!==t.T.projectId)throw new Rr(Cr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.T.projectId);if(e.get(3)!==t.T.database)throw new Rr(Cr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.T.database);return new di(Xu(e))}function Ku(t,e){return Hu(t.T,e)}function Ju(t){return 4===(t=Bu(t)).length?fi.at():Xu(t)}function Wu(t){return new fi(["projects",t.T.projectId,"databases",t.T.database]).ot()}function Xu(t){return Nr(4<t.length&&"documents"===t.get(4)),t.X(5)}function Yu(t,e,n){return{name:Gu(t,e),fields:n.proto.mapValue.fields}}function Qu(t,e,n){var r=zu(t,e.name),t=qu(e.updateTime),e=new Ji({mapValue:{fields:e.fields}});return new to(r,t,e,{hasCommittedMutations:!!n})}function $u(t,e){var n,r,i;if(e instanceof Vs)n={update:Yu(t,e.key,e.value)};else if(e instanceof Ws)n={delete:Gu(t,e.key)};else if(e instanceof Ms)n={update:Yu(t,e.key,e.data),updateMask:(i=e.zt,r=[],i.fields.forEach(function(t){return r.push(t.ot())}),{fieldPaths:r})};else{if(!(e instanceof Xs))return Tr();n={verify:Gu(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof ls)return{fieldPath:t.field.ot(),setToServerValue:"REQUEST_TIME"};if(e instanceof ps)return{fieldPath:t.field.ot(),appendMissingElements:{values:e.elements}};if(e instanceof ms)return{fieldPath:t.field.ot(),removeAllFromArray:{values:e.elements}};if(e instanceof _s)return{fieldPath:t.field.ot(),increment:e.Qt};throw Tr()})),e.Gt.jt||(n.currentDocument=void 0!==(i=e.Gt).updateTime?{updateTime:Fu(e=t,(t=i.updateTime).G())}:void 0!==i.exists?{exists:i.exists}:Tr()),n}function Zu(i,t){var e=t.currentDocument?void 0!==(s=t.currentDocument).updateTime?xs.updateTime(qu(s.updateTime)):void 0!==s.exists?xs.exists(s.exists):xs.Wt():xs.Wt(),n=t.updateTransforms?t.updateTransforms.map(function(t){return e=i,r=null,"setToServerValue"in(t=t)?(Nr("REQUEST_TIME"===t.setToServerValue),r=new ls):"appendMissingElements"in t?(n=t.appendMissingElements.values||[],r=new ps(n)):"removeAllFromArray"in t?(n=t.removeAllFromArray.values||[],r=new ms(n)):"increment"in t?r=new _s(e,t.increment):Tr(),t=pi._t(t.fieldPath),new As(t,r);var e,n,r}):[];if(t.update){t.update.name;var r=zu(i,t.update.name),o=new Ji({mapValue:{fields:t.update.fields}});if(t.updateMask){var s=(s=t.updateMask.fieldPaths||[],new Ti(s.map(function(t){return pi._t(t)})));return new Ms(r,o,s,e,n)}return new Vs(r,o,e,n)}return t.delete?(n=zu(i,t.delete),new Ws(n,e)):t.verify?(t=zu(i,t.verify),new Xs(t,e)):Tr()}function ta(t,e){return{documents:[Ku(t,e.path)]}}function ea(t,e){var n={structuredQuery:{}},r=e.path;return null!==e.collectionGroup?(n.parent=Ku(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ku(t,r.Z()),n.structuredQuery.from=[{collectionId:r.et()}]),(r=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(zi(t.value))return{unaryFilter:{field:oa(t.field),op:"IS_NAN"}};if(Gi(t.value))return{unaryFilter:{field:oa(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(zi(t.value))return{unaryFilter:{field:oa(t.field),op:"IS_NOT_NAN"}};if(Gi(t.value))return{unaryFilter:{field:oa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:oa(t.field),op:(e=t.op,Mu[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(e.filters))&&(n.structuredQuery.where=r),(r=function(t){if(0!==t.length)return t.map(function(t){return{field:oa(t.field),direction:(t=t.dir,Vu[t])}})}(e.orderBy))&&(n.structuredQuery.orderBy=r),r=e.limit,null!==(r=t.qt||Li(r)?r:{value:r})&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=ra(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ra(e.endAt)),n}function na(t){var e=Ju(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Nr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=sa(t.unaryFilter.field);return lo.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=sa(t.unaryFilter.field);return lo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=sa(t.unaryFilter.field),lo.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=sa(t.unaryFilter.field),lo.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Tr()}}(e)]:void 0!==e.fieldFilter?[(n=e,lo.create(sa(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Tr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Tr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new Fo(sa((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=Li(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=ia(n.startAt));var u=null;return n.endAt&&(u=ia(n.endAt)),Bo(e,i,t,o,r,"F",s,u)}function ra(t){return{before:t.before,values:t.position}}function ia(t){var e=!!t.before,t=t.values||[];return new Po(t,e)}function oa(t){return{fieldPath:t.ot()}}function sa(t){return pi._t(t.fieldPath)}function ua(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var aa,ca=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},ha=(wa.prototype.catch=function(t){return this.next(void 0,t)},wa.prototype.next=function(r,i){var o=this;return this.Fn&&Tr(),this.Fn=!0,this.Nn?this.error?this.On(i,this.error):this.kn(r,this.result):new wa(function(e,n){o.Cn=function(t){o.kn(r,t).next(e,n)},o.xn=function(t){o.On(i,t).next(e,n)}})},wa.prototype.Mn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},wa.prototype.$n=function(t){try{var e=t();return e instanceof wa?e:wa.resolve(e)}catch(t){return wa.reject(t)}},wa.prototype.kn=function(t,e){return t?this.$n(function(){return t(e)}):wa.resolve(e)},wa.prototype.On=function(t,e){return t?this.$n(function(){return t(e)}):wa.reject(e)},wa.resolve=function(n){return new wa(function(t,e){t(n)})},wa.reject=function(n){return new wa(function(t,e){e(n)})},wa.Ln=function(t){return new wa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},wa.Bn=function(t){for(var n=wa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?wa.resolve(t):e()})}(r[e]);return n},wa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Ln(i)},wa),fa=(ma.open=function(t,e,n,r){try{return new ma(e,t.transaction(r,n))}catch(t){throw new da(e,t)}},Object.defineProperty(ma.prototype,"Un",{get:function(){return this.qn.promise},enumerable:!1,configurable:!0}),ma.prototype.abort=function(t){t&&this.qn.reject(t),this.aborted||(br("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},ma.prototype.store=function(t){return t=this.transaction.objectStore(t),new Ia(t)},ma),la=(ga.delete=function(t){return br("SimpleDb","Removing database:",t),Ea(window.indexedDB.deleteDatabase(t)).Mn()},ga.Wn=function(){if("undefined"==typeof indexedDB)return!1;if(ga.jn())return!0;var t=p(),e=0<(n=ga.Kn(t))&&n<10,n=0<(n=ga.Gn(t))&&n<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||e||n)},ga.jn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.zn)},ga.Hn=function(t,e){return t.store(e)},ga.Kn=function(t){return t=(t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?t[1].split("_").slice(0,2).join("."):"-1",Number(t)},ga.Gn=function(t){return t=(t=t.match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1",Number(t)},ga.prototype.Jn=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(br("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result,e(t)},r.onblocked=function(){n(new da(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){"VersionError"===(t=t.target.error).name?n(new Rr(Cr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new da(o,t))},r.onupgradeneeded=function(t){br("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Qn.Yn(e,r.transaction,t.oldVersion,i.version).next(function(){br("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Xn&&(this.db.onversionchange=function(t){return i.Xn(t)}),this.db)]}})})},ga.prototype.Zn=function(e){this.Xn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},ga.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Jn(u)];case 2:return s.db=t.sent(),e=fa.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),ha.reject(t)}).Mn(),r={},n.catch(function(){}),[4,e.Un];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,br("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},ga.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},ga),pa=(Object.defineProperty(va.prototype,"Nn",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(va.prototype,"ss",{get:function(){return this.ns},enumerable:!1,configurable:!0}),Object.defineProperty(va.prototype,"cursor",{set:function(t){this.ts=t},enumerable:!1,configurable:!0}),va.prototype.done=function(){this.es=!0},va.prototype.rs=function(t){this.ns=t},va.prototype.delete=function(){return Ea(this.ts.delete())},va),da=(h(ya,aa=Rr),ya);function ya(t,e){var n=this;return(n=aa.call(this,Cr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function va(t){this.ts=t,this.es=!1,this.ns=null}function ga(t,e,n){this.name=t,this.version=e,this.Qn=n,12.2===ga.Kn(p())&&Ir("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function ma(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.qn=new ca,this.transaction.oncomplete=function(){n.qn.resolve()},this.transaction.onabort=function(){t.error?n.qn.reject(new da(e,t.error)):n.qn.resolve()},this.transaction.onerror=function(t){t=Na(t.target.error),n.qn.reject(new da(e,t))}}function wa(t){var e=this;this.Cn=null,this.xn=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.Fn=!1,t(function(t){e.Nn=!0,e.result=t,e.Cn&&e.Cn(t)},function(t){e.Nn=!0,e.error=t,e.xn&&e.xn(t)})}function ba(t){return"IndexedDbTransactionError"===t.name}var Ia=(_a.prototype.put=function(t,e){return Ea(t=void 0!==e?(br("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(br("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},_a.prototype.add=function(t){return br("SimpleDb","ADD",this.store.name,t,t),Ea(this.store.add(t))},_a.prototype.get=function(e){var n=this;return Ea(this.store.get(e)).next(function(t){return void 0===t&&(t=null),br("SimpleDb","GET",n.store.name,e,t),t})},_a.prototype.delete=function(t){return br("SimpleDb","DELETE",this.store.name,t),Ea(this.store.delete(t))},_a.prototype.count=function(){return br("SimpleDb","COUNT",this.store.name),Ea(this.store.count())},_a.prototype.os=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.cs(e,function(t,e){n.push(e)}).next(function(){return n})},_a.prototype.us=function(t,e){return br("SimpleDb","DELETE ALL",this.store.name),(e=this.options(t,e)).hs=!1,e=this.cursor(e),this.cs(e,function(t,e,n){return n.delete()})},_a.prototype.ls=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.cs(n,e)},_a.prototype._s=function(r){var t=this.cursor({});return new ha(function(n,e){t.onerror=function(t){t=Na(t.target.error),e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},_a.prototype.cs=function(t,i){var o=[];return new ha(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new pa(n),(t=i(n.primaryKey,n.value,e))instanceof ha&&(t=t.catch(function(t){return e.done(),ha.reject(t)}),o.push(t)),e.Nn?r():null===e.ss?n.continue():n.continue(e.ss)):r()}}).next(function(){return ha.Ln(o)})},_a.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},_a.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.hs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},_a);function _a(t){this.store=t}function Ea(t){return new ha(function(e,n){t.onsuccess=function(t){t=t.target.result,e(t)},t.onerror=function(t){t=Na(t.target.error),n(t)}})}var Ta=!1;function Na(t){var e=la.Kn(p());if(12.2<=e&&e<13&&(e="An internal error was encountered in the Indexed Database server",0<=t.message.indexOf(e))){var n=new Rr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ta||(Ta=!0,setTimeout(function(){throw n},0)),n}return t}var Sa=(Aa.Is=function(t,e,n,r,i){return(i=new Aa(t,e,Date.now()+n,r,i)).start(n),i},Aa.prototype.start=function(t){var e=this;this.As=setTimeout(function(){return e.Rs()},t)},Aa.prototype.Ps=function(){return this.Rs()},Aa.prototype.cancel=function(t){null!==this.As&&(this.clearTimeout(),this.Ts.reject(new Rr(Cr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Aa.prototype.Rs=function(){var e=this;this.fs.ys(function(){return null!==e.As?(e.clearTimeout(),e.op().then(function(t){return e.Ts.resolve(t)})):Promise.resolve()})},Aa.prototype.clearTimeout=function(){null!==this.As&&(this.Es(this),clearTimeout(this.As),this.As=null)},Aa);function Aa(t,e,n,r,i){this.fs=t,this.ds=e,this.ws=n,this.op=r,this.Es=i,this.Ts=new ca,this.then=this.Ts.promise.then.bind(this.Ts.promise),this.Ts.promise.catch(function(t){})}function xa(t,e){if(Ir("AsyncQueue",e+": "+t),ba(t))return new Rr(Cr.UNAVAILABLE,e+": "+t);throw t}var Da="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",o=(ka.prototype.Vs=function(t){this.gs.push(t)},ka.prototype.ps=function(){this.gs.forEach(function(t){return t()})},ka);function ka(){this.gs=[]}function Oa(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=La(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return La(o)}function La(t){return t+""}function Pa(t){var e=t.length;if(Nr(2<=e),2===e)return Nr(""===t.charAt(0)&&""===t.charAt(1)),fi.at();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Tr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Tr()}o=s+2}return new fi(r)}function Ca(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}var Ra=function(t,e){this.seconds=t,this.nanoseconds=e};function Va(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}function Ma(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}Ca.store="owner",Ca.key="owner",Va.store="mutationQueues",Va.keyPath="userId",Ma.store="mutations",Ma.keyPath="batchId",Ma.userMutationsIndex="userMutationsIndex",Ma.userMutationsKeyPath=["userId","batchId"];var Ua=(Fa.prefixForUser=function(t){return[t]},Fa.prefixForPath=function(t,e){return[t,Oa(e)]},Fa.key=function(t,e,n){return[t,Oa(e),n]},Fa);function Fa(){}function ja(t,e){this.path=t,this.readTime=e}function qa(t,e){this.path=t,this.version=e}Ua.store="documentMutations",Ua.PLACEHOLDER=new Ua;var Ha=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};function Ba(t){this.byteSize=t}function Ga(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s}Ha.store="remoteDocuments",Ha.readTimeIndex="readTimeIndex",Ha.readTimeIndexPath="readTime",Ha.collectionReadTimeIndex="collectionReadTimeIndex",Ha.collectionReadTimeIndexPath=["parentPath","readTime"],Ba.store="remoteDocumentGlobal",Ba.key="remoteDocumentGlobalKey",Ga.store="targets",Ga.keyPath="targetId",Ga.queryTargetsIndexName="queryTargetsIndex",Ga.queryTargetsKeyPath=["canonicalId","targetId"];var za=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};function Ka(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}function Ja(t,e){this.collectionId=t,this.parent=e}function Wa(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}function Xa(t,e,n){this.bundleId=t,this.createTime=e,this.version=n}function Ya(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n}za.store="targetDocuments",za.keyPath=["targetId","path"],za.documentTargetsIndex="documentTargetsIndex",za.documentTargetsKeyPath=["path","targetId"],Ka.key="targetGlobalKey",Ka.store="targetGlobal",Ja.store="collectionParents",Ja.keyPath=["collectionId","parent"],Wa.store="clientMetadata",Wa.keyPath="clientId",Xa.store="bundles",Xa.keyPath="bundleId",Ya.store="namedQueries",Ya.keyPath="name";var Qa,$a=f(f(f(f([Va.store,Ma.store,Ua.store,Ha.store,Ga.store,Ca.store,Ka.store,za.store],[Wa.store]),[Ba.store]),[Ja.store]),[Xa.store,Ya.store]),Za=(h(tc,Qa=o),tc);function tc(t,e){var n=this;return(n=Qa.call(this)||this).bs=t,n.vs=e,n}function ec(t,e){return la.Hn(t.bs,e)}var nc=(sc.prototype.Ds=function(t,e,n){for(var r,i,o,s,u,a,c=n.Cs,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,u=e,i=c[h],f=a=void 0,e=r instanceof Vs?(a=i,f=(o=r).value,a.transformResults&&(s=qs(o.fieldTransforms,u,a.transformResults),f=Bs(o.fieldTransforms,f,s)),new to(o.key,a.version,f,{hasCommittedMutations:!0})):r instanceof Ms?(a=u,f=i,ks((u=r).Gt,a)?(a=js(u,a,f.transformResults?qs(u.fieldTransforms,a,f.transformResults):[]),new to(u.key,f.version,a,{hasCommittedMutations:!0})):new no(u.key,f.version)):new eo(r.key,i.version,{hasCommittedMutations:!0}))}return e},sc.prototype.xs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(i=r[n]).key.isEqual(t)&&(e=Os(i,e,0,this.Ss));for(var i,o=0,s=this.mutations;o<s.length;o++)(i=s[o]).key.isEqual(t)&&(e=Os(i,e,0,this.Ss));return e},sc.prototype.Ns=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.xs(t.key,n.get(t.key));e&&(i=i.Ht(t.key,e))}),i},sc.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},yu())},sc.prototype.isEqual=function(t){return this.batchId===t.batchId&&Dr(this.mutations,t.mutations,Ls)&&Dr(this.baseMutations,t.baseMutations,Ls)},sc),rc=(oc.from=function(t,e,n){Nr(t.mutations.length===n.length);for(var r=pu,i=t.mutations,o=0;o<i.length;o++)r=r.Ht(i[o].key,n[o].version);return new oc(t,e,n,r)},oc),ic=function(t){this.ks=t};function oc(t,e,n,r){this.batch=t,this.Fs=e,this.Cs=n,this.Os=r}function sc(t,e,n,r){this.batchId=t,this.Ss=e,this.baseMutations=n,this.mutations=r}function uc(t,e){if(e.document)return Qu(t.ks,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=di.Tt(e.noDocument.path),r=lc(e.noDocument.readTime);return new eo(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(n=di.Tt(e.unknownDocument.path),r=lc(e.unknownDocument.version),new no(n,r)):Tr()}function ac(t,e,n){var r=cc(n),n=e.key.path.Z().rt();if(e instanceof to){var i={name:Gu(o=t.ks,(s=e).key),fields:s.vt().mapValue.fields,updateTime:Fu(o,s.version.G())},o=e.hasCommittedMutations;return new Ha(null,null,i,o,r,n)}if(e instanceof eo){var s=e.key.path.rt(),i=fc(e.version),o=e.hasCommittedMutations;return new Ha(null,new ja(s,i),null,o,r,n)}return e instanceof no?(o=e.key.path.rt(),e=fc(e.version),new Ha(new qa(o,e),null,null,!0,r,n)):Tr()}function cc(t){return[(t=t.G()).seconds,t.nanoseconds]}function hc(t){return t=new ci(t[0],t[1]),hi.W(t)}function fc(t){return t=t.G(),new Ra(t.seconds,t.nanoseconds)}function lc(t){return t=new ci(t.seconds,t.nanoseconds),hi.W(t)}function pc(e,t){for(var n=(t.baseMutations||[]).map(function(t){return Zu(e.ks,t)}),r=t.mutations.length-1;0<=r;--r){var i=t.mutations[r];void 0!==(null==i?void 0:i.transform)&&(t.mutations[r-1].updateTransforms=i.transform.fieldTransforms,t.mutations.splice(r,1),--r)}var o=t.mutations.map(function(t){return Zu(e.ks,t)}),s=ci.fromMillis(t.localWriteTimeMs);return new nc(t.batchId,s,n,o)}function dc(t){var e=lc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?lc(t.lastLimboFreeSnapshotVersion):hi.min(),r=void 0!==t.query.documents?(Nr(1===(r=t.query).documents.length),Qo(Go(Ju(r.documents[0])))):Qo(na(t.query));return new is(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Or.fromBase64String(t.resumeToken))}function yc(t,e){var n=fc(e.Mt),r=fc(e.lastLimboFreeSnapshotVersion),i=(ho(e.target)?ta:ea)(t.ks,e.target),t=e.resumeToken.toBase64();return new Ga(e.targetId,ao(e.target),n,t,e.sequenceNumber,r,i)}function vc(t){var e=na({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?$o(e,e.limit,"L"):e}var gc=(mc.prototype.Ms=function(t,e){return wc(t).get(e).next(function(t){if(t)return{id:t.bundleId,createTime:lc(t.createTime),version:t.version}})},mc.prototype.$s=function(t,e){return wc(t).put({bundleId:e.id,createTime:fc(qu(e.createTime)),version:e.version})},mc.prototype.Ls=function(t,e){return bc(t).get(e).next(function(t){if(t)return{name:t.name,query:vc(t.bundledQuery),readTime:lc(t.readTime)}})},mc.prototype.Bs=function(t,e){return bc(t).put({name:e.name,readTime:fc(qu(e.readTime)),bundledQuery:e.bundledQuery})},mc);function mc(){}function wc(t){return ec(t,Xa.store)}function bc(t){return ec(t,Ya.store)}var Ic=(Sc.prototype.Us=function(t,e){return this.qs.add(e),ha.resolve()},Sc.prototype.Qs=function(t,e){return ha.resolve(this.qs.getEntries(e))},Sc),_c=(Nc.prototype.add=function(t){var e=t.et(),n=t.Z(),r=this.index[e]||new uu(fi.J),t=!r.has(n);return this.index[e]=r.add(n),t},Nc.prototype.has=function(t){var e=t.et(),t=t.Z();return(e=this.index[e])&&e.has(t)},Nc.prototype.getEntries=function(t){return(this.index[t]||new uu(fi.J)).rt()},Nc),Ec=(Tc.prototype.Us=function(t,e){var n=this;if(this.Ks.has(e))return ha.resolve();var r=e.et(),i=e.Z();return t.Vs(function(){n.Ks.add(e)}),i={collectionId:r,parent:Oa(i)},Ac(t).put(i)},Tc.prototype.Qs=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[kr(i),""],!1,!0);return Ac(t).os(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(Pa(r.parent))}return o})},Tc);function Tc(){this.Ks=new _c}function Nc(){this.index={}}function Sc(){this.qs=new _c}function Ac(t){return ec(t,Ja.store)}var xc={Ws:!1,js:0,Gs:0,zs:0},Dc=(kc.Xs=function(t){return new kc(t,kc.Zs,kc.ti)},kc);function kc(t,e,n){this.Hs=t,this.Js=e,this.Ys=n}function Oc(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Cr.FAILED_PRECONDITION||e.message!==Da)throw e;return br("LocalStore","Unexpectedly lost primary lease"),[2]})})}Dc.Zs=10,Dc.ti=1e3,Dc.ei=new Dc(41943040,Dc.Zs,Dc.ti),Dc.ni=new Dc(-1,0,0);var Lc=(Cc.prototype.get=function(t){var e=this.si(t);if(void 0!==(e=this.ri[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.ii(i,t))return o}},Cc.prototype.has=function(t){return void 0!==this.get(t)},Cc.prototype.set=function(t,e){var n=this.si(t),r=this.ri[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.ii(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ri[n]=[[t,e]]},Cc.prototype.delete=function(t){var e=this.si(t),n=this.ri[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.ii(n[r][0],t))return 1===n.length?delete this.ri[e]:n.splice(r,1),!0;return!1},Cc.prototype.forEach=function(s){_i(this.ri,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},Cc.prototype.nt=function(){return Ei(this.ri)},Cc),me=(Pc.prototype.ai=function(t){return(t=this.oi.get(t))?t.readTime:hi.min()},Pc.prototype.ui=function(t,e){this.hi(),this.oi.set(t.key,{li:t,readTime:e})},Pc.prototype._i=function(t,e){void 0===e&&(e=null),this.hi(),this.oi.set(t,{li:null,readTime:e})},Pc.prototype.fi=function(t,e){this.hi();var n=this.oi.get(e);return void 0!==n?ha.resolve(n.li):this.di(t,e)},Pc.prototype.getEntries=function(t,e){return this.wi(t,e)},Pc.prototype.apply=function(t){return this.hi(),this.ci=!0,this.Ei(t)},Pc.prototype.hi=function(){},Pc);function Pc(){this.oi=new Lc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.ci=!1}function Cc(t,e){this.si=t,this.ii=e,this.ri={}}function Rc(t,e,n){var r=t.store(Ma.store),i=t.store(Ua.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.ls({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Nr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=Ua.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return ha.Ln(o).next(function(){return u})}function Vc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Tr();e=t.noDocument}return JSON.stringify(e).length}var Mc=(Uc.Ai=function(t,e,n,r){return Nr(""!==t.uid),new Uc(t.A()?t.uid:"",e,n,r)},Uc.prototype.Ri=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return jc(t).ls({index:Ma.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},Uc.prototype.Pi=function(d,y,v,g){var m=this,w=qc(d),b=jc(d);return b.add({}).next(function(t){Nr("number"==typeof t);for(var e,n,r,i,o,s=new nc(t,y,v,g),u=(e=m.Kt,n=m.userId,i=(r=s).baseMutations.map(function(t){return $u(e.ks,t)}),o=r.mutations.map(function(t){return $u(e.ks,t)}),new Ma(n,r.batchId,r.Ss.toMillis(),i,o)),a=[],c=new uu(function(t,e){return xr(t.ot(),e.ot())}),h=0,f=g;h<f.length;h++){var l=f[h],p=Ua.key(m.userId,l.key.path,t),c=c.add(l.key.path.Z());a.push(b.put(u)),a.push(w.put(p,Ua.PLACEHOLDER))}return c.forEach(function(t){a.push(m.Ti.Us(d,t))}),d.Vs(function(){m.mi[t]=s.keys()}),ha.Ln(a).next(function(){return s})})},Uc.prototype.yi=function(t,e){var n=this;return jc(t).get(e).next(function(t){return t?(Nr(t.userId===n.userId),pc(n.Kt,t)):null})},Uc.prototype.gi=function(t,e){var n=this;return this.mi[e]?ha.resolve(this.mi[e]):this.yi(t,e).next(function(t){return t?(t=t.keys(),n.mi[e]=t):null})},Uc.prototype.Vi=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return jc(t).ls({index:Ma.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Nr(e.batchId>=i),o=pc(r.Kt,e)),n.done()}).next(function(){return o})},Uc.prototype.pi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return jc(t).ls({index:Ma.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},Uc.prototype.bi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return jc(t).os(Ma.userMutationsIndex,n).next(function(t){return t.map(function(t){return pc(e.Kt,t)})})},Uc.prototype.vi=function(o,s){var u=this,t=Ua.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return qc(o).ls({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Pa(i);if(r===u.userId&&s.path.isEqual(i))return jc(o).get(t).next(function(t){if(!t)throw Tr();Nr(t.userId===u.userId),a.push(pc(u.Kt,t))});n.done()}).next(function(){return a})},Uc.prototype.Si=function(e,t){var s=this,u=new uu(xr),n=[];return t.forEach(function(o){var t=Ua.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=qc(e).ls({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Pa(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),ha.Ln(n).next(function(){return s.Di(e,u)})},Uc.prototype.Ci=function(t,e){var o=this,s=e.path,u=s.length+1,e=Ua.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new uu(xr);return qc(t).ls({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Pa(i);r===o.userId&&s.st(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Di(t,a)})},Uc.prototype.Di=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(jc(e).get(t).next(function(t){if(null===t)throw Tr();Nr(t.userId===n.userId),r.push(pc(n.Kt,t))}))}),ha.Ln(i).next(function(){return r})},Uc.prototype.xi=function(e,n){var r=this;return Rc(e.bs,this.userId,n).next(function(t){return e.Vs(function(){r.Ni(n.batchId)}),ha.forEach(t,function(t){return r.Ii.Fi(e,t)})})},Uc.prototype.Ni=function(t){delete this.mi[t]},Uc.prototype.Oi=function(e){var i=this;return this.Ri(e).next(function(t){if(!t)return ha.resolve();var t=IDBKeyRange.lowerBound(Ua.prefixForUser(i.userId)),r=[];return qc(e).ls({range:t},function(t,e,n){t[0]===i.userId?(t=Pa(t[1]),r.push(t)):n.done()}).next(function(){Nr(0===r.length)})})},Uc.prototype.ki=function(t,e){return Fc(t,this.userId,e)},Uc.prototype.Mi=function(t){var e=this;return Hc(t).get(this.userId).next(function(t){return t||new Va(e.userId,-1,"")})},Uc);function Uc(t,e,n,r){this.userId=t,this.Kt=e,this.Ti=n,this.Ii=r,this.mi={}}function Fc(t,o,e){var s=(e=Ua.prefixForPath(o,e.path))[1],e=IDBKeyRange.lowerBound(e),u=!1;return qc(t).ls({range:e,hs:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function jc(t){return ec(t,Ma.store)}function qc(t){return ec(t,Ua.store)}function Hc(t){return ec(t,Va.store)}var Bc=(Kc.prototype.next=function(){return this.$i+=2,this.$i},Kc.Li=function(){return new Kc(0)},Kc.Bi=function(){return new Kc(-1)},Kc),Gc=(zc.prototype.qi=function(n){var r=this;return this.Ui(n).next(function(t){var e=new Bc(t.highestTargetId);return t.highestTargetId=e.next(),r.Qi(n,t).next(function(){return t.highestTargetId})})},zc.prototype.Ki=function(t){return this.Ui(t).next(function(t){return hi.W(new ci(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},zc.prototype.Wi=function(t){return this.Ui(t).next(function(t){return t.highestListenSequenceNumber})},zc.prototype.ji=function(e,n,r){var i=this;return this.Ui(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.G()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Qi(e,t)})},zc.prototype.Gi=function(e,n){var r=this;return this.zi(e,n).next(function(){return r.Ui(e).next(function(t){return t.targetCount+=1,r.Hi(n,t),r.Qi(e,t)})})},zc.prototype.Ji=function(t,e){return this.zi(t,e)},zc.prototype.Yi=function(e,t){var n=this;return this.Xi(e,t.targetId).next(function(){return Jc(e).delete(t.targetId)}).next(function(){return n.Ui(e)}).next(function(t){return Nr(0<t.targetCount),--t.targetCount,n.Qi(e,t)})},zc.prototype.Zi=function(n,r,i){var o=this,s=0,u=[];return Jc(n).ls(function(t,e){(e=dc(e)).sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.Yi(n,e)))}).next(function(){return ha.Ln(u)}).next(function(){return s})},zc.prototype.mn=function(t,n){return Jc(t).ls(function(t,e){e=dc(e),n(e)})},zc.prototype.Ui=function(t){return Wc(t).get(Ka.key).next(function(t){return Nr(null!==t),t})},zc.prototype.Qi=function(t,e){return Wc(t).put(Ka.key,e)},zc.prototype.zi=function(t,e){return Jc(t).put(yc(this.Kt,e))},zc.prototype.Hi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},zc.prototype.tr=function(t){return this.Ui(t).next(function(t){return t.targetCount})},zc.prototype.er=function(t,r){var e=ao(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return Jc(t).ls({range:e,index:Ga.queryTargetsIndexName},function(t,e,n){e=dc(e),co(r,e.target)&&(i=e,n.done())}).next(function(){return i})},zc.prototype.nr=function(n,t,r){var i=this,o=[],s=Xc(n);return t.forEach(function(t){var e=Oa(t.path);o.push(s.put(new za(r,e))),o.push(i.Ii.sr(n,r,t))}),ha.Ln(o)},zc.prototype.ir=function(n,t,r){var i=this,o=Xc(n);return ha.forEach(t,function(t){var e=Oa(t.path);return ha.Ln([o.delete([r,e]),i.Ii.rr(n,r,t)])})},zc.prototype.Xi=function(t,e){return t=Xc(t),e=IDBKeyRange.bound([e],[e+1],!1,!0),t.delete(e)},zc.prototype.cr=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Xc(t),r=yu();return t.ls({range:e,hs:!0},function(t,e,n){t=Pa(t[1]),t=new di(t),r=r.add(t)}).next(function(){return r})},zc.prototype.ki=function(t,e){var e=Oa(e.path),e=IDBKeyRange.bound([e],[kr(e)],!1,!0),i=0;return Xc(t).ls({index:za.documentTargetsIndex,hs:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},zc.prototype.Dn=function(t,e){return Jc(t).get(e).next(function(t){return t?dc(t):null})},zc);function zc(t,e){this.Ii=t,this.Kt=e}function Kc(t){this.$i=t}function Jc(t){return ec(t,Ga.store)}function Wc(t){return ec(t,Ka.store)}function Xc(t){return ec(t,za.store)}function Yc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1];return 0===(t=xr(n,t))?xr(r,e):t}var Qc=(ih.prototype.hr=function(){return++this.ur},ih.prototype.lr=function(t){var e=[t,this.hr()];this.buffer.size<this.ar?this.buffer=this.buffer.add(e):Yc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(ih.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),ih),$c=(rh.prototype.start=function(t){-1!==this._r.params.Hs&&this.Er(t)},rh.prototype.stop=function(){this.wr&&(this.wr.cancel(),this.wr=null)},Object.defineProperty(rh.prototype,"Tr",{get:function(){return null!==this.wr},enumerable:!1,configurable:!0}),rh.prototype.Er=function(n){var t=this,e=this.dr?3e5:6e4;br("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.wr=this.fs.Ir("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.wr=null,this.dr=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.mr(this._r)];case 2:return t.sent(),[3,7];case 3:return ba(e=t.sent())?(br("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Oc(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Er(n)];case 8:return t.sent(),[2]}})})})},rh),Zc=(nh.prototype.Rr=function(t,e){return this.Ar.Pr(t).next(function(t){return Math.floor(e/100*t)})},nh.prototype.yr=function(t,e){var n=this;if(0===e)return ha.resolve(ei.U);var r=new Qc(e);return this.Ar.mn(t,function(t){return r.lr(t.sequenceNumber)}).next(function(){return n.Ar.gr(t,function(t){return r.lr(t)})}).next(function(){return r.maxValue})},nh.prototype.Zi=function(t,e,n){return this.Ar.Zi(t,e,n)},nh.prototype.Vr=function(t,e){return this.Ar.Vr(t,e)},nh.prototype.pr=function(e,n){var r=this;return-1===this.params.Hs?(br("LruGarbageCollector","Garbage collection skipped; disabled"),ha.resolve(xc)):this.br(e).next(function(t){return t<r.params.Hs?(br("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Hs),xc):r.vr(e,n)})},nh.prototype.br=function(t){return this.Ar.br(t)},nh.prototype.vr=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Rr(e,this.params.Js).next(function(t){return i=t>h.params.Ys?(br("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Ys+" from "+t),h.params.Ys):t,s=Date.now(),h.yr(e,i)}).next(function(t){return r=t,u=Date.now(),h.Zi(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.Vr(e,r)}).next(function(t){return c=Date.now(),wr()<=l.DEBUG&&br("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),ha.resolve({Ws:!0,js:i,Gs:o,zs:t})})},nh),th=(eh.prototype.Pr=function(t){var n=this.Sr(t);return this.db.Dr().tr(t).next(function(e){return n.next(function(t){return e+t})})},eh.prototype.Sr=function(t){var e=0;return this.gr(t,function(t){e++}).next(function(){return e})},eh.prototype.mn=function(t,e){return this.db.Dr().mn(t,e)},eh.prototype.gr=function(t,n){return this.Cr(t,function(t,e){return n(e)})},eh.prototype.sr=function(t,e,n){return oh(t,n)},eh.prototype.rr=function(t,e,n){return oh(t,n)},eh.prototype.Zi=function(t,e,n){return this.db.Dr().Zi(t,e,n)},eh.prototype.Fi=oh,eh.prototype.Nr=function(t,e){return r=e,i=!1,Hc(n=t)._s(function(t){return Fc(n,t,r).next(function(t){return t&&(i=!0),ha.resolve(!t)})}).next(function(){return i});var n,r,i},eh.prototype.Vr=function(n,r){var i=this,o=this.db.Or().Fr(),s=[],u=0;return this.Cr(n,function(e,t){t<=r&&(t=i.Nr(n,e).next(function(t){if(!t)return u++,o.fi(n,e).next(function(){return o._i(e),Xc(n).delete([0,Oa(e.path)])})}),s.push(t))}).next(function(){return ha.Ln(s)}).next(function(){return o.apply(n)}).next(function(){return u})},eh.prototype.removeTarget=function(t,e){return e=e.$t(t.vs),this.db.Dr().Ji(t,e)},eh.prototype.kr=oh,eh.prototype.Cr=function(t,r){var i,t=Xc(t),o=ei.U;return t.ls({index:za.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==ei.U&&r(new di(Pa(i)),o),o=e,i=t):o=ei.U}).next(function(){o!==ei.U&&r(new di(Pa(i)),o)})},eh.prototype.br=function(t){return this.db.Or().Mr(t)},eh);function eh(t,e){this.db=t,this._r=new Zc(this,e)}function nh(t,e){this.Ar=t,this.params=e}function rh(t,e){this._r=t,this.fs=e,this.dr=!1,this.wr=null}function ih(t){this.ar=t,this.buffer=new uu(Yc),this.ur=0}function oh(t,e){return Xc(t).put((t=t.vs,new za(0,Oa(e.path),t)))}var sh,uh=(hh.prototype.ui=function(t,e,n){return lh(t).put(ph(e),n)},hh.prototype._i=function(t,e){return t=lh(t),e=ph(e),t.delete(e)},hh.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.$r(e,t)})},hh.prototype.fi=function(t,e){var n=this;return lh(t).get(ph(e)).next(function(t){return n.Lr(t)})},hh.prototype.Br=function(t,e){var n=this;return lh(t).get(ph(e)).next(function(t){var e=n.Lr(t);return e?{li:e,size:Vc(t)}:null})},hh.prototype.getEntries=function(t,e){var n=this,r=cu;return this.qr(t,e,function(t,e){e=n.Lr(e),r=r.Ht(t,e)}).next(function(){return r})},hh.prototype.Ur=function(t,e){var r=this,i=cu,o=new tu(di.J);return this.qr(t,e,function(t,e){var n=r.Lr(e);o=n?(i=i.Ht(t,n),o.Ht(t,Vc(e))):(i=i.Ht(t,null),o.Ht(t,0))}).next(function(){return{Qr:i,Kr:o}})},hh.prototype.qr=function(t,e,i){if(e.nt())return ha.resolve();var n=IDBKeyRange.bound(e.first().path.rt(),e.last().path.rt()),o=e.ee(),s=o.ce();return lh(t).ls({range:n},function(t,e,n){for(var r=di.Tt(t);s&&di.J(s,r)<0;)i(s,null),s=o.ce();s&&s.isEqual(r)&&(i(s,e),s=o.ae()?o.ce():null),s?n.rs(s.path.rt()):n.done()}).next(function(){for(;s;)i(s,null),s=o.ae()?o.ce():null})},hh.prototype.Wr=function(t,r,e){var n,i=this,o=lu,s=r.path.length+1,u={};return e.isEqual(hi.min())?(n=r.path.rt(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.rt(),e=cc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=Ha.collectionReadTimeIndex),lh(t).ls(u,function(t,e,n){t.length===s&&(e=uc(i.Kt,e),r.path.st(e.key.path)?e instanceof to&&ns(r,e)&&(o=o.Ht(e.key,e)):n.done())}).next(function(){return o})},hh.prototype.Fr=function(t){return new ah(this,!!t&&t.jr)},hh.prototype.Mr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},hh.prototype.getMetadata=function(t){return fh(t).get(Ba.key).next(function(t){return Nr(!!t),t})},hh.prototype.$r=function(t,e){return fh(t).put(Ba.key,e)},hh.prototype.Lr=function(t){return!t||(t=uc(this.Kt,t))instanceof eo&&t.version.isEqual(hi.min())?null:t},hh),ah=(h(ch,sh=me),ch.prototype.Ei=function(i){var o=this,s=[],u=0,a=new uu(function(t,e){return xr(t.ot(),e.ot())});return this.oi.forEach(function(t,e){var n,r=o.zr.get(t);e.li?(n=ac(o.Gr.Kt,e.li,o.ai(t)),a=a.add(t.path.Z()),e=Vc(n),u+=e-r,s.push(o.Gr.ui(i,t,n))):(u-=r,o.jr?(r=ac(o.Gr.Kt,new eo(t,hi.min()),o.ai(t)),s.push(o.Gr.ui(i,t,r))):s.push(o.Gr._i(i,t)))}),a.forEach(function(t){s.push(o.Gr.Ti.Us(i,t))}),s.push(this.Gr.updateMetadata(i,u)),ha.Ln(s)},ch.prototype.di=function(t,e){var n=this;return this.Gr.Br(t,e).next(function(t){return null===t?(n.zr.set(e,0),null):(n.zr.set(e,t.size),t.li)})},ch.prototype.wi=function(t,e){var n=this;return this.Gr.Ur(t,e).next(function(t){var e=t.Qr;return t.Kr.forEach(function(t,e){n.zr.set(t,e)}),e})},ch);function ch(t,e){var n=this;return(n=sh.call(this)||this).Gr=t,n.jr=e,n.zr=new Lc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function hh(t,e){this.Kt=t,this.Ti=e}function fh(t){return ec(t,Ba.store)}function lh(t){return ec(t,Ha.store)}function ph(t){return t.path.rt()}var dh=(yh.prototype.Yn=function(e,n,t,r){var i=this;Nr(t<r&&0<=t&&r<=11);var o=new fa("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(Ca.store),(s=e).createObjectStore(Va.store,{keyPath:Va.keyPath}),s.createObjectStore(Ma.store,{keyPath:Ma.keyPath,autoIncrement:!0}).createIndex(Ma.userMutationsIndex,Ma.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Ua.store),vh(e),e.createObjectStore(Ha.store));var s,u=ha.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(za.store),s.deleteObjectStore(Ga.store),s.deleteObjectStore(Ka.store),vh(e)),u=u.next(function(){return t=o.store(Ka.store),e=new Ka(0,0,hi.min().G(),0),t.put(Ka.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(Ma.store).os().next(function(t){n.deleteObjectStore(Ma.store),n.createObjectStore(Ma.store,{keyPath:Ma.keyPath,autoIncrement:!0}).createIndex(Ma.userMutationsIndex,Ma.userMutationsKeyPath,{unique:!0});var e=r.store(Ma.store),t=t.map(function(t){return e.put(t)});return ha.Ln(t)});var n,r})),u=u.next(function(){e.createObjectStore(Wa.store,{keyPath:Wa.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.Hr(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(Ba.store),i.Jr(o)})),t<7&&7<=r&&(u=u.next(function(){return i.Yr(o)})),t<8&&8<=r&&(u=u.next(function(){return i.Xr(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(Ha.store)).createIndex(Ha.readTimeIndex,Ha.readTimeIndexPath,{unique:!1}),t.createIndex(Ha.collectionReadTimeIndex,Ha.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.Zr(o)})),t<11&&11<=r&&(u=u.next(function(){e.createObjectStore(Xa.store,{keyPath:Xa.keyPath}),e.createObjectStore(Ya.store,{keyPath:Ya.keyPath})})),u},yh.prototype.Jr=function(e){var n=0;return e.store(Ha.store).ls(function(t,e){n+=Vc(e)}).next(function(){var t=new Ba(n);return e.store(Ba.store).put(Ba.key,t)})},yh.prototype.Hr=function(n){var r=this,t=n.store(Va.store),i=n.store(Ma.store);return t.os().next(function(t){return ha.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.os(Ma.userMutationsIndex,t).next(function(t){return ha.forEach(t,function(t){return Nr(t.userId===e.userId),t=pc(r.Kt,t),Rc(n,e.userId,t).next(function(){})})})})})},yh.prototype.Yr=function(t){var o=t.store(za.store),e=t.store(Ha.store);return t.store(Ka.store).get(Ka.key).next(function(r){var i=[];return e.ls(function(t,e){var n=new fi(t),t=[0,Oa(n)];i.push(o.get(t).next(function(t){return t?ha.resolve():o.put(new za(0,Oa(n),r.highestListenSequenceNumber))}))}).next(function(){return ha.Ln(i)})})},yh.prototype.Xr=function(t,e){function r(t){if(i.add(t)){var e=t.et(),t=t.Z();return n.put({collectionId:e,parent:Oa(t)})}}t.createObjectStore(Ja.store,{keyPath:Ja.keyPath});var n=e.store(Ja.store),i=new _c;return e.store(Ha.store).ls({hs:!0},function(t,e){return r((t=new fi(t)).Z())}).next(function(){return e.store(Ua.store).ls({hs:!0},function(t,e){t[0];var n=t[1];return r((n=(t[2],Pa(n))).Z())})})},yh.prototype.Zr=function(t){var n=this,r=t.store(Ga.store);return r.ls(function(t,e){return e=dc(e),e=yc(n.Kt,e),r.put(e)})},yh);function yh(t){this.Kt=t}function vh(t){t.createObjectStore(za.store,{keyPath:za.keyPath}).createIndex(za.documentTargetsIndex,za.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ga.store,{keyPath:Ga.keyPath}).createIndex(Ga.queryTargetsIndexName,Ga.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ka.store)}var gh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",mh=(wh.prototype.start=function(){var e=this;return this.Io().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Rr(Cr.FAILED_PRECONDITION,gh);return e.mo(),e.Ao(),e.Ro(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.fo.Wi(t)})}).then(function(t){e.io=new ei(t,e.no)}).then(function(){e.ro=!0}).catch(function(t){return e._o&&e._o.close(),Promise.reject(t)})},wh.prototype.Po=function(n){var t=this;return this.ho=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.Tr?[2,n(e)]:[2]})})},n(this.isPrimary)},wh.prototype.yo=function(n){var t=this;this._o.Zn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},wh.prototype.Vo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.eo.ys(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Tr?[4,this.Io()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},wh.prototype.Io=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Ih(e).put(new Wa(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.po(e).next(function(t){t||(n.isPrimary=!1,n.eo.bo(function(){return n.ho(!1)}))})}).next(function(){return n.vo(e)}).next(function(t){return n.isPrimary&&!t?n.So(e).next(function(){return!1}):!!t&&n.Do(e).next(function(){return!0})})}).catch(function(t){if(ba(t))return br("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return br("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.eo.bo(function(){return n.ho(t)}),n.isPrimary=t})},wh.prototype.po=function(t){var e=this;return bh(t).get(Ca.key).next(function(t){return ha.resolve(e.Co(t))})},wh.prototype.xo=function(t){return Ih(t).delete(this.clientId)},wh.prototype.No=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Fo(this.uo,18e5)?[3,2]:(this.uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=ec(t,Wa.store);return r.os().next(function(t){var e=o.Oo(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return ha.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.To)for(n=0,r=e;n<r.length;n++)i=r[n],this.To.removeItem(this.ko(i.clientId));t.label=2;case 2:return[2]}})})},wh.prototype.Ro=function(){var t=this;this.ao=this.eo.Ir("client_metadata_refresh",4e3,function(){return t.Io().then(function(){return t.No()}).then(function(){return t.Ro()})})},wh.prototype.Co=function(t){return!!t&&t.ownerId===this.clientId},wh.prototype.vo=function(e){var r=this;return this.so?ha.resolve(!0):bh(e).get(Ca.key).next(function(t){if(null!==t&&r.Fo(t.leaseTimestampMs,5e3)&&!r.Mo(t.ownerId)){if(r.Co(t)&&r.networkEnabled)return!0;if(!r.Co(t)){if(!t.allowTabSynchronization)throw new Rr(Cr.FAILED_PRECONDITION,gh);return!1}}return!(!r.networkEnabled||!r.inForeground)||Ih(e).os().next(function(t){return void 0===r.Oo(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&br("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},wh.prototype.$o=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.ro=!1,this.Lo(),this.ao&&(this.ao.cancel(),this.ao=null),this.Bo(),this.qo(),[4,this._o.runTransaction("shutdown","readwrite",[Ca.store,Wa.store],function(t){var e=new Za(t,ei.U);return n.So(e).next(function(){return n.xo(e)})})];case 1:return t.sent(),this._o.close(),this.Uo(),[2]}})})},wh.prototype.Oo=function(t,e){var n=this;return t.filter(function(t){return n.Fo(t.updateTimeMs,e)&&!n.Mo(t.clientId)})},wh.prototype.Qo=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Ih(t).os().next(function(t){return e.Oo(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(wh.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),wh.prototype.Ko=function(t){return Mc.Ai(t,this.Kt,this.Ti,this.Ii)},wh.prototype.Dr=function(){return this.fo},wh.prototype.Or=function(){return this.wo},wh.prototype.Wo=function(){return this.Ti},wh.prototype.jo=function(){return this.Eo},wh.prototype.runTransaction=function(e,n,r){var i=this;br("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this._o.runTransaction(e,t,$a,function(t){return o=new Za(t,i.io?i.io.next():ei.U),"readwrite-primary"===n?i.po(o).next(function(t){return!!t||i.vo(o)}).next(function(t){if(!t)throw Ir("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.eo.bo(function(){return i.ho(!1)}),new Rr(Cr.FAILED_PRECONDITION,Da);return r(o)}).next(function(t){return i.Do(o).next(function(){return t})}):i.Go(o).next(function(){return r(o)})}).then(function(t){return o.ps(),t})},wh.prototype.Go=function(t){var e=this;return bh(t).get(Ca.key).next(function(t){if(null!==t&&e.Fo(t.leaseTimestampMs,5e3)&&!e.Mo(t.ownerId)&&!e.Co(t)&&!(e.so||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Rr(Cr.FAILED_PRECONDITION,gh)})},wh.prototype.Do=function(t){var e=new Ca(this.clientId,this.allowTabSynchronization,Date.now());return bh(t).put(Ca.key,e)},wh.Wn=function(){return la.Wn()},wh.prototype.So=function(t){var e=this,n=bh(t);return n.get(Ca.key).next(function(t){return e.Co(t)?(br("IndexedDbPersistence","Releasing primary lease."),n.delete(Ca.key)):ha.resolve()})},wh.prototype.Fo=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Ir("Detected an update time that is in the future: "+t+" > "+n),1))},wh.prototype.mo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.co=function(){t.eo.ys(function(){return t.inForeground="visible"===t.document.visibilityState,t.Io()})},this.document.addEventListener("visibilitychange",this.co),this.inForeground="visible"===this.document.visibilityState)},wh.prototype.Bo=function(){this.co&&(this.document.removeEventListener("visibilitychange",this.co),this.co=null)},wh.prototype.Ao=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.oo=function(){e.Lo(),e.eo.ys(function(){return e.$o()})},this.window.addEventListener("unload",this.oo))},wh.prototype.qo=function(){this.oo&&(this.window.removeEventListener("unload",this.oo),this.oo=null)},wh.prototype.Mo=function(t){try{var e=null!==(null===(e=this.To)||void 0===e?void 0:e.getItem(this.ko(t)));return br("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Ir("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},wh.prototype.Lo=function(){if(this.To)try{this.To.setItem(this.ko(this.clientId),String(Date.now()))}catch(t){Ir("Failed to set zombie client id.",t)}},wh.prototype.Uo=function(){if(this.To)try{this.To.removeItem(this.ko(this.clientId))}catch(t){}},wh.prototype.ko=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},wh);function wh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.eo=i,this.window=o,this.document=s,this.no=a,this.so=c,this.io=null,this.ro=!1,this.isPrimary=!1,this.networkEnabled=!0,this.oo=null,this.inForeground=!1,this.co=null,this.ao=null,this.uo=Number.NEGATIVE_INFINITY,this.ho=function(t){return Promise.resolve()},!wh.Wn())throw new Rr(Cr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ii=new th(this,r),this.lo=e+"main",this.Kt=new ic(u),this._o=new la(this.lo,11,new dh(this.Kt)),this.fo=new Gc(this.Ii,this.Kt),this.Ti=new Ec,this.wo=(e=this.Kt,u=this.Ti,new uh(e,u)),this.Eo=new gc,this.window&&this.window.localStorage?this.To=this.window.localStorage:(this.To=null,!1===c&&Ir("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function bh(t){return ec(t,Ca.store)}function Ih(t){return ec(t,Wa.store)}function _h(t,e){var n=t.projectId;return t.m||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}function Eh(t,e){this.progress=t,this.zo=e}var Th=(Oh.prototype.Jo=function(e,n){var r=this;return this.Ho.vi(e,n).next(function(t){return r.Yo(e,n,t)})},Oh.prototype.Yo=function(t,r,i){return this.wo.fi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].xs(r,t);return t})},Oh.prototype.Xo=function(t,e,i){var o=cu;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].xs(t,e);o=o.Ht(t,e)}),o},Oh.prototype.Zo=function(e,t){var n=this;return this.wo.getEntries(e,t).next(function(t){return n.tc(e,t)})},Oh.prototype.tc=function(e,r){var i=this;return this.Ho.Si(e,r).next(function(t){var t=i.Xo(e,r,t),n=cu;return t.forEach(function(t,e){e=e||new eo(t,hi.min()),n=n.Ht(t,e)}),n})},Oh.prototype.Wr=function(t,e,n){return r=e,di.Et(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ec(t,e.path):Xo(e)?this.nc(t,e,n):this.sc(t,e,n);var r},Oh.prototype.ec=function(t,e){return this.Jo(t,new di(e)).next(function(t){var e=lu;return t instanceof to&&(e=e.Ht(t.key,t)),e})},Oh.prototype.nc=function(n,r,i){var o=this,s=r.collectionGroup,u=lu;return this.Ti.Qs(n,s).next(function(t){return ha.forEach(t,function(t){var e=(e=r,t=t.child(s),new Ho(t,null,e.Nt.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.sc(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Ht(t,e)})})}).next(function(){return u})})},Oh.prototype.sc=function(e,n,t){var a,c,r=this;return this.wo.Wr(e,n,t).next(function(t){return a=t,r.Ho.Ci(e,n)}).next(function(t){return c=t,r.ic(e,c,a).next(function(t){a=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key;a=(s=Os(s,a.get(u),0,r.Ss))instanceof to?a.Ht(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){ns(n,e)||(a=a.remove(t))}),a})},Oh.prototype.ic=function(t,e,n){for(var r=yu(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ms&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.wo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof to&&(c=c.Ht(t,e))}),c})},Oh),Nh=(kh.cc=function(t,e){for(var n=yu(),r=yu(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new kh(t,e.fromCache,n,r)},kh),Sh=(Dh.prototype.ac=function(t){this.uc=t},Dh.prototype.Wr=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.Nt.length||1===r.Nt.length&&r.Nt[0].field.ht())||i.isEqual(hi.min())?this.hc(e,r):this.uc.Zo(e,o).next(function(t){var n=s.lc(r,t);return(zo(r)||Ko(r))&&s._c(r.limitType,n,o,i)?s.hc(e,r):(wr()<=l.DEBUG&&br("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),es(r)),s.uc.Wr(e,r,i).next(function(e){return n.forEach(function(t){e=e.Ht(t.key,t)}),e}))})},Dh.prototype.lc=function(n,t){var r=new uu(rs(n));return t.forEach(function(t,e){e instanceof to&&ns(n,e)&&(r=r.add(e))}),r},Dh.prototype._c=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.u(r))},Dh.prototype.hc=function(t,e){return wr()<=l.DEBUG&&br("QueryEngine","Using full collection scan to execute query:",es(e)),this.uc.Wr(t,e,hi.min())},Dh),Ah=(xh.prototype.mr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.pr(t,n.dc)})},xh);function xh(t,e,n,r){this.persistence=t,this.fc=e,this.Kt=r,this.dc=new tu(xr),this.wc=new Lc(ao,co),this.Ec=hi.min(),this.Ho=t.Ko(n),this.Tc=t.Or(),this.fo=t.Dr(),this.Ic=new Th(this.Tc,this.Ho,this.persistence.Wo()),this.Eo=t.jo(),this.fc.ac(this.Ic)}function Dh(){}function kh(t,e,n,r){this.targetId=t,this.fromCache=e,this.rc=n,this.oc=r}function Oh(t,e,n){this.wo=t,this.Ho=e,this.Ti=n}function Lh(t,e,n,r){return new Ah(t,e,n,r)}function Ph(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Ho,m=e.Ic,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Ho.bi(v).next(function(t){return g=t,n=e.persistence.Ko(o),m=new Th(e.Tc,n,e.persistence.Wo()),n.bi(v)}).next(function(t){for(var e=[],n=[],r=yu(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Zo(v,r).next(function(t){return{mc:t,Ac:e,Rc:n}})})})];case 1:return r=t.sent(),[2,(e.Ho=n,e.Ic=m,e.fc.ac(e.Ic),r)]}})})}function Ch(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.fo.Ki(t)})}function Rh(t,s,e,u,a){var n=yu();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=cu;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof eo&&e.version.isEqual(hi.min())?(s._i(t,r),o=o.Ht(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(s.ui(e,r),o=o.Ht(t,e)):br("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function Vh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.fo.er(e,r).next(function(t){return t?(n=t,ha.resolve(n)):i.fo.qi(e).next(function(t){return n=new is(r,t,0,e.vs),i.fo.Gi(e,n).next(function(){return n})})})}).then(function(t){var e=i.dc.get(t.targetId);return(null===e||0<t.Mt.u(e.Mt))&&(i.dc=i.dc.Ht(t.targetId,t),i.wc.set(r,t.targetId)),t})}function Mh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).dc.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Ii.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!ba(r=t.sent()))throw r;return br("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.dc=e.dc.remove(o),e.wc.delete(n.target),[2]}})})}function Uh(t,o,s){var u=t,a=hi.min(),c=yu();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Qo(o),(void 0!==(t=(i=t).wc.get(r))?ha.resolve(i.dc.get(t)):i.fo.er(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.fo.cr(e,t.targetId).next(function(t){c=t})}).next(function(){return u.fc.Wr(e,o,s?a:hi.min(),s?c:yu())}).next(function(t){return{documents:t,Pc:c}});var t,n,r,i})}function Fh(t,e){var n=t,r=n.fo;return(t=n.dc.get(e))?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Dn(t,e).next(function(t){return t?t.target:null})})}function jh(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Tc,n=t,t=s.Ec,r=e,i=cu,o=cc(t),t=lh(n),n=IDBKeyRange.lowerBound(o,!0),t.ls({index:Ha.readTimeIndex,range:n},function(t,e){var n=uc(r.Kt,e);i=i.Ht(n.key,n),o=e.readTime}).next(function(){return{zo:i,readTime:hc(o)}});var e,n,r,i,o}).then(function(t){var e=t.zo,t=t.readTime;return s.Ec=t,e})}var qh,Hh,Bh=(cf.prototype.Ms=function(t,e){return ha.resolve(this.bc.get(e))},cf.prototype.$s=function(t,e){return this.bc.set(e.id,{id:e.id,version:e.version,createTime:qu(e.createTime)}),ha.resolve()},cf.prototype.Ls=function(t,e){return ha.resolve(this.vc.get(e))},cf.prototype.Bs=function(t,e){return this.vc.set(e.name,{name:e.name,query:vc(e.bundledQuery),readTime:qu(e.readTime)}),ha.resolve()},cf),Gh=(af.prototype.nt=function(){return this.Sc.nt()},af.prototype.sr=function(t,e){e=new zh(t,e),this.Sc=this.Sc.add(e),this.Cc=this.Cc.add(e)},af.prototype.Nc=function(t,e){var n=this;t.forEach(function(t){return n.sr(t,e)})},af.prototype.rr=function(t,e){this.Fc(new zh(t,e))},af.prototype.Oc=function(t,e){var n=this;t.forEach(function(t){return n.rr(t,e)})},af.prototype.kc=function(t){var e=this,n=new di(new fi([])),r=new zh(n,t),t=new zh(n,t+1),i=[];return this.Cc.Ae([r,t],function(t){e.Fc(t),i.push(t.key)}),i},af.prototype.Mc=function(){var e=this;this.Sc.forEach(function(t){return e.Fc(t)})},af.prototype.Fc=function(t){this.Sc=this.Sc.delete(t),this.Cc=this.Cc.delete(t)},af.prototype.$c=function(t){var e=new di(new fi([])),n=new zh(e,t),t=new zh(e,t+1),r=yu();return this.Cc.Ae([n,t],function(t){r=r.add(t.key)}),r},af.prototype.ki=function(t){var e=new zh(t,0);return null!==(e=this.Sc.Pe(e))&&t.isEqual(e.key)},af),zh=(uf.Dc=function(t,e){return di.J(t.key,e.key)||xr(t.Lc,e.Lc)},uf.xc=function(t,e){return xr(t.Lc,e.Lc)||di.J(t.key,e.key)},uf),Kh=(sf.prototype.Ri=function(t){return ha.resolve(0===this.Ho.length)},sf.prototype.Pi=function(t,e,n,r){var i=this.Bc;this.Bc++,0<this.Ho.length&&this.Ho[this.Ho.length-1],n=new nc(i,e,n,r),this.Ho.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.qc=this.qc.add(new zh(u.key,i)),this.Ti.Us(t,u.key.path.Z())}return ha.resolve(n)},sf.prototype.yi=function(t,e){return ha.resolve(this.Uc(e))},sf.prototype.Vi=function(t,e){return e+=1,e=(e=this.Qc(e))<0?0:e,ha.resolve(this.Ho.length>e?this.Ho[e]:null)},sf.prototype.pi=function(){return ha.resolve(0===this.Ho.length?-1:this.Bc-1)},sf.prototype.bi=function(t){return ha.resolve(this.Ho.slice())},sf.prototype.vi=function(t,e){var n=this,r=new zh(e,0),e=new zh(e,Number.POSITIVE_INFINITY),i=[];return this.qc.Ae([r,e],function(t){t=n.Uc(t.Lc),i.push(t)}),ha.resolve(i)},sf.prototype.Si=function(t,e){var n=this,r=new uu(xr);return e.forEach(function(t){var e=new zh(t,0),t=new zh(t,Number.POSITIVE_INFINITY);n.qc.Ae([e,t],function(t){r=r.add(t.Lc)})}),ha.resolve(this.Kc(r))},sf.prototype.Ci=function(t,e){var n=e.path,r=n.length+1,e=n;di.Et(e)||(e=e.child(""));var e=new zh(new di(e),0),i=new uu(xr);return this.qc.Re(function(t){var e=t.key.path;return!!n.st(e)&&(e.length===r&&(i=i.add(t.Lc)),!0)},e),ha.resolve(this.Kc(i))},sf.prototype.Kc=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.Uc(t))&&n.push(t)}),n},sf.prototype.xi=function(n,r){var i=this;Nr(0===this.Wc(r.batchId,"removed")),this.Ho.shift();var o=this.qc;return ha.forEach(r.mutations,function(t){var e=new zh(t.key,r.batchId);return o=o.delete(e),i.Ii.Fi(n,t.key)}).next(function(){i.qc=o})},sf.prototype.Ni=function(t){},sf.prototype.ki=function(t,e){var n=new zh(e,0),n=this.qc.Pe(n);return ha.resolve(e.isEqual(n&&n.key))},sf.prototype.Oi=function(t){return this.Ho.length,ha.resolve()},sf.prototype.Wc=function(t,e){return this.Qc(t)},sf.prototype.Qc=function(t){return 0===this.Ho.length?0:t-this.Ho[0].batchId},sf.prototype.Uc=function(t){return(t=this.Qc(t))<0||t>=this.Ho.length?null:this.Ho[t]},sf),Jh=(of.prototype.ui=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.jc(e);return this.docs=this.docs.Ht(r,{li:e,size:o,readTime:n}),this.size+=o-i,this.Ti.Us(t,r.path.Z())},of.prototype._i=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},of.prototype.fi=function(t,e){return e=this.docs.get(e),ha.resolve(e?e.li:null)},of.prototype.getEntries=function(t,e){var n=this,r=cu;return e.forEach(function(t){var e=n.docs.get(t);r=r.Ht(t,e?e.li:null)}),ha.resolve(r)},of.prototype.Wr=function(t,e,n){for(var r=lu,i=new di(e.path.child("")),o=this.docs.ne(i);o.ae();){var s=(u=o.ce()).key,u=(a=u.value).li,a=a.readTime;if(!e.path.st(s.path))break;a.u(n)<=0||u instanceof to&&ns(e,u)&&(r=r.Ht(u.key,u))}return ha.resolve(r)},of.prototype.Gc=function(t,e){return ha.forEach(this.docs,function(t){return e(t)})},of.prototype.Fr=function(t){return new Wh(this)},of.prototype.Mr=function(t){return ha.resolve(this.size)},of),Wh=(h(rf,Hh=me),rf.prototype.Ei=function(n){var r=this,i=[];return this.oi.forEach(function(t,e){e&&e.li?i.push(r.Gr.ui(n,e.li,r.ai(t))):r.Gr._i(t)}),ha.Ln(i)},rf.prototype.di=function(t,e){return this.Gr.fi(t,e)},rf.prototype.wi=function(t,e){return this.Gr.getEntries(t,e)},rf),Xh=(nf.prototype.mn=function(t,n){return this.zc.forEach(function(t,e){return n(e)}),ha.resolve()},nf.prototype.Ki=function(t){return ha.resolve(this.lastRemoteSnapshotVersion)},nf.prototype.Wi=function(t){return ha.resolve(this.Hc)},nf.prototype.qi=function(t){return this.highestTargetId=this.Yc.next(),ha.resolve(this.highestTargetId)},nf.prototype.ji=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hc&&(this.Hc=e),ha.resolve()},nf.prototype.zi=function(t){this.zc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yc=new Bc(e),this.highestTargetId=e),t.sequenceNumber>this.Hc&&(this.Hc=t.sequenceNumber)},nf.prototype.Gi=function(t,e){return this.zi(e),this.targetCount+=1,ha.resolve()},nf.prototype.Ji=function(t,e){return this.zi(e),ha.resolve()},nf.prototype.Yi=function(t,e){return this.zc.delete(e.target),this.Jc.kc(e.targetId),--this.targetCount,ha.resolve()},nf.prototype.Zi=function(n,r,i){var o=this,s=0,u=[];return this.zc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.zc.delete(t),u.push(o.Xi(n,e.targetId)),s++)}),ha.Ln(u).next(function(){return s})},nf.prototype.tr=function(t){return ha.resolve(this.targetCount)},nf.prototype.er=function(t,e){return e=this.zc.get(e)||null,ha.resolve(e)},nf.prototype.nr=function(t,e,n){return this.Jc.Nc(e,n),ha.resolve()},nf.prototype.ir=function(e,t,n){this.Jc.Oc(t,n);var r=this.persistence.Ii,i=[];return r&&t.forEach(function(t){i.push(r.Fi(e,t))}),ha.Ln(i)},nf.prototype.Xi=function(t,e){return this.Jc.kc(e),ha.resolve()},nf.prototype.cr=function(t,e){return e=this.Jc.$c(e),ha.resolve(e)},nf.prototype.ki=function(t,e){return ha.resolve(this.Jc.ki(e))},nf),Yh=(ef.prototype.start=function(){return Promise.resolve()},ef.prototype.$o=function(){return this.ro=!1,Promise.resolve()},Object.defineProperty(ef.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),ef.prototype.yo=function(){},ef.prototype.Vo=function(){},ef.prototype.Wo=function(){return this.Ti},ef.prototype.Ko=function(t){var e=this.Xc[t.R()];return e||(e=new Kh(this.Ti,this.Ii),this.Xc[t.R()]=e),e},ef.prototype.Dr=function(){return this.fo},ef.prototype.Or=function(){return this.wo},ef.prototype.jo=function(){return this.Eo},ef.prototype.runTransaction=function(t,e,n){var r=this;br("MemoryPersistence","Starting transaction:",t);var i=new Qh(this.io.next());return this.Ii.ta(),n(i).next(function(t){return r.Ii.ea(i).next(function(){return t})}).Mn().then(function(t){return i.ps(),t})},ef.prototype.na=function(e,n){return ha.Bn(Object.values(this.Xc).map(function(t){return function(){return t.ki(e,n)}}))},ef),Qh=(h(tf,qh=o),tf),$h=(Zh.ra=function(t){return new Zh(t)},Object.defineProperty(Zh.prototype,"oa",{get:function(){if(this.ia)return this.ia;throw Tr()},enumerable:!1,configurable:!0}),Zh.prototype.sr=function(t,e,n){return this.sa.sr(n,e),this.oa.delete(n.toString()),ha.resolve()},Zh.prototype.rr=function(t,e,n){return this.sa.rr(n,e),this.oa.add(n.toString()),ha.resolve()},Zh.prototype.Fi=function(t,e){return this.oa.add(e.toString()),ha.resolve()},Zh.prototype.removeTarget=function(t,e){var n=this;this.sa.kc(e.targetId).forEach(function(t){return n.oa.add(t.toString())});var r=this.persistence.Dr();return r.cr(t,e.targetId).next(function(t){t.forEach(function(t){return n.oa.add(t.toString())})}).next(function(){return r.Yi(t,e)})},Zh.prototype.ta=function(){this.ia=new Set},Zh.prototype.ea=function(n){var r=this,i=this.persistence.Or().Fr();return ha.forEach(this.oa,function(t){var e=di.ft(t);return r.ca(n,e).next(function(t){t||i._i(e)})}).next(function(){return r.ia=null,i.apply(n)})},Zh.prototype.kr=function(t,e){var n=this;return this.ca(t,e).next(function(t){t?n.oa.delete(e.toString()):n.oa.add(e.toString())})},Zh.prototype.Zc=function(t){return 0},Zh.prototype.ca=function(t,e){var n=this;return ha.Bn([function(){return ha.resolve(n.sa.ki(e))},function(){return n.persistence.Dr().ki(t,e)},function(){return n.persistence.na(t,e)}])},Zh);function Zh(t){this.persistence=t,this.sa=new Gh,this.ia=null}function tf(t){var e=this;return(e=qh.call(this)||this).vs=t,e}function ef(t,e){var n=this;this.Xc={},this.io=new ei(0),this.ro=!1,this.ro=!0,this.Ii=t(this),this.fo=new Xh(this),this.Ti=new Ic,this.wo=(t=this.Ti,new Jh(t,function(t){return n.Ii.Zc(t)})),this.Kt=new ic(e),this.Eo=new Bh(this.Kt)}function nf(t){this.persistence=t,this.zc=new Lc(ao,co),this.lastRemoteSnapshotVersion=hi.min(),this.highestTargetId=0,this.Hc=0,this.Jc=new Gh,this.targetCount=0,this.Yc=Bc.Li()}function rf(t){var e=this;return(e=Hh.call(this)||this).Gr=t,e}function of(t,e){this.Ti=t,this.jc=e,this.docs=new tu(di.J),this.size=0}function sf(t,e){this.Ti=t,this.Ii=e,this.Ho=[],this.Bc=1,this.qc=new uu(zh.Dc)}function uf(t,e){this.key=t,this.Lc=e}function af(){this.Sc=new uu(zh.Dc),this.Cc=new uu(zh.xc)}function cf(t){this.Kt=t,this.bc=new Map,this.vc=new Map}function hf(t,e){return"firestore_clients_"+t+"_"+e}function ff(t,e,n){return n="firestore_mutations_"+t+"_"+n,e.A()&&(n+="_"+e.uid),n}function lf(t,e){return"firestore_targets_"+t+"_"+e}var pf,df=(Mf.aa=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Rr(r.error.code,r.error.message)),i?new Mf(t,e,r.state,o):(Ir("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Mf.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Mf),yf=(Vf.aa=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Rr(n.error.code,n.error.message)),r?new Vf(t,n.state,i):(Ir("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Vf.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Vf),vf=(Rf.aa=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=vu,o=0;r&&o<n.activeTargetIds.length;++o)r=Ci(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Rf(t,i):(Ir("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Rf),gf=(Cf.aa=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Cf(e.clientId,e.onlineState):(Ir("SharedClientState","Failed to parse online state: "+t),null)},Cf),mf=(Pf.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Pf.prototype.la=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Pf.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.rt(),updateTimeMs:Date.now()};return JSON.stringify(t)},Pf),wf=(Lf.Wn=function(t){return!(!t||!t.localStorage)},Lf.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.fa.Qo()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this._a&&(i=this.getItem(hf(this.persistenceKey,r)))&&(o=vf.aa(r,i))&&(this.Ta=this.Ta.Ht(o.clientId,o));for(this.pa(),(s=this.storage.getItem(this.ga))&&(u=this.ba(s))&&this.va(u),a=0,c=this.Ia;a<c.length;a++)h=c[a],this.Ea(h);return this.Ia=[],this.window.addEventListener("unload",function(){return f.$o()}),this.Tr=!0,[2]}})})},Lf.prototype.q=function(t){this.setItem(this.Aa,JSON.stringify(t))},Lf.prototype.Sa=function(){return this.Da(this.Ta)},Lf.prototype.Ca=function(n){var r=!1;return this.Ta.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Lf.prototype.xa=function(t){this.Na(t,"pending")},Lf.prototype.Fa=function(t,e,n){this.Na(t,e,n),this.Oa(t)},Lf.prototype.ka=function(t){var e,n="not-current";return this.Ca(t)&&(!(e=this.storage.getItem(lf(this.persistenceKey,t)))||(e=yf.aa(t,e))&&(n=e.state)),this.Ma.ha(t),this.pa(),n},Lf.prototype.$a=function(t){this.Ma.la(t),this.pa()},Lf.prototype.La=function(t){return this.Ma.activeTargetIds.has(t)},Lf.prototype.Ba=function(t){this.removeItem(lf(this.persistenceKey,t))},Lf.prototype.qa=function(t,e,n){this.Ua(t,e,n)},Lf.prototype.Qa=function(t,e,n){var r=this;e.forEach(function(t){r.Oa(t)}),this.currentUser=t,n.forEach(function(t){r.xa(t)})},Lf.prototype.Ka=function(t){this.Wa(t)},Lf.prototype.ja=function(){this.Ga()},Lf.prototype.$o=function(){this.Tr&&(this.window.removeEventListener("storage",this.wa),this.removeItem(this.ma),this.Tr=!1)},Lf.prototype.getItem=function(t){var e=this.storage.getItem(t);return br("SharedClientState","READ",t,e),e},Lf.prototype.setItem=function(t,e){br("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Lf.prototype.removeItem=function(t){br("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Lf.prototype.Ea=function(t){var e=this,o=t;o.storageArea===this.storage&&(br("SharedClientState","EVENT",o.key,o.newValue),o.key!==this.ma?this.eo.bo(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.Tr){if(null!==o.key)if(this.Ra.test(o.key)){if(null==o.newValue)return e=this.za(o.key),[2,this.Ha(e,null)];if(e=this.Ja(o.key,o.newValue))return[2,this.Ha(e.clientId,e)]}else if(this.Pa.test(o.key)){if(null!==o.newValue&&(n=this.Ya(o.key,o.newValue)))return[2,this.Xa(n)]}else if(this.ya.test(o.key)){if(null!==o.newValue&&(r=this.Za(o.key,o.newValue)))return[2,this.tu(r)]}else if(o.key===this.ga){if(null!==o.newValue&&(i=this.ba(o.newValue)))return[2,this.va(i)]}else if(o.key===this.Aa)(i=function(t){var e=ei.U;if(null!=t)try{var n=JSON.parse(t);Nr("number"==typeof n),e=n}catch(t){Ir("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==ei.U&&this.$(i);else if(o.key===this.Va)return[2,this.fa.eu()]}else this.Ia.push(o);return[2]})})}):Ir("Received WebStorage notification for local change. Another client might have garbage-collected our state"))},Object.defineProperty(Lf.prototype,"Ma",{get:function(){return this.Ta.get(this._a)},enumerable:!1,configurable:!0}),Lf.prototype.pa=function(){this.setItem(this.ma,this.Ma.ua())},Lf.prototype.Na=function(t,e,n){n=new df(this.currentUser,t,e,n),t=ff(this.persistenceKey,this.currentUser,t),this.setItem(t,n.ua())},Lf.prototype.Oa=function(t){t=ff(this.persistenceKey,this.currentUser,t),this.removeItem(t)},Lf.prototype.Wa=function(t){t={clientId:this._a,onlineState:t},this.storage.setItem(this.ga,JSON.stringify(t))},Lf.prototype.Ua=function(t,e,n){var r=lf(this.persistenceKey,t),n=new yf(t,e,n);this.setItem(r,n.ua())},Lf.prototype.Ga=function(){this.setItem(this.Va,"value-not-used")},Lf.prototype.za=function(t){return(t=this.Ra.exec(t))?t[1]:null},Lf.prototype.Ja=function(t,e){return t=this.za(t),vf.aa(t,e)},Lf.prototype.Ya=function(t,e){var n=this.Pa.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return df.aa(new Kr(n),t,e)},Lf.prototype.Za=function(t,e){return t=this.ya.exec(t),t=Number(t[1]),yf.aa(t,e)},Lf.prototype.ba=function(t){return gf.aa(t)},Lf.prototype.Xa=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.fa.nu(e.batchId,e.state,e.error)]:(br("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Lf.prototype.tu=function(t){return this.fa.su(t.targetId,t.state,t.error)},Lf.prototype.Ha=function(t,e){var n=this,r=e?this.Ta.Ht(t,e):this.Ta.remove(t),i=this.Da(this.Ta),o=this.Da(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fa.iu(s,u).then(function(){n.Ta=r})},Lf.prototype.va=function(t){this.Ta.get(t.clientId)&&this.da(t.onlineState)},Lf.prototype.Da=function(t){var n=vu;return t.forEach(function(t,e){n=n.ye(e.activeTargetIds)}),n},Lf),bf=(Of.prototype.xa=function(t){},Of.prototype.Fa=function(t,e,n){},Of.prototype.ka=function(t){return this.ru.ha(t),this.ou[t]||"not-current"},Of.prototype.qa=function(t,e,n){this.ou[t]=e},Of.prototype.$a=function(t){this.ru.la(t)},Of.prototype.La=function(t){return this.ru.activeTargetIds.has(t)},Of.prototype.Ba=function(t){delete this.ou[t]},Of.prototype.Sa=function(){return this.ru.activeTargetIds},Of.prototype.Ca=function(t){return this.ru.activeTargetIds.has(t)},Of.prototype.start=function(){return this.ru=new mf,Promise.resolve()},Of.prototype.Qa=function(t,e,n){},Of.prototype.Ka=function(t){},Of.prototype.$o=function(){},Of.prototype.q=function(t){},Of.prototype.ja=function(){},Of),If=(kf.prototype.cu=function(t){},kf.prototype.$o=function(){},kf),_f=(Df.prototype.cu=function(t){this._u.push(t)},Df.prototype.$o=function(){window.removeEventListener("online",this.au),window.removeEventListener("offline",this.hu)},Df.prototype.fu=function(){window.addEventListener("online",this.au),window.addEventListener("offline",this.hu)},Df.prototype.uu=function(){br("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(0)},Df.prototype.lu=function(){br("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(1)},Df.Wn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Df),Ef={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Tf=(xf.prototype.Eu=function(t){this.Tu=t},xf.prototype.Iu=function(t){this.mu=t},xf.prototype.onMessage=function(t){this.Au=t},xf.prototype.close=function(){this.wu()},xf.prototype.send=function(t){this.du(t)},xf.prototype.Ru=function(){this.Tu()},xf.prototype.Pu=function(t){this.mu(t)},xf.prototype.yu=function(t){this.Au(t)},xf),Nf=(Af.prototype.bu=function(e,t,n,r){var i=this.vu(e,t);return br("RestConnection","Sending: ",i,n),t={},this.Su(t,r),this.Du(e,i,t,n).then(function(t){return br("RestConnection","Received: ",t),t},function(t){throw _r("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Af.prototype.Cu=function(t,e,n,r){return this.bu(t,e,n,r)},Af.prototype.Su=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.4-2021019222814",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},Af.prototype.vu=function(t,e){return t=Ef[t],this.Vu+"/v1/"+e+":"+t},h(Sf,pf=Af),Sf.prototype.Du=function(o,e,s,u){return new Promise(function(n,r){var i=new vr;i.listenOnce(pr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case lr.NO_ERROR:var t=i.getResponseJson();br("Connection","XHR received:",JSON.stringify(t)),n(t);break;case lr.TIMEOUT:br("Connection",'RPC "'+o+'" timed out'),r(new Rr(Cr.DEADLINE_EXCEEDED,"Request time out"));break;case lr.HTTP_ERROR:var e=i.getStatus();br("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(Cr).indexOf(e)?e:Cr.UNKNOWN,r(new Rr(e,t.message))):r(new Rr(Cr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Rr(Cr.UNAVAILABLE,"Connection failed."));break;default:Tr()}}finally{br("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Sf.prototype.xu=function(t,e){var n,r=[this.Vu,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new sr,o=fr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.I};this.Su(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),br("Connection","Creating WebChannel: "+(r=r.join("")),t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new Tf({du:function(t){a?br("Connection","Not sending because WebChannel is closed:",t):(u||(br("Connection","Opening WebChannel transport."),s.open(),u=!0),br("Connection","WebChannel sending:",t),s.send(t))},wu:function(){return s.close()}});return(t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})})(s,yr.EventType.OPEN,function(){a||br("Connection","WebChannel transport opened.")}),t(s,yr.EventType.CLOSE,function(){a||(a=!0,br("Connection","WebChannel transport closed"),c.Pu())}),t(s,yr.EventType.ERROR,function(t){a||(a=!0,_r("Connection","WebChannel transport errored:",t),c.Pu(new Rr(Cr.UNAVAILABLE,"The operation could not be completed")))}),t(s,yr.EventType.MESSAGE,function(t){var e,n,r,i;a||(Nr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(br("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=zs[r];if(void 0!==t)return Zs(t)}(),i=n.message,void 0===t&&(t=Cr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.Pu(new Rr(t,i)),s.close()):(br("Connection","WebChannel received:",e),c.yu(e)))}),t(o,dr.STAT_EVENT,function(t){10===t.stat?br("Connection","Detected buffering proxy"):11===t.stat&&br("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Ru()},0),c},Sf);function Sf(t){var e=this;return(e=pf.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.I=t.I,e}function Af(t){this.gu=t,this.T=t.T;var e=t.ssl?"https":"http";this.Vu=e+"://"+t.host,this.pu="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}function xf(t){this.du=t.du,this.wu=t.wu}function Df(){var t=this;this.au=function(){return t.uu()},this.hu=function(){return t.lu()},this._u=[],this.fu()}function kf(){}function Of(){this.ru=new mf,this.ou={},this.da=null,this.$=null}function Lf(t,e,n,r,i){this.window=t,this.eo=e,this.persistenceKey=n,this._a=r,this.fa=null,this.da=null,this.$=null,this.wa=this.Ea.bind(this),this.Ta=new tu(xr),this.Tr=!1,this.Ia=[],n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),this.storage=this.window.localStorage,this.currentUser=i,this.ma=hf(this.persistenceKey,this._a),this.Aa="firestore_sequence_number_"+this.persistenceKey,this.Ta=this.Ta.Ht(this._a,new mf),this.Ra=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Pa=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.ya=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.ga="firestore_online_state_"+this.persistenceKey,this.Va="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.wa)}function Pf(){this.activeTargetIds=vu}function Cf(t,e){this.clientId=t,this.onlineState=e}function Rf(t,e){this.clientId=t,this.activeTargetIds=e}function Vf(t,e,n){this.targetId=t,this.state=e,this.error=n}function Mf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Uf(){return"undefined"!=typeof window?window:null}function Ff(){return"undefined"!=typeof document?document:null}function jf(t){return new Uu(t,!0)}function qf(t,e,n,r,i){var o=this;this.Sh=t,this.Dh=e,this.fs=n,this.Ch={},this.xh=[],this.Nh=new Map,this.Fh=new Set,this.Oh=[],this.kh=i,this.kh.cu(function(t){n.ys(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return hl(this)?(br("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Fh.add(4),[4,rl(e)];case 1:return t.sent(),e.Mh.set("Unknown"),e.Fh.delete(4),[4,nl(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Mh=new Xf(n,r)}var Hf,Bf,Gf,zf=(el.prototype.reset=function(){this.ku=0},el.prototype.Lu=function(){this.ku=this.Ou},el.prototype.Bu=function(t){var e=this;this.cancel();var n=Math.floor(this.ku+this.qu()),r=Math.max(0,Date.now()-this.$u),i=Math.max(0,n-r);0<i&&br("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ku+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Mu=this.eo.Ir(this.ds,i,function(){return e.$u=Date.now(),t()}),this.ku*=this.Fu,this.ku<this.Nu&&(this.ku=this.Nu),this.ku>this.Ou&&(this.ku=this.Ou)},el.prototype.Uu=function(){null!==this.Mu&&(this.Mu.Ps(),this.Mu=null)},el.prototype.cancel=function(){null!==this.Mu&&(this.Mu.cancel(),this.Mu=null)},el.prototype.qu=function(){return(Math.random()-.5)*this.ku},el),me=(tl.prototype.Hu=function(){return 1===this.state||2===this.state||4===this.state},tl.prototype.Ju=function(){return 2===this.state},tl.prototype.start=function(){3!==this.state?this.auth():this.Yu()},tl.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},tl.prototype.Xu=function(){this.state=0,this.zu.reset()},tl.prototype.Zu=function(){var t=this;this.Ju()&&null===this.Gu&&(this.Gu=this.eo.Ir(this.Qu,6e4,function(){return t.th()}))},tl.prototype.eh=function(t){this.nh(),this.stream.send(t)},tl.prototype.th=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Ju()?[2,this.close(0)]:[2]})})},tl.prototype.nh=function(){this.Gu&&(this.Gu.cancel(),this.Gu=null)},tl.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.nh(),this.zu.cancel(),this.ju++,3!==e?this.zu.reset():n&&n.code===Cr.RESOURCE_EXHAUSTED?(Ir(n.toString()),Ir("Using maximum backoff delay to prevent overloading the backend."),this.zu.Lu()):n&&n.code===Cr.UNAUTHENTICATED&&this.Wu.v(),null!==this.stream&&(this.sh(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Iu(n)];case 1:return t.sent(),[2]}})})},tl.prototype.sh=function(){},tl.prototype.auth=function(){var n=this;this.state=1;var t=this.ih(this.ju),e=this.ju;this.Wu.getToken().then(function(t){n.ju===e&&n.rh(t)},function(e){t(function(){var t=new Rr(Cr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.oh(t)})})},tl.prototype.rh=function(t){var e=this,n=this.ih(this.ju);this.stream=this.ah(t),this.stream.Eu(function(){n(function(){return e.state=2,e.listener.Eu()})}),this.stream.Iu(function(t){n(function(){return e.oh(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},tl.prototype.Yu=function(){var t=this;this.state=4,this.zu.Bu(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},tl.prototype.oh=function(t){return br("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},tl.prototype.ih=function(e){var n=this;return function(t){n.eo.ys(function(){return n.ju===e?t():(br("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},tl),Kf=(h(Zf,Gf=me),Zf.prototype.ah=function(t){return this.Ku.xu("Listen",t)},Zf.prototype.onMessage=function(t){this.zu.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Tr(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.qt?(Nr(void 0===s||"string"==typeof s),Or.fromBase64String(s||"")):(Nr(void 0===s||s instanceof Uint8Array),Or.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?Cr.UNKNOWN:Zs(c.code),new Rr(a,c.message||"")),s=new Tu(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=zu(t,n.document.name),i=qu(n.document.updateTime);var u=new Ji({mapValue:{fields:n.document.fields}}),a=(o=new to(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[],s=new _u(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=zu(t,n.document),i=n.readTime?qu(n.readTime):hi.min(),u=new eo(r,i),o=n.removedTargetIds||[],s=new _u([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=zu(t,n.document),i=n.removedTargetIds||[],s=new _u([],i,r,null);else{if(!("filter"in e))return Tr();e.filter,(e=e.filter).targetId,r=new Gs(n=e.count||0),i=e.targetId,s=new Eu(i,r)}return s}(this.Kt,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?hi.min():qu(e.readTime);return this.listener.uh(n,t)},Zf.prototype.hh=function(t){var e,n,r,i,o={};o.database=Wu(this.Kt),o.addTarget=(e=this.Kt,(r=ho(r=(n=t).target)?{documents:ta(e,r)}:{query:ea(e,r)}).targetId=n.targetId,0<n.resumeToken.o()?r.resumeToken=ju(e,n.resumeToken):0<n.Mt.u(hi.min())&&(r.readTime=Fu(e,n.Mt.G())),r),(t=(this.Kt,i=t,null==(t=function(){switch(i.kt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Tr()}}())?null:{"goog-listen-tags":t}))&&(o.labels=t),this.eh(o)},Zf.prototype.lh=function(t){var e={};e.database=Wu(this.Kt),e.removeTarget=t,this.eh(e)},Zf),Jf=(h($f,Bf=me),Object.defineProperty($f.prototype,"fh",{get:function(){return this._h},enumerable:!1,configurable:!0}),$f.prototype.start=function(){this._h=!1,this.lastStreamToken=void 0,Bf.prototype.start.call(this)},$f.prototype.sh=function(){this._h&&this.dh([])},$f.prototype.ah=function(t){return this.Ku.xu("Write",t)},$f.prototype.onMessage=function(t){if(Nr(!!t.streamToken),this.lastStreamToken=t.streamToken,this._h){this.zu.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Nr(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?qu(e.updateTime):qu(n)).isEqual(hi.min())&&(t=qu(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new Ss(t,n);var e,n})):[]),n=qu(t.commitTime);return this.listener.wh(n,e)}var r;return Nr(!t.writeResults||0===t.writeResults.length),this._h=!0,this.listener.Eh()},$f.prototype.Th=function(){var t={};t.database=Wu(this.Kt),this.eh(t)},$f.prototype.dh=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return $u(e.Kt,t)})};this.eh(t)},$f),Wf=(h(Qf,Hf=function(){}),Qf.prototype.mh=function(){if(this.Ih)throw new Rr(Cr.FAILED_PRECONDITION,"The client has already been terminated.")},Qf.prototype.bu=function(e,n,r){var i=this;return this.mh(),this.credentials.getToken().then(function(t){return i.Ku.bu(e,n,r,t)}).catch(function(t){throw t.code===Cr.UNAUTHENTICATED&&i.credentials.v(),t})},Qf.prototype.Cu=function(e,n,r){var i=this;return this.mh(),this.credentials.getToken().then(function(t){return i.Ku.Cu(e,n,r,t)}).catch(function(t){throw t.code===Cr.UNAUTHENTICATED&&i.credentials.v(),t})},Qf.prototype.terminate=function(){this.Ih=!1},Qf),Xf=(Yf.prototype.yh=function(){var t=this;0===this.Ah&&(this.gh("Unknown"),this.Rh=this.fs.Ir("online_state_timeout",1e4,function(){return t.Rh=null,t.Vh("Backend didn't respond within 10 seconds."),t.gh("Offline"),Promise.resolve()}))},Yf.prototype.ph=function(t){"Online"===this.state?this.gh("Unknown"):(this.Ah++,1<=this.Ah&&(this.bh(),this.Vh("Connection failed 1 times. Most recent error: "+t.toString()),this.gh("Offline")))},Yf.prototype.set=function(t){this.bh(),this.Ah=0,"Online"===t&&(this.Ph=!1),this.gh(t)},Yf.prototype.gh=function(t){t!==this.state&&(this.state=t,this.da(t))},Yf.prototype.Vh=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Ph?(Ir(t),this.Ph=!1):br("OnlineStateTracker",t)},Yf.prototype.bh=function(){null!==this.Rh&&(this.Rh.cancel(),this.Rh=null)},Yf);function Yf(t,e){this.fs=t,this.da=e,this.state="Unknown",this.Ah=0,this.Rh=null,this.Ph=!0}function Qf(t,e,n){var r=this;return(r=Hf.call(this)||this).credentials=t,r.Ku=e,r.Kt=n,r.Ih=!1,r}function $f(t,e,n,r,i){var o=this;return(o=Bf.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).Kt=r,o._h=!1,o}function Zf(t,e,n,r,i){var o=this;return(o=Gf.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).Kt=r,o}function tl(t,e,n,r,i,o){this.eo=t,this.Qu=n,this.Ku=r,this.Wu=i,this.listener=o,this.state=0,this.ju=0,this.Gu=null,this.stream=null,this.zu=new zf(t,e)}function el(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.eo=t,this.ds=e,this.Nu=n,this.Fu=r,this.Ou=i,this.ku=0,this.Mu=null,this.$u=Date.now(),this.reset()}function nl(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!hl(r))return[3,4];e=0,n=r.Oh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function rl(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Oh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function il(t,e){t.Nh.has(e.targetId)||(t.Nh.set(e.targetId,e),cl(t)?al(t):ml(t).Ju()&&sl(t,e))}function ol(t,e){var n=t,t=ml(n);n.Nh.delete(e),t.Ju()&&ul(n,e),0===n.Nh.size&&(t.Ju()?t.Zu():hl(n)&&n.Mh.set("Unknown"))}function sl(t,e){t.$h.cn(e.targetId),ml(t).hh(e)}function ul(t,e){t.$h.cn(e),ml(t).lh(e)}function al(e){e.$h=new Su({Sn:function(t){return e.Ch.Sn(t)},Dn:function(t){return e.Nh.get(t)||null}}),ml(e).start(),e.Mh.yh()}function cl(t){return hl(t)&&!ml(t).Hu()&&0<t.Nh.size}function hl(t){return 0===t.Fh.size}function fl(t){t.$h=void 0}function ll(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!ba(r))throw r;return n.Fh.add(1),[4,rl(n)];case 1:return t.sent(),n.Mh.set("Offline"),i=i||function(){return Ch(n.Sh)},n.fs.bo(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return br("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Fh.delete(1),[4,nl(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function pl(e,n){return n().catch(function(t){return ll(e,t,n)})}function dl(c){return y(this,void 0,void 0,function(){var o,s,u,a;return v(this,function(t){switch(t.label){case 0:s=wl(o=c),u=0<o.xh.length?o.xh[o.xh.length-1].batchId:-1,t.label=1;case 1:if(!(hl(o)&&o.xh.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(n=o.Sh,r=u,(i=n).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===r&&(r=-1),i.Ho.Vi(t,r)}))];case 3:return null===(a=t.sent())?(0===o.xh.length&&s.Zu(),[3,7]):(u=a.batchId,e=a,(n=o).xh.push(e),(n=wl(n)).Ju()&&n.fh&&n.dh(e.mutations),[3,6]);case 4:return a=t.sent(),[4,ll(o,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return yl(o)&&vl(o),[2]}var e,n,r,i})})}function yl(t){return hl(t)&&!wl(t).Hu()&&0<t.xh.length}function vl(t){wl(t).start()}function gl(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Fh.delete(2),[4,nl(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Fh.add(2),[4,rl(e)]);case 3:t.sent(),e.Mh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function ml(n){var t,e,r,i=this;return n.Qh||(n.Qh=(t=n.Dh,e=n.fs,r={Eu:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Nh.forEach(function(t,e){sl(n,t)}),[2]})})}.bind(null,n),Iu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return fl(e),cl(e)?(e.Mh.ph(n),al(e)):e.Mh.set("Unknown"),[2]})})}.bind(null,n),uh:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Mh.set("Online"),!(u instanceof Tu&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Nh.has(i)?[4,o.Ch.Lh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Nh.delete(i),o.$h.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),br("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,ll(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof _u?s.$h.wn(u):u instanceof Eu?s.$h.yn(u):s.$h.In(u),a.isEqual(hi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Ch(s.Sh)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).$h.pn(i)).Oe.forEach(function(t,e){var n;0<t.resumeToken.o()&&(n=r.Nh.get(e))&&r.Nh.set(e,n.Lt(t.resumeToken,i))}),e.ke.forEach(function(t){var e=r.Nh.get(t);e&&(r.Nh.set(t,e.Lt(Or.h,e.Mt)),ul(r,t),e=new is(e.target,t,1,e.sequenceNumber),sl(r,e))}),r.Ch.Bh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return br("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,ll(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.mh(),new Kf(e,t.Ku,t.credentials,t.Kt,r)),n.Oh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Qh.Xu(),cl(n)?al(n):n.Mh.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Qh.stop()];case 2:t.sent(),fl(n),t.label=3;case 3:return[2]}})})})),n.Qh}function wl(n){var t,e,r,i=this;return n.Kh||(n.Kh=(t=n.Dh,e=n.fs,r={Eu:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return wl(e).Th(),[2]})})}.bind(null,n),Iu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&wl(e).fh?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return $s(n=i.code)&&n!==Cr.ABORTED?(e=r.xh.shift(),wl(r).Xu(),[4,pl(r,function(){return r.Ch.Uh(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,dl(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return yl(e)&&vl(e),[2]}})})}.bind(null,n),Eh:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=wl(o),n=0,r=o.xh;n<r.length;n++)i=r[n],e.dh(i.mutations);return[2]})})}.bind(null,n),wh:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.xh.shift(),n=rc.from(e,i,o),[4,pl(r,function(){return r.Ch.qh(n)})];case 1:return t.sent(),[4,dl(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.mh(),new Jf(e,t.Ku,t.credentials,t.Kt,r)),n.Oh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Kh.Xu(),[4,dl(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Kh.stop()];case 3:t.sent(),0<n.xh.length&&(br("RemoteStore","Stopping write stream with "+n.xh.length+" pending writes"),n.xh=[]),t.label=4;case 4:return[2]}})})})),n.Kh}function bl(){this.queries=new Lc(ts,Zo),this.onlineState="Unknown",this.jh=new Set}var Il=function(){this.Wh=void 0,this.listeners=[]};function _l(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Il),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Gh(n)];case 2:return o.Wh=t.sent(),[3,4];case 3:return o=xa(o=t.sent(),"Initialization of query '"+es(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.zh(e.onlineState),i.Wh&&u.Hh(i.Wh)&&Tl(e),[2]}})})}function El(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Jh(n))]:[2]})})}function Tl(t){t.jh.forEach(function(t){t.next()})}var Nl=(Ll.prototype.Hh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new wu(t.query,t.docs,t.De,e,t.Ce,t.fromCache,t.xe,!0)}var o=!1;return this.Xh?this.tl(t)&&(this.Yh.next(t),o=!0):this.el(t,this.onlineState)&&(this.nl(t),o=!0),this.Zh=t,o},Ll.prototype.onError=function(t){this.Yh.error(t)},Ll.prototype.zh=function(t){this.onlineState=t;var e=!1;return this.Zh&&!this.Xh&&this.el(this.Zh,t)&&(this.nl(this.Zh),e=!0),e},Ll.prototype.el=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.sl&&n||t.docs.nt()&&"Offline"!==e)},Ll.prototype.tl=function(t){if(0<t.docChanges.length)return!0;var e=this.Zh&&this.Zh.hasPendingWrites!==t.hasPendingWrites;return!(!t.xe&&!e)&&!0===this.options.includeMetadataChanges},Ll.prototype.nl=function(t){t=wu.Fe(t.query,t.docs,t.Ce,t.fromCache),this.Xh=!0,this.Yh.next(t)},Ll),Sl=(Ol.prototype.il=function(){return"metadata"in this.payload},Ol),Al=(kl.prototype.yc=function(t){return zu(this.Kt,t)},kl.prototype.gc=function(t){return t.metadata.exists?Qu(this.Kt,t.document,!1):new eo(this.yc(t.metadata.name),this.Vc(t.metadata.readTime))},kl.prototype.Vc=qu,kl),xl=(Dl.prototype.ol=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},Dl.prototype.cl=function(t){for(var e=new Map,n=new Al(this.Kt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.yc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||yu()).add(s);e.set(c,h)}}return e},Dl.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,l,p,d){return y(this,void 0,void 0,function(){var n,r,i,o,e,s,u,a,c,h;return v(this,function(t){switch(t.label){case 0:for(n=f,r=yu(),i=cu,o=pu,e=0,s=p;e<s.length;e++)u=s[e],a=l.yc(u.metadata.name),u.document&&(r=r.add(a)),i=i.Ht(a,l.gc(u)),o=o.Ht(a,l.Vc(u.metadata.readTime));return c=n.Tc.Fr({jr:!0}),[4,Vh(n,Qo(Go(fi.ct("__bundle__/docs/"+d))))];case 1:return h=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return Rh(e,c,i,hi.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n.fo.Xi(e,h.targetId).next(function(){return n.fo.nr(e,r,h.targetId)}).next(function(){return n.Ic.tc(e,t)})})})]}})})}(this.Sh,new Al(this.Kt),this.documents,this.rl.id)];case 1:e=t.sent(),n=this.cl(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=yu()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,Vh(e,Qo(vc(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=qu(i.readTime);return 0<=n.Mt.u(e)?r.Eo.Bs(t,i):(e=n.Lt(Or.h,e),r.dc=r.dc.Ht(e.targetId,e),r.fo.Ji(t,e).next(function(){return r.fo.Xi(t,n.targetId)}).next(function(){return r.fo.nr(t,o,n.targetId)}).next(function(){return r.Eo.Bs(t,i)}))})]}})})}(this.Sh,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Eh(Object.assign({},this.progress),e))]}})})},Dl);function Dl(t,e,n){this.rl=t,this.Sh=e,this.Kt=n,this.queries=[],this.documents=[],this.progress=Pl(t)}function kl(t){this.Kt=t}function Ol(t,e){this.payload=t,this.byteLength=e}function Ll(t,e,n){this.query=t,this.Yh=e,this.Xh=!1,this.Zh=null,this.onlineState="Unknown",this.options=n||{}}function Pl(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Cl=function(t){this.key=t},Rl=function(t){this.key=t},Vl=(Object.defineProperty(ql.prototype,"fl",{get:function(){return this.al},enumerable:!1,configurable:!0}),ql.prototype.dl=function(t,e){var s=this,u=e?e.wl:new mu,a=(e||this)._l,c=(e||this).Ce,h=a,f=!1,l=zo(this.query)&&a.size===this.query.limit?a.last():null,p=Ko(this.query)&&a.size===this.query.limit?a.first():null;if(t.Zt(function(t,e){var n=a.get(t),r=(r=e instanceof to?e:null)&&(ns(s.query,r)?r:null),i=!!n&&s.Ce.has(n.key),o=!!r&&(r.bt||s.Ce.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.El(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.ll(r,l)||p&&s.ll(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),zo(this.query)||Ko(this.query))for(;h.size>this.query.limit;){var n=zo(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{_l:h,wl:u,_c:f,Ce:c}},ql.prototype.El=function(t,e){return t.bt&&e.hasCommittedMutations&&!e.bt},ql.prototype.Ei=function(t,e,n){var o=this,r=this._l;this._l=t._l,this.Ce=t.Ce;var i=t.wl.Se();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.ll(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Tr()}}var r,i}),this.Tl(n);var s=e?this.Il():[],e=(n=0===this.hl.size&&this.qe?1:0)!==this.ul;return this.ul=n,0!==i.length||e?{snapshot:new wu(this.query,t._l,r,i,t.Ce,0==n,e,!1),ml:s}:{ml:s}},ql.prototype.zh=function(t){return this.qe&&"Offline"===t?(this.qe=!1,this.Ei({_l:this._l,wl:new mu,Ce:this.Ce,_c:!1},!1)):{ml:[]}},ql.prototype.Al=function(t){return!this.al.has(t)&&!!this._l.has(t)&&!this._l.get(t).bt},ql.prototype.Tl=function(t){var e=this;t&&(t.Ue.forEach(function(t){return e.al=e.al.add(t)}),t.Qe.forEach(function(t){}),t.Ke.forEach(function(t){return e.al=e.al.delete(t)}),this.qe=t.qe)},ql.prototype.Il=function(){var e=this;if(!this.qe)return[];var n=this.hl;this.hl=yu(),this._l.forEach(function(t){e.Al(t.key)&&(e.hl=e.hl.add(t.key))});var r=[];return n.forEach(function(t){e.hl.has(t)||r.push(new Rl(t))}),this.hl.forEach(function(t){n.has(t)||r.push(new Cl(t))}),r},ql.prototype.Rl=function(t){return this.al=t.Pc,this.hl=yu(),t=this.dl(t.documents),this.Ei(t,!0)},ql.prototype.Pl=function(){return wu.Fe(this.query,this._l,this.Ce,0===this.ul)},ql),Ml=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Ul=function(t){this.key=t,this.yl=!1},Fl=(Object.defineProperty(jl.prototype,"Ll",{get:function(){return!0===this.$l},enumerable:!1,configurable:!0}),jl);function jl(t,e,n,r,i,o){this.Sh=t,this.gl=e,this.Vl=n,this.pl=r,this.currentUser=i,this.bl=o,this.vl={},this.Sl=new Lc(ts,Zo),this.Dl=new Map,this.Cl=[],this.xl=new tu(di.J),this.Nl=new Map,this.Fl=new Gh,this.Ol={},this.kl=new Map,this.Ml=Bc.Bi(),this.onlineState="Unknown",this.$l=void 0}function ql(t,e){this.query=t,this.al=e,this.ul=null,this.qe=!1,this.hl=yu(),this.Ce=yu(),this.ll=rs(t),this._l=new gu(this.ll)}function Hl(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Bl=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.dl(o))._c?[4,Uh(r.Sh,i.query,!1).then(function(t){return t=t.documents,i.view.dl(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Oe.get(i.targetId),n=i.view.Ei(e,r.Ll,n),[2,(Ql(r,i.targetId,n.ml),n.snapshot)]}})})}(i,t,e,n)},[4,Uh(i.Sh,o,!0)];case 1:return n=t.sent(),r=new Vl(o,n.Pc),e=r.dl(n.documents),n=Iu.Be(s,u&&"Offline"!==i.onlineState),n=r.Ei(e,i.Ll,n),Ql(i,s,n.ml),r=new Ml(o,s,r),[2,(i.Sl.set(o,r),i.Dl.has(s)?i.Dl.get(s).push(o):i.Dl.set(s,[o]),n.snapshot)]}})})}function Bl(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=rp(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Sh,a=p,h=i,f=ci.now(),o=a.reduce(function(t,e){return t.add(e.key)},yu()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Ic.Zo(u,o).next(function(t){c=t;for(var e,n=[],r=0,i=a;r<i.length;r++){var o=i[r],s=(e=o,s=c.get(o.key),function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof to?e.field(o.field):void 0;null!=(s=cs(o.transform,s||null))&&(n=(null==n?new Wi:n).set(o.field,s))}return n?n.yt():null}(e.fieldTransforms,s));null!=s&&n.push(new Ms(o.key,s,function s(t){var u=[];return _i(t.fields||{},function(t,e){var n=new pi([t]);if(Ki(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Ti(u)}(s.proto.mapValue),xs.exists(!0)))}return h.Ho.Pi(u,f,n,a)})}).then(function(t){var e=t.Ns(c);return{batchId:t.batchId,oi:e}}))];case 2:return s=t.sent(),u.pl.xa(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.Ol[e.currentUser.R()])||new tu(xr)).Ht(n,r),e.Ol[e.currentUser.R()]=i,[4,Zl(u,s.oi)];case 3:return t.sent(),[4,dl(u.gl)];case 4:return t.sent(),[3,6];case 5:return u=xa(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}function Gl(o,s){return y(this,void 0,void 0,function(){var n,i;return v(this,function(t){switch(t.label){case 0:n=o,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Sh,a=e,c=(r=s).Mt,h=a.dc,a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.Tc.Fr({jr:!0});h=a.dc;var u=[];r.Oe.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a.fo.ir(s,t.Ke,e).next(function(){return a.fo.nr(s,t.Ue,e)})),0<(i=t.resumeToken).o()&&(n=o.Lt(i,c).$t(s.vs),h=h.Ht(e,n),r=o,i=t,Nr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.Mt.j()-r.Mt.j()||0<i.Ue.size+i.Qe.size+i.Ke.size)&&u.push(a.fo.Ji(s,n))))});var e,n=cu;return r.Me.forEach(function(t,e){r.$e.has(t)&&u.push(a.persistence.Ii.kr(s,t))}),u.push(Rh(s,t,r.Me,c,void 0).next(function(t){n=t})),c.isEqual(hi.min())||(e=a.fo.Ki(s).next(function(t){return a.fo.ji(s,s.vs,c)}),u.push(e)),ha.Ln(u).next(function(){return t.apply(s)}).next(function(){return a.Ic.tc(s,n)})}).then(function(t){return a.dc=h,t}))];case 2:return i=t.sent(),s.Oe.forEach(function(t,e){(e=n.Nl.get(e))&&(Nr(t.Ue.size+t.Qe.size+t.Ke.size<=1),0<t.Ue.size?e.yl=!0:0<t.Qe.size?Nr(e.yl):0<t.Ke.size&&(Nr(e.yl),e.yl=!1))}),[4,Zl(n,i,s)];case 3:return t.sent(),[3,6];case 4:return[4,Oc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,a,c,h})})}function zl(t,n,e){var r;((t=t).Ll&&0===e||!t.Ll&&1===e)&&(r=[],t.Sl.forEach(function(t,e){(e=e.view.zh(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].zh(i)&&(o=!0)}),o&&Tl(t)}(t.Vl,n),r.length&&t.vl.uh(r),t.onlineState=n,t.Ll&&t.pl.Ka(n))}function Kl(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:hl((n=o).gl)||br("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Sh).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ho.pi(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.kl.get(r)||[]).push(s),n.kl.set(r,i),[3,4]);case 3:return i=xa(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function Jl(t,e){(t.kl.get(e)||[]).forEach(function(t){t.resolve()}),t.kl.delete(e)}function Wl(t,e,n){var r=t,i=r.Ol[r.currentUser.R()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Ol[r.currentUser.R()]=i)}function Xl(e,t,n){void 0===n&&(n=null),e.pl.$a(t);for(var r=0,i=e.Dl.get(t);r<i.length;r++){var o=i[r];e.Sl.delete(o),n&&e.vl.ql(o,n)}e.Dl.delete(t),e.Ll&&e.Fl.kc(t).forEach(function(t){e.Fl.ki(t)||Yl(e,t)})}function Yl(t,e){var n=t.xl.get(e);null!==n&&(ol(t.gl,n),t.xl=t.xl.remove(e),t.Nl.delete(n),$l(t))}function Ql(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof Cl?(t.Fl.sr(u.key,e),r=t,i=(i=u).key,r.xl.get(i)||(br("SyncEngine","New document in limbo: "+i),r.Cl.push(i),$l(r))):u instanceof Rl?(br("SyncEngine","Document no longer in limbo: "+u.key),t.Fl.rr(u.key,e),t.Fl.ki(u.key)||Yl(t,u.key)):Tr()}}function $l(t){for(;0<t.Cl.length&&t.xl.size<t.bl;){var e=t.Cl.shift(),n=t.Ml.next();t.Nl.set(n,new Ul(e)),t.xl=t.xl.Ht(e,n),il(t.gl,new is(Qo(Go(e.path)),n,2,ei.U))}}function Zl(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Sl.nt()?[3,3]:(n.Sl.forEach(function(t,e){o.push(n.Bl(e,s,u).then(function(t){t&&(n.Ll&&n.pl.qa(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Nh.cc(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.vl.uh(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ha.forEach(c,function(e){return ha.forEach(e.rc,function(t){return r.persistence.Ii.sr(n,e.targetId,t)}).next(function(){return ha.forEach(e.oc,function(t){return r.persistence.Ii.rr(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!ba(e=t.sent()))throw e;return br("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.dc.get(o),u=s.Mt,u=s.Bt(u),r.dc=r.dc.Ht(o,u));return[2]}})})}(n.Sh,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function tp(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.Dl.get(s))&&0!==a.length?[4,Vh(e.Sh,Qo(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Sl.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Uh((e=r).Sh,i.query,!0)];case 1:return n=t.sent(),n=i.view.Rl(n),[2,(e.Ll&&Ql(e,i.targetId,n.ml),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Fh(e.Sh,s)];case 8:return l=t.sent(),[4,Vh(e.Sh,l)];case 9:return u=t.sent(),[4,Hl(e,ep(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.vl.uh(r),n)]}})})}function ep(t){return Bo(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function np(t){return t.gl.Ch.Bh=Gl.bind(null,t),t.gl.Ch.Sn=function(t,e){var n=t;if((t=n.Nl.get(e))&&t.yl)return yu().add(t.key);var r=yu();if(!(e=n.Dl.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Sl.get(s),r=r.ye(s.view.fl);return r}.bind(null,t),t.gl.Ch.Lh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).pl.qa(s,"rejected",u),i=e.Nl.get(s),(n=i&&i.key)?(r=(r=new tu(di.J)).Ht(n,new eo(n,hi.min())),i=yu().add(n),i=new bu(hi.min(),new Map,new uu(xr),r,i),[4,Gl(e,i)]):[3,2];case 1:return t.sent(),e.xl=e.xl.remove(n),e.Nl.delete(s),$l(e),[3,4];case 2:return[4,Mh(e.Sh,s,!1).then(function(){return Xl(e,s,u)}).catch(Oc)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.vl.uh=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.queries.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Hh(s)&&(r=!0);u.Wh=s}}r&&Tl(n)}.bind(null,t.Vl),t.vl.ql=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.Vl),t}function rp(t){return t.gl.Ch.qh=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Sh,h=s,(f=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=h.batch.keys(),n=f.Tc.Fr({jr:!0}),i=f,o=t,s=n,u=(r=h).batch,a=u.keys(),c=ha.resolve();return a.forEach(function(n){c=c.next(function(){return s.fi(o,n)}).next(function(t){var e=t;Nr(null!==(t=r.Os.get(n))),(!e||e.version.u(t)<0)&&(e=u.Ds(n,e,r))&&s.ui(e,r.Fs)})}),c.next(function(){return i.Ho.xi(o,u)}).next(function(){return n.apply(t)}).next(function(){return f.Ho.Oi(t)}).next(function(){return f.Ic.Zo(t,e)})}))];case 2:return i=t.sent(),Wl(n,r,null),Jl(n,r),n.pl.Fa(r,"acknowledged"),[4,Zl(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Oc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,f})})}.bind(null,t),t.gl.Ch.Uh=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Sh,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Ho.yi(e,r).next(function(t){return Nr(null!==t),n=t.keys(),i.Ho.xi(e,t)}).next(function(){return i.Ho.Oi(e)}).next(function(){return i.Ic.Zo(e,n)})}))];case 2:return o=t.sent(),Wl(n,u,a),Jl(n,u),n.pl.Fa(u,"rejected",a),[4,Zl(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Oc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,t),t}function ip(t,e,n){var r=t;(function(l,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=l.Sh,o=r,s=qu((i=u).createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.Eo.Ms(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.u(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.Ul({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.Ql(Pl(u)),a=new xl(u,l.Sh,p.Kt),[4,p.Kl()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.ol(c)]:[3,10];case 7:return(h=t.sent())&&d.Ql(h),[4,p.Kl()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return f=t.sent(),[4,Zl(l,f.zo,void 0)];case 12:return t.sent(),[4,(r=l.Sh,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.Eo.$s(t,e)}))];case 13:return t.sent(),d.Ul(f.progress),[3,15];case 14:return _r("SyncEngine","Loading bundle failed with "+(f=t.sent())),d.Wl(f),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.pl.ja()})}var op,sp,up=(dp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Kt=jf(e.gu.T),this.pl=this.jl(e),this.persistence=this.Gl(e),[4,this.persistence.start()];case 1:return t.sent(),this.zl=this.Hl(e),this.Sh=this.Jl(e),[2]}})})},dp.prototype.Hl=function(t){return null},dp.prototype.Jl=function(t){return Lh(this.persistence,new Sh,t.Yl,this.Kt)},dp.prototype.Gl=function(t){return new Yh($h.ra,this.Kt)},dp.prototype.jl=function(t){return new bf},dp.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.pl.$o()];case 1:return t.sent(),[4,this.persistence.$o()];case 2:return t.sent(),[2]}})})},dp),ap=(h(pp,sp=up),pp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,sp.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=lh(t),r=hi.min(),t.ls({index:Ha.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=hc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.Ec=t})]})})}(this.Sh)];case 2:return t.sent(),[4,this.Xl.initialize(this,e)];case 3:return t.sent(),[4,rp(this.Xl.fa)];case 4:return t.sent(),[4,dl(this.Xl.gl)];case 5:return t.sent(),[2]}})})},pp.prototype.Jl=function(t){return Lh(this.persistence,new Sh,t.Yl,this.Kt)},pp.prototype.Hl=function(t){var e=this.persistence.Ii._r;return new $c(e,t.fs)},pp.prototype.Gl=function(t){var e=_h(t.gu.T,t.gu.persistenceKey),n=void 0!==this.cacheSizeBytes?Dc.Xs(this.cacheSizeBytes):Dc.ei;return new mh(this.synchronizeTabs,e,t.clientId,n,t.fs,Uf(),Ff(),this.Kt,this.pl,!!this.forceOwnership)},pp.prototype.jl=function(t){return new bf},pp),cp=(h(lp,op=ap),lp.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,op.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Xl.fa,this.pl instanceof wf?(this.pl.fa={nu:function(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Sh,n=a,i=(r=e).Ho,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.gi(e,n).next(function(t){return t?r.Ic.Zo(e,t):ha.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,dl(o.gl)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(Wl(o,a,h||null),Jl(o,a),o.Sh.Ho.Ni(a)):Tr(),t.label=4;case 4:return[4,Zl(o,s)];case 5:return t.sent(),[3,7];case 6:br("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),su:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).$l?(br("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.Dl.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,jh(e.Sh)];case 3:return n=t.sent(),r=bu.Le(o,"current"===s),[4,Zl(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,Mh(e.Sh,o,!0)];case 6:return t.sent(),Xl(e,o,u),[3,8];case 7:Tr(),t.label=8;case 8:return[2]}})})}.bind(null,e),iu:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=np(c)).$l)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.Dl.has(r)?(br("SyncEngine","Adding an already active target "+r),[3,5]):[4,Fh(n.Sh,r)]):[3,6];case 2:return i=t.sent(),[4,Vh(n.Sh,i)];case 3:return o=t.sent(),[4,Hl(n,ep(i),o.targetId,!1)];case 4:t.sent(),il(n.gl,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.Dl.has(e)?[4,Mh(n.Sh,e,!1).then(function(){ol(n.gl,e),Xl(n,e)}).catch(Oc)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),Qo:function(t){return t.Sh.persistence.Qo()}.bind(null,e),eu:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,jh((e=n).Sh).then(function(t){return Zl(e,t)})]})})}.bind(null,e)},[4,this.pl.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Po(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,function(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return np(r=h),rp(r),!0!==f||!0===r.$l?[3,3]:(e=r.pl.Sa(),[4,tp(r,e.rt())]);case 1:return i=t.sent(),r.$l=!0,[4,gl(r.gl,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],il(r.gl,u);return[3,7];case 3:return!1!==f||!1===r.$l?[3,7]:(a=[],c=Promise.resolve(),r.Dl.forEach(function(t,e){r.pl.La(e)?a.push(e):c=c.then(function(){return Xl(r,e),Mh(r.Sh,e,!0)}),ol(r.gl,e)}),[4,c]);case 4:return t.sent(),[4,tp(r,a)];case 5:return t.sent(),(n=r).Nl.forEach(function(t,e){ol(n.gl,e)}),n.Fl.Mc(),n.Nl=new Map,n.xl=new tu(di.J),r.$l=!1,[4,gl(r.gl,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.Xl.fa,e)];case 1:return t.sent(),this.zl&&(e&&!this.zl.Tr?this.zl.start(this.Sh):e||this.zl.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},lp.prototype.jl=function(t){var e=Uf();if(!wf.Wn(e))throw new Rr(Cr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=_h(t.gu.T,t.gu.persistenceKey);return new wf(e,t.fs,n,t.clientId,t.Yl)},lp),hp=(fp.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Sh?[3,2]:(this.Sh=n.Sh,this.pl=n.pl,this.Dh=this.Zl(r),this.gl=this.t_(r),this.Vl=this.e_(r),this.fa=this.n_(r,!n.synchronizeTabs),this.pl.da=function(t){return zl(e.fa,t,1)},this.gl.Ch.s_=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(br("SyncEngine","User change. New user:",o.R()),[4,Ph(n.Sh,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).kl.forEach(function(t){t.forEach(function(t){t.reject(new Rr(Cr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.kl.clear(),n.pl.Qa(o,r.Ac,r.Rc),[4,Zl(n,r.mc)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.fa),[4,gl(this.gl,this.fa.Ll)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},fp.prototype.e_=function(t){return new bl},fp.prototype.Zl=function(t){var e=jf(t.gu.T),n=(n=t.gu,new Nf(n));return t=t.credentials,new Wf(t,n,e)},fp.prototype.t_=function(t){var e=this;return new qf(this.Sh,this.Dh,t.fs,function(t){return zl(e.fa,t,0)},t=new(_f.Wn()?_f:If))},fp.prototype.n_=function(t,e){return n=this.Sh,r=this.gl,i=this.Vl,o=this.pl,s=t.Yl,t=t.bl,e=e,t=new Fl(n,r,i,o,s,t),e&&(t.$l=!0),t;var n,r,i,o,s},fp.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,br("RemoteStore","RemoteStore shutting down."),e.Fh.add(5),[4,rl(e)];case 1:return t.sent(),e.kh.$o(),e.Mh.set("Unknown"),[2]}})})}(this.gl)},fp);function fp(){}function lp(t,e){var n=this;return(n=op.call(this,t,e,!1)||this).Xl=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function pp(t,e,n){var r=this;return(r=sp.call(this)||this).Xl=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function dp(){this.synchronizeTabs=!1}function yp(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}var vp=(_p.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},_p.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},_p.prototype.r_=function(){this.muted=!0},_p.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},_p),gp=(Ip.prototype.close=function(){return this.o_.cancel()},Ip.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},Ip.prototype.Kl=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.a_())]}})})},Ip.prototype.a_=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.u_()];case 1:return null===(e=t.sent())?[2,null]:(r=this.c_.decode(e),n=Number(r),isNaN(n)&&this.h_("length string ("+r+") is not valid number"),[4,this.l_(n)]);case 2:return r=t.sent(),[2,new Sl(JSON.parse(r),e.length+n)]}})})},Ip.prototype.__=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},Ip.prototype.u_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.__()<0?[4,this.f_()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.__())<0&&this.h_("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},Ip.prototype.l_=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.f_()]:[3,3];case 1:t.sent()&&this.h_("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.c_.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},Ip.prototype.h_=function(t){throw this.o_.cancel(),new Error("Invalid bundle format: "+t)},Ip.prototype.f_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.o_.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},Ip),mp=(bp.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},bp),wp=function(t){this._methodName=t};function bp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.d_=new pi(t)}function Ip(t,e){var n=this;this.o_=t,this.Kt=e,this.metadata=new ca,this.buffer=new Uint8Array,this.c_=new TextDecoder("utf-8"),this.a_().then(function(t){t&&t.il()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function _p(t){this.observer=t,this.muted=!1}function Ep(t,e,n){if(!n)throw new Rr(Cr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Tp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Np(t,e,n,r){if(!0===e&&!0===r)throw new Rr(Cr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Sp(t){if(!di.Et(t))throw new Rr(Cr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Ap(t){if(di.Et(t))throw new Rr(Cr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function xp(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Tr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Dp(t,e){if("_delegate"in t&&(t=t._),t instanceof e)return t;if(e.name===t.constructor.name)throw new Rr(Cr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=xp(t),new Rr(Cr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function kp(t,e){if(e<=0)throw new Rr(Cr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Op,Lp=(Hp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Hp),Pp=new Map,Cp=(Object.defineProperty(qp.prototype,"app",{get:function(){if(!this.A_)throw new Rr(Cr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(qp.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(qp.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),qp.prototype.g_=function(t){if(this.T_)throw new Rr(Cr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new Lp(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new Qr;switch(t.type){case"gapi":var e=t.client;return Nr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ti(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Rr(Cr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},qp.prototype.V_=function(){return this.E_},qp.prototype.p_=function(){return this.T_=!0,this.E_},qp.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},qp.prototype.b_=function(){return(t=Pp.get(this))&&(br("ComponentProvider","Removing Datastore"),Pp.delete(this),t.terminate()),Promise.resolve();var t},qp),Rp=(Object.defineProperty(jp.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(jp.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(jp.prototype,"path",{get:function(){return this.S_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(jp.prototype,"parent",{get:function(){return new Mp(this.firestore,this.v_,this.S_.path.Z())},enumerable:!1,configurable:!0}),jp.prototype.withConverter=function(t){return new jp(this.firestore,t,this.S_)},jp),Vp=(Fp.prototype.withConverter=function(t){return new Fp(this.firestore,t,this.C_)},Fp),Mp=(h(Up,Op=Vp),Object.defineProperty(Up.prototype,"id",{get:function(){return this.C_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(Up.prototype,"path",{get:function(){return this.C_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(Up.prototype,"parent",{get:function(){var t=this.D_.Z();return t.nt()?null:new Rp(this.firestore,null,new di(t))},enumerable:!1,configurable:!0}),Up.prototype.withConverter=function(t){return new Up(this.firestore,t,this.D_)},Up);function Up(t,e,n){var r=this;return(r=Op.call(this,t,e,Go(n))||this).firestore=t,r.D_=n,r.type="collection",r}function Fp(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}function jp(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}function qp(t,e){this.w_="(lite)",this.E_=new Lp({}),this.T_=!1,t instanceof zr?(this.I_=t,this.m_=new Qr):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Rr(Cr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zr(t.options.projectId)}(t),this.m_=new $r(e))}function Hp(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Rr(Cr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Rr(Cr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Np("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Bp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Mr&&(t=t._),Ep("collection","path",e),t instanceof Cp)return Ap(n=fi.ct.apply(fi,f([e],r))),new Mp(t,null,n);if(!(t instanceof Rp||t instanceof Mp))throw new Rr(Cr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Ap(n=fi.ct.apply(fi,f([t.path],r)).child(fi.ct(e))),new Mp(t.firestore,null,n)}function Gp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Mr&&(t=t._),1===arguments.length&&(e=Sr.t()),Ep("doc","path",e),t instanceof Cp)return Sp(n=fi.ct.apply(fi,f([e],r))),new Rp(t,null,new di(n));if(!(t instanceof Rp||t instanceof Mp))throw new Rr(Cr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Sp(n=t.D_.child(fi.ct.apply(fi,f([e],r)))),new Rp(t.firestore,t instanceof Mp?t.v_:null,new di(n))}function zp(t,e){return t instanceof Mr&&(t=t._),e instanceof Mr&&(e=e._),(t instanceof Rp||t instanceof Mp)&&(e instanceof Rp||e instanceof Mp)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function Kp(t,e){return t instanceof Mr&&(t=t._),e instanceof Mr&&(e=e._),t instanceof Vp&&e instanceof Vp&&t.firestore===e.firestore&&Zo(t.C_,e.C_)&&t.v_===e.v_}var Jp=(Object.defineProperty(Zp.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(Zp.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),Zp.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},Zp.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},Zp.prototype.K=function(t){return xr(this.x_,t.x_)||xr(this.N_,t.N_)},Zp),Wp=/^__.*__$/,Xp=($p.prototype.F_=function(t,e){return null!==this.zt?new Ms(t,this.data,this.zt,e,this.fieldTransforms):new Vs(t,this.data,e,this.fieldTransforms)},$p),Yp=(Qp.prototype.F_=function(t,e){return new Ms(t,this.data,this.zt,e,this.fieldTransforms)},Qp);function Qp(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}function $p(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}function Zp(t,e){if(!isFinite(t)||t<-90||90<t)throw new Rr(Cr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Rr(Cr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}function td(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Tr()}}var ed=(Object.defineProperty(id.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(id.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),id.prototype.M_=function(t){return new id(Object.assign(Object.assign({},this.settings),t),this.T,this.Kt,this.ignoreUndefinedProperties,this.fieldTransforms,this.zt)},id.prototype.L_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.M_({path:e,B_:!1})).q_(t),e},id.prototype.U_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.M_({path:t,B_:!1})).O_(),t},id.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},id.prototype.K_=function(t){return Pd(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},id.prototype.contains=function(e){return void 0!==this.zt.find(function(t){return e.st(t)})||void 0!==this.fieldTransforms.find(function(t){return e.st(t.field)})},id.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},id.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(td(this.k_)&&Wp.test(t))throw this.K_('Document fields cannot begin and end with "__"')},id),nd=(rd.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new ed({k_:t,methodName:e,j_:n,path:pi.at(),B_:!1,W_:r},this.T,this.Kt,this.ignoreUndefinedProperties)},rd);function rd(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.Kt=n||jf(t)}function id(t,e,n,r,i,o){this.settings=t,this.T=e,this.Kt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.zt=o||[]}function od(t){var e=t.p_(),n=jf(t.I_);return new nd(t.I_,!!e.ignoreUndefinedProperties,n)}function sd(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);Dd("Data must be an object, but it was:",s,r);var u,a,r=Ad(r,s);if(o.merge)u=new Ti(s.zt),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=kd(e,f[h],n);if(!s.contains(l))throw new Rr(Cr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");Cd(c,l)||c.push(l)}u=new Ti(c),a=s.fieldTransforms.filter(function(t){return u.It(t.field)})}else u=null,a=s.fieldTransforms;return new Xp(new Ji(r),u,a)}var ud,ad=(h(cd,ud=wp),cd.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.zt.push(t.path),null},cd.prototype.isEqual=function(t){return t instanceof cd},cd);function cd(){return null!==ud&&ud.apply(this,arguments)||this}function hd(t,e,n){return new ed({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.T,e.Kt,e.ignoreUndefinedProperties)}var fd,ld,pd,dd,yd=(h(_d,dd=wp),_d.prototype.z_=function(t){return new As(t.path,new ls)},_d.prototype.isEqual=function(t){return t instanceof _d},_d),vd=(h(Id,pd=wp),Id.prototype.z_=function(t){var e=hd(this,t,!0),n=this.H_.map(function(t){return Sd(t,e)}),n=new ps(n);return new As(t.path,n)},Id.prototype.isEqual=function(t){return this===t},Id),gd=(h(bd,ld=wp),bd.prototype.z_=function(t){var e=hd(this,t,!0),n=this.H_.map(function(t){return Sd(t,e)}),n=new ms(n);return new As(t.path,n)},bd.prototype.isEqual=function(t){return this===t},bd),md=(h(wd,fd=wp),wd.prototype.z_=function(t){var e=new _s(t.Kt,as(t.Kt,this.J_));return new As(t.path,e)},wd.prototype.isEqual=function(t){return this===t},wd);function wd(t,e){var n=this;return(n=fd.call(this,t)||this).J_=e,n}function bd(t,e){var n=this;return(n=ld.call(this,t)||this).H_=e,n}function Id(t,e){var n=this;return(n=pd.call(this,t)||this).H_=e,n}function _d(){return null!==dd&&dd.apply(this,arguments)||this}function Ed(t,r,i,e){var o=t.G_(1,r,i);Dd("Data must be an object, but it was:",o,e);var s=[],u=new Wi;return _i(e,function(t,e){var n=Ld(r,t,i);e instanceof Mr&&(e=e._),t=o.U_(n),e instanceof ad?s.push(n):null!=(t=Sd(e,t))&&(s.push(n),u.set(n,t))}),e=new Ti(s),new Yp(u.yt(),e,o.fieldTransforms)}function Td(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[kd(e,r,n)],a=[i];if(o.length%2!=0)throw new Rr(Cr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(kd(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new Wi,y=u.length-1;0<=y;--y)Cd(p,u[y])||(h=u[y],(f=a[y])instanceof Mr&&(f=f._),l=s.U_(h),f instanceof ad?p.push(h):null!=(l=Sd(f,l))&&(p.push(h),d.set(h,l)));return i=new Ti(p),new Yp(d.yt(),i,s.fieldTransforms)}function Nd(t,e,n,r){return void 0===r&&(r=!1),Sd(n,t.G_(r?4:3,e))}function Sd(s,t){if(s instanceof Mr&&(s=s._),xd(s))return Dd("Unsupported field value:",t,s),Ad(s,t);if(s instanceof wp)return function(t,e){if(!td(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");(t=t.z_(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.zt.push(t.path),s instanceof Array){if(t.settings.B_&&4!==t.k_)throw t.K_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Sd(i[r],t.Q_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Mr&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return as(e.Kt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ci.fromDate(t);return{timestampValue:Fu(e.Kt,n)}}if(t instanceof ci)return n=new ci(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Fu(e.Kt,n)};if(t instanceof Jp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Vr)return{bytesValue:ju(e.Kt,t.l)};if(t instanceof Rp){n=e.T;var r=t.firestore.I_;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Hu(t.firestore.I_||e.T,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+xp(t))}(s,t)}function Ad(t,n){var r={};return Ei(t)?n.path&&0<n.path.length&&n.zt.push(n.path):_i(t,function(t,e){null!=(e=Sd(e,n.L_(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function xd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ci||t instanceof Jp||t instanceof Vr||t instanceof Rp||t instanceof wp)}function Dd(t,e,n){if(!xd(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=xp(n))?e.K_(t+" a custom object"):e.K_(t+" "+n);var r}function kd(t,e,n){if(e instanceof Mr&&(e=e._),e instanceof mp)return e.d_;if("string"==typeof e)return Ld(t,e);throw Pd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Od=new RegExp("[~\\*/\\[\\]]");function Ld(e,n,r){if(0<=n.search(Od))throw Pd("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(mp.bind.apply(mp,f([void 0],n.split("."))))).d_}catch(t){throw Pd("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Pd(t,e,n,r,i){var o=r&&!r.nt(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Rr(Cr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Cd(t,e){return t.some(function(t){return t.isEqual(e)})}var Rd=(jd.prototype.ef=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),0<this.mutations.length)throw new Rr(Cr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var r,e,n,i,o;return v(this,function(t){switch(t.label){case 0:return e=Wu((r=s).Kt)+"/documents",n={documents:u.map(function(t){return Gu(r.Kt,t)})},[4,r.Cu("BatchGetDocuments",e,n)];case 1:return n=t.sent(),i=new Map,n.forEach(function(t){var e,n,t=(n=r.Kt,"found"in t?function(t,e){Nr(!!e.found),e.found.name,e.found.updateTime;var n=zu(t,e.found.name),t=qu(e.found.updateTime),e=new Ji({mapValue:{fields:e.found.fields}});return new to(n,t,e,{})}(n,t):"missing"in t?(e=n,Nr(!!(n=t).missing),Nr(!!n.readTime),e=zu(e,n.missing),n=qu(n.readTime),new eo(e,n)):Tr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){Nr(!!(t=i.get(t.toString()))),o.push(t)}),o)]}})})}(this.Dh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof eo||t instanceof to?n.sf(t):Tr()}),e)]}})})},jd.prototype.set=function(t,e){this.write(e.F_(t,this.Gt(t))),this.tf.add(t.toString())},jd.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},jd.prototype.delete=function(t){this.write(new Ws(t,this.Gt(t))),this.tf.add(t.toString())},jd.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return e=this.Y_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=di.ft(e),n.mutations.push(new Xs(e,n.Gt(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Wu((e=i).Kt)+"/documents",r={writes:o.map(function(t){return $u(e.Kt,t)})},[4,e.bu("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Dh,this.mutations)];case 1:return t.sent(),this.X_=!0,[2]}})})},jd.prototype.sf=function(t){var e;if(t instanceof to)e=t.version;else{if(!(t instanceof eo))throw Tr();e=hi.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Rr(Cr.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},jd.prototype.Gt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?xs.updateTime(e):xs.Wt()},jd.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(this.tf.has(t.toString())||!e)return xs.exists(!0);if(e.isEqual(hi.min()))throw new Rr(Cr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return xs.updateTime(e)},jd.prototype.write=function(t){this.nf(),this.mutations.push(t)},jd.prototype.nf=function(){},jd),Vd=(Fd.prototype.run=function(){this.af()},Fd.prototype.af=function(){var t=this;this.zu.Bu(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Rd(this.Dh),(n=this.uf(e))&&n.then(function(t){r.fs.ys(function(){return e.commit().then(function(){r.Ts.resolve(t)}).catch(function(t){r.hf(t)})})}).catch(function(t){r.hf(t)}),[2]})})})},Fd.prototype.uf=function(t){try{var e=this.updateFunction(t);return!Li(e)&&e.catch&&e.then?e:(this.Ts.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ts.reject(t),null}},Fd.prototype.hf=function(t){var e=this;0<this.cf&&this.lf(t)?(--this.cf,this.fs.ys(function(){return e.af(),Promise.resolve()})):this.Ts.reject(t)},Fd.prototype.lf=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!$s(t))},Fd),Md=(Ud.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{fs:this.fs,gu:this.gu,clientId:this.clientId,credentials:this.credentials,Yl:this.user,bl:100})]}})})},Ud.prototype.ff=function(t){var e=this;this._f=t,this.N.promise.then(function(){return e._f(e.user)})},Ud.prototype.df=function(){if(this.fs.wf)throw new Rr(Cr.FAILED_PRECONDITION,"The client has already been terminated.")},Ud.prototype.terminate=function(){var t=this;this.fs.Ef();var n=new ca;return this.fs.Tf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.D(),n.resolve(),[3,6];case 5:return e=xa(t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Ud);function Ud(t,e,n){var r=this;this.credentials=t,this.fs=e,this.gu=n,this.user=Kr.UNAUTHENTICATED,this.clientId=Sr.t(),this._f=function(){},this.N=new ca,this.credentials.S(function(t){br("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.N.resolve()})}function Fd(t,e,n,r){this.fs=t,this.Dh=e,this.updateFunction=n,this.Ts=r,this.cf=5,this.zu=new zf(this.fs,"transaction_retry")}function jd(t){this.Dh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}function qd(i,o){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return i.fs.Af(),br("FirestoreClient","Initializing OfflineComponentProvider"),[4,i.getConfiguration()];case 1:return e=t.sent(),[4,o.initialize(e)];case 2:return t.sent(),n=e.Yl,i.ff(function(e){n.isEqual(e)||(n=e,i.fs.bo(function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Ph(o.Sh,e)];case 1:return t.sent(),[2]}})})}))}),o.persistence.yo(function(){return i.terminate()}),i.mf=o,[2]}})})}function Hd(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.fs.Af(),[4,Bd(r)];case 1:return e=t.sent(),br("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.ff(function(t){return r.fs.bo(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).fs.Af(),br("RemoteStore","RemoteStore received new credentials"),n=hl(e),e.Fh.add(3),[4,rl(e)];case 1:return t.sent(),n&&e.Mh.set("Unknown"),[4,e.Ch.s_(i)];case 2:return t.sent(),e.Fh.delete(3),[4,nl(e)];case 3:return t.sent(),[2]}})})}(i.gl,t)})}),r.If=i,[2]}})})}function Bd(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.mf?[3,2]:(br("FirestoreClient","Using default OfflineComponentProvider"),[4,qd(e,new up)]);case 1:t.sent(),t.label=2;case 2:return[2,e.mf]}})})}function Gd(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.If?[3,2]:(br("FirestoreClient","Using default OnlineComponentProvider"),[4,Hd(e,new hp)]);case 1:t.sent(),t.label=2;case 2:return[2,e.If]}})})}function zd(t){return Bd(t).then(function(t){return t.persistence})}function Kd(t){return Bd(t).then(function(t){return t.Sh})}function Jd(t){return Gd(t).then(function(t){return t.gl})}function Wd(t){return Gd(t).then(function(t){return t.fa})}function Xd(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Gd(r)];case 1:return e=t.sent(),[2,((n=e.Vl).Gh=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=np(s),(o=e.Sl.get(u))?(n=o.targetId,e.pl.ka(n),r=o.view.Pl(),[3,4]):[3,1];case 1:return[4,Vh(e.Sh,Qo(u))];case 2:return i=t.sent(),o=e.pl.ka(i.targetId),n=i.targetId,[4,Hl(e,u,n,"current"===o)];case 3:r=t.sent(),e.Ll&&il(e.gl,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e.fa),n.Jh=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Sl.get(o),1<(r=e.Dl.get(n.targetId)).length?[2,(e.Dl.set(n.targetId,r.filter(function(t){return!Zo(t,o)})),void e.Sl.delete(o))]:e.Ll?(e.pl.$a(n.targetId),e.pl.Ca(n.targetId)?[3,2]:[4,Mh(e.Sh,n.targetId,!1).then(function(){e.pl.Ba(n.targetId),ol(e.gl,n.targetId),Xl(e,n.targetId)}).catch(Oc)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Xl(e,n.targetId),[4,Mh(e.Sh,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.fa),n)]}})})}function Yd(n,r,i){var t=this;void 0===i&&(i={});var o=new ca;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new vp({next:function(t){r.ys(function(){return El(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Rr(Cr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Rr(Cr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Nl(Go(i.path),t,{includeMetadataChanges:!0,sl:!0});return _l(n,u)},[4,Xd(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.fs,r,i,o])]}})})}),o.promise}function Qd(n,r,i){var t=this;void 0===i&&(i={});var o=new ca;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new vp({next:function(t){n.ys(function(){return El(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Rr(Cr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Nl(t,o,{includeMetadataChanges:!0,sl:!0});return _l(e,s)},[4,Xd(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.fs,r,i,o])]}})})}),o.promise}var $d,Zd=(Object.defineProperty(ny.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),ny.prototype.ys=function(t){this.enqueue(t)},ny.prototype.Tf=function(t){this.Sf(),this.Df(t)},ny.prototype.Ef=function(){var t;this.yf||(this.yf=!0,(t=Ff())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf))},ny.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},ny.prototype.bo=function(t){var e=this;this.ys(function(){return e.Pf.push(t),e.Cf()})},ny.prototype.Cf=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Pf.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return t.sent(),this.Pf.shift(),this.zu.reset(),[3,4];case 3:if(!ba(e=t.sent()))throw e;return br("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Pf.length&&this.zu.Bu(function(){return n.Cf()}),t.label=5;case 5:return[2]}})})},ny.prototype.Df=function(t){var r=this,e=this.Rf.then(function(){return r.pf=!0,t().catch(function(t){throw r.Vf=t,r.pf=!1,Ir("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.pf=!1,t})});return this.Rf=e},ny.prototype.Ir=function(t,e,n){var r=this;return this.Sf(),-1<this.bf.indexOf(t)&&(e=0),n=Sa.Is(this,t,e,n,function(t){return r.xf(t)}),this.gf.push(n),n},ny.prototype.Sf=function(){this.Vf&&Tr()},ny.prototype.Af=function(){},ny.prototype.Nf=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Rf];case 1:t.sent(),t.label=2;case 2:if(e!==this.Rf)return[3,0];t.label=3;case 3:return[2]}})})},ny.prototype.Ff=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].ds===t)return!0;return!1},ny.prototype.Of=function(r){var i=this;return this.Nf().then(function(){i.gf.sort(function(t,e){return t.ws-e.ws});for(var t=0,e=i.gf;t<e.length;t++){var n=e[t];if(n.Ps(),"all"!==r&&n.ds===r)break}return i.Nf()})},ny.prototype.kf=function(t){this.bf.push(t)},ny.prototype.xf=function(t){t=this.gf.indexOf(t),this.gf.splice(t,1)},ny),ty=(h(ey,$d=Cp),ey.prototype.b_=function(){return this.$f||iy(this),this.$f.terminate()},ey);function ey(t,e){var n=this;return(n=$d.call(this,t,e)||this).Mf=new Zd,n.w_="name"in t?t.name:"[DEFAULT]",n}function ny(){var e=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.zu=new zf(this,"async_queue_retry"),this.vf=function(){var t=Ff();t&&br("AsyncQueue","Visibility state changed to "+t.visibilityState),e.zu.Uu()};var t=Ff();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.vf)}function ry(t){return t.$f||iy(t),t.$f.df(),t.$f}function iy(t){var e,n,r=t.p_(),r=(e=t.I_,n=t.w_,new Gr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.$f=new Md(t.m_,t.Mf,r)}function oy(n,r,i){var t=this,o=new ca;return n.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,qd(n,i)];case 1:return t.sent(),[4,Hd(n,r)];case 2:return t.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(t=e=t.sent()).name?t.code===Cr.FAILED_PRECONDITION||t.code===Cr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),o.reject(e),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function sy(t){if(t.R_||t.P_)throw new Rr(Cr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var uy,o=(ly.prototype.Lf=function(t,e){switch(void 0===e&&(e="none"),Ri(t)){case 0:return null;case 1:return t.booleanValue;case 2:return xi(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(Di(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.Wf(t.arrayValue,e);case 10:return this.jf(t.mapValue,e);default:throw Tr()}},ly.prototype.jf=function(t,n){var r=this,i={};return _i(t.fields||{},function(t,e){i[t]=r.Lf(e,n)}),i},ly.prototype.Kf=function(t){return new Jp(xi(t.latitude),xi(t.longitude))},ly.prototype.Wf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Lf(t,e)})},ly.prototype.qf=function(t,e){switch(e){case"previous":var n=function t(e){return ki(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==n?null:this.Lf(n,e);case"estimate":return this.Bf(Oi(t));default:return null}},ly.prototype.Bf=function(t){return t=Ai(t),new ci(t.seconds,t.nanos)},ly.prototype.Gf=function(t,e){var n=fi.ct(t);return Nr(ua(n)),t=new zr(n.get(1),n.get(3)),n=new di(n.X(5)),t.isEqual(e)||Ir("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},ly),ay=(Object.defineProperty(fy.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(fy.prototype,"ref",{get:function(){return new Rp(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),fy.prototype.exists=function(){return null!==this.Jf},fy.prototype.data=function(){if(this.Jf){if(this.v_){var t=new cy(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.Lf(this.Jf.vt())}},fy.prototype.get=function(t){if(this.Jf&&null!==(t=this.Jf.data().field(py("DocumentSnapshot.get",t))))return this.Hf.Lf(t)},fy),cy=(h(hy,uy=ay),hy.prototype.data=function(){return uy.prototype.data.call(this)},hy);function hy(){return null!==uy&&uy.apply(this,arguments)||this}function fy(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}function ly(){}function py(t,e){return"string"==typeof e?Ld(t,e):(e instanceof Mr?e._:e).d_}function dy(t){if(Ko(t)&&0===t.Nt.length)throw new Rr(Cr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}function yy(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r].Yf(t);return t}var vy,gy,my,wy,by,Iy=(h(ky,by=me=function(){}),ky.prototype.Yf=function(t){var e=od(t.firestore),e=function(t,e,n,r,i,o){if(r.ht()){if("array-contains"===i||"array-contains-any"===i)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Py(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(Ly(n,t,c))}h={arrayValue:{values:s}}}else h=Ly(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Py(o,i),h=Nd(e,"where",o,"in"===i||"not-in"===i);var h=lo.create(r,i,h);return function(t,e){if(e.xt()){var n=Wo(t);if(null!==n&&!n.isEqual(e.field))throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=Jo(t))&&Cy(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Rr(Cr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Rr(Cr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.C_,e,t.firestore.I_,this.Xf,this.Zf,this.td);return new Vp(t.firestore,t.v_,(e=(t=t.C_).filters.concat([e]),new Ho(t.path,t.collectionGroup,t.Nt.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},ky),_y=(h(Dy,wy=me),Dy.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Fo(e,n);return e=r,null!==Jo(n=t)||null!==(t=Wo(n))&&Cy(0,t,e.field),r}(t.C_,this.Xf,this.ed);return new Vp(t.firestore,t.v_,(e=(t=t.C_).Nt.concat([e]),new Ho(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},Dy),Ey=(h(xy,my=me),xy.prototype.Yf=function(t){return new Vp(t.firestore,t.v_,$o(t.C_,this.nd,this.sd))},xy),Ty=(h(Ay,gy=me),Ay.prototype.Yf=function(t){var e=Oy(t,this.type,this.rd,this.od);return new Vp(t.firestore,t.v_,(t=t.C_,new Ho(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},Ay),Ny=(h(Sy,vy=me),Sy.prototype.Yf=function(t){var e=Oy(t,this.type,this.rd,this.od);return new Vp(t.firestore,t.v_,(t=t.C_,new Ho(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},Sy);function Sy(t,e,n){var r=this;return(r=vy.call(this)||this).type=t,r.rd=e,r.od=n,r}function Ay(t,e,n){var r=this;return(r=gy.call(this)||this).type=t,r.rd=e,r.od=n,r}function xy(t,e,n){var r=this;return(r=my.call(this)||this).type=t,r.nd=e,r.sd=n,r}function Dy(t,e){var n=this;return(n=wy.call(this)||this).Xf=t,n.ed=e,n.type="orderBy",n}function ky(t,e,n){var r=this;return(r=by.call(this)||this).Xf=t,r.Zf=e,r.td=n,r.type="where",r}function Oy(t,c,e,n){if(e[0]instanceof Mr&&(e[0]=e[0]._),e[0]instanceof ay)return function(t,e,n,r){if(!n)throw new Rr(Cr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Yo(t);o<s.length;o++){var u=s[o];if(u.field.ht())i.push(qi(e,n.key));else{var a=n.field(u.field);if(ki(a))throw new Rr(Cr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.ot(),new Rr(Cr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new Po(i,r)}(t.C_,t.firestore.I_,e[0].Jf,n);var r=od(t.firestore);return function(t,e,n,r,i,o){var s=t.Nt;if(i.length>s.length)throw new Rr(Cr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ht()){if("string"!=typeof c)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Xo(t)&&-1!==c.indexOf("/"))throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(fi.ct(c));if(!di.Et(h))throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new di(h),u.push(qi(e,h))}else c=Nd(n,r,c),u.push(c)}return new Po(u,o)}(t.C_,t.firestore.I_,r,c,e,n)}function Ly(t,e,n){if(n instanceof Mr&&(n=n._),"string"==typeof n){if(""===n)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Xo(e)&&-1!==n.indexOf("/"))throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(fi.ct(n)),!di.Et(e))throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return qi(t,new di(e))}if(n instanceof Rp)return qi(t,n.S_);throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+xp(n)+".")}function Py(t,e){if(!Array.isArray(t)||0===t.length)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Cy(t,e,n){if(!n.isEqual(e))throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Ry(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}function Vy(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var My,Uy,Fy,jy=(h(Xy,Fy=o),Xy.prototype.Uf=function(t){return new Vr(t)},Xy.prototype.Qf=function(t){return t=this.Gf(t,this.firestore.I_),new Rp(this.firestore,null,t)},Xy),qy=(Wy.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Wy),Hy=(h(Jy,Uy=ay),Jy.prototype.exists=function(){return Uy.prototype.exists.call(this)},Jy.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new By(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.Lf(this.Jf.vt(),t.serverTimestamps)}},Jy.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf&&null!==(t=this.Jf.data().field(py("DocumentSnapshot.get",t))))return this.Hf.Lf(t,e.serverTimestamps)},Jy),By=(h(Ky,My=Hy),Ky.prototype.data=function(t){return void 0===t&&(t={}),My.prototype.data.call(this,t)},Ky),Gy=(Object.defineProperty(zy.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(zy.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(zy.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),zy.prototype.forEach=function(e,n){var r=this;this.ud.docs.forEach(function(t){e.call(n,new By(r.zf,r.Hf,t.key,t,new qy(r.ud.Ce.has(t.key),r.ud.fromCache),r.query.v_))})},zy.prototype.docChanges=function(t){if(void 0===t&&(t={}),(t=!!t.includeMetadataChanges)&&this.ud.Ne)throw new Rr(Cr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===t||(this.hd=function(i,e){if(i.ud.De.nt()){var n=0;return i.ud.docChanges.map(function(t){var e=new By(i.zf,i.Hf,t.doc.key,t.doc,new qy(i.ud.Ce.has(t.doc.key),i.ud.fromCache),i.query.v_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.ud.De;return i.ud.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new By(i.zf,i.Hf,t.doc.key,t.doc,new qy(i.ud.Ce.has(t.doc.key),i.ud.fromCache),i.query.v_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Tr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.ld=t),this.hd},zy);function zy(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new qy(r.hasPendingWrites,r.fromCache),this.query=n}function Ky(){return null!==My&&My.apply(this,arguments)||this}function Jy(t,e,n,r,i,o){var s=this;return(s=Uy.call(this,t,e,n,r,o)||this).zf=t,s.ad=t,s.metadata=i,s}function Wy(t,e){this.hasPendingWrites=t,this.fromCache=e}function Xy(t){var e=this;return(e=Fy.call(this)||this).firestore=t,e}function Yy(t,e){return t instanceof Hy&&e instanceof Hy?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof Gy&&e instanceof Gy&&t.zf===e.zf&&Kp(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var Qy,$y=(h(Zy,Qy=o),Zy.prototype.Uf=function(t){return new Vr(t)},Zy.prototype.Qf=function(t){return t=this.Gf(t,this.firestore.I_),new Rp(this.firestore,null,t)},Zy);function Zy(t){var e=this;return(e=Qy.call(this)||this).firestore=t,e}function tv(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Dp(t,Rp);var o=Dp(t.firestore,ty),s=od(o);return e instanceof Mr&&(e=e._),nv(o,[("string"==typeof e||e instanceof mp?Td(s,"updateDoc",t.S_,e,n,r):Ed(s,"updateDoc",t.S_,e)).F_(t.S_,xs.exists(!0))])}function ev(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof Mr&&(e=e._);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Ry(n[i])||(r=n[i],i++);var o,s,u,a,c,h,f={includeMetadataChanges:r.includeMetadataChanges};return Ry(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof Rp?(u=Dp(e.firestore,ty),a=Go(e.S_.path),h={next:function(t){n[i]&&n[i](rv(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=Dp(e,Vp),u=Dp(s.firestore,ty),a=s.C_,c=new $y(u),h={next:function(t){n[i]&&n[i](new Gy(u,c,s,t))},error:n[i+1],complete:n[i+2]},dy(e.C_)),function(n,t,e){var r=this,i=new vp(h),o=new Nl(t,i,e);return n.fs.ys(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=_l,[4,Xd(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.r_(),n.fs.ys(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=El,[4,Xd(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(ry(u),a,f)}function nv(t,e){return function(n,r){var t=this,i=new ca;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Bl,[4,Wd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(ry(t),e)}function rv(t,e,n){var r=n.docs.get(e.S_),i=new $y(t);return new Hy(t,i,e.S_,r,new qy(n.hasPendingWrites,n.fromCache),e.v_)}var iv=(ov.prototype.set=function(t,e,n){return this.Ed(),e=Vy((t=sv(t,this.zf)).v_,e,n),n=sd(this.wd,"WriteBatch.set",t.S_,e,null!==t.v_,n),this.fd.push(n.F_(t.S_,xs.Wt())),this},ov.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this.Ed(),t=sv(t,this.zf),e instanceof Mr&&(e=e._),e="string"==typeof e||e instanceof mp?Td(this.wd,"WriteBatch.update",t.S_,e,n,r):Ed(this.wd,"WriteBatch.update",t.S_,e),this.fd.push(e.F_(t.S_,xs.exists(!0))),this},ov.prototype.delete=function(t){return this.Ed(),t=sv(t,this.zf),this.fd=this.fd.concat(new Ws(t.S_,xs.Wt())),this},ov.prototype.commit=function(){return this.Ed(),this.dd=!0,0<this.fd.length?this._d(this.fd):Promise.resolve()},ov.prototype.Ed=function(){if(this.dd)throw new Rr(Cr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},ov);function ov(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=od(t)}function sv(t,e){if(t instanceof Mr&&(t=t._),t.firestore!==e)throw new Rr(Cr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var uv,av,cv,hv=(mv.prototype.get=function(t){var e=this,n=sv(t,this.zf),r=new jy(this.zf);return this.Td.ef([n.S_]).then(function(t){if(!t||1!==t.length)return Tr();if((t=t[0])instanceof eo)return new ay(e.zf,r,n.S_,null,n.v_);if(t instanceof to)return new ay(e.zf,r,t.key,t,n.v_);throw Tr()})},mv.prototype.set=function(t,e,n){return e=Vy((t=sv(t,this.zf)).v_,e,n),n=sd(this.wd,"Transaction.set",t.S_,e,null!==t.v_,n),this.Td.set(t.S_,n),this},mv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t=sv(t,this.zf),e instanceof Mr&&(e=e._),e="string"==typeof e||e instanceof mp?Td(this.wd,"Transaction.update",t.S_,e,n,r):Ed(this.wd,"Transaction.update",t.S_,e),this.Td.update(t.S_,e),this},mv.prototype.delete=function(t){return t=sv(t,this.zf),this.Td.delete(t.S_),this},h(gv,cv=mv),gv.prototype.get=function(t){var e=this,n=sv(t,this.zf),r=new $y(this.zf);return cv.prototype.get.call(this,t).then(function(t){return new Hy(e.zf,r,n.S_,t.Jf,new qy(!1,!1),n.v_)})},gv),fv=(vv.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){sy(t=Dp(t,ty));var n=ry(t),r=t.p_();return oy(n,t=new hp,new ap(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},vv.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){sy(t=Dp(t,ty));var e=ry(t),n=t.p_();return oy(e,t=new hp,new cp(t,n.cacheSizeBytes))}(t._)},vv.prototype.clearIndexedDbPersistence=function(t){return function(n){var t=this;if(n.R_&&!n.P_)throw new Rr(Cr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new ca;return n.Mf.Tf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return la.Wn()?(e=n+"main",[4,la.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(_h(n.I_,n.w_))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}(t._)},vv),lv=(h(yv,av=Mr),Object.defineProperty(yv.prototype,"I_",{get:function(){return this._.I_},enumerable:!1,configurable:!0}),yv.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.V_()),t)).merge,this._.g_(t)},yv.prototype.useEmulator=function(t,e){var n=this._,r=t;t=e,"firestore.googleapis.com"!==(e=(n=Dp(n,Cp)).V_()).host&&e.host!==r&&_r("Host has been set in both settings() and useEmulator(), emulator host will be used"),n.g_(Object.assign(Object.assign({},e),{host:r+":"+t,ssl:!1}))},yv.prototype.enableNetwork=function(){return function(r){var t=this;return r.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,zd(r)];case 1:return e=t.sent(),[4,Jd(r)];case 2:return n=t.sent(),[2,(e.Vo(!0),(t=n).Fh.delete(0),nl(t))]}})})})}(ry(Dp(this._,ty)))},yv.prototype.disableNetwork=function(){return function(r){var t=this;return r.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,zd(r)];case 1:return e=t.sent(),[4,Jd(r)];case 2:return n=t.sent(),[2,(e.Vo(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Fh.add(0),[4,rl(e)];case 1:return t.sent(),e.Mh.set("Offline"),[2]}})})}(n))]}})})})}(ry(Dp(this._,ty)))},yv.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Np("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},yv.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},yv.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},yv.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new ca;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Kl,[4,Wd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(ry(Dp(this._,ty)))},yv.prototype.onSnapshotsInSync=function(t){return function(n,t){var e=this,r=new vp(t);return n.fs.ys(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.jh.add(e),e.next()},[4,Xd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.r_(),n.fs.ys(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.jh.delete(e)},[4,Xd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(ry(Dp(this._,ty)),Ry(t)?t:{next:t})},Object.defineProperty(yv.prototype,"app",{get:function(){if(!this.md)throw new Rr(Cr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),yv.prototype.collection=function(t){try{return new zv(this,Bp(this._,t))}catch(t){throw Ov(t,"collection()","Firestore.collection()")}},yv.prototype.doc=function(t){try{return new Dv(this,Gp(this._,t))}catch(t){throw Ov(t,"doc()","Firestore.doc()")}},yv.prototype.collectionGroup=function(t){try{return new Hv(this,function(t,e){if(t=Dp(t,Cp),Ep("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Rr(Cr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Vp(t,null,new Ho(fi.at(),e))}(this._,t))}catch(t){throw Ov(t,"collectionGroup()","Firestore.collectionGroup()")}},yv.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new ca;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Gd(n).then(function(t){return t.Dh})];case 1:return e=t.sent(),new Vd(n.fs,e,r,i).run(),[2]}})})}),i.promise}(ry(n=this._),function(t){return t=new hv(n,t),e(new _v(r,t))})},yv.prototype.batch=function(){var e=this;return ry(this._),new Ev(new iv(this._,function(t){return nv(e._,t)}))},yv.prototype.loadBundle=function(t){throw new Rr(Cr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},yv.prototype.namedQuery=function(t){throw new Rr(Cr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},yv),pv=(h(dv,uv=o),dv.prototype.Uf=function(t){return new Br(new Vr(t))},dv.prototype.Qf=function(t){return t=this.Gf(t,this.firestore.I_),Dv.Ad(t,this.firestore,null)},dv);function dv(t){var e=this;return(e=uv.call(this)||this).firestore=t,e}function yv(t,e,n){var r=this;return(r=av.call(this,e)||this).Id=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof zr||(r.md=t),r}function vv(){}function gv(t,e){var n=this;return(n=cv.call(this,t,e)||this).zf=t,n}function mv(t,e){this.zf=t,this.Td=e,this.wd=od(t)}var wv,bv,Iv,_v=(h(Av,Iv=Mr),Av.prototype.get=function(t){var e=this,n=$v(t);return this._.get(n).then(function(t){return new jv(e.zf,new Hy(e.zf._,e.Hf,t.S_,t.Jf,t.metadata,n.v_))})},Av.prototype.set=function(t,e,n){return t=$v(t),n?(Tp("Transaction.set",n),this._.set(t,e,n)):this._.set(t,e),this},Av.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=$v(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,f([o,e,n],r)),this},Av.prototype.delete=function(t){return t=$v(t),this._.delete(t),this},Av),Ev=(h(Sv,bv=Mr),Sv.prototype.set=function(t,e,n){return t=$v(t),n?(Tp("WriteBatch.set",n),this._.set(t,e,n)):this._.set(t,e),this},Sv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=$v(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,f([o,e,n],r)),this},Sv.prototype.delete=function(t){return t=$v(t),this._.delete(t),this},Sv.prototype.commit=function(){return this._.commit()},Sv),Tv=(h(Nv,wv=Mr),Nv.prototype.fromFirestore=function(t,e){return t=new By(this.zf._,this.Hf,t.S_,t.Jf,t.metadata,null),this._.fromFirestore(new qv(this.zf,t),null!=e?e:{})},Nv.prototype.toFirestore=function(t,e){return e?this._.toFirestore(t,e):this._.toFirestore(t)},Nv.Rd=function(t,e){var n=Nv.Pd,r=n.get(t);return r||(r=new WeakMap,n.set(t,r)),(n=r.get(e))||(n=new Nv(t,new pv(t),e),r.set(e,n)),n},Nv);function Nv(t,e,n){var r=this;return(r=wv.call(this,n)||this).zf=t,r.Hf=e,r}function Sv(){return null!==bv&&bv.apply(this,arguments)||this}function Av(t,e){var n=this;return(n=Iv.call(this,e)||this).zf=t,n.Hf=new pv(t),n}Tv.Pd=new WeakMap;var xv,Dv=(h(kv,xv=Mr),kv.yd=function(t,e,n){if(t.length%2!=0)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.ot()+" has "+t.length);return new kv(e,new Rp(e._,n,new di(t)))},kv.Ad=function(t,e,n){return new kv(e,new Rp(e._,n,t))},Object.defineProperty(kv.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(kv.prototype,"parent",{get:function(){return new zv(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(kv.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),kv.prototype.collection=function(t){try{return new zv(this.firestore,Bp(this._,t))}catch(t){throw Ov(t,"collection()","DocumentReference.collection()")}},kv.prototype.isEqual=function(t){return t instanceof Mr&&(t=t._),t instanceof Rp&&zp(this._,t)},kv.prototype.set=function(t,e){e=Tp("DocumentReference.set",e);try{return function(t,e,n){t=Dp(t,Rp);var r=Dp(t.firestore,ty),e=Vy(t.v_,e,n);return nv(r,[sd(od(r),"setDoc",t.S_,e,null!==t.v_,n).F_(t.S_,xs.Wt())])}(this._,t,e)}catch(t){throw Ov(t,"setDoc()","DocumentReference.set()")}},kv.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?tv(this._,t):tv.apply(void 0,f([this._,t,e],n))}catch(t){throw Ov(t,"updateDoc()","DocumentReference.update()")}},kv.prototype.delete=function(){return nv(Dp((t=this._).firestore,ty),[new Ws(t.S_,xs.Wt())]);var t},kv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Lv(t),i=Pv(t,function(t){return new jv(e.firestore,new Hy(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))});return ev(this._,r,i)},kv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Dp(e,Rp);var n=Dp(e.firestore,ty),t=ry(n),r=new $y(n);return function(n,r){var t=this,i=new ca;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(o,s,u){return y(this,void 0,void 0,function(){var r,i;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=s,(n=o).persistence.runTransaction("read document","readonly",function(t){return n.Ic.Jo(t,e)}))];case 1:return(i=t.sent())instanceof to?u.resolve(i):i instanceof eo?u.resolve(null):u.reject(new Rr(Cr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),i=xa(r,"Failed to get document '"+s+" from cache"),u.reject(i),[3,3];case 3:return[2]}var e,n})})},[4,Kd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.S_).then(function(t){return new Hy(n,r,e.S_,t,new qy(t instanceof to&&t.bt,!0),e.v_)})}:"server"===(null==t?void 0:t.source)?function(e){e=Dp(e,Rp);var n=Dp(e.firestore,ty);return Yd(ry(n),e.S_,{source:"server"}).then(function(t){return rv(n,e,t)})}:function(e){e=Dp(e,Rp);var n=Dp(e.firestore,ty);return Yd(ry(n),e.S_).then(function(t){return rv(n,e,t)})})(this._).then(function(t){return new jv(e.firestore,new Hy(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))})},kv.prototype.withConverter=function(t){return new kv(this.firestore,this._.withConverter(Tv.Rd(this.firestore,t)))},kv);function kv(t,e){var n=this;return(n=xv.call(this,e)||this).firestore=t,n.Hf=new pv(t),n}function Ov(t,e,n){return t.message=t.message.replace(e,n),t}function Lv(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Ry(r))return r}return{}}function Pv(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=Ry(t[0])?t[0]:Ry(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Cv,Rv,Vv,Mv,Uv,Fv,jv=(h(Qv,Fv=Mr),Object.defineProperty(Qv.prototype,"ref",{get:function(){return new Dv(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Qv.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Qv.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Qv.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),Qv.prototype.data=function(t){return this._.data(t)},Qv.prototype.get=function(t,e){return this._.get(t,e)},Qv.prototype.isEqual=function(t){return Yy(this._,t._)},Qv),qv=(h(Yv,Uv=jv),Yv.prototype.data=function(t){return this._.data(t)},Yv),Hv=(h(Xv,Mv=Mr),Xv.prototype.where=function(t,e,n){try{return new Xv(this.firestore,yy(this._,(r=n,i=e,o=py("where",t),new Iy(o,i,r))))}catch(t){throw Ov(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},Xv.prototype.orderBy=function(n,t){try{return new Xv(this.firestore,yy(this._,function(t){void 0===t&&(t="asc");var e=t,t=py("orderBy",n);return new _y(t,e)}(t)))}catch(n){throw Ov(n,/(orderBy|where)\(\)/,"Query.$1()")}},Xv.prototype.limit=function(t){try{return new Xv(this.firestore,yy(this._,(kp("limit",e=t),new Ey("limit",e,"F"))))}catch(t){throw Ov(t,"limit()","Query.limit()")}var e},Xv.prototype.limitToLast=function(t){try{return new Xv(this.firestore,yy(this._,(kp("limitToLast",e=t),new Ey("limitToLast",e,"L"))))}catch(t){throw Ov(t,"limitToLast()","Query.limitToLast()")}var e},Xv.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Xv(this.firestore,yy(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ty("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Ov(t,"startAt()","Query.startAt()")}},Xv.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Xv(this.firestore,yy(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ty("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Ov(t,"startAfter()","Query.startAfter()")}},Xv.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Xv(this.firestore,yy(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ny("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Ov(t,"endBefore()","Query.endBefore()")}},Xv.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Xv(this.firestore,yy(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ny("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Ov(t,"endAt()","Query.endAt()")}},Xv.prototype.isEqual=function(t){return Kp(this._,t._)},Xv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Dp(e,Vp);var n=Dp(e.firestore,ty),t=ry(n),r=new $y(n);return function(n,r){var t=this,i=new ca;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Uh(i,o,!0)];case 1:return r=t.sent(),e=new Vl(o,r.Pc),n=e.dl(r.documents),n=e.Ei(n,!1),s.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),r=xa(n,"Failed to execute query '"+o+" against cache"),s.reject(r),[3,3];case 3:return[2]}})})},[4,Kd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.C_).then(function(t){return new Gy(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=Dp(e,Vp);var n=Dp(e.firestore,ty),t=ry(n),r=new $y(n);return Qd(t,e.C_,{source:"server"}).then(function(t){return new Gy(n,r,e,t)})}:function(e){e=Dp(e,Vp);var n=Dp(e.firestore,ty),t=ry(n),r=new $y(n);return dy(e.C_),Qd(t,e.C_).then(function(t){return new Gy(n,r,e,t)})})(this._).then(function(t){return new Gv(e.firestore,new Gy(e.firestore._,e.Hf,e._,t.ud))})},Xv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Lv(t),i=Pv(t,function(t){return new Gv(e.firestore,new Gy(e.firestore._,e.Hf,e._,t.ud))});return ev(this._,r,i)},Xv.prototype.withConverter=function(t){return new Xv(this.firestore,this._.withConverter(Tv.Rd(this.firestore,t)))},Xv),Bv=(h(Wv,Vv=Mr),Object.defineProperty(Wv.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(Wv.prototype,"doc",{get:function(){return new qv(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(Wv.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(Wv.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),Wv),Gv=(h(Jv,Rv=Mr),Object.defineProperty(Jv.prototype,"query",{get:function(){return new Hv(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(Jv.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Jv.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(Jv.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Jv.prototype,"docs",{get:function(){var e=this;return this._.docs.map(function(t){return new qv(e.zf,t)})},enumerable:!1,configurable:!0}),Jv.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new Bv(e.zf,t)})},Jv.prototype.forEach=function(e,n){var r=this;this._.forEach(function(t){e.call(n,new qv(r.zf,t))})},Jv.prototype.isEqual=function(t){return Yy(this._,t._)},Jv),zv=(h(Kv,Cv=Hv),Object.defineProperty(Kv.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Kv.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(Kv.prototype,"parent",{get:function(){var t=this._.parent;return t?new Dv(this.firestore,t):null},enumerable:!1,configurable:!0}),Kv.prototype.doc=function(t){try{return new Dv(this.firestore,void 0===t?Gp(this._):Gp(this._,t))}catch(t){throw Ov(t,"doc()","CollectionReference.doc()")}},Kv.prototype.add=function(t){var e,n=this,r=this._,i=t;return t=Dp(r.firestore,ty),e=Gp(r),i=Vy(r.v_,i),nv(t,[sd(od(r.firestore),"addDoc",e.S_,i,null!==r.v_,{}).F_(e.S_,xs.exists(!1))]).then(function(){return e}).then(function(t){return new Dv(n.firestore,t)})},Kv.prototype.isEqual=function(t){return zp(this._,t._)},Kv.prototype.withConverter=function(t){return new Kv(this.firestore,this._.withConverter(Tv.Rd(this.firestore,t)))},Kv);function Kv(t,e){var n=this;return(n=Cv.call(this,t,e)||this).firestore=t,n._=e,n}function Jv(t,e){var n=this;return(n=Rv.call(this,e)||this).zf=t,n}function Wv(t,e){var n=this;return(n=Vv.call(this,e)||this).zf=t,n}function Xv(t,e){var n=this;return(n=Mv.call(this,e)||this).firestore=t,n.Hf=new pv(t),n}function Yv(){return null!==Uv&&Uv.apply(this,arguments)||this}function Qv(t,e){var n=this;return(n=Fv.call(this,e)||this).zf=t,n}function $v(t){return t instanceof Mr&&(t=t._),Dp(t,Rp)}var Zv,tg,me=(h(ig,tg=Mr),ig.documentId=function(){return new ig(pi.lt().ot())},ig.prototype.isEqual=function(t){return t instanceof Mr&&(t=t._),t instanceof mp&&this._.d_.isEqual(t.d_)},ig),o=(h(rg,Zv=Mr),rg.serverTimestamp=function(){var t=new yd("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new rg(t)},rg.delete=function(){var t=new ad("deleteField");return t._methodName="FieldValue.delete",new rg(t)},rg.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new vd("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new rg(n)},rg.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new gd("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new rg(n)},rg.increment=function(t){return(t=new md("increment",t))._methodName="FieldValue.increment",new rg(t)},rg.prototype.isEqual=function(t){return this._.isEqual(t._)},rg),eg=(ng.prototype.onProgress=function(t,e,n){this.gd={next:t,error:e,complete:n}},ng.prototype.catch=function(t){return this.Vd.promise.catch(t)},ng.prototype.then=function(t,e){return this.Vd.promise.then(t,e)},ng.prototype.Ul=function(t){this.Ql(t),this.gd.complete&&this.gd.complete(),this.Vd.resolve(t)},ng.prototype.Wl=function(t){this.pd.taskState="Error",this.gd.next&&this.gd.next(this.pd),this.gd.error&&this.gd.error(t),this.Vd.reject(t)},ng.prototype.Ql=function(t){this.pd=t,this.gd.next&&this.gd.next(t)},ng);function ng(){this.gd={},this.Vd=new ca,this.pd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function rg(){return null!==Zv&&Zv.apply(this,arguments)||this}function ig(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return tg.call(this,new(mp.bind.apply(mp,f([void 0],t))))||this}og.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},og.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},og.prototype.setServiceProps=function(t){return this.serviceProps=t,this},ge=og;function og(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}o={Firestore:lv,GeoPoint:Jp,Timestamp:ci,Blob:Br,Transaction:_v,WriteBatch:Ev,DocumentReference:Dv,DocumentSnapshot:jv,Query:Hv,QueryDocumentSnapshot:qv,QuerySnapshot:Gv,CollectionReference:zv,FieldPath:me,FieldValue:o,setLogLevel:function(t){mr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(e=e.default).INTERNAL.registerComponent(new ge("firestore",function(t){var e=t.getProvider("app").getImmediate();return t=t.getProvider("auth-internal"),new lv(e,new ty(e,t),new fv)},"PUBLIC").setServiceProps(Object.assign({},o))),e.registerVersion("@firebase/firestore","2.1.3-2021019222814"),lv.prototype.loadBundle=function(t){return e=this,s=t,t=new eg,function(n,t,r){var e,i=this,o=(e=s,t=jf(t),e=function(t){if(t instanceof Uint8Array)return yp(t,void 0);if(t instanceof ArrayBuffer)return yp(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),new gp(e,t));n.fs.ys(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=ip,[4,Wd(n)];case 1:return e.apply(void 0,[t.sent(),o,r]),[2]}})})})}(ry(e._),e.I_,t),t;var e,s},lv.prototype.namedQuery=function(t){return function(n,r){var t=this;return n.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.Eo.Ls(t,e)})},[4,Kd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(ry((e=this)._),t).then(function(t){return t?new Hv(e,new Vp(e._,null,t.query)):null});var e}}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});