!function(){var e="undefined"!=typeof window?window:global,t={};if(function(d,e,t){var o="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)},u=(void 0===d||d!==this)&&void 0!==e&&null!=e?e:this;function c(){c=function(){},u.Symbol||(u.Symbol=i)}var n,i=(n=0,function(e){return"jscomp_symbol_"+(e||"")+n++});function l(){c();var e=(e=u.Symbol.iterator)||(u.Symbol.iterator=u.Symbol("iterator"));"function"!=typeof Array.prototype[e]&&o(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return r(this)}}),l=function(){}}function r(e){var t=0;return a(function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}})}function a(e){return l(),(e={next:e})[u.Symbol.iterator]=function(){return this},e}function B(e){l();var t=e[Symbol.iterator];return t?t.call(e):r(e)}function s(e,t){if(t){for(var n=u,i=e.split("."),r=0;r<i.length-1;r++){var a=i[r];a in n||(n[a]={}),n=n[a]}(a=t(r=n[i=i[i.length-1]]))!=r&&null!=a&&o(n,i,{configurable:!0,writable:!0,value:a})}}function h(t){function r(e){return t.next(e)}function a(e){return t.throw(e)}return new Promise(function(n,i){!function e(t){t.done?n(t.value):Promise.resolve(t.value).then(r,a).then(e,i)}(t.next())})}function G(e){return h(e())}s("Promise",function(e){function o(e){this.b=0,this.g=void 0,this.a=[];var t=this.c();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function t(){this.a=null}function s(t){return t instanceof o?t:new o(function(e){e(t)})}if(e)return e;t.prototype.b=function(e){null==this.a&&(this.a=[],this.f()),this.a.push(e)},t.prototype.f=function(){var e=this;this.c(function(){e.j()})};var n=u.setTimeout;t.prototype.c=function(e){n(e,0)},t.prototype.j=function(){for(;this.a&&this.a.length;){var e=this.a;this.a=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.g(e)}}}this.a=null},t.prototype.g=function(e){this.c(function(){throw e})},o.prototype.c=function(){function e(t){return function(e){i||(i=!0,t.call(n,e))}}var n=this,i=!1;return{resolve:e(this.w),reject:e(this.f)}},o.prototype.w=function(e){if(e===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof o)this.B(e);else{e:switch(typeof e){case"object":var t=null!=e;break e;case"function":t=!0;break e;default:t=!1}t?this.v(e):this.j(e)}},o.prototype.v=function(e){var t=void 0;try{t=e.then}catch(e){return void this.f(e)}"function"==typeof t?this.G(t,e):this.j(e)},o.prototype.f=function(e){this.l(2,e)},o.prototype.j=function(e){this.l(1,e)},o.prototype.l=function(e,t){if(0!=this.b)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.b);this.b=e,this.g=t,this.s()},o.prototype.s=function(){if(null!=this.a){for(var e=0;e<this.a.length;++e)r.b(this.a[e]);this.a=null}};var r=new t;return o.prototype.B=function(e){var t=this.c();e.Jc(t.resolve,t.reject)},o.prototype.G=function(e,t){var n=this.c();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},o.prototype.then=function(e,t){function n(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(e){r(e)}}:e}var i,r,a=new o(function(e,t){i=e,r=t});return this.Jc(n(e,i),n(t,r)),a},o.prototype.catch=function(e){return this.then(void 0,e)},o.prototype.Jc=function(e,t){function n(){switch(i.b){case 1:e(i.g);break;case 2:t(i.g);break;default:throw Error("Unexpected state: "+i.b)}}var i=this;null==this.a?r.b(n):this.a.push(n)},o.resolve=s,o.reject=function(n){return new o(function(e,t){t(n)})},o.race=function(r){return new o(function(e,t){for(var n=B(r),i=n.next();!i.done;i=n.next())s(i.value).Jc(e,t)})},o.all=function(e){var t=B(e),a=t.next();return a.done?s([]):new o(function(n,e){for(var i=[],r=0;i.push(void 0),r++,s(a.value).Jc(function(t){return function(e){i[t]=e,0==--r&&n(i)}}(i.length-1),e),a=t.next(),!a.done;);})},o}),s("Promise.prototype.finally",function(e){return e||function(t){return this.then(function(e){return Promise.resolve(t()).then(function(){return e})},function(e){return Promise.resolve(t()).then(function(){throw e})})}});var f,p="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)Ps=Object.setPrototypeOf;else{e:{var m={};try{m.__proto__={Hf:!0},f=m.Hf;break e}catch(e){}f=!1}Ps=f?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var g=Ps;function v(e,t){if(e.prototype=p(t.prototype),e.prototype.constructor=e,g)g(e,t);else for(var n in t){var i;"prototype"!=n&&(Object.defineProperties?(i=Object.getOwnPropertyDescriptor(t,n))&&Object.defineProperty(e,n,i):e[n]=t[n])}e.Eh=t.prototype}function b(){this.g=!1,this.c=null,this.A=void 0,this.o=1,this.b=this.f=0,this.l=this.a=null}function y(e){if(e.g)throw new TypeError("Generator is already running");e.g=!0}function E(e,t){e.a={Ge:t,Se:!0},e.o=e.f||e.b}function V(e,t,n){return e.o=n,{value:t}}function x(e){e.o=0}function z(e,t,n){e.f=t,null!=n&&(e.b=n)}function C(e,t){e.f=0,e.b=t||0}function H(e,t){e.o=t,e.f=0}function W(e){e.f=0;var t=e.a.Ge;return e.a=null,t}function N(e){e.l=[e.a],e.f=0,e.b=0}function P(e,t){var n=e.l.splice(0)[0];(n=e.a=e.a||n)?n.Se?e.o=e.f||e.b:null!=n.C&&e.b<n.C?(e.o=n.C,e.a=null):e.o=e.b:e.o=t}function w(e){this.a=new b,this.b=e}function T(t,e,n,i){try{var r=e.call(t.a.c,n);if(!(r instanceof Object))throw new TypeError("Iterator result "+r+" is not an object");if(!r.done)return t.a.g=!1,r;var a=r.value}catch(e){return t.a.c=null,E(t.a,e),S(t)}return t.a.c=null,i.call(t.a,a),S(t)}function S(t){for(;t.a.o;)try{var e=t.b(t.a);if(e)return t.a.g=!1,{value:e.value,done:!1}}catch(e){t.a.A=void 0,E(t.a,e)}if(t.a.g=!1,t.a.a){if(e=t.a.a,t.a.a=null,e.Se)throw e.Ge;return{value:e.return,done:!0}}return{value:void 0,done:!0}}function A(t){this.next=function(e){return y(t.a),e=t.a.c?T(t,t.a.c.next,e,t.a.j):(t.a.j(e),S(t))},this.throw=function(e){return y(t.a),e=t.a.c?T(t,t.a.c.throw,e,t.a.j):(E(t.a,e),S(t))},this.return=function(e){return function(e,t){y(e.a);var n=e.a.c;return n?T(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.a.return):(e.a.return(t),S(e))}(t,e)},l(),this[Symbol.iterator]=function(){return this}}function q(e,t){return A.prototype=e.prototype,new A(new w(t))}function I(e){if(!(e instanceof Array)){e=B(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}function k(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function M(e,t,n){e instanceof String&&(e=String(e));for(var i=e.length,r=0;r<i;r++){var a=e[r];if(t.call(n,a,r,e))return{Pe:r,Bf:a}}return{Pe:-1,Bf:void 0}}function R(e,t,n){if(null==e)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""}b.prototype.j=function(e){this.A=e},b.prototype.return=function(e){this.a={return:e},this.o=this.b},b.prototype.C=function(e){this.o=e},s("WeakMap",function(i){function e(e){if(this.a=(a+=Math.random()+1).toString(),e){c(),l(),e=B(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(e){k(e,r)||o(e,r,{value:{}})}function t(e){var t=Object[e];t&&(Object[e]=function(e){return n(e),t(e)})}if(function(){if(i&&Object.seal)try{var e=Object.seal({}),t=Object.seal({}),n=new i([[e,2],[t,3]]);return 2!=n.get(e)||3!=n.get(t)?void 0:(n.delete(e),n.set(t,4),!n.has(e)&&4==n.get(t))}catch(e){return}}())return i;var r="$jscomp_hidden_"+Math.random();t("freeze"),t("preventExtensions"),t("seal");var a=0;return e.prototype.set=function(e,t){if(n(e),!k(e,r))throw Error("WeakMap key fail: "+e);return e[r][this.a]=t,this},e.prototype.get=function(e){return k(e,r)?e[r][this.a]:void 0},e.prototype.has=function(e){return k(e,r)&&k(e[r],this.a)},e.prototype.delete=function(e){return!(!k(e,r)||!k(e[r],this.a))&&delete e[r][this.a]},e}),s("Map",function(i){function n(){var e={};return e.fb=e.next=e.head=e}function e(e,t){var n=e.a;return a(function(){if(n){for(;n.head!=e.a;)n=n.fb;if(n.next!=n.head)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}})}function r(e,t){var n=t&&typeof t;"object"==n||"function"==n?o.has(t)?n=o.get(t):(n=""+ ++s,o.set(t,n)):n="p_"+t;var i=e.b[n];if(i&&k(e.b,n))for(var r=0;r<i.length;r++){var a=i[r];if(t!=t&&a.key!=a.key||t===a.key)return{id:n,list:i,index:r,qa:a}}return{id:n,list:i,index:-1,qa:void 0}}function t(e){if(this.b={},this.a=n(),this.size=0,e){e=B(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}if(function(){if(i&&"function"==typeof i&&i.prototype.entries&&"function"==typeof Object.seal)try{var e=Object.seal({x:4}),t=new i(B([[e,"s"]]));if("s"!=t.get(e)||1!=t.size||t.get({x:4})||t.set({x:4},"t")!=t||2!=t.size)return;var n=t.entries(),t=n.next();return t.done||t.value[0]!=e||"s"!=t.value[1]?void 0:!((t=n.next()).done||4!=t.value[0].x||"t"!=t.value[1]||!n.next().done)}catch(e){return}}())return i;c(),l();var o=new WeakMap;t.prototype.set=function(e,t){var n=r(this,e);return n.list||(n.list=this.b[n.id]=[]),n.qa?n.qa.value=t:(n.qa={next:this.a,fb:this.a.fb,head:this.a,key:e,value:t},n.list.push(n.qa),this.a.fb.next=n.qa,this.a.fb=n.qa,this.size++),this},t.prototype.delete=function(e){return!(!(e=r(this,e)).qa||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this.b[e.id],e.qa.fb.next=e.qa.next,e.qa.next.fb=e.qa.fb,e.qa.head=null,this.size--,!0)},t.prototype.clear=function(){this.b={},this.a=this.a.fb=n(),this.size=0},t.prototype.has=function(e){return!!r(this,e).qa},t.prototype.get=function(e){return(e=r(this,e).qa)&&e.value},t.prototype.entries=function(){return e(this,function(e){return[e.key,e.value]})},t.prototype.keys=function(){return e(this,function(e){return e.key})},t.prototype.values=function(){return e(this,function(e){return e.value})},t.prototype.forEach=function(e,t){for(var n,i=this.entries();!(n=i.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},t.prototype[Symbol.iterator]=t.prototype.entries;var s=0;return t}),s("Set",function(i){function e(e){if(this.a=new Map,e){e=B(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.a.size}return function(){if(i&&"function"==typeof i&&i.prototype.entries&&"function"==typeof Object.seal)try{var e=Object.seal({x:4}),t=new i(B([e]));if(!t.has(e)||1!=t.size||t.add(e)!=t||1!=t.size||t.add({x:4})!=t||2!=t.size)return;var n=t.entries(),t=n.next();return t.done||t.value[0]!=e||t.value[1]!=e?void 0:!(t=n.next()).done&&t.value[0]!=e&&4==t.value[0].x&&t.value[1]==t.value[0]&&n.next().done}catch(e){return}}()?i:(c(),l(),e.prototype.add=function(e){return this.a.set(e,e),this.size=this.a.size,this},e.prototype.delete=function(e){return e=this.a.delete(e),this.size=this.a.size,e},e.prototype.clear=function(){this.a.clear(),this.size=0},e.prototype.has=function(e){return this.a.has(e)},e.prototype.entries=function(){return this.a.entries()},e.prototype.keys=e.prototype.values=function(){return this.a.values()},e.prototype[Symbol.iterator]=e.prototype.values,e.prototype.forEach=function(t,n){var i=this;this.a.forEach(function(e){return t.call(n,e,e,i)})},e)}),s("Array.prototype.keys",function(e){return e||function(){return function(t,n){l(),t instanceof String&&(t+="");var i=0,r={next:function(){if(i<t.length){var e=i++;return{value:n(e,t[e]),done:!1}}return r.next=function(){return{done:!0,value:void 0}},r.next()}};return r[Symbol.iterator]=function(){return r},r}(this,function(e){return e})}}),s("Array.from",function(e){return e||function(e,t,n){l(),t=null!=t?t:function(e){return e};var i=[],r=e[Symbol.iterator];if("function"==typeof r)for(e=r.call(e);!(r=e.next()).done;)i.push(t.call(n,r.value));else{r=e.length;for(var a=0;a<r;a++)i.push(t.call(n,e[a]))}return i}}),s("Array.prototype.findIndex",function(e){return e||function(e,t){return M(this,e,t).Pe}}),s("Object.is",function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}}),s("Array.prototype.includes",function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var i=n.length,r=t||0;for(r<0&&(r=Math.max(r+i,0));r<i;r++){var a=n[r];if(a===e||Object.is(a,e))return!0}return!1}}),s("String.prototype.includes",function(e){return e||function(e,t){return-1!==R(this,e,"includes").indexOf(e,t||0)}}),s("String.prototype.startsWith",function(e){return e||function(e,t){for(var n=R(this,e,"startsWith"),i=n.length,r=e.length,a=Math.max(0,Math.min(0|t,n.length)),o=0;o<r&&a<i;)if(n[a++]!=e[o++])return!1;return r<=o}}),s("Array.prototype.find",function(e){return e||function(e,t){return M(this,e,t).Bf}});var L="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var r in i)k(i,r)&&(e[r]=i[r])}return e};s("Object.assign",function(e){return e||L});var U=this;function _(e,t){var n,i=e.split("."),r=U;i[0]in r||!r.execScript||r.execScript("var "+i[0]);for(;i.length&&(n=i.shift());)i.length||void 0===t?r=r[n]||(r[n]={}):r[n]=t}function O(e,i){function t(){}t.prototype=i.prototype,e.Eh=i.prototype,e.prototype=new t,(e.prototype.constructor=e).base=function(e,t,n){return i.prototype[t].apply(e,Array.prototype.slice.call(arguments,2))}}function D(e,t){for(var n in t=void 0===t?{}:t)this[n]=t[n];this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=(d.performance&&d.performance.now?d.performance:Date).now(),this.type=e,this.isTrusted=!1,this.target=this.currentTarget=null,this.a=!1}U.a=!0,_("shaka.util.FakeEvent",D),D.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},D.prototype.stopImmediatePropagation=function(){this.a=!0},D.prototype.stopPropagation=function(){};var X={Nb:0,Hc:function(){},ba:function(){},error:function(){},u:function(){},info:function(){},debug:function(){},I:function(){},N:function(){}};function F(){this.a={}}function j(){this.Cd=new F,this.Ec=this}function K(e,t){for(var n=[],i=B(e),r=i.next();!r.done;r=i.next())n.push(t(r.value));return n}function Y(e,t){for(var n=B(e),i=n.next();!i.done;i=n.next())if(!t(i.value))return!1;return!0}function $(e,t){for(var n=[],i=B(e),r=i.next();!r.done;r=i.next())t(r=r.value)&&n.push(r);return n}function J(e,t){return e=Q(e),t=Q(t),e.split("-")[0]==t.split("-")[0]}function Z(e,t){e=Q(e),t=Q(t);e=e.split("-"),t=t.split("-");return e[0]==t[0]&&1==e.length&&2==t.length}function Q(e){var t=e.split("-");return e=t[0]||"",t=t[1]||"",e=e.toLowerCase(),e=ie.get(e)||e,(t=t.toUpperCase())?e+"-"+t:e}function ee(e){var t=e.indexOf("-");return e=(e=0<=t?e.substring(0,t):e).toLowerCase(),ie.get(e)||e}function te(e){return e.language?Q(e.language):e.audio&&e.audio.language?Q(e.audio.language):e.video&&e.video.language?Q(e.video.language):"und"}function ne(e,t){for(var n=Q(e),i=new Set,r=B(t),a=r.next();!a.done;a=r.next())i.add(Q(a.value));for(a=(r=B(i)).next();!a.done;a=r.next())if((a=a.value)==n)return a;for(a=(r=B(i)).next();!a.done;a=r.next())if(Z(a=a.value,n))return a;for(a=(r=B(i)).next();!a.done;a=r.next()){var o=n,s=Q(s=a=a.value),o=Q(o);if(s=s.split("-"),o=o.split("-"),2==s.length&&2==o.length&&s[0]==o[0])return a}for(a=(i=B(i)).next();!a.done;a=i.next())if(Z(n,r=a.value))return r;return null}d.console&&d.console.log.bind&&(X.ba=console.warn.bind(console),X.Hc=console.error.bind(console),1<=X.Nb&&(X.error=console.error.bind(console)),2<=X.Nb&&(X.u=console.warn.bind(console)),3<=X.Nb&&(X.info=console.info.bind(console)),4<=X.Nb&&(X.debug=console.log.bind(console)),5<=X.Nb&&(X.I=console.debug.bind(console)),6<=X.Nb&&(X.N=console.debug.bind(console))),(e=F.prototype).push=function(e,t){this.a.hasOwnProperty(e)?this.a[e].push(t):this.a[e]=[t]},e.get=function(e){return(e=this.a[e])?e.slice():null},e.getAll=function(){var e,t=[];for(e in this.a)t.push.apply(t,this.a[e]);return t},e.remove=function(e,t){var n=this.a[e];if(n)for(var i=0;i<n.length;++i)n[i]==t&&(n.splice(i,1),--i)},e.forEach=function(e){for(var t in this.a)e(t,this.a[t])},j.prototype.addEventListener=function(e,t){this.Cd.push(e,t)},j.prototype.removeEventListener=function(e,t){this.Cd.remove(e,t)},j.prototype.dispatchEvent=function(e){for(var t=this.Cd.get(e.type)||[],n=0;n<t.length;++n){e.target=this.Ec,e.currentTarget=this.Ec;var i=t[n];try{i.handleEvent?i.handleEvent(e):i.call(this,e)}catch(e){X.error("Uncaught exception in event handler",e,e?e.message:null,e?e.stack:null)}if(e.a)break}return e.defaultPrevented};var ie=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function re(e){this.g=Q(e),this.f=new Map,this.b=new Set,this.c=new Map,this.a=new j}function ae(n){for(var e=n.c,t=n.g,i=n.b,r=new Set,a={},o=B(i),s=o.next();!s.done;a={locale:a.locale},s=o.next()){a.locale=s.value,r.add(a.locale),r.add(ee(a.locale)),(s=$(e.keys(),function(r){return function(e){var t=r.locale,n=ee(e),i=ee(t);return e!=n&&t!=i&&n==i}}(a))).sort();for(var u=B(s),s=u.next();!s.done;s=u.next())r.add(s.value);for((s=$(e.keys(),function(t){return function(e){return ee(e)==t.locale}}(a))).sort(),s=(u=B(s)).next();!s.done;s=u.next())r.add(s.value)}for(r.add(t),t=[],s=(r=B(r)).next();!s.done;s=r.next())(s=e.get(s.value))&&t.push(s);for(t.reverse(),n.f.clear(),s=(e=B(t)).next();!s.done;s=e.next())s.value.forEach(function(e,t){n.f.set(t,e)});for(e=n.f.keys(),r=new Set,s=(t=B(n.b)).next();!s.done;s=t.next())(function(e,t,n){for(var i=(t=B(t)).next();!i.done;i=t.next())i=i.value,e.get(i)||n.add(i)})(s=n.c.get(s.value)||new Map,e,r);0<r.size&&(i={locales:Array.from(i),missing:Array.from(r)},n.a.dispatchEvent(new D("missing-localizations",i)))}_("shaka.ui.Localization",re),re.prototype.addEventListener=function(e,t,n){this.a.addEventListener(e,t,n)},re.prototype.removeEventListener=function(e,t,n){this.a.removeEventListener(e,t,n||void 0)},re.prototype.dispatchEvent=function(e){return this.a.dispatchEvent(e)},re.prototype.changeLocale=re.prototype.Be=function(e){var t=this;this.b.clear();for(var n=(e=B(e)).next();!n.done;n=e.next())this.b.add(Q(n.value));ae(this),this.a.dispatchEvent(new D("locale-changed")),(e=$(this.b,function(e){return!t.c.has(e)})).length&&this.a.dispatchEvent(new D("unknown-locales",{locales:e}))},re.prototype.insert=re.prototype.aa=function(e,t,n){var i=oe;e=Q(e),void 0===n&&(n=i.Gf);var r=this.c.get(e)||new Map;return t.forEach(function(e,t){r.has(t)&&n!=i.Gf||r.set(t,e)}),this.c.set(e,r),ae(this),this.a.dispatchEvent(new D("locale-updated")),this},re.prototype.resolveDictionary=re.prototype.nh=function(e){for(var t=B(e.keys()),n=t.next();!n.done;n=t.next())n=n.value,e.set(n,this.resolve(n))},re.prototype.resolve=function(e){var t=this.f.get(e);return t||(e={locales:Array.from(this.b),missing:e},this.a.dispatchEvent(new D("unknown-localization",e)),"")};var oe={USE_OLD:0,USE_NEW:1};function se(e){this.c=Math.exp(Math.log(.5)/e),this.b=this.a=0}function ue(e,t,n){var i=Math.pow(e.c,t);n=n*(1-i)+i*e.a,isNaN(n)||(e.a=n,e.b+=t)}function ce(e){return e.a/(1-Math.pow(e.c,e.b))}function le(){this.b=new se(2),this.c=new se(5),this.a=0}re.ConflictResolution=oe,re.UNKNOWN_LOCALES="unknown-locales",re.UNKNOWN_LOCALIZATION="unknown-localization",re.MISSING_LOCALIZATIONS="missing-localizations",re.LOCALE_CHANGED="locale-changed",re.LOCALE_UPDATED="locale-updated",le.prototype.getBandwidthEstimate=function(e){return this.a<128e3?e:Math.min(ce(this.b),ce(this.c))};var de=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function he(e){var t;e instanceof he?(fe(this,e.Qa),this.Kb=e.Kb,this.Pa=e.Pa,pe(this,e.ec),this.Ca=e.Ca,me(this,e.a.clone()),this.wb=e.wb):e&&(t=String(e).match(de))?(fe(this,t[1]||"",!0),this.Kb=ge(t[2]||""),this.Pa=ge(t[3]||"",!0),pe(this,t[4]),this.Ca=ge(t[5]||"",!0),me(this,t[6]||"",!0),this.wb=ge(t[7]||"")):this.a=new Ae(null)}function fe(e,t,n){e.Qa=n?ge(t,!0):t,e.Qa&&(e.Qa=e.Qa.replace(/:$/,""))}function pe(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.ec=t}else e.ec=null}function me(e,t,n){t instanceof Ae?e.a=t:(n||(t=ve(t,Te)),e.a=new Ae(t))}function ge(e,t){return e?(t?decodeURI:decodeURIComponent)(e):""}function ve(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,be),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function be(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}(e=he.prototype).Qa="",e.Kb="",e.Pa="",e.ec=null,e.Ca="",e.wb="",e.toString=function(){var e,t=[],n=this.Qa;return n&&t.push(ve(n,ye,!0),":"),(n=this.Pa)&&(t.push("//"),(e=this.Kb)&&t.push(ve(e,ye,!0),"@"),t.push(encodeURIComponent(n).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.ec)&&t.push(":",String(n))),(n=this.Ca)&&(this.Pa&&"/"!=n.charAt(0)&&t.push("/"),t.push(ve(n,"/"==n.charAt(0)?we:Ee,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.wb)&&t.push("#",ve(n,Se)),t.join("")},e.resolve=function(e){var t=this.clone();"data"===t.Qa&&(t=new he);var n=!!e.Qa;n?fe(t,e.Qa):n=!!e.Kb,n?t.Kb=e.Kb:n=!!e.Pa,n?t.Pa=e.Pa:n=null!=e.ec;var i,r=e.Ca;if(n)pe(t,e.ec);else if(n=!!e.Ca)if("/"!=r.charAt(0)&&(this.Pa&&!this.Ca?r="/"+r:-1!=(i=t.Ca.lastIndexOf("/"))&&(r=t.Ca.substr(0,i+1)+r)),".."==r||"."==r)r="";else if(-1!=r.indexOf("./")||-1!=r.indexOf("/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var a=[],o=0;o<r.length;){var s=r[o++];"."==s?i&&o==r.length&&a.push(""):".."==s?((1<a.length||1==a.length&&""!=a[0])&&a.pop(),i&&o==r.length&&a.push("")):(a.push(s),i=!0)}r=a.join("/")}return n?t.Ca=r:n=""!==e.a.toString(),n?me(t,e.a.clone()):n=!!e.wb,n&&(t.wb=e.wb),t},e.clone=function(){return new he(this)};var ye=/[#\/\?@]/g,Ee=/[#\?:]/g,we=/[#\?]/g,Te=/[#\?@]/g,Se=/#/g;function Ae(e){this.a=e||null}function Ie(e){this.b=e,this.a=null}function ke(e){this.b=e,this.a=null}function Ce(e,t){var n=Ne();this.l=(null==e.maxAttempts?n:e).maxAttempts,this.f=(null==e.baseDelay?n:e).baseDelay,this.j=(null==e.fuzzFactor?n:e).fuzzFactor,this.g=(null==e.backoffFactor?n:e).backoffFactor,this.a=0,this.b=this.f,(this.c=void 0!==t&&t)&&(this.a=1)}function xe(i){return G(function e(){var t,n;return q(e,function(e){switch(e.o){case 1:if(i.a>=i.l){if(!i.c)return e.return(Promise.reject());i.a=1,i.b=i.f}return(t=i.a,i.a++,0==t)?e.return():(n=i.b*(1+(2*Math.random()-1)*i.j),V(e,new Promise(function(e){new ke(e).R(n/1e3)}),2));case 2:i.b*=i.g,x(e)}})})}function Ne(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0}}function Pe(e,t,n,i){for(var r=[],a=3;a<arguments.length;++a)r[a-3]=arguments[a];this.severity=e,this.category=t,this.code=n,this.data=r,this.handled=!1}function Me(){var n,i,e=new Promise(function(e,t){n=e,i=t});return e.resolve=n,e.reject=i,e}function Re(e,t){this.promise=e,this.We=t,this.a=!1}function Le(e){return new Re(Promise.reject(e),function(){return Promise.resolve()})}function Ue(){var e=Promise.reject(new Pe(2,7,7001));return e.catch(function(){}),new Re(e,function(){return Promise.resolve()})}function _e(e){return new Re(Promise.resolve(e),function(){return Promise.resolve()})}function Oe(e){return new Re(e,function(){return e.catch(function(){})})}function De(e){return new Re(Promise.all(e.map(function(e){return e.promise})),function(){return Promise.all(e.map(function(e){return e.abort()}))})}function Fe(e){var a=new Set;return function e(t){switch(typeof t){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return t;default:if(!t||t.buffer&&t.buffer.constructor==ArrayBuffer)return t;if(a.has(t))return null;var n=t.constructor==Array;if(t.constructor!=Object&&!n)return null;a.add(t);var i,r=n?[]:{};for(i in t)r[i]=e(t[i]);return n&&(r.length=t.length),r}}(e)}function je(e,t){return!("number"!=typeof e||"number"!=typeof t||!isNaN(e)||!isNaN(t))||e===t}function Ke(e,t){t=e.indexOf(t);-1<t&&e.splice(t,1)}function Be(e,t,n){if(n=n||je,e.length!=t.length)return!1;t=t.slice();for(var i={},r=(e=B(e)).next();!r.done;i={item:i.item},r=e.next()){if(i.item=r.value,-1==(r=t.findIndex(function(t){return function(e){return n(t.item,e)}}(i))))return!1;t[r]=t[t.length-1],t.pop()}return 0==t.length}function Ge(e,t,n){if(n=n||je,e.length==t.length){for(var i=0;i<e.length;i++)if(!n(e[i],t[i]))return;return 1}}function Ve(){this.a=[]}function ze(e,t){e.a.push(t.finally(function(){Ke(e.a,t)}))}function He(e){j.call(this),this.f=!1,this.g=new Ve,this.a=new Set,this.b=new Set,this.c=e||null}(e=Ae.prototype).Aa=null,e.Mc=null,e.add=function(e,t){if(!this.Aa&&(this.Aa={},this.Mc=0,this.a))for(var n=this.a.split("&"),i=0;i<n.length;i++){var r,a=n[i].indexOf("="),o=null;0<=a?(r=n[i].substring(0,a),o=n[i].substring(a+1)):r=n[i],r=decodeURIComponent(r.replace(/\+/g," ")),o=o||"",this.add(r,decodeURIComponent(o.replace(/\+/g," ")))}return this.a=null,(n=this.Aa.hasOwnProperty(e)&&this.Aa[e])||(this.Aa[e]=n=[]),n.push(t),this.Mc++,this},e.toString=function(){if(this.a)return this.a;if(!this.Aa)return"";var e,t=[];for(e in this.Aa)for(var n=encodeURIComponent(e),i=this.Aa[e],r=0;r<i.length;r++){var a=n;""!==i[r]&&(a+="="+encodeURIComponent(i[r])),t.push(a)}return this.a=t.join("&")},e.clone=function(){var e=new Ae;if(e.a=this.a,this.Aa){var t,n={};for(t in this.Aa)n[t]=this.Aa[t].concat();e.Aa=n,e.Mc=this.Mc}return e},Ie.prototype.R=function(e){var t=this;this.stop();var n=!0,i=null;return this.a=function(){d.clearTimeout(i),n=!1},i=d.setTimeout(function(){n&&t.b()},1e3*e),this},Ie.prototype.stop=function(){this.a&&(this.a(),this.a=null)},_("shaka.util.Timer",ke),ke.prototype.tickNow=ke.prototype.gb=function(){return this.stop(),this.b(),this},ke.prototype.tickAfter=ke.prototype.R=function(e){var t=this;return this.stop(),this.a=new Ie(function(){t.b()}).R(e),this},ke.prototype.tickEvery=ke.prototype.Ia=function(e){var t=this;return this.stop(),this.a=new Ie(function(){t.a.R(e),t.b()}).R(e),this},ke.prototype.stop=function(){this.a&&(this.a.stop(),this.a=null)},_("shaka.util.Error",Pe),Pe.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},Pe.Severity={RECOVERABLE:1,CRITICAL:2},Pe.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9},Pe.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,HLS_INTERNAL_SKIP_STREAM:4035,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013},Me.prototype.resolve=function(){},Me.prototype.reject=function(){},_("shaka.util.AbortableOperation",Re),Re.failed=Le,Re.aborted=Ue,Re.completed=_e,Re.notAbortable=Oe,Re.prototype.abort=function(){return this.a=!0,this.We()},Re.all=De,Re.prototype.finally=function(e){return this.promise.then(function(){return e(!0)},function(){return e(!1)}),this},Re.prototype.chain=Re.prototype.ma=function(i,r){function e(n){return function(e){var t;o.a&&n?s.reject(u):(t=n?i:r)?a=function(e,t,n){try{var i=e(t);return i&&i.promise&&i.abort?(n.resolve(i.promise),function(){return i.abort()}):(n.resolve(i),function(){return Promise.resolve(i).then(function(){},function(){})})}catch(e){return n.reject(e),function(){return Promise.resolve()}}}(t,e,s):(n?s.resolve:s.reject)(e)}}function a(){return s.reject(u),o.abort()}var o=this,s=new Me,u=new Pe(2,7,7001);return this.promise.then(e(!0),e(!1)),new Re(s,function(){return a()})},Ve.prototype.destroy=function(){var t=[];return this.a.forEach(function(e){e.promise.catch(function(){}),t.push(e.abort())}),this.a=[],Promise.all(t)},O(He,j),_("shaka.net.NetworkingEngine",He),He.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4},He.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3};var We={};function qe(e,t,n){n=n||3;var i=We[e];(!i||n>=i.priority)&&(We[e]={priority:n,dh:t})}function Xe(e,t){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null}}function Ye(){this.a=0}function $e(e,t,n){Re.call(this,e,t),this.b=n}function Je(){}function Ze(){this.a=new F}function Qe(e,t,n,i){this.target=e,this.type=t,this.listener=n,this.a=function(e,t){if(null==t)return!1;if("boolean"==typeof t)return t;var n=new Set(["passive","capture"]);return Object.keys(t).filter(function(e){return!n.has(e)}),function(e){var t=et;if(null==t){t=!1;try{var n={},i={get:function(){return!(t=!0)}};Object.defineProperty(n,"passive",i),Object.defineProperty(n,"capture",i),i=function(){},e.addEventListener("test",i,n),e.removeEventListener("test",i,n)}catch(e){t=!1}et=t}return t||!1}(e)?t:t.capture||!1}(e,i),this.target.addEventListener(t,n,this.a)}He.registerScheme=qe,He.unregisterScheme=function(e){delete We[e]},He.prototype.registerRequestFilter=He.prototype.fh=function(e){this.a.add(e)},He.prototype.unregisterRequestFilter=He.prototype.Fh=function(e){this.a.delete(e)},He.prototype.clearAllRequestFilters=He.prototype.Nf=function(){this.a.clear()},He.prototype.registerResponseFilter=He.prototype.gh=function(e){this.b.add(e)},He.prototype.unregisterResponseFilter=He.prototype.Gh=function(e){this.b.delete(e)},He.prototype.clearAllResponseFilters=He.prototype.Of=function(){this.b.clear()},He.defaultRetryParameters=Ne,He.makeRequest=Xe,He.prototype.destroy=function(){return this.f=!0,this.a.clear(),this.b.clear(),this.g.destroy()},He.prototype.request=function(i,e){var r=this,t=new Ye;if(this.f){var n=Promise.reject(new Pe(2,7,7001));return n.catch(function(){}),new $e(n,function(){return Promise.resolve()},t)}e.method=e.method||"GET",e.headers=e.headers||{},e.retryParameters=e.retryParameters?Fe(e.retryParameters):Ne(),e.uris=Fe(e.uris);var a=(n=function(e,t,n){for(var i=_e(void 0),r={},a=(e=B(e.a)).next();!a.done;r={Yd:r.Yd},a=e.next())r.Yd=a.value,i=i.ma(function(e){return function(){return e.Yd(t,n)}}(r));return i.ma(void 0,function(e){if(e&&7001==e.code)throw e;throw new Pe(2,1,1006,e)})}(this,i,e)).ma(function(){return function t(i,r,n,a,o,s,u){var e=new he(n.uris[o]),c=e.Qa,l=!1;c||(c=location.protocol,c=c.slice(0,-1),fe(e,c),n.uris[o]=e.toString());c=c.toLowerCase();var d=(c=We[c])?c.dh:null;if(!d)return Le(new Pe(2,1,1e3,e));var h;return Oe(xe(a)).ma(function(){return i.f?Ue():(h=Date.now(),d(n.uris[o],n,r,function(e,t,n){i.c&&1==r&&(i.c(e,t),l=!0,u.a=n)}))}).ma(function(e){return null==e.timeMs&&(e.timeMs=Date.now()-h),{response:e,Ag:l}},function(e){if(e&&7001==e.code)throw e;if(i.f)return Ue();if(e&&1==e.severity)return i.dispatchEvent(new D("retry",{error:e instanceof Pe?e:null})),o=(o+1)%n.uris.length,t(i,r,n,a,o,e,u);throw e||s})}(r,i,e,new Ce(e.retryParameters,!1),0,null,t)}),o=a.ma(function(e){return function(e,t,n){for(var i=_e(void 0),r=(e=B(e.b)).next();!r.done;r=e.next())i=i.ma(r.value.bind(null,t,n.response));return i.ma(function(){return n},function(e){if(e&&7001==e.code)throw e;var t=2;throw e instanceof Pe&&(t=e.severity),new Pe(t,1,1007,e)})}(r,i,e)}),s=Date.now(),u=0;n.promise.then(function(){u=Date.now()-s},function(){});var c=0;return a.promise.then(function(){c=Date.now()},function(){}),n=new $e((n=o.ma(function(e){var t=Date.now()-c,n=e.response;return n.timeMs+=u,n.timeMs+=t,e.Ag||!r.c||n.fromCache||1!=i||r.c(n.timeMs,n.data.byteLength),n},function(e){throw e&&(e.severity=2),e})).promise,n.We,t),ze(this.g,n),n},He.NumBytesRemainingClass=Ye,v($e,Re),(He.PendingRequest=$e).all=De,$e.notAbortable=Oe,$e.completed=_e,$e.aborted=Ue,$e.failed=Le,_("shaka.util.IReleasable",Je),Je.prototype.release=function(){},_("shaka.util.EventManager",Ze),Ze.prototype.release=function(){this.Hb(),this.a=null},Ze.prototype.listen=Ze.prototype.m=function(e,t,n,i){this.a&&(e=new Qe(e,t,n,i),this.a.push(t,e))},Ze.prototype.listenOnce=Ze.prototype.Ha=function(n,i,r,e){var a=this;this.m(n,i,function e(t){a.xa(n,i,e),r(t)},e)},Ze.prototype.unlisten=Ze.prototype.xa=function(e,t,n){if(this.a)for(var i=this.a.get(t)||[],r=(i=B(i)).next();!r.done;r=i.next())(r=r.value).target!=e||n!=r.listener&&n||(r.xa(),this.a.remove(t,r))},Ze.prototype.removeAll=Ze.prototype.Hb=function(){if(this.a){for(var e=this.a.getAll(),t=(e=B(e)).next();!t.done;t=e.next())t.value.xa();this.a.a={}}},Qe.prototype.unlisten=Qe.prototype.xa=function(){this.target.removeEventListener(this.type,this.listener,this.a),this.listener=this.target=null,this.a=!1};var et=void 0;function tt(e){return new he(e=yt(e)).Pa}function nt(e,t,n){function i(e){new DataView(r.buffer).setUint32(a,e.byteLength,!0),a+=4,r.set(e,a),a+=e.byteLength}if(!n||!n.byteLength)throw new Pe(2,6,6015);t="string"==typeof t?new Uint8Array(wt(t,!0)):new Uint8Array(t),e=wt(e=yt(e),!0);var r=new Uint8Array(12+e.byteLength+t.byteLength+n.byteLength),a=0;return i(new Uint8Array(e)),i(t),i(new Uint8Array(n)),r}function it(t){var n=new Map;return Object.keys(t).forEach(function(e){n.set(e,t[e])}),n}function rt(e){var n={};return e.forEach(function(e,t){n[t]=e}),n}function at(e,t){return t&&(e+='; codecs="'+t+'"'),e}function ot(e){var t=(e=e.split("."))[0];return e.pop(),[t,e.join(".")]}_("shaka.util.FairPlayUtils.defaultGetContentId",tt),_("shaka.util.FairPlayUtils.initDataTransform",nt);var st=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function ut(){return!(!d.MediaSource||!MediaSource.isTypeSupported)}function ct(e){return""!=pt().canPlayType(e)}function lt(){return!!navigator.userAgent.match(/Edge?\//)}function dt(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!ft("Tizen")}function ht(){if(!dt())return null;var e=navigator.userAgent.match(/Version\/(\d+)/);return(e=e||navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null}function ft(e){return(navigator.userAgent||"").includes(e)}function pt(){return gt||(mt=mt||new ke(function(){gt=null}),(gt=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(gt=document.createElement("video")),mt.R(1),gt)}var mt=null,gt=null;function vt(e){if(!e)return"";239==(e=new Uint8Array(e))[0]&&187==e[1]&&191==e[2]&&(e=e.subarray(3)),e=Tt(e),e=escape(e);try{return decodeURIComponent(e)}catch(e){throw new Pe(2,2,2004)}}function bt(e,t,n){if(!e)return"";if(!n&&0!=e.byteLength%2)throw X.error("Data has an incorrect length, must be even."),new Pe(2,2,2004);var i=e instanceof ArrayBuffer?e:((n=new Uint8Array(e.byteLength)).set(new Uint8Array(e)),n.buffer);e=Math.floor(e.byteLength/2),n=new Uint16Array(e),i=new DataView(i);for(var r=0;r<e;r++)n[r]=i.getUint16(2*r,t);return Tt(n)}function yt(e){var t=new Uint8Array(e);if(239==t[0]&&187==t[1]&&191==t[2])return vt(t);if(254==t[0]&&255==t[1])return bt(t.subarray(2),!1);if(255==t[0]&&254==t[1])return bt(t.subarray(2),!0);var n=function(e,t){return e.byteLength<=t||32<=e[t]&&e[t]<=126}.bind(null,t);if(X.debug("Unable to find byte-order-mark, making an educated guess."),0==t[0]&&0==t[2])return bt(e,!1);if(0==t[1]&&0==t[3])return bt(e,!0);if(n(0)&&n(1)&&n(2)&&n(3))return vt(e);throw new Pe(2,2,2003)}function Et(e){e=encodeURIComponent(e),e=unescape(e);for(var t=new Uint8Array(e.length),n=0;n<e.length;++n)t[n]=e.charCodeAt(n);return t.buffer}function wt(e,t){for(var n=new Uint8Array(2*e.length),i=new DataView(n.buffer),r=0;r<e.length;++r)i.setUint16(2*r,e.charCodeAt(r),t);return n.buffer}function Tt(e){if(!St)for(var t={size:65536};0<t.size;(t={size:t.size}).size/=2)if(function(e){try{var t=new Uint8Array(e);return 0<String.fromCharCode.apply(null,t).length}catch(e){return!1}}(t.size)){St=function(i){return function(e){for(var t="",n=0;n<e.length;n+=i.size)t+=String.fromCharCode.apply(null,e.subarray(n,n+i.size));return t}}(t);break}return St(e)}_("shaka.util.StringUtils.fromUTF8",vt),_("shaka.util.StringUtils.fromUTF16",bt),_("shaka.util.StringUtils.fromBytesAutoDetect",yt),_("shaka.util.StringUtils.toUTF8",Et),_("shaka.util.StringUtils.toUTF16",wt);var St=null;_("shaka.util.StringUtils.resetFromCharCode",function(){St=null});var At={gd:function(e,t){e=Tt(e);return t=null==t||t,e=d.btoa(e).replace(/\+/g,"-").replace(/\//g,"_"),t?e:e.replace(/=*$/,"")}};function It(t,e){var i=this;e=void 0===e?1:e,this.G=t,this.w=new Set,this.j=this.s=null,this.O=!1,this.K=0,this.a=null,this.l=new Ze,this.b=new Map,this.B=[],this.v=new Me,this.f=null,this.g=function(e){i.v.reject(e),t.onError(e)},this.na=new Map,this.Y=new Map,this.L=new ke(function(){return t=(e=i).na,(n=e.Y).clear(),t.forEach(function(e,t){return n.set(t,e)}),(t=Array.from(n.values())).length&&t.every(function(e){return"expired"==e})&&e.g(new Pe(2,6,6014)),void e.G.Wc(rt(n));var e,t,n}),this.c=!1,this.ia=new Me,this.H=!1,this.J=[],this.ka=!1,this.Z=new ke(function(){var r;(r=i).b.forEach(function(e,t){var n=e.Qd,i=t.expiration;isNaN(i)&&(i=1/0),i!=n&&(r.G.onExpirationUpdated(t.sessionId,i),e.Qd=i)})}).Ia(e),this.v.catch(function(){})}function kt(e,t,n){return e.B=n,e.H=0<n.length,Ct(e,t)}function Ct(e,t){var n=function(e){if(0==(e=it(e.f.clearKeys)).size)return null;var n=[],i=[];e.forEach(function(e,t){t=At.vd(t),e=At.vd(e),t={kty:"oct",kid:At.gd(t,!1),k:At.gd(e,!1)};n.push(t),i.push(t.kid)}),e=JSON.stringify({keys:n});var t=JSON.stringify({kids:i});return t=[{initData:new Uint8Array(Et(t)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+d.btoa(e),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:t,keyIds:[]}}(e);if(n)for(var i=B(t),r=i.next();!r.done;r=i.next())r.value.drmInfos=[n];for((n=t.some(function(e){return 0<e.drmInfos.length}))||function(e,t){var n=[];t.forEach(function(e,t){n.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})});for(var i=B(e),r=i.next();!r.done;r=i.next())r.value.drmInfos=n}(t,r=it(e.f.servers)),r=(i=B(t)).next();!r.done;r=i.next())for(var a=(r=B(r.value.drmInfos)).next();!a.done;a=r.next())Gt(a.value,it(e.f.servers),it(e.f.advanced||{}));return(r=function(e,t){for(var n=new Set,i=B(t),r=i.next();!r.done;r=i.next()){var a=B(r.value.drmInfos);for(r=a.next();!r.done;r=a.next())n.add(r.value)}for(i=B(n),r=i.next();!r.done;r=i.next())Gt(r.value,it(e.f.servers),it(e.f.advanced||{}));a=e.H?"required":"optional";var o=e.H?["persistent-license"]:["temporary"];for(i=new Map,n=B(n),r=n.next();!r.done;r=n.next())r=r.value,i.set(r.keySystem,{audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:a,sessionTypes:o,label:r.keySystem,drmInfos:[]});for(n=B(t),r=n.next();!r.done;r=n.next()){r=r.value,a=r.audio,o=r.video;var s=a?at(a.mimeType,a.codecs):"",u=o?at(o.mimeType,o.codecs):"",c=B(r.drmInfos);for(r=c.next();!r.done;r=c.next()){r=r.value;var l=i.get(r.keySystem);l.drmInfos.push(r),r.distinctiveIdentifierRequired&&(l.distinctiveIdentifier="required"),r.persistentStateRequired&&(l.persistentState="required"),a&&l.audioCapabilities.push({robustness:r.audioRobustness||"",contentType:s}),o&&l.videoCapabilities.push({robustness:r.videoRobustness||"",contentType:u})}}return i}(e,t)).size?(r=Lt(e,r),n?r:r.catch(function(){})):(e.O=!0,Promise.resolve())}function xt(n){return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:if(n.s&&n.a&&n.a.serverCertificate&&n.a.serverCertificate.length)return z(e,3),V(e,n.s.setServerCertificate(n.a.serverCertificate),5);e.C(0);break;case 5:e.A||X.u("Server certificates are not supported by the key system.  The server certificate has been ignored."),H(e,0);break;case 3:return t=W(e),e.return(Promise.reject(new Pe(2,6,6004,t.message)))}})})}function Nt(t){var e=t.a?t.a.initData:[];return e.forEach(function(e){return Pt(t,e.initDataType,e.initData)}),t.B.forEach(function(e){return Ut(t,e)}),e.length||t.B.length||t.v.resolve(),t.v}function Pt(e,t,n){for(var i=e.b.values(),r=(i=B(i)).next();!r.done;r=i.next())if(At.Xa(n,r.value.initData)&&!ft("Tizen 2"))return void X.debug("Ignoring duplicate init data.");!function(n,t,e){try{var i;i=n.H?(X.I("Creating new persistent session"),n.s.createSession("persistent-license")):(X.I("Creating new temporary session"),n.s.createSession())}catch(e){return n.g(new Pe(2,6,6005,e.message))}n.l.m(i,"message",n.cf.bind(n)),n.l.m(i,"keystatuseschange",n.$e.bind(n)),n.b.set(i,{initData:e,loaded:!1,Qd:1/0,Va:null});try{e=n.f.initDataTransform(e,n.a)}catch(e){return(t=e)instanceof Pe||(t=new Pe(2,6,6016,e)),n.g(t)}i.generateRequest(t,e).catch(function(e){var t;n.c||(n.b.delete(i),e.errorCode&&e.errorCode.systemCode&&((t=e.errorCode.systemCode)<0&&(t+=Math.pow(2,32)),t="0x"+t.toString(16)),n.g(new Pe(2,6,6006,e.message,e,t)))})}(e,t,n)}function Mt(e){return e?e.keySystem:""}function Rt(e){return e=K(e=e.b.keys(),function(e){return e.sessionId}),Array.from(e)}function Lt(e,h){if(1==h.size&&h.has(""))return Promise.reject(new Pe(2,6,6e3));for(var t=B(h.values()),n=t.next();!n.done;n=t.next())0==(n=n.value).audioCapabilities.length&&delete n.audioCapabilities,0==n.videoCapabilities.length&&delete n.videoCapabilities;var r=t=new Me;return[!0,!1].forEach(function(n){var i=this;h.forEach(function(e,t){e.drmInfos.some(function(e){return!!e.licenseServerUri})==n&&(r=r.catch(function(){if(!this.c)return navigator.requestMediaKeySystemAccess(t,[e])}.bind(i)))})}.bind(e)),r=(r=r.catch(function(){return Promise.reject(new Pe(2,6,6001))})).then(function(e){if(this.c)return Promise.reject();this.w.clear();for(var t=(i=e.getConfiguration()).videoCapabilities||[],n=B(i.audioCapabilities||[]),i=n.next();!i.done;i=n.next())this.w.add(i.value.contentType.toLowerCase());for(i=(t=B(t)).next();!i.done;i=t.next())this.w.add(i.value.contentType.toLowerCase());t=e.keySystem,i=h.get(e.keySystem),n=[];var r,a,o,s,u,c=[],l=[],d=[];return r=i.drmInfos,a=n,o=c,s=l,u=d,r.forEach(function(t){if(a.includes(t.licenseServerUri)||a.push(t.licenseServerUri),t.serverCertificate&&(o.some(function(e){return At.Xa(e,t.serverCertificate)})||o.push(t.serverCertificate)),t.initData&&t.initData.forEach(function(t){s.some(function(e){return!(!e.keyId||e.keyId!=t.keyId)||e.initDataType==t.initDataType&&At.Xa(e.initData,t.initData)})||s.push(t)}),t.keyIds)for(var e=0;e<t.keyIds.length;++e)u.includes(t.keyIds[e])||u.push(t.keyIds[e])}),1<c.length&&X.u("Multiple unique server certificates found! Only the first will be used."),1<n.length&&X.u("Multiple unique license server URIs found! Only the first will be used."),this.a={keySystem:t,licenseServerUri:n[0],distinctiveIdentifierRequired:"required"==i.distinctiveIdentifier,persistentStateRequired:"required"==i.persistentState,audioRobustness:(i.audioCapabilities?i.audioCapabilities[0].robustness:"")||"",videoRobustness:(i.videoCapabilities?i.videoCapabilities[0].robustness:"")||"",serverCertificate:c[0],initData:l,keyIds:d},this.a.licenseServerUri?e.createMediaKeys():Promise.reject(new Pe(2,6,6012,this.a.keySystem))}.bind(e)).then(function(e){if(this.c)return Promise.reject();X.info("Created MediaKeys object for key system",this.a.keySystem),this.s=e,this.O=!0}.bind(e)).catch(function(e){if(!this.c)return this.a=null,this.w.clear(),e instanceof Pe?Promise.reject(e):Promise.reject(new Pe(2,6,6002,e.message))}.bind(e)),t.reject(),r}function Ut(t,n){try{X.I("Attempting to load an offline session",n);var i=t.s.createSession("persistent-license")}catch(e){var r=new Pe(2,6,6005,e.message);return t.g(r),Promise.reject(r)}t.l.m(i,"message",t.cf.bind(t)),t.l.m(i,"keystatuseschange",t.$e.bind(t));var a={initData:null,loaded:!1,Qd:1/0,Va:null};return t.b.set(i,a),i.load(n).then(function(e){return this.c?Promise.reject():(X.N("Loaded offline session",n,e),e?(a.loaded=!0,Bt(this)&&this.v.resolve(),i):(this.b.delete(i),void this.g(new Pe(2,6,6013))))}.bind(t),function(e){this.c||(this.b.delete(i),this.g(new Pe(2,6,6005,e.message)))}.bind(t))}function _t(e,t){return Mt(t).startsWith("com.apple.fps")&&(t=t.serverCertificate,e=nt(e,tt(e),t)),e}function Ot(e,t){var n=t.target;X.I("Sending license request for session",n.sessionId,"of type",t.messageType);var i=e.b.get(n),r=e.a.licenseServerUri,a=e.f.advanced[e.a.keySystem];"individualization-request"==t.messageType&&a&&a.individualizationServer&&(r=a.individualizationServer),(r=Xe([r],e.f.retryParameters)).body=t.message,r.method="POST",r.licenseRequestType=t.messageType,r.sessionId=n.sessionId,"com.microsoft.playready"!=e.a.keySystem&&"com.chromecast.playready"!=e.a.keySystem||function(e){var t=bt(e.body,!0,!0);if(t.includes("PlayReadyKeyMessage")){X.debug("Unwrapping PlayReady request.");for(var n=(t=(new DOMParser).parseFromString(t,"application/xml")).getElementsByTagName("HttpHeader"),i=0;i<n.length;++i)e.headers[n[i].getElementsByTagName("name")[0].textContent]=n[i].getElementsByTagName("value")[0].textContent;e.body=At.Za(t.getElementsByTagName("Challenge")[0].textContent).buffer}else X.debug("PlayReady request is already unwrapped."),e.headers["Content-Type"]="text/xml; charset=utf-8"}(r),e.a.keySystem.startsWith("com.apple.fps")&&e.f.fairPlayTransform&&(a=r,t=new Uint8Array(a.body),t="spc="+At.gd(t),a.headers["Content-Type"]="application/x-www-form-urlencoded",a.body=Et(t));var o=Date.now();e.G.Zb.request(2,r).promise.then(function(e){return this.c?Promise.reject():(this.a.keySystem.startsWith("com.apple.fps")&&this.f.fairPlayTransform&&function(e){try{var t=vt(e.data)}catch(e){return}"<ckc>"===(t=t.trim()).substr(0,5)&&"</ckc>"===t.substr(-6)&&(t=t.slice(5,-6));try{t=JSON.parse(t).ckc}catch(e){}e.data=At.Za(t).buffer}(e),this.K+=(Date.now()-o)/1e3,X.I("Updating session",n.sessionId),n.update(e.data).then(function(){var e=this;this.G.onEvent(new D("drmsessionupdate")),i&&(i.Va&&i.Va.resolve(),new ke(function(){i.loaded=!0,Bt(e)&&e.v.resolve()}).R(zt))}.bind(this)))}.bind(e),function(e){this.c||(e=new Pe(2,6,6007,e),this.g(e),i&&i.Va&&i.Va.reject(e))}.bind(e)).catch(function(e){this.c||(e=new Pe(2,6,6008,e.message),this.g(e),i&&i.Va&&i.Va.reject(e))}.bind(e))}function Dt(){var r=[{videoCapabilities:e=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:e}],a=new Map,e="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").map(function(e){return i=e,G(function e(){var t,n;return q(e,function(e){switch(e.o){case 1:return z(e,2),V(e,navigator.requestMediaKeySystemAccess(i,r),4);case 4:return t=e.A,n=!!(n=t.getConfiguration().sessionTypes)&&n.includes("persistent-license"),ft("Tizen 3")&&(n=!1),a.set(i,{persistentState:n}),V(e,t.createMediaKeys(),5);case 5:H(e,0);break;case 2:W(e),a.set(i,null),x(e)}})});var i});return Promise.all(e).then(function(){return rt(a)})}function Ft(e,t){var n=t.audio,i=t.video;if(n&&n.encrypted&&!lt()&&!e.w.has(at(n.mimeType,n.codecs).toLowerCase())||i&&i.encrypted&&!lt()&&!e.w.has(at(i.mimeType,i.codecs).toLowerCase()))return!1;var r=Mt(e.a);return 0==t.drmInfos.length||t.drmInfos.some(function(e){return e.keySystem==r})}function jt(e,t){if(!e.length)return t;if(!t.length)return e;for(var n=[],i=0;i<e.length;i++)for(var r=0;r<t.length;r++)if(e[i].keySystem==t[r].keySystem){var a=e[i],r=t[r],o=[];o=(o=o.concat(a.initData||[])).concat(r.initData||[]);var s=[];s=(s=s.concat(a.keyIds)).concat(r.keyIds),n.push({keySystem:a.keySystem,licenseServerUri:a.licenseServerUri||r.licenseServerUri,distinctiveIdentifierRequired:a.distinctiveIdentifierRequired||r.distinctiveIdentifierRequired,persistentStateRequired:a.persistentStateRequired||r.persistentStateRequired,videoRobustness:a.videoRobustness||r.videoRobustness,audioRobustness:a.audioRobustness||r.audioRobustness,serverCertificate:a.serverCertificate||r.serverCertificate,initData:o,keyIds:s});break}return n}function Kt(n){return G(function e(){var t;return q(e,function(e){if(1===e.o)return t=Array.from(n.b.keys()),n.b.clear(),V(e,Promise.all(t.map(function(t){return G(function e(){return q(e,function(e){switch(e.o){case 1:return X.I("Closing session",t.sessionId),z(e,2),V(e,(n=t,G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return t=new Promise(function(e,t){new ke(t).R(Vt)}),z(e,2),V(e,Promise.race([Promise.all([n.close(),n.closed]),t]),4);case 4:H(e,0);break;case 2:W(e),X.u("Timeout waiting for session close"),x(e)}})})),4);case 4:H(e,0);break;case 2:W(e),x(e)}var n})})})),0)})})}function Bt(e){return Y(e=e.b.values(),function(e){return e.loaded})}function Gt(e,t,n){!e.keySystem||"org.w3.clearkey"==e.keySystem&&e.licenseServerUri||(t.size&&(t=t.get(e.keySystem)||"",e.licenseServerUri=t),e.keyIds||(e.keyIds=[]),(n=n.get(e.keySystem))&&(e.distinctiveIdentifierRequired||(e.distinctiveIdentifierRequired=n.distinctiveIdentifierRequired),e.persistentStateRequired||(e.persistentStateRequired=n.persistentStateRequired),e.videoRobustness||(e.videoRobustness=n.videoRobustness),e.audioRobustness||(e.audioRobustness=n.audioRobustness),e.serverCertificate||(e.serverCertificate=n.serverCertificate)),d.cast&&d.cast.__platform__&&"com.microsoft.playready"==e.keySystem&&(e.keySystem="com.chromecast.playready"))}_("shaka.util.Uint8ArrayUtils.toBase64",At.gd),At.Za=function(e){e=d.atob(e.replace(/-/g,"+").replace(/_/g,"/"));for(var t=new Uint8Array(e.length),n=0;n<e.length;++n)t[n]=e.charCodeAt(n);return t},_("shaka.util.Uint8ArrayUtils.fromBase64",At.Za),At.vd=function(e){for(var t=new Uint8Array(e.length/2),n=0;n<e.length;n+=2)t[n/2]=d.parseInt(e.substr(n,2),16);return t},_("shaka.util.Uint8ArrayUtils.fromHex",At.vd),At.hd=function(e){for(var t="",n=0;n<e.length;++n){var i=e[n].toString(16);1==i.length&&(i="0"+i),t+=i}return t},_("shaka.util.Uint8ArrayUtils.toHex",At.hd),At.Xa=function(e,t){if(!e&&!t)return!0;if(!e||!t||e.length!=t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!=t[n])return!1;return!0},_("shaka.util.Uint8ArrayUtils.equal",At.Xa),At.concat=function(e){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];for(var i=n=0;i<t.length;++i)n+=t[i].length;n=new Uint8Array(n);for(var r=i=0;r<t.length;++r)n.set(t[r],i),i+=t[r].length;return n},_("shaka.util.Uint8ArrayUtils.concat",At.concat),(e=It.prototype).destroy=function(){var n=this;return G(function e(){return q(e,function(e){switch(e.o){case 1:return n.c?V(e,n.ia,0):(n.c=!0,V(e,(t=n,G(function e(){return q(e,function(e){switch(e.o){case 1:return t.l.release(),t.l=null,t.v.reject(),t.Z.stop(),t.Z=null,t.L.stop(),t.L=null,V(e,Kt(t),2);case 2:if(t.j)return z(e,4),V(e,t.j.setMediaKeys(null),6);e.C(3);break;case 6:H(e,5);break;case 4:W(e);case 5:t.j=null;case 3:t.a=null,t.w.clear(),t.s=null,t.B=[],t.f=null,t.g=null,t.G=null,x(e)}})})),4));case 4:n.ia.resolve(),e.C(0)}var t})})},e.configure=function(e){this.f=e},e.kc=function(e){var t=this;if(!this.s)return this.l.Ha(e,"encrypted",function(){t.g(new Pe(2,6,6010))}),Promise.resolve();this.j=e,this.l.Ha(this.j,"play",function(){for(var e=0;e<t.J.length;e++)Ot(t,t.J[e]);t.ka=!0,t.J=[]}),"webkitCurrentPlaybackTargetIsWireless"in this.j&&this.l.m(this.j,"webkitcurrentplaybacktargetiswirelesschanged",function(){return Kt(t)}),e=(e=this.j.setMediaKeys(this.s)).catch(function(e){return Promise.reject(new Pe(2,6,6003,e.message))});var n=xt(this);return Promise.all([e,n]).then(function(){return t.c?Promise.reject():(Nt(t),void(t.a.initData.length||t.B.length||t.l.m(t.j,"encrypted",function(e){return Pt(t,e.initDataType,new Uint8Array(e.initData))})))}).catch(function(e){if(!t.c)return Promise.reject(e)})},e.nc=function(){for(var e=1/0,t=this.b.keys(),n=(t=B(t)).next();!n.done;n=t.next())n=n.value,isNaN(n.expiration)||(e=Math.min(e,n.expiration));return e},e.cf=function(e){this.j&&this.f.delayLicenseRequestUntilPlayed&&this.j.paused&&!this.ka?this.J.push(e):Ot(this,e)},e.$e=function(e){e=e.target,X.N("Key status changed for session",e.sessionId);var o=this.b.get(e),s=!1;e.keyStatuses.forEach(function(e,t){var n,i,r,a;"string"==typeof t&&(n=t,t=e,e=n),"com.microsoft.playready"==this.a.keySystem&&16==t.byteLength&&(ft("Trident/")||lt())&&(i=(n=new DataView(t)).getUint32(0,!0),r=n.getUint16(4,!0),a=n.getUint16(6,!0),n.setUint32(0,i,!1),n.setUint16(4,r,!1),n.setUint16(6,a,!1)),"com.microsoft.playready"==this.a.keySystem&&"status-pending"==e&&(e="usable"),"status-pending"!=e&&(o.loaded=!0),"expired"==e&&(s=!0),n=At.hd(new Uint8Array(t)),this.na.set(n,e)}.bind(this));var t=e.expiration-Date.now();(t<0||s&&t<1e3)&&o&&!o.Va&&(X.debug("Session has expired",e.sessionId),this.b.delete(e),e.close().catch(function(){})),Bt(this)&&(this.v.resolve(),this.L.R(Ht))};var Vt=1,zt=5,Ht=.5;function Wt(){this.a=new muxjs.mp4.CaptionParser,this.g=[],this.f={}}function qt(){}function Xt(e){return e&&!(1==e.length&&e.end(0)-e.start(0)<1e-6)&&e.length?e.end(e.length-1):null}function Yt(e,t,n){return n=void 0===n?0:n,!(!e||!e.length||1==e.length&&e.end(0)-e.start(0)<1e-6||t>e.end(e.length-1))&&t+n>=e.start(0)}function $t(e,t){if(!e||!e.length||1==e.length&&e.end(0)-e.start(0)<1e-6)return 0;for(var n=0,i=e.length-1;0<=i&&e.end(i)>t;--i)n+=e.end(i)-Math.max(e.start(i),t);return n}function Jt(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}Wt.prototype.init=function(e){var t=muxjs.mp4.probe;e=new Uint8Array(e),this.g=t.videoTrackIds(e),this.f=t.timescale(e),this.a.init()},Wt.prototype.b=function(e,t){e=new Uint8Array(e);(e=this.a.parse(e,this.g,this.f))&&e.captions&&t(e.captions),this.a.clearParsedCaptions()},Wt.prototype.c=function(){this.a.resetCaptionStream()},qt.prototype.init=function(){},qt.prototype.b=function(){},qt.prototype.c=function(){};var Zt={Pf:function(e,t){return e.reduce(function(e,t,n){return t.catch(e.bind(null,n))}.bind(null,t),Promise.reject())},nd:function(e,t){return e.concat(t)},Uc:function(){},jb:function(e){return null!=e}};function Qt(e,t){if(0==t.length)return e;var n=t.map(function(e){return new he(e)});return e.map(function(e){return new he(e)}).map(function(e){return n.map(e.resolve.bind(e))}).reduce(Zt.nd,[]).map(function(e){return e.toString()})}function en(e,t){return{keySystem:e,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:t||[],keyIds:[]}}var tn={tb:"video",jc:"audio",Oa:"text",Mh:"image",Kh:"application"},nn=1/15;function rn(){this.a=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0}),this.b=null,this.g=[],this.c=[],this.f=!1,this.a.on("data",this.l.bind(this)),this.a.on("done",this.j.bind(this))}function an(e,t){return!(!d.muxjs||"mp2t"!=e.toLowerCase().split(";")[0].split("/")[1])&&(t?MediaSource.isTypeSupported(on(t,e)):MediaSource.isTypeSupported(on("audio",e))||MediaSource.isTypeSupported(on("video",e)))}function on(e,t){var n=t.replace(/mp2t/i,"mp4");"audio"==e&&(n=n.replace("video","audio"));var i=/avc1\.(66|77|100)\.(\d+)/.exec(n);return i&&(t="avc1.",t=("66"==(e=i[1])?t+"4200":"77"==e?t+"4d00":t+"6400")+((e=Number(i[2]))>>4).toString(16),t+=(15&e).toString(16),n=n.replace(i[0],t)),n}function sn(e,t,n){this.startTime=e,this.direction=pn,this.endTime=t,this.payload=n,this.region=new Tn,this.position=null,this.positionAlign=cn,this.size=0,this.textAlign=ln,this.writingMode=mn,this.lineInterpretation=gn,this.line=null,this.lineHeight="",this.lineAlign=vn,this.displayAlign=hn,this.fontSize=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=yn,this.fontStyle=En,this.fontFamily="",this.textDecoration=[],this.wrapLine=!0,this.id="",this.nestedCues=[],this.spacer=!1}function un(e,t){for(var n in e)if("nestedCues"==n){if(!Ge(e.nestedCues,t.nestedCues,un))return!1}else if("region"==n||"cellResolution"==n){for(var i in e[n])if(e[n][i]!=t[n][i])return!1}else if(Array.isArray(e[n])){if(!Ge(e[n],t[n]))return!1}else if(e[n]!=t[n])return!1;return!0}rn.prototype.destroy=function(){return this.a.dispose(),this.a=null,Promise.resolve()},rn.prototype.l=function(e){this.c=e.captions;var t=new Uint8Array(e.data.byteLength+e.initSegment.byteLength);t.set(e.initSegment,0),t.set(e.data,e.initSegment.byteLength),this.g.push(t)},rn.prototype.j=function(){var e={data:At.concat.apply(null,this.g),captions:this.c};this.b.resolve(e),this.f=!1},_("shaka.text.Cue",sn),sn.prototype.clone=function(){var e,t=new sn(0,0,"");for(e in this)t[e]=this[e],t[e]&&t[e].constructor==Array&&(t[e]=t[e].slice());return t};var cn="auto";sn.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:cn};var ln="center",dn={LEFT:"left",RIGHT:"right",CENTER:ln,START:"start",END:"end"};sn.textAlign=dn;var hn="after",fn={BEFORE:"before",CENTER:"center",AFTER:hn};sn.displayAlign=fn;var pn="ltr";sn.direction={HORIZONTAL_LEFT_TO_RIGHT:pn,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var mn="horizontal-tb";sn.writingMode={HORIZONTAL_TOP_TO_BOTTOM:mn,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var gn=0;sn.lineInterpretation={LINE_NUMBER:gn,PERCENTAGE:1};var vn="start",bn={CENTER:"center",START:vn,END:"end"};sn.lineAlign=bn;var yn=400;sn.fontWeight={NORMAL:yn,BOLD:700};var En="normal",wn={NORMAL:En,ITALIC:"italic",OBLIQUE:"oblique"};function Tn(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=Sn,this.scroll=An}sn.fontStyle=wn,sn.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"},_("shaka.text.CueRegion",Tn);var Sn=1;Tn.units={PX:0,PERCENTAGE:Sn,LINES:2};var An="";function In(e){this.g=null,this.c=e,this.f=this.v=0,this.j=1/0,this.b=this.a=null,this.s="",this.l=new Map}Tn.scrollMode={NONE:An,UP:"up"};var kn={};function Cn(e){return!!(kn[e]||d.muxjs&&"application/cea-608"==e)}function xn(e,t){"application/cea-608"!=t&&(e.g=new kn[t])}function Nn(e,t,n,i,r){for(var a=n+" "+i,o=new Map,s=(t=B(t)).next();!s.done;s=t.next()){var u=s.value,s=u.stream;o.has(s)||o.set(s,new Map),o.get(s).has(a)||o.get(s).set(a,[]),u.startTime+=r,u.endTime+=r,u.startTime>=e.f&&u.startTime<e.j&&(u=new sn(u.startTime,u.endTime,u.text),o.get(s).get(a).push(u),s==e.s&&e.c.append([u]))}for(a=(r=B(o.keys())).next();!a.done;a=r.next())for(a=a.value,e.l.has(a)||e.l.set(a,new Map),s=(t=B(o.get(a).keys())).next();!s.done;s=t.next())s=s.value,u=o.get(a).get(s),e.l.get(a).set(s,u);e.a=null==e.a?Math.max(n,e.f):Math.min(e.a,Math.max(n,e.f)),e.b=Math.max(e.b,Math.min(i,e.j))}function Pn(e,t,n){this.f=e,this.g=n,this.b={},this.a=null,this.c={},this.l=new Ze,this.B=!1,this.s={},this.v=t,e=this.w=new Me,t=new MediaSource,this.l.Ha(t,"sourceopen",e.resolve),this.f.src=Mn(t),this.j=t}_("shaka.text.TextEngine.registerParser",function(e,t){kn[e]=t}),_("shaka.text.TextEngine.unregisterParser",function(e){delete kn[e]}),In.prototype.destroy=function(){return this.c=this.g=null,this.l.clear(),Promise.resolve()},In.prototype.Rc=function(e){try{return this.g.parseMedia(new Uint8Array(e),{periodStart:0,segmentStart:null,segmentEnd:0})[0].startTime}catch(e){throw new Pe(2,2,2009,e)}},In.prototype.remove=function(e,t){return Promise.resolve().then(function(){!this.c||!this.c.remove(e,t)||null==this.a||t<=this.a||e>=this.b||(e<=this.a&&t>=this.b?this.a=this.b=null:e<=this.a&&t<this.b?this.a=t:e>this.a&&t>=this.b&&(this.b=e))}.bind(this))};var Mn=d.URL.createObjectURL;function Rn(e){var n,i,t=at(e.mimeType,e.codecs),r=(i=[(n=e).mimeType],st.forEach(function(e,t){t=n[t];t&&i.push(e+'="'+t+'"')}),i.join(";"));return Cn(t)||MediaSource.isTypeSupported(r)||an(t,e.type)}function Ln(e,t){e.a||(e.a=new In(e.g)),xn(e.a,t)}function Un(e){return!e.j||"ended"==e.j.readyState}function _n(e,t){var n="text"==t?e.a.a:!(n=Dn(e,t))||1==n.length&&n.end(0)-n.start(0)<1e-6?null:1==n.length&&n.start(0)<0?0:n.length?n.start(0):null;return n}function On(e,t){return"text"==t?e.a.b:Xt(Dn(e,t))}function Dn(t,n){try{return t.b[n].buffered}catch(e){return n in t.b&&X.error("failed to get buffered range for "+n,e),null}}function Fn(t,n,e,i,r,a){return"text"==n?(l=t.a,o=e,s=i,u=r,Promise.resolve().then(function(){var e;this.g&&this.c&&(null==s||null==u?this.g.parseInit(new Uint8Array(o)):(e={periodStart:this.v,segmentStart:s,segmentEnd:u},e=this.g.parseMedia(new Uint8Array(o),e).filter(function(e){return e.startTime>=this.f&&e.startTime<this.j}.bind(this)),this.c.append(e),null==this.a&&(this.a=Math.max(s,this.f)),this.b=Math.min(u,this.j)))}.bind(l))):t.s[n]?(c=t.s[n],l=e,c.f=!0,c.b=new Me,c.g=[],c.c=[],l=new Uint8Array(l),c.a.push(l),c.a.flush(),c.f&&c.b.reject(new Pe(2,3,3018)),c.b.then(function(e){return this.a||Ln(this,"text/vtt"),e.captions&&e.captions.length&&Nn(this.a,e.captions,i,r,this.b.video.timestampOffset),Bn(this,n,this.wf.bind(this,n,e.data.buffer))}.bind(t))):(a&&d.muxjs&&(t.a||Ln(t,"text/vtt"),null==i&&null==r?t.v.init(e):t.v.b(e,function(e){e.length&&Nn(t.a,e,i,r,t.b.video.timestampOffset)})),Bn(t,n,t.wf.bind(t,n,e)));var o,s,u,c,l}function jn(e,t){var n=On(e,"video")||0;!function(e,t,n){if(e.s=t,t=e.l.get(t))for(var i=B(t.keys()),r=i.next();!r.done;r=i.next())(r=t.get(r.value).filter(function(e){return e.endTime<=n}))&&e.c.append(r)}(e.a,t,n)}function Kn(e,t){return"text"==t?e.a?(e.v.c(),e.a.remove(0,1/0)):Promise.resolve():Bn(e,t,e.xf.bind(e,t,0,e.j.duration))}function Bn(t,n,i){if(t.B)return Promise.reject();if(i={start:i,p:new Me},t.c[n].push(i),1==t.c[n].length)try{i.start()}catch(e){"QuotaExceededError"==e.name?i.p.reject(new Pe(2,3,3017,n)):i.p.reject(new Pe(2,3,3015,e)),Vn(t,n)}return i.p}function Gn(e,n){if(e.B)return Promise.reject();var t,i=[];for(t in e.b){var r=new Me,a={start:function(e){e.resolve()}.bind(null,r),p:r};e.c[t].push(a),i.push(r),1==e.c[t].length&&a.start()}return Promise.all(i).then(function(){try{n()}catch(e){var t=Promise.reject(new Pe(2,3,3015,e))}for(var e in this.b)Vn(this,e);return t}.bind(e),function(e){throw e}.bind(e))}function Vn(t,n){t.c[n].shift();var i=t.c[n][0];if(i)try{i.start()}catch(e){i.p.reject(new Pe(2,3,3015,e)),Vn(t,n)}}(e=Pn.prototype).destroy=function(){var e=this;this.B=!0;var t,n,i=[];for(t in this.c){var r=this.c[t],a=r[0];for(this.c[t]=r.slice(0,1),a&&i.push(a.p.catch(Zt.Uc)),a=1;a<r.length;++a)r[a].p.reject()}for(n in this.a&&i.push(this.a.destroy()),this.g&&i.push(this.g.destroy()),this.s)i.push(this.s[n].destroy());return Promise.all(i).then(function(){e.l&&(e.l.release(),e.l=null),e.f&&(e.f.removeAttribute("src"),e.f.load(),e.f=null),e.j=null,e.a=null,e.g=null,e.b={},e.s={},e.v=null,e.c={}})},e.init=function(t,i){var r=this;return G(function e(){var n;return q(e,function(e){switch(e.o){case 1:return n=tn,V(e,r.w,2);case 2:t.forEach(function(e,t){e=at(e.mimeType,e.codecs);t==n.Oa?Ln(r,e):(!i&&MediaSource.isTypeSupported(e)||!an(e,t)||(r.s[t]=new rn,e=on(t,e)),e=r.j.addSourceBuffer(e),r.l.m(e,"error",r.wh.bind(r,t)),r.l.m(e,"updateend",r.bc.bind(r,t)),r.b[t]=e,r.c[t]=[])}),x(e)}})})},e.wd=function(e){var t,n;e.total=Jt(this.f.buffered),e.audio=Jt(Dn(this,"audio")),e.video=Jt(Dn(this,"video")),e.text=[],this.a&&(t=this.a.a,n=this.a.b,null!=t&&null!=n&&e.text.push({start:t,end:n}))},e.remove=function(e,t,n){return"text"==e?this.a.remove(t,n):Bn(this,e,this.xf.bind(this,e,t,n))},e.flush=function(e){return"text"==e?Promise.resolve():Bn(this,e,this.Uf.bind(this,e))},e.endOfStream=function(e){return Gn(this,function(){Un(this)||(e?this.j.endOfStream(e):this.j.endOfStream())}.bind(this))},e.Ua=function(e){return Gn(this,function(){this.j.duration=e}.bind(this))},e.ra=function(){return this.j.duration},e.wf=function(e,t){this.b[e].appendBuffer(t)},e.xf=function(e,t,n){n<=t?this.bc(e):this.b[e].remove(t,n)},e.If=function(e){var t=this.b[e].appendWindowStart,n=this.b[e].appendWindowEnd;this.b[e].abort(),this.b[e].appendWindowStart=t,this.b[e].appendWindowEnd=n,this.bc(e)},e.Uf=function(e){this.f.currentTime-=.001,this.bc(e)},e.vh=function(e,t){t<0&&(t+=.001),this.b[e].timestampOffset=t,this.bc(e)},e.rh=function(e,t,n){this.b[e].appendWindowStart=0,this.b[e].appendWindowEnd=n,this.b[e].appendWindowStart=t,this.bc(e)},e.wh=function(e){this.c[e][0].p.reject(new Pe(2,3,3014,this.f.error?this.f.error.code:0))},e.bc=function(e){var t=this.c[e][0];t&&(t.p.resolve(),Vn(this,e))};var zn={De:function(e,t){function n(e){var t="";e.video&&(t=ot(e.video.codecs)[0]);var n="";return e.audio&&(n=ot(e.audio.codecs)[0]),t+"-"+n}for(var i=e.periods.reduce(function(e,t){return e.concat(t.variants)},[]),i=zn.Ie(i,t),r=new F,a=(i=B(i)).next();!a.done;a=i.next()){var o=n(a=a.value);r.push(o,a)}var s=null,u=1/0;for(r.forEach(function(e,t){for(var n=0,i=0,r=B(t),a=r.next();!a.done;a=r.next())n+=a.value.bandwidth||0,++i;n/=i,X.debug("codecs",e,"avg bandwidth",n),n<u&&(s=e,u=n)}),i=(r=B(e.periods)).next();!i.done;i=r.next())(i=i.value).variants=i.variants.filter(function(e){return n(e)==s||(X.debug("Dropping Variant (better codec available)",e),!1)})},Jd:function(e,t,n){function i(e,t,n){return t<=e&&e<=n}var r=e.video;return!(r&&r.width&&r.height&&(!i(r.width,t.minWidth,Math.min(t.maxWidth,n.width))||!i(r.height,t.minHeight,Math.min(t.maxHeight,n.height))||!i(r.width*r.height,t.minPixels,t.maxPixels))||e&&e.video&&e.video.frameRate&&!i(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||!i(e.bandwidth,t.minBandwidth,t.maxBandwidth))},we:function(e,n,i){var r=!1;return e.forEach(function(e){var t=e.allowedByApplication;e.allowedByApplication=zn.Jd(e,n,i),t!=e.allowedByApplication&&(r=!0)}),r},filterNewPeriod:function(n,i,r,e){e.variants=e.variants.filter(function(e){if(n&&n.O&&!Ft(n,e))return X.debug("Dropping variant - not compatible with key system",e),!1;var t=e.audio;return e=e.video,t&&!Rn(t)?(X.debug("Dropping variant - audio not compatible with platform",zn.Tb(t)),!1):e&&!Rn(e)?(X.debug("Dropping variant - video not compatible with platform",zn.Tb(e)),!1):t&&i&&!zn.xe(t,i)?(X.debug("Droping variant - not compatible with active audio","active audio",zn.Tb(i),"variant.audio",zn.Tb(t)),!1):!(e&&r&&!zn.xe(e,r))||(X.debug("Droping variant - not compatible with active video","active video",zn.Tb(r),"variant.video",zn.Tb(e)),!1)}),e.textStreams=e.textStreams.filter(function(e){var t=Cn(at(e.mimeType,e.codecs));return t||X.debug("Dropping text stream. Is not supported by the platform.",e),t})},xe:function(e,t){return e.mimeType==t.mimeType&&e.codecs.split(".")[0]==t.codecs.split(".")[0]},ue:function(e){var t=e.audio,n=e.video,i=t?t.codecs:null,r=n?n.codecs:null,a=[];r&&a.push(r),i&&a.push(i);var o=[];n&&o.push(n.mimeType),t&&o.push(t.mimeType),o=o[0]||null;var s=[];t&&s.push(t.kind),n&&s.push(n.kind),s=s[0]||null;var u=new Set;return t&&t.roles.forEach(function(e){return u.add(e)}),n&&n.roles.forEach(function(e){return u.add(e)}),e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:s,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:o,codecs:a.join(", "),audioCodec:i,videoCodec:r,primary:e.primary,roles:Array.from(u),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null},n&&(e.videoId=n.id,e.originalVideoId=n.originalId,e.width=n.width||null,e.height=n.height||null,e.frameRate=n.frameRate||null,e.pixelAspectRatio=n.pixelAspectRatio||null,e.videoBandwidth=n.bandwidth||null),t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.label=t.label,e.audioRoles=t.roles),e},fd:function(e){return{id:e.id,active:!1,type:"text",bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:e.mimeType,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId}},Bd:function(e){return e.__shaka_id||(e.__shaka_id=zn.Kg++),e.__shaka_id},Kg:0,Bg:function(e){var t=zn.Oe(e);return t.active="disabled"!=e.mode,t.type="text",t.originalTextId=e.id,"captions"==e.kind&&(t.mimeType="application/cea-608"),e.kind&&(t.roles=[e.kind]),t},Ne:function(e){var t=zn.Oe(e);return t.active=e.enabled,t.type="variant",t.originalAudioId=e.id,"main"==e.kind&&(t.primary=!0),e.kind&&(t.roles=[e.kind],t.audioRoles=[e.kind]),t},Oe:function(e){return{id:zn.Bd(e),active:!1,type:"",bandwidth:0,language:Q(e.language),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null}},Xb:function(e){return e.allowedByApplication&&e.allowedByKeySystem},qg:function(e){return e.filter(function(e){return zn.Xb(e)})},Ie:function(e,t){for(var n=e.filter(function(e){return e.audio&&e.audio.channelsCount}),i=new Map,r=(n=B(n)).next();!r.done;r=n.next()){var a=(r=r.value).audio.channelsCount;i.has(a)||i.set(a,[]),i.get(a).push(r)}return 0==(n=Array.from(i.keys())).length?e:(r=n.filter(function(e){return e<=t})).length?i.get(Math.max.apply(null,r)):i.get(Math.min.apply(null,n))},mc:function(e,t,n){var i=e,r=e.filter(function(e){return e.primary});r.length&&(i=r);var a,o=i.length?i[0].language:"",i=i.filter(function(e){return e.language==o});if(!t||(a=ne(Q(t),e.map(function(e){return e.language})))&&(i=e.filter(function(e){return Q(e.language)==a})),n){if((e=zn.He(i,n)).length)return e;X.u("No exact match for the text role could be found.")}else if((e=i.filter(function(e){return 0==e.roles.length})).length)return e;return(e=i.map(function(e){return e.roles}).reduce(Zt.nd,[])).length?zn.He(i,e[0]):i},He:function(e,t){return e.filter(function(e){return e.roles.includes(t)})},Me:function(e,t,n){for(var i=0;i<n.length;i++)if(n[i].audio==e&&n[i].video==t)return n[i];return null},Cg:function(e){return"audio"==e.type},Gg:function(e){return"video"==e.type},yg:function(e){var t=[];return e.audio&&t.push(e.audio),e.video&&t.push(e.video),t},Tb:function(e){return zn.Cg(e)?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:zn.Gg(e)?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"}};function Hn(){this.j=null,this.f=!1,this.b=new le,this.g=[],this.l=!1,this.a=this.c=null}function Wn(t,e){return t&&(e=e.filter(function(e){return zn.Jd(e,t,{width:1/0,height:1/0})})),e.sort(function(e,t){return e.bandwidth-t.bandwidth})}function qn(e,t){this.a=e,this.b=t}function Xn(e,t){var n=new qn(2,6),i=Jn.a,r=n.b-i.b;(0<(n.a-i.a||r)?Jn.c:Jn.b)(Jn.a,n,e,t)}function Yn(e,t,n,i){X.ba([n,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",i].join(" "))}function $n(e,t,n,i){X.Hc([n,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",i].join(""))}_("shaka.abr.SimpleAbrManager",Hn),Hn.prototype.stop=function(){this.j=null,this.f=!1,this.g=[],this.c=null},Hn.prototype.init=function(e){this.j=e},Hn.prototype.chooseVariant=function(){var e=Wn(this.a.restrictions,this.g),t=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);this.g.length&&!e.length&&(X.u("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),e=[(e=Wn(null,this.g))[0]]);for(var n=e[0]||null,i=0;i<e.length;++i){var r=e[i],a=r.bandwidth/this.a.bandwidthDowngradeTarget,o=(e[i+1]||{bandwidth:1/0}).bandwidth/this.a.bandwidthUpgradeTarget;X.N("Bandwidth ranges:",(r.bandwidth/1e6).toFixed(3),(a/1e6).toFixed(3),(o/1e6).toFixed(3)),a<=t&&t<=o&&(n=r)}return this.c=Date.now(),n},Hn.prototype.enable=function(){this.f=!0},Hn.prototype.disable=function(){this.f=!1},Hn.prototype.segmentDownloaded=function(e,t){X.N("Segment downloaded:","deltaTimeMs="+e,"numBytes="+t,"lastTimeChosenMs="+this.c,"enabled="+this.f);var n,i=this.b;if(t<16e3||(n=8e3*t/e,e=e/1e3,i.a+=t,ue(i.b,e,n),ue(i.c,e,n)),null!=this.c&&this.f)e:{if(X.N("Suggesting Streams..."),this.l){if(Date.now()-this.c<1e3*this.a.switchInterval){X.N("Still within switch interval...");break e}}else{if(!(128e3<=this.b.a)){X.N("Still waiting for a good estimate...");break e}this.l=!0}i=this.chooseVariant(),n=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate),X.debug("Calling switch_(), bandwidth="+Math.round(n/1e3)+" kbps"),this.j(i)}},Hn.prototype.getBandwidthEstimate=function(){return this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate)},Hn.prototype.setVariants=function(e){this.g=e},Hn.prototype.configure=function(e){this.a=e},qn.prototype.toString=function(){return"v"+this.a+"."+this.b};var Jn=null,Zn="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),Qn="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),ei=["loop","playbackRate"],ti=["pause","play"],ni="abrstatuschanged adaptation buffering drmsessionupdate emsg error expirationupdated largegap loading manifestparsed onstatechange onstateidle streaming textchanged texttrackvisibility timelineregionadded timelineregionenter timelineregionexit trackschanged unloading variantchanged".split(" "),ii={getAssetUri:2,getAudioLanguages:2,getAudioLanguagesAndRoles:2,getBufferedInfo:2,getConfiguration:2,getExpiration:2,getPlaybackRate:2,getTextLanguages:2,getTextLanguagesAndRoles:2,getTextTracks:2,getStats:5,getVariantTracks:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,usingEmbeddedTextTrack:2,getLoadMode:10},ri={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},ai=[["getConfiguration","configure"]],oi=[["isTextTrackVisible","setTextTrackVisibility"]],si="addTextTrack cancelTrickPlay configure resetConfiguration retryStreaming selectAudioLanguage selectEmbeddedTextTrack selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay".split(" "),ui=["attach","detach","load","unload"];function ci(e){return JSON.stringify(e,function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof D){var n={};for(r in t){var i=t[r];i&&"object"==typeof i?"detail"==r&&(n[r]=i):r in Event||(n[r]=i)}return n}if(t instanceof Error){var r=new Set(["name","message","stack"]);for(n in t)r.add(n);for(n=(i=B(Object.getOwnPropertyNames(t))).next();!n.done;n=i.next())r.add(n.value);for(i={},n=(r=B(r)).next();!n.done;n=r.next())i[n=n.value]=t[n];r={__type__:"Error",contents:i}}else if(t instanceof TimeRanges)for(r={__type__:"TimeRanges",length:t.length,start:[],end:[]},n=0;n<t.length;++n)r.start.push(t.start(n)),r.end.push(t.end(n));else r=t instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(t)}:"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:t<0?"-Infinity":"Infinity":t;return r}})}function li(e){return JSON.parse(e,function(e,t){if("NaN"==t)var n=NaN;else if("-Infinity"==t)n=-1/0;else if("Infinity"==t)n=1/0;else if(t&&"object"==typeof t&&"TimeRanges"==t.__type__)n={length:(a=t).length,start:function(e){return a.start[e]},end:function(e){return a.end[e]}};else if(t&&"object"==typeof t&&"Uint8Array"==t.__type__)n=new Uint8Array(t.entries);else if(t&&"object"==typeof t&&"Error"==t.__type__){n=t.contents;var i,r=Error(n.message);for(i in n)r[i]=n[i];n=r}else n=t;var a;return n})}function di(e,t,n,i,r,a){this.L=e,this.f=new ke(t),this.O=n,this.s=!1,this.B=i,this.K=r,this.H=a,this.b=this.j=!1,this.J="",this.l=null,this.v=this.Rd.bind(this),this.w=this.Rg.bind(this),this.a={video:{},player:{}},this.G=0,this.c={},this.g=null,bi.add(this)}var hi=!1,fi=null;function pi(e,t){X.debug("CastSender: onExistingSessionJoined");var n=e.H();e.g=new Me,e.s=!0,e.Td(n,t)}function mi(e){var t=fi;t.removeUpdateListener(e.v),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.w)}function gi(e){for(var t in e.c){var n=e.c[t];delete e.c[t],n.reject(new Pe(1,7,7e3))}}function vi(t,e){var n=ci(e),i=fi;try{i.sendMessage("urn:x-cast:com.google.shaka.v2",n,function(){},X.error)}catch(e){throw X.error("Cast session sendMessage threw",e),n=new Pe(2,8,8005,e),t.B("player",new D("error",{detail:n})),t.Qb(),n}}(e=di.prototype).destroy=function(){return bi.delete(this),gi(this),fi&&mi(this),this.f&&(this.f.stop(),this.f=null),this.K=this.B=null,this.b=this.j=!1,this.w=this.v=this.g=this.c=this.a=this.l=null,Promise.resolve()},e.ha=function(){return this.b},e.bd=function(){return this.J},e.init=function(){var e;d.chrome&&chrome.cast&&chrome.cast.isAvailable&&this.L.length&&(this.j=!0,this.f.gb(),e=new chrome.cast.SessionRequest(this.L),e=new chrome.cast.ApiConfig(e,function(e){for(var t=B(bi),n=t.next();!n.done;n=t.next())pi(n.value,e)}.bind(this),function(e){for(var t=B(bi),n=t.next();!n.done;n=t.next()){n=n.value;var i=e;X.debug("CastSender: receiver status",i),hi="available"==i,n.f.gb()}}.bind(this),"origin_scoped"),chrome.cast.initialize(e,function(){X.debug("CastSender: init")},function(e){X.error("CastSender: init error",e)}),hi&&this.f.R(.02),(e=fi)&&e.status!=chrome.cast.SessionStatus.STOPPED?(X.debug("CastSender: re-using existing connection"),pi(this,e)):fi=null)},e.be=function(e){this.l=e,this.b&&vi(this,{type:"appData",appData:this.l})},e.cast=function(e){return this.j?hi?this.b?Promise.reject(new Pe(1,8,8002)):(this.g=new Me,chrome.cast.requestSession(this.Td.bind(this,e),this.Ze.bind(this)),this.g):Promise.reject(new Pe(1,8,8001)):Promise.reject(new Pe(1,8,8e3))},e.Qb=function(){if(this.b){if(gi(this),fi){mi(this);try{fi.stop(function(){},function(){})}catch(e){}fi=null}this.Rd()}},e.get=function(e,t){if("video"==e){if(ti.includes(t))return this.mf.bind(this,e,t)}else if("player"==e){if(ri[t]&&!this.get("player","isLive")())return function(){};if(si.includes(t))return this.mf.bind(this,e,t);if(ui.includes(t))return this.ih.bind(this,e,t);if(ii[t])return this.gf.bind(this,e,t)}return this.gf(e,t)},e.set=function(e,t,n){this.a[e][t]=n,vi(this,{type:"set",targetName:e,property:t,value:n})},e.Td=function(e,t){X.debug("CastSender: onSessionInitiated"),(fi=t).addUpdateListener(this.v),t.addMessageListener("urn:x-cast:com.google.shaka.v2",this.w),this.Rd(),vi(this,{type:"init",initState:e,appData:this.l}),this.g.resolve()},e.Ze=function(e){var t=8003;switch(e.code){case"cancel":t=8004;break;case"timeout":t=8005;break;case"receiver_unavailable":t=8006}this.g.reject(new Pe(2,8,t,e))},e.gf=function(e,t){return this.a[e][t]},e.mf=function(e,t,n){for(var i=[],r=2;r<arguments.length;++r)i[r-2]=arguments[r];vi(this,{type:"call",targetName:e,methodName:t,args:i})},e.ih=function(e,t,n){for(var i=[],r=2;r<arguments.length;++r)i[r-2]=arguments[r];r=new Me;var a=this.G.toString();this.G++,this.c[a]=r;try{vi(this,{type:"asyncCall",targetName:e,methodName:t,args:i,id:a})}catch(e){r.reject(e)}return r},e.Rd=function(){var e=!!fi&&"connected"==fi.status;if(X.debug("CastSender: connection status",e),this.b&&!e){for(var t in this.K(),this.a)this.a[t]={};gi(this)}this.J=(this.b=e)?fi.receiver.friendlyName:"",this.f.gb()},e.Rg=function(e,t){var n=li(t);switch(X.N("CastSender: message",n),n.type){case"event":var i=n.event;this.B(n.targetName,new D(i.type,i));break;case"update":for(var r in i=n.update)for(var a in n=this.a[r]||{},i[r])n[a]=i[r][a];this.s&&(this.O(),this.s=!1);break;case"asyncComplete":if(r=n.id,n=n.error,a=this.c[r],delete this.c[r],a)if(n){for(i in r=new Pe(n.severity,n.category,n.code),n)r[i]=n[i];a.reject(r)}else a.resolve()}};var bi=new Set;function yi(e,t,n){var i=this;j.call(this),this.c=e,this.b=t,this.l=this.g=this.f=this.s=this.j=null,this.w=n,this.v=new Map,this.a=new di(n,function(){return Ti(i)},function(){return Si(i)},function(e,t){return Ii(i,e,t)},function(){return Ai(i)},function(){return wi(i)}),function(t){for(var e in t.a.init(),t.l=new Ze,Zn.forEach(function(e){this.l.m(this.c,e,this.H.bind(this))}.bind(t)),ni.forEach(function(e){this.l.m(this.b,e,this.B.bind(this))}.bind(t)),t.j={},t.c)Object.defineProperty(t.j,e,{configurable:!1,enumerable:!0,get:t.G.bind(t,e),set:t.J.bind(t,e)});t.s={},Ei(t,function(e){Object.defineProperty(t.s,e,{configurable:!1,enumerable:!0,get:function(){return function e(t,n){t.v.has(n)&&(n=t.v.get(n));if("addEventListener"==n)return t.g.addEventListener.bind(t.g);if("removeEventListener"==n)return t.g.removeEventListener.bind(t.g);if("getMediaElement"==n)return function(){return this.j}.bind(t);if("getSharedConfiguration"==n)return X.u("Can't share configuration across a network. Returning copy."),t.a.get("player","getConfiguration");if("getNetworkingEngine"==n)return t.a.ha()&&X.u("NOTE: getNetworkingEngine() is always local!"),t.b.pc.bind(t.b);if(t.a.ha()){if("getManifest"==n||"drmInfo"==n)return function(){return X.ba(n+"() does not work while casting!"),null};if("getManifestUri"==n)return Xn("getManifestUri",'Please use "getAssetUri" instead.'),e(t,"getAssetUri");if("attach"==n||"detach"==n)return function(){return X.ba(n+"() does not work while casting!"),Promise.resolve()}}return t.a.ha()&&0==Object.keys(t.a.a.video).length&&ii[n]||!t.a.ha()?t.b[n].bind(t.b):t.a.get("player",n)}(t,e)}})}),function(i){var r=new Map;Ei(i,function(e,t){var n;r.has(t)?(n=r.get(t),e.length<n.length?i.v.set(e,n):i.v.set(n,e)):r.set(t,e)})}(t),t.f=new j,t.f.Ec=t.j,t.g=new j,t.g.Ec=t.s}(this)}function Ei(e,t){function n(e){return"constructor"!=e&&"function"==typeof i[e]&&!r.has(e)}var i=e.b,r=new Set;for(a in i)n(a)&&(r.add(a),t(a,i[a]));for(var a=Object.getPrototypeOf(i),o=Object.getPrototypeOf({});a&&a!=o;){for(var s=B(Object.getOwnPropertyNames(a)),u=s.next();!u.done;u=s.next())n(u=u.value)&&(r.add(u),t(u,i[u]));a=Object.getPrototypeOf(a)}}function wi(e){var n={video:{},player:{},playerAfterLoad:{},manifest:e.b.Oc(),startTime:null};return e.c.pause(),ei.forEach(function(e){n.video[e]=this.c[e]}.bind(e)),e.c.ended||(n.startTime=e.c.currentTime),ai.forEach(function(e){var t=e[1];e=this.b[e[0]](),n.player[t]=e}.bind(e)),oi.forEach(function(e){var t=e[1];e=this.b[e[0]](),n.playerAfterLoad[t]=e}.bind(e)),n}function Ti(e){e.dispatchEvent(new D("caststatuschanged"))}function Si(e){e.f.dispatchEvent(new D(e.j.paused?"pause":"play"))}function Ai(t){ai.forEach(function(e){var t=e[1];e=this.a.get("player",e[0])(),this.b[t](e)}.bind(t));var e=t.a.get("player","getAssetUri")(),n=t.a.get("video","ended"),i=Promise.resolve(),r=t.c.autoplay,a=null;n||(a=t.a.get("video","currentTime")),e&&(t.c.autoplay=!1,i=t.b.load(e,a));var o={};ei.forEach(function(e){o[e]=this.a.get("video",e)}.bind(t)),i.then(function(){t.c&&(ei.forEach(function(e){this.c[e]=o[e]}.bind(t)),oi.forEach(function(e){var t=e[1];e=this.a.get("player",e[0])(),this.b[t](e)}.bind(t)),t.c.autoplay=r,e&&t.c.play())},function(e){t.b.dispatchEvent(new D("error",{detail:e}))})}function Ii(e,t,n){e.a.ha()&&("video"==t?e.f.dispatchEvent(n):"player"==t&&e.g.dispatchEvent(n))}function ki(e,t,n,i){var r=this;j.call(this),this.a=e,this.b=t,this.c=new Ze,this.H={video:e,player:t},this.w=n||function(){},this.J=i||function(e){return e},this.B=!1,this.j=!0,this.g=0,this.v=!1,this.s=!0,this.l=this.f=null,this.G=new ke(function(){xi(r)}),n=this,(i=cast.receiver.CastReceiverManager.getInstance()).onSenderConnected=n.bf.bind(n),i.onSenderDisconnected=n.bf.bind(n),i.onSystemVolumeChanged=n.Tf.bind(n),n.l=i.getCastMessageBus("urn:x-cast:com.google.cast.media"),n.l.onMessage=n.Mg.bind(n),n.f=i.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),n.f.onMessage=n.Wg.bind(n),i.start(),Zn.forEach(function(e){this.c.m(this.a,e,this.hf.bind(this,"video"))}.bind(n)),ni.forEach(function(e){this.c.m(this.b,e,this.hf.bind(this,"player"))}.bind(n)),cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?n.b.ee(3840,2160):n.b.ee(1920,1080),n.c.m(n.a,"loadeddata",function(){this.v=!0}.bind(n)),n.c.m(n.b,"loading",function(){this.j=!1,Ci(this)}.bind(n)),n.c.m(n.a,"playing",function(){this.j=!1,Ci(this)}.bind(n)),n.c.m(n.a,"pause",function(){Ci(this)}.bind(n)),n.c.m(n.b,"unloading",function(){this.j=!0,Ci(this)}.bind(n)),n.c.m(n.a,"ended",function(){var e=this;new ke(function(){e.a&&e.a.ended&&(e.j=!0,Ci(e))}).R(5)}.bind(n))}function Ci(e){Promise.resolve().then(function(){this.b&&(this.dispatchEvent(new D("caststatuschanged")),Ni(this)||Ri(this))}.bind(e))}function xi(e){e.G.R(.5);var t,n={video:{},player:{}};if(Qn.forEach(function(e){n.video[e]=this.a[e]}.bind(e)),e.b.W())for(var i in ri)0==e.g%ri[i]&&(n.player[i]=e.b[i]());for(t in ii)0==e.g%ii[t]&&(n.player[t]=e.b[t]());(i=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(n.video.volume=i.level,n.video.muted=i.muted),e.v&&(e.g+=1),Mi(e,{type:"update",update:n},e.f),Ni(e)}function Ni(e){return e.s&&(e.a.duration||e.b.W())&&(Pi(e),e.s=!1,1)}function Pi(e,t){t=void 0===t?0:t;var n={contentId:e.b.Oc(),streamType:e.b.W()?"LIVE":"BUFFERED",contentType:""};e.b.W()||(n.duration=e.a.duration),Ri(e,t,n)}function Mi(e,t,n,i){e.B&&(e=ci(t),i?n.getCastChannel(i).send(e):n.broadcast(e))}function Ri(e,t,n){t=void 0===t?0:t,n=void 0===n?null:n;var i=e.a.playbackRate,r=Li,i={mediaSessionId:0,playbackRate:i,playerState:r=e.j?r.IDLE:e.b.Wb()?r.Cf:e.a.paused?r.Ef:r.Ff,currentTime:e.a.currentTime,supportedMediaCommands:63,volume:{level:e.a.volume,muted:e.a.muted}};n&&(i.media=n),Mi(e,{requestId:t,type:"MEDIA_STATUS",status:[i]},e.l)}d.__onGCastApiAvailable=function(e){if(e)for(var t=(e=B(bi)).next();!t.done;t=e.next())t.value.init()},O(yi,j),_("shaka.cast.CastProxy",yi),yi.prototype.destroy=function(e){return e&&this.a.Qb(),this.l&&(this.l.release(),this.l=null),e=[],this.b&&(e.push(this.b.destroy()),this.b=null),this.a&&(e.push(this.a.destroy()),this.a=null),this.s=this.j=this.c=null,Promise.all(e)},yi.prototype.getVideo=yi.prototype.sc=function(){return this.j},yi.prototype.getPlayer=yi.prototype.$a=function(){return this.s},yi.prototype.canCast=yi.prototype.ye=function(){return this.a.j&&hi},yi.prototype.isCasting=yi.prototype.ha=function(){return this.a.ha()},yi.prototype.receiverName=yi.prototype.bd=function(){return this.a.bd()},yi.prototype.cast=function(){var e=wi(this);return this.a.cast(e).then(function(){if(this.b)return this.b.re()}.bind(this))},yi.prototype.setAppData=yi.prototype.be=function(e){this.a.be(e)},yi.prototype.suggestDisconnect=yi.prototype.yf=function(){var e,t=this.a;t.b&&(e=t.H(),chrome.cast.requestSession(t.Td.bind(t,e),t.Ze.bind(t)))},yi.prototype.changeReceiverId=yi.prototype.Ce=function(t){var n=this;return G(function e(){return q(e,function(e){switch(e.o){case 1:return t==n.w?e.return():(n.w=t,n.a.Qb(),V(e,n.a.destroy(),2));case 2:n.a=null,n.a=new di(t,function(){return Ti(n)},function(){return Si(n)},function(e,t){return Ii(n,e,t)},function(){return Ai(n)},function(){return wi(n)}),n.a.init(),x(e)}})})},yi.prototype.forceDisconnect=yi.prototype.Qb=function(){this.a.Qb()},yi.prototype.G=function(e){if("addEventListener"==e)return this.f.addEventListener.bind(this.f);if("removeEventListener"==e)return this.f.removeEventListener.bind(this.f);if(this.a.ha()&&0==Object.keys(this.a.a.video).length){var t=this.c[e];if("function"!=typeof t)return t}return this.a.ha()?this.a.get("video",e):("function"==typeof(e=this.c[e])&&(e=e.bind(this.c)),e)},yi.prototype.J=function(e,t){this.a.ha()?this.a.set("video",e,t):this.c[e]=t},yi.prototype.H=function(e){this.a.ha()||this.f.dispatchEvent(new D(e.type,e))},yi.prototype.B=function(e){this.a.ha()||this.g.dispatchEvent(e)},O(ki,j),_("shaka.cast.CastReceiver",ki),ki.prototype.isConnected=function(){return this.B},ki.prototype.isIdle=ki.prototype.Eg=function(){return this.j},ki.prototype.destroy=function(){var n=this;return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return n.c&&(n.c.release(),n.c=null),t=[],n.b&&(t.push(n.b.destroy()),n.b=null),n.G&&(n.G.stop(),n.G=null),n.a=null,n.H=null,n.w=null,n.B=!1,n.j=!0,n.f=null,n.l=null,V(e,Promise.all(t),2);case 2:cast.receiver.CastReceiverManager.getInstance().stop(),x(e)}})})},(e=ki.prototype).bf=function(){this.g=0,this.s=!0,this.B=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,Ci(this)},e.hf=function(e,t){this.b&&(xi(this),Mi(this,{type:"event",targetName:e,event:t},this.f))},e.Tf=function(){var e=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();e&&Mi(this,{type:"update",update:{video:{volume:e.level,muted:e.muted}}},this.f),Mi(this,{type:"event",targetName:"video",event:{type:"volumechange"}},this.f)},e.Wg=function(e){var t=li(e.data);switch(X.debug("CastReceiver: message",t),t.type){case"init":this.g=0,this.v=!1,this.s=!0,function(n,i,e){for(var t in i.player)n.b[t](i.player[t]);n.w(e),e=Promise.resolve();var r=n.a.autoplay;i.manifest&&(n.a.autoplay=!1,e=n.b.load(i.manifest,i.startTime)),e.then(function(){if(n.b){for(var e in i.video)n.a[e]=i.video[e];for(var t in i.playerAfterLoad)n.b[t](i.playerAfterLoad[t]);n.a.autoplay=r,i.manifest&&(n.a.play(),Ri(n))}},function(e){n.b.dispatchEvent(new D("error",{detail:e}))})}(this,t.initState,t.appData),xi(this);break;case"appData":this.w(t.appData);break;case"set":var n=t.targetName,i=t.property,t=t.value;if("video"==n){var r=cast.receiver.CastReceiverManager.getInstance();if("volume"==i){r.setSystemVolumeLevel(t);break}if("muted"==i){r.setSystemVolumeMuted(t);break}}this.H[n][i]=t;break;case"call":(n=this.H[t.targetName])[t.methodName].apply(n,t.args);break;case"asyncCall":n=t.targetName,i=t.methodName,"player"==n&&"load"==i&&(this.g=0,this.v=!1),r=t.id,e=e.senderId;var a=this.H[n];t=a[i].apply(a,t.args),"player"==n&&"load"==i&&(t=t.then(function(){this.s=!0}.bind(this))),t.then(this.rf.bind(this,e,r,null),this.rf.bind(this,e,r))}},e.Mg=function(e){var n=li(e.data);switch(X.debug("CastReceiver: message",n),n.type){case"PLAY":this.a.play(),Ri(this);break;case"PAUSE":this.a.pause(),Ri(this);break;case"SEEK":e=n.currentTime;var t=n.resumeState;null!=e&&(this.a.currentTime=Number(e)),t&&"PLAYBACK_START"==t?(this.a.play(),Ri(this)):t&&"PLAYBACK_PAUSE"==t&&(this.a.pause(),Ri(this));break;case"STOP":this.b.re().then(function(){this.b&&Ri(this)}.bind(this));break;case"GET_STATUS":Pi(this,Number(n.requestId));break;case"VOLUME":e=(t=n.volume).level,t=t.muted;var i=this.a.volume,r=this.a.muted;null!=e&&(this.a.volume=Number(e)),null!=t&&(this.a.muted=t),i==this.a.volume&&r==this.a.muted||Ri(this);break;case"LOAD":this.g=0,this.s=this.v=!1,e=n.media,t=n.currentTime,i=this.J(e.contentId),r=n.autoplay||!0,this.w(e.customData),r&&(this.a.autoplay=!0),this.b.load(i,t).then(function(){this.b&&Pi(this)}.bind(this)).catch(function(e){var t="LOAD_FAILED";7==e.category&&7e3==e.code&&(t="LOAD_CANCELLED"),Mi(this,{requestId:Number(n.requestId),type:t},this.l)}.bind(this));break;default:X.u("Unrecognized message type from the generic Chromecast controller!",n.type),Mi(this,{requestId:Number(n.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},this.l)}},e.rf=function(e,t,n){this.b&&Mi(this,{type:"asyncComplete",id:t,error:n},this.f,e)};var Li={IDLE:"IDLE",Ff:"PLAYING",Cf:"BUFFERING",Ef:"PAUSED"};function Ui(e,t){this.T=e,this.b=t==_i,this.a=0}_("shaka.util.DataViewReader",Ui);var _i=1;function Oi(){throw new Pe(2,3,3e3)}function Di(){this.c=[],this.b=[],this.a=!1}function Fi(e){for(var t=null!=e.flags?12:8;e.reader.Ra()&&!e.parser.a;)e.parser.Yc(e.start+t,e.reader,e.partialOkay)}function ji(e){for(var t=null!=e.flags?12:8,n=e.reader.M();0<n&&!e.parser.a;--n)e.parser.Yc(e.start+t,e.reader,e.partialOkay)}function Ki(t){return function(e){t(e.reader.Gb(e.reader.T.byteLength-e.reader.va()))}}function Bi(e){for(var t=0,n=0;n<e.length;n++)t=t<<8|e.charCodeAt(n);return t}function Gi(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function Vi(e){var r=this;this.a=[],this.b=[],this.data=[],(new Di).P("moov",Fi).za("pssh",function(e){if(1<e.version)X.u("Unrecognized PSSH version found!");else{var t=e.reader.T,t=new Uint8Array(t.buffer,t.byteOffset-12,e.size);if(r.data.push(t),r.a.push(At.hd(e.reader.Gb(16))),0<e.version){t=e.reader.M();for(var n=0;n<t;++n){var i=At.hd(e.reader.Gb(16));r.b.push(i)}}}}).parse(e),0==this.data.length&&X.u("No pssh box found!")}Ui.Endianness={Lh:0,Nh:_i},Ui.prototype.hasMoreData=Ui.prototype.Ra=function(){return this.a<this.T.byteLength},Ui.prototype.getPosition=Ui.prototype.va=function(){return this.a},Ui.prototype.getLength=Ui.prototype.eg=function(){return this.T.byteLength},Ui.prototype.readUint8=Ui.prototype.Ea=function(){try{var e=this.T.getUint8(this.a);return this.a+=1,e}catch(e){Oi()}},Ui.prototype.readUint16=Ui.prototype.xc=function(){try{var e=this.T.getUint16(this.a,this.b);return this.a+=2,e}catch(e){Oi()}},Ui.prototype.readUint32=Ui.prototype.M=function(){try{var e=this.T.getUint32(this.a,this.b);return this.a+=4,e}catch(e){Oi()}},Ui.prototype.readInt32=Ui.prototype.lf=function(){try{var e=this.T.getInt32(this.a,this.b);return this.a+=4,e}catch(e){Oi()}},Ui.prototype.readUint64=Ui.prototype.fc=function(){try{var e,t;this.b?(e=this.T.getUint32(this.a,!0),t=this.T.getUint32(this.a+4,!0)):(t=this.T.getUint32(this.a,!1),e=this.T.getUint32(this.a+4,!1))}catch(e){Oi()}if(2097151<t)throw new Pe(2,3,3001);return this.a+=8,t*Math.pow(2,32)+e},Ui.prototype.readBytes=Ui.prototype.Gb=function(e){this.a+e>this.T.byteLength&&Oi();var t=new Uint8Array(this.T.buffer,this.T.byteOffset+this.a,e);return this.a+=e,t},Ui.prototype.skip=Ui.prototype.V=function(e){this.a+e>this.T.byteLength&&Oi(),this.a+=e},Ui.prototype.rewind=Ui.prototype.nf=function(e){this.a<e&&Oi(),this.a-=e},Ui.prototype.seek=function(e){(e<0||e>this.T.byteLength)&&Oi(),this.a=e},Ui.prototype.readTerminatedString=Ui.prototype.Vd=function(){for(var e=this.a;this.Ra()&&0!=this.T.getUint8(this.a);)this.a+=1;return e=new Uint8Array(this.T.buffer,this.T.byteOffset+e,this.a-e),this.a+=1,vt(e)},_("shaka.util.Mp4Parser",Di),Di.prototype.box=Di.prototype.P=function(e,t){e=Bi(e);return this.c[e]=0,this.b[e]=t,this},Di.prototype.fullBox=Di.prototype.za=function(e,t){e=Bi(e);return this.c[e]=1,this.b[e]=t,this},Di.prototype.stop=function(){this.a=!0},Di.prototype.parse=function(e,t){var n=new Uint8Array(e),n=new Ui(new DataView(n.buffer,n.byteOffset,n.byteLength),0);for(this.a=!1;n.Ra()&&!this.a;)this.Yc(0,n,t)},Di.prototype.parseNext=Di.prototype.Yc=function(e,t,n){var i=t.va(),r=t.M(),a=t.M();switch(X.N("Parsing MP4 box",Gi(a)),r){case 0:r=t.T.byteLength-i;break;case 1:r=t.fc()}var o,s,u=this.b[a];u?(s=o=null,1==this.c[a]&&(o=(s=t.M())>>>24,s&=16777215),a=i+r,n&&a>t.T.byteLength&&(a=t.T.byteLength),t=0<(a-=t.va())?t.Gb(a):new Uint8Array(0),u({parser:this,partialOkay:n||!1,version:o,flags:s,reader:t=new Ui(new DataView(t.buffer,t.byteOffset,t.byteLength),0),size:r,start:i+e})):t.V(Math.min(i+r-t.va(),t.T.byteLength-t.va()))},Di.children=Fi,Di.sampleDescription=ji,Di.allData=Ki,Di.typeToString=Gi;var zi={Nc:function(e,t){t=zi.$(e,t);return 1!=t.length?null:t[0]},td:function(e,t,n){return 1!=(e=zi.Je(e,t,n)).length?null:e[0]},$:function(e,t){return Array.prototype.filter.call(e.childNodes,function(e){return e instanceof Element&&e.tagName==t})},Je:function(e,t,n){return Array.prototype.filter.call(e.childNodes,function(e){return e instanceof Element&&e.localName==n&&e.namespaceURI==t})},getAttributeNS:function(e,t,n){return e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null},Pc:function(e){return Array.prototype.every.call(e.childNodes,function(e){return e.nodeType==Node.TEXT_NODE||e.nodeType==Node.CDATA_SECTION_NODE})?e.textContent.trim():null},S:function(e,t,n,i){i=void 0===i?null:i;var r=null;return null!=(e=e.getAttribute(t))&&(r=n(e)),null==r?i:r},$g:function(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:Math.floor(e/1e3)):null},eb:function(e){if(!e)return null;var t=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(e);return t?(e=31536e3*Number(t[1]||null)+2592e3*Number(t[2]||null)+86400*Number(t[3]||null)+3600*Number(t[4]||null)+60*Number(t[5]||null)+Number(t[6]||null),isFinite(e)?e:null):(X.u("Invalid duration string:",e),null)},$c:function(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null},parseInt:function(e){return 0==(e=Number(e))%1?e:null},Zc:function(e){return 0==(e=Number(e))%1&&0<e?e:null},cc:function(e){return 0==(e=Number(e))%1&&0<=e?e:null},parseFloat:function(e){return e=Number(e),isNaN(e)?null:e},Rf:function(e){var t;return e=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e),isNaN(e)?null:e},ef:function(e,t){var n,i=new DOMParser;try{var r=i.parseFromString(e,"text/xml")}catch(e){}return r&&r.documentElement.tagName==t&&(n=r.documentElement),n&&0<n.getElementsByTagName("parsererror").length?null:n},df:function(e,t){try{var n=vt(e);return zi.ef(n,t)}catch(e){}}},Hi=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime");function Wi(e,t,n){var i=function(e){for(var t=[],n=(e=B(e)).next();!n.done;n=e.next())(n=function(e){var t=e.getAttribute("schemeIdUri"),n=zi.getAttributeNS(e,"urn:mpeg:cenc:2013","default_KID"),i=zi.Je(e,"urn:mpeg:cenc:2013","pssh").map(zi.Pc);if(!t)return X.error("Missing required schemeIdUri attribute on","ContentProtection element",e),null;if(t=t.toLowerCase(),n&&(n=n.replace(/-/g,"").toLowerCase()).includes(" "))throw new Pe(2,4,4009);var r=[];try{r=i.map(function(e){return{initDataType:"cenc",initData:At.Za(e),keyId:null}})}catch(e){throw new Pe(2,4,4007)}return{node:e,pf:t,keyId:n,init:0<r.length?r:null}}(n.value))&&t.push(n);return t}(e),r=null;e=[];var a=[],o=new Set(i.map(function(e){return e.keyId}));if(o.delete(null),1<o.size)throw new Pe(2,4,4010);if(n||(a=i.filter(function(e){return"urn:mpeg:dash:mp4protection:2011"!=e.pf||(r=e.init||r,!1)})).length&&(0==(e=function(e,t,n){for(var i,r=[],a=(n=B(n)).next();!a.done;a=n.next()){a=a.value;var o,s,u,c,l,d,h=Hi.get(a.pf);if(h)i=(i=zi.td(a.node,"urn:microsoft:playready","pro"))?(i=At.Za(i.textContent),o=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),s=i.length,u=o.length+16+s,c=new ArrayBuffer(u),l=new Uint8Array(c),c=new DataView(c),d=0,c.setUint32(0,u),d+=4,c.setUint32(4,1886614376),d+=4,c.setUint32(8,0),d+=4,l.set(o,12),d+=o.length,c.setUint32(d,s),d+=4,l.set(i,d),[{initData:l,initDataType:"cenc",keyId:a.keyId}]):null,i=en(h,a.init||e||i),(h=Xi.get(h))&&(i.licenseServerUri=h(a)),r.push(i);else for(a=t(a.node)||[],a=B(a),h=a.next();!h.done;h=a.next())r.push(h.value)}return r}(r,t,a)).length&&(e=[en("",r)])),i.length&&(n||!a.length))for(e=[],n=(t=B(Hi.values())).next();!n.done;n=t.next())"org.w3.clearkey"!=(n=n.value)&&e.push(en(n,r));if(o=Array.from(o)[0]||null)for(n=(t=B(e)).next();!n.done;n=t.next())for(i=(n=B(n.value.initData)).next();!i.done;i=n.next())i.value.keyId=o;return{Fe:o,Oh:r,drmInfos:e,Ke:!0}}var qi,Xi=(new Map).set("com.widevine.alpha",function(e){return(e=zi.td(e.node,"urn:microsoft","laurl"))&&e.getAttribute("licenseUrl")||""}).set("com.microsoft.playready",function(e){return(e=zi.td(e.node,"urn:microsoft:playready","pro"))&&(e=function(e){var t=0,n=new DataView(e).getUint32(t,!0);if(t+=4,n!==e.byteLength)return X.u("PlayReady Object with invalid length encountered."),[];t+=2,n=[];for(var i=new DataView(e);t<e.byteLength-1;){var r=i.getUint16(t,!0);t+=2;var a=i.getUint16(t,!0);t+=2;var o=new Uint8Array(e,t,a);n.push({type:r,value:o}),t+=a}return n}((e=At.Za(e.textContent)).buffer).filter(function(e){return 1===e.type})[0])?(e=bt(e.value,!0),(e=zi.ef(e,"WRMHEADER"))?function(e){for(var t=(e=B(e.getElementsByTagName("DATA"))).next();!t.done;t=e.next())for(var n=(t=B(t.value.childNodes)).next();!n.done;n=t.next())if((n=n.value)instanceof Element&&"LA_URL"==n.tagName)return n.textContent;return""}(e):""):""});function Yi(a,e,t,n,i){var o={RepresentationID:e,Number:t,Bandwidth:n,Time:i};return a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(e,t,n,i){if("$$"==e)return"$";var r=o[t];if(null==r)return X.u("URL template does not have an available substitution for identifier",'"'+t+'":',a),e;switch("RepresentationID"==t&&n&&(X.u("URL template should not contain a width specifier for identifier",'"RepresentationID":',a),n=void 0),"Time"==t&&(r=Math.round(r)),i){case void 0:case"d":case"i":case"u":e=r.toString();break;case"o":e=r.toString(8);break;case"x":e=r.toString(16);break;case"X":e=r.toString(16).toUpperCase();break;default:e=r.toString()}return n=d.parseInt(n,10)||1,Array(Math.max(0,n-e.length)+1).join("0")+e})}function $i(e,t){var n=Ji(e,t,"timescale"),i=1;n&&(i=zi.Zc(n)||1),n=Ji(e,t,"duration"),(n=zi.Zc(n||""))&&(n/=i);var r=Ji(e,t,"startNumber"),a=Number(Ji(e,t,"presentationTimeOffset"))||0,o=zi.cc(r||"");null!=r&&null!=o||(o=1);r=null;if(u=Zi(e,t,"SegmentTimeline")){r=i;for(var s=e.ea.duration||1/0,u=zi.$(u,"S"),c=[],l=-a,d=0;d<u.length;++d){var h=u[d],f=zi.S(h,"t",zi.cc),p=zi.S(h,"d",zi.cc),m=zi.S(h,"r",zi.parseInt);if(null!=f&&(f-=a),!p){X.u('"S" element must have a duration:','ignoring the remaining "S" elements.',h);break}if(f=null!=f?f:l,(m=m||0)<0)if(d+1<u.length){if(null==(m=zi.S(u[d+1],"t",zi.cc))){X.u('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:','ignoring the remaining "S" elements.',h);break}if(m<=f){X.u('An "S" element cannot have a negative repeat','if its start time exceeds the next "S" element\'s start time:','ignoring the remaining "S" elements.',h);break}m=Math.ceil((m-f)/p)-1}else{if(1/0==s){X.u('The last "S" element cannot have a negative repeat',"if the Period has an infinite duration:",'ignoring the last "S" element.',h);break}if(s<=f/r){X.u('The last "S" element cannot have a negative repeat',"if its start time exceeds the Period's duration:",'igoring the last "S" element.',h);break}m=Math.ceil((s*r-f)/p)-1}for(0<c.length&&f!=l&&(Math.abs((f-l)/r)>=nn&&X.u("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",h),c[c.length-1].end=f/r),h=0;h<=m;++h)l=f+p,c.push({start:f/r,end:l/r,Hh:f}),f=l}r=c}return{timescale:i,sa:n,Jb:o,Fa:a/i||0,se:a,X:r}}function Ji(e,t,n){return[t(e.F),t(e.oa),t(e.Da)].filter(Zt.jb).map(function(e){return e.getAttribute(n)}).reduce(function(e,t){return e||t})}function Zi(e,t,n){return[t(e.F),t(e.oa),t(e.Da)].filter(Zt.jb).map(function(e){return zi.Nc(e,n)}).reduce(function(e,t){return e||t})}function Qi(e,t,n,i,r,a){if(a=void 0===a?0:a,zi.getAttributeNS(e,"http://www.w3.org/1999/xlink","href")){var o=function(r,a,o,e,s,u){for(var c=zi.getAttributeNS(r,"http://www.w3.org/1999/xlink","href"),t=zi.getAttributeNS(r,"http://www.w3.org/1999/xlink","actuate")||"onRequest",n=0;n<r.attributes.length;n++){var i=r.attributes[n];"http://www.w3.org/1999/xlink"==i.namespaceURI&&(r.removeAttributeNS(i.namespaceURI,i.localName),--n)}if(5<=u)return Le(new Pe(2,4,4028));if("onLoad"!=t)return Le(new Pe(2,4,4027));var l=Qt([e],[c]);return s.request(0,Xe(l,a)).ma(function(e){if(!(e=zi.df(e.data,r.tagName)))return Le(new Pe(2,4,4001,c));for(;r.childNodes.length;)r.removeChild(r.childNodes[0]);for(;e.childNodes.length;){var t=e.childNodes[0];e.removeChild(t),r.appendChild(t)}for(t=0;t<e.attributes.length;t++){var n=e.attributes[t].nodeName,i=e.getAttribute(n);r.setAttribute(n,i)}return Qi(r,a,o,l[0],s,u+1)})}(e,t,n,i,r,a);return n&&(o=o.ma(void 0,function(){return Qi(e,t,n,i,r,a)})),o}o=[];for(var s=0;s<e.childNodes.length;s++){var u=e.childNodes[s];u instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==zi.getAttributeNS(u,"http://www.w3.org/1999/xlink","href")?(e.removeChild(u),--s):"SegmentTimeline"!=u.tagName&&o.push(Qi(u,t,n,i,r,a)))}return De(o).ma(function(){return e})}function er(e,t,n){this.c=e,this.b=t,this.a=n}function tr(e,t,n,i,r,a){this.position=e,this.startTime=t,this.endTime=n,this.c=i,this.b=r,this.a=a}function nr(e,t,n,i){var r,a=(new Di).za("sidx",function(e){r=function(e,t,n,i){var r=[];i.reader.V(4);var a=i.reader.M();if(0==a)throw X.error("Invalid timescale."),new Pe(2,3,3005);{var o,s;s=0==i.version?(o=i.reader.M(),i.reader.M()):(o=i.reader.fc(),i.reader.fc())}i.reader.V(2);var u=i.reader.xc();for(e=e+i.size+s,s=0;s<u;s++){var c=i.reader.M(),l=(2147483648&c)>>>31;c&=2147483647;var d=i.reader.M();if(i.reader.V(4),1==l)throw X.error("Heirarchical SIDXs are not supported."),new Pe(2,3,3006);r.push(new tr(r.length,o/a-t,(o+d)/a-t,function(){return n},e,e+c-1)),o+=d,e+=c}return i.parser.stop(),r}(t,i,n,e)});if(e&&a.parse(e),r)return r;throw X.error('Invalid box type, expected "sidx".'),new Pe(2,3,3004)}function ir(e){this.a=e}function rr(e,t){for(;e.a.length&&e.a[e.a.length-1].startTime>=t;)e.a.pop();for(;e.a.length&&e.a[0].endTime<=0;)e.a.shift();var n;0!=e.a.length&&(n=e.a[e.a.length-1],e.a[e.a.length-1]=new tr(n.position,n.startTime,t,n.c,n.b,n.a))}function ar(e){this.b=e,this.a=new Ui(e,0),qi=qi||[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])]}function or(e){var t=sr(e);if(7<t.length)throw new Pe(2,3,3002);for(var n=0,i=0;i<t.length;i++)n=256*n+t[i];t=n,n=sr(e);e:{i=At.Xa;for(var r=0;r<qi.length;r++)if(i(n,qi[r])){i=!0;break e}i=!1}if(i)n=e.b.byteLength-e.a.va();else{if(8==n.length&&224&n[1])throw new Pe(2,3,3001);for(i=n[0]&(1<<8-n.length)-1,r=1;r<n.length;r++)i=256*i+n[r];n=i}return n=e.a.va()+n<=e.b.byteLength?n:e.b.byteLength-e.a.va(),i=new DataView(e.b.buffer,e.b.byteOffset+e.a.va(),n),e.a.V(n),new ur(t,i)}function sr(e){for(var t=e.a.Ea(),n=1;n<=8&&!(t&1<<8-n);n++);if(8<n)throw new Pe(2,3,3002);var i=new Uint8Array(n);for(i[0]=t,t=1;t<n;t++)i[t]=e.a.Ea();return i}function ur(e,t){this.id=e,this.a=t}function cr(e){if(8<e.a.byteLength)throw new Pe(2,3,3002);if(8==e.a.byteLength&&224&e.a.getUint8(0))throw new Pe(2,3,3001);for(var t=0,n=0;n<e.a.byteLength;n++)t=256*t+e.a.getUint8(n);return t}function lr(){}function dr(e,t){var n=Zi(e,t,"Initialization");if(!n)return null;var i=e.F.Ga,t=n.getAttribute("sourceURL");t&&(i=Qt(e.F.Ga,[t])),t=0;e=null;return(n=zi.S(n,"range",zi.$c))&&(t=n.start,e=n.end),new er(function(){return i},t,e)}function hr(e,t,n,i,r,a,o,s){var u=e.presentationTimeline,c=!e.Ob||!e.ea.Ed,l=e.ea.start,d=e.ea.duration,h=t,f=null;return{createSegmentIndex:function(){var e=[h(i,r,a),"webm"==o?h(n.c(),n.b,n.a):null];return h=null,Promise.all(e).then(function(e){var t=e[0];e=e[1]||null,t="mp4"==o?nr(t,r,i,s):(new lr).parse(t,e,i,s),u.$b(t,l),f=new ir(t),c&&rr(f,d)})},findSegmentPosition:function(e){return f.find(e)},getSegmentReference:function(e){return f.get(e)}}}function fr(e){return e.yc}function pr(e,t){var n,i=dr(e,mr),r=[(n=e).F.ob,n.oa.ob,n.Da.ob].filter(Zt.jb).map(function(e){return zi.$(e,"SegmentURL")}).reduce(function(e,t){return 0<e.length?e:t}).map(function(e){return e.getAttribute("indexRange")&&!n.Qe&&(n.Qe=!0,X.u("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate.")),{Ig:e.getAttribute("media"),start:(e=zi.S(e,"mediaRange",zi.$c,{start:0,end:null})).start,end:e.end}}),a=$i(e,mr),o=a.Jb;0==o&&(X.u("SegmentList@startNumber must be > 0"),o=1);var s=0;if(a.sa?s=a.sa*(o-1):a.X&&0<a.X.length&&(s=a.X[0].start),!(r={sa:a.sa,startTime:s,Jb:o,Fa:a.Fa,X:a.X,Db:r}).sa&&!r.X&&1<r.Db.length)throw X.u("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",e.F),new Pe(2,4,4002);if(!r.sa&&!e.ea.duration&&!r.X&&1==r.Db.length)throw X.u("SegmentList does not contain sufficient segment information:","the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",e.F),new Pe(2,4,4002);if(r.X&&0==r.X.length)throw X.u("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",e.F),new Pe(2,4,4002);return o=a=null,e.Da.id&&e.F.id&&(a=t[o=e.Da.id+","+e.F.id]),s=function(e,t,n,i){var r=i.Db.length;i.X&&i.X.length!=i.Db.length&&(r=Math.min(i.X.length,i.Db.length),X.u("The number of items in the segment timeline and the number of segment","URLs do not match, truncating",i.Db.length,"to",r));for(var a=[],o=i.startTime,s=0;s<r;s++){var u=i.Db[s],c=Qt(n,[u.Ig]),l=void 0;l=null!=i.sa?o+i.sa:i.X?i.X[s].end:o+e,a.push(new tr(s+t,o,l,function(e){return e}.bind(null,c),u.start,u.end)),o=l}return a}(e.ea.duration,r.Jb,e.F.Ga,r),a?(a.Kd(s),o=e.presentationTimeline.rc(),a.rd(o-e.ea.start)):(e.presentationTimeline.$b(s,e.ea.start),a=new ir(s),o&&e.Ob&&(t[o]=a)),e.Ob&&e.ea.Ed||rr(a,e.ea.duration),{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:a.find.bind(a),getSegmentReference:a.get.bind(a),initSegmentReference:i,Fa:r.Fa}}function mr(e){return e.ob}function gr(e,t,n,i){var r,a,o,s,u,c,l,d,h,f,p=function(e){var t=Ji(e,vr,"initialization");if(!t)return null;var n=e.F.id,i=e.bandwidth||null,r=e.F.Ga;return new er(function(){var e=Yi(t,n,null,i,null);return Qt(r,[e])},0,null)}(e),m=$i(e,vr),g=Ji(e,vr,"media"),v=Ji(e,vr,"index"),g=(m={sa:m.sa,timescale:m.timescale,Jb:m.Jb,Fa:m.Fa,se:m.se,X:m.X,Id:g,vc:v}).vc?1:0;if(g+=m.X?1:0,0==(g+=m.sa?1:0))throw X.error("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",e.F),new Pe(2,4,4002);if(1!=g&&(X.u("SegmentTemplate containes multiple segment information sources:","the SegmentTemplate should only contain an index URL template,","a SegmentTimeline or a segment duration.",e.F),m.vc?(X.info("Using the index URL template by default."),m.X=null):X.info("Using the SegmentTimeline by default."),m.sa=null),!m.vc&&!m.Id)throw X.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",e.F),new Pe(2,4,4002);if(m.vc){if("mp4"!=(n=e.F.mimeType.split("/")[1])&&"webm"!=n)throw X.error("SegmentTemplate specifies an unsupported container type.",e.F),new Pe(2,4,4006);if("webm"==n&&!p)throw X.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate uses a WebM container,","but does not contain an initialization URL template.",e.F),new Pe(2,4,4005);i=Yi(m.vc,e.F.id,null,e.bandwidth||null,null),e=hr(e,t,p,i=Qt(e.F.Ga,[i]),0,null,n,m.Fa)}else e=m.sa?(i||(e.presentationTimeline.Nd(m.sa),e.presentationTimeline.Od(e.ea.start)),a=m,o=(r=e).ea.duration,s=a.sa,u=a.Jb,c=a.timescale,l=a.Id,d=r.bandwidth||null,h=r.F.id,f=r.F.Ga,{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(e){return e<0||o&&o<=e?null:Math.floor(e/s)},getSegmentReference:function(t){var n=t*s,e=n+s;return o&&(e=Math.min(e,o)),e<0||o&&o<=n?null:new tr(t,n,e,function(){var e=Yi(l,h,t+u,d,n*c);return Qt(f,[e])},0,null)}}):(g=t=null,e.Da.id&&e.F.id&&(t=n[g=e.Da.id+","+e.F.id]),v=function(e,t){for(var n=[],i=0;i<t.X.length;i++){var r=i+t.Jb;n.push(new tr(r,t.X[i].start,t.X[i].end,function(e,t,n,i,r,a){return Qt(i,[e=Yi(e,t,r,n,a)]).map(function(e){return e.toString()})}.bind(null,t.Id,e.F.id,e.bandwidth||null,e.F.Ga,r,t.X[i].Hh+t.se),0,null))}return n}(e,m),i=!e.Ob||!e.ea.Ed,t?(i&&rr(new ir(v),e.ea.duration),t.Kd(v),n=e.presentationTimeline.rc(),t.rd(n-e.ea.start)):(e.presentationTimeline.$b(v,e.ea.start),t=new ir(v),g&&e.Ob&&(n[g]=t)),i&&rr(t,e.ea.duration),{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:t.find.bind(t),getSegmentReference:t.get.bind(t)});return{createSegmentIndex:e.createSegmentIndex,findSegmentPosition:e.findSegmentPosition,getSegmentReference:e.getSegmentReference,initSegmentReference:p,Fa:m.Fa}}function vr(e){return e.Ac}_("shaka.media.InitSegmentReference",er),er.prototype.createUris=er.prototype.pd=function(){return this.c()},er.prototype.getStartByte=er.prototype.zd=function(){return this.b},er.prototype.getEndByte=er.prototype.xd=function(){return this.a},_("shaka.media.SegmentReference",tr),tr.prototype.getPosition=tr.prototype.va=function(){return this.position},tr.prototype.getStartTime=tr.prototype.Rc=function(){return this.startTime},tr.prototype.getEndTime=tr.prototype.cg=function(){return this.endTime},tr.prototype.createUris=tr.prototype.pd=function(){return this.c()},tr.prototype.getStartByte=tr.prototype.zd=function(){return this.b},tr.prototype.getEndByte=tr.prototype.xd=function(){return this.a},_("shaka.media.SegmentIndex",ir),ir.prototype.destroy=function(){return this.a=null,Promise.resolve()},ir.prototype.find=function(e){for(var t=this.a.length-1;0<=t;--t){var n=this.a[t];if(e>=n.startTime&&e<n.endTime)return n.position}return this.a.length&&e<this.a[0].startTime?this.a[0].position:null},ir.prototype.get=function(e){return 0==this.a.length||(e-=this.a[0].position)<0||e>=this.a.length?null:this.a[e]},ir.prototype.offset=function(e){for(var t=0;t<this.a.length;++t)this.a[t].startTime+=e,this.a[t].endTime+=e},ir.prototype.merge=ir.prototype.Kd=function(e){for(var t=[],n=0,i=0;n<this.a.length&&i<e.length;){var r=this.a[n],a=e[i];r.startTime<a.startTime?(t.push(r),n++):(r.startTime>a.startTime?0==n?t.push(a):X.u("Refusing to rewrite original references on update!"):(.1<Math.abs(r.endTime-a.endTime)?t.push(new tr(r.position,a.startTime,a.endTime,a.c,a.b,a.a)):t.push(r),n++),i++)}for(;n<this.a.length;)t.push(this.a[n++]);if(t.length)for(n=t[t.length-1].position+1;i<e.length;)r=new tr(n++,(r=e[i++]).startTime,r.endTime,r.c,r.b,r.a),t.push(r);else t=e;this.a=t},ir.prototype.evict=ir.prototype.rd=function(e){for(var t=0;t<this.a.length;++t)if(this.a[t].endTime>e)return void this.a.splice(0,t);this.a=[]},ar.prototype.Ra=function(){return this.a.Ra()},lr.prototype.parse=function(e,t,n,i){var r;if(440786851!=or(t=new ar(new DataView(t))).id)throw X.error("Not an EBML element."),new Pe(2,3,3008);var a=or(t);if(408125543!=a.id)throw X.error("Not a Segment element."),new Pe(2,3,3009);for(t=a.a.byteOffset,a=new ar(a.a),r=null;a.Ra();){var o=or(a);if(357149030==o.id){r=o;break}}if(!r)throw X.error("Not an Info element."),new Pe(2,3,3010);for(a=new ar(r.a),r=1e6,o=null;a.Ra();){var s=or(a);if(2807729==s.id)r=cr(s);else if(17545==s.id)if(4==(o=s).a.byteLength)o=o.a.getFloat32(0);else{if(8!=o.a.byteLength)throw new Pe(2,3,3003);o=o.a.getFloat64(0)}}if(null==o)throw new Pe(2,3,3011);if(r=o*(a=r/1e9),475249515!=(e=or(new ar(new DataView(e)))).id)throw X.error("Not a Cues element."),new Pe(2,3,3007);return function(e,t,n,i,r,a){function o(){return r}var s=[];e=new ar(e.a);for(var u=null,c=null;e.Ra();){var l,d=or(e);187!=d.id||(l=function(e){var t=new ar(e.a);if(179!=(e=or(t)).id)throw X.u("Not a CueTime element."),new Pe(2,3,3013);if(e=cr(e),183!=(t=or(t)).id)throw X.u("Not a CueTrackPositions element."),new Pe(2,3,3012);t=new ar(t.a);for(var n=0;t.Ra();){var i=or(t);if(241==i.id){n=cr(i);break}}return{Ih:e,hh:n}}(d))&&(d=n*l.Ih,l=t+l.hh,null!=u&&s.push(new tr(s.length,u-a,d-a,o,c,l-1)),u=d,c=l)}return null!=u&&s.push(new tr(s.length,u-a,i-a,o,c,null)),s}(e,t,a,r,n,i)};var br={dc:{},wc:{},Xd:function(e,t){br.wc[e]=t}};function yr(e,t,n){this.f=e,this.ad=t,this.j=this.g=1/0,this.a=1,this.b=this.c=null,this.s=0,this.v=!0,this.l=0,this.w=void 0===n||n}function Er(e,t,n,i){return e=Xe(e,i),0==t&&null==n||(e.headers.Range=n?"bytes="+t+"-"+n:"bytes="+t+"-"),e}function wr(){var e=this;this.b=this.a=null,this.f=[],this.c=null,this.s=[],this.j=1,this.v={},this.w=0,this.B=new se(5),this.l=new ke(function(){var i;i=e,G(function e(){var t,n;return q(e,function(e){switch(e.o){case 1:return X.info("Updating manifest..."),t=0,z(e,2),V(e,Tr(i),4);case 4:t=e.A,H(e,3);break;case 2:n=W(e),i.b&&(n.severity=1,i.b.onError(n));case 3:if(!i.b)return e.return();Ar(i,t),x(e)}})})}),this.g=new Ve}function Tr(t){var n=Date.now(),e=t.b.networkingEngine.request(0,Xe(t.f,t.a.retryParameters));return ze(t.g,e),e.promise.then(function(e){if(t.b)return e.uri&&!t.f.includes(e.uri)&&t.f.unshift(e.uri),function(t,e,n){if(!(e=zi.df(e,"MPD")))throw new Pe(2,4,4001,n);return e=Qi(e,t.a.retryParameters,t.a.dash.xlinkFailGracefully,n,t.b.networkingEngine),ze(t.g,e),e.promise.then(function(e){return I=t,k=e,C=n,G(function e(){var h,f,p,m,g,v,b,y,E,w,T,S,A;return q(e,function(e){switch(e.o){case 1:m=Zt,b=[C],0<(g=(h=zi).$(k,"Location").map(h.Pc).filter(m.jb)).length&&(v=Qt(b,g),b=I.f=v),y=h.$(k,"BaseURL").map(h.Pc),f=Qt(b,y),E=I.a.dash.ignoreMinBufferTime,p=0,E||(p=h.S(k,"minBufferTime",h.eb)),I.w=h.S(k,"minimumUpdatePeriod",h.eb,-1),m=h.S(k,"availabilityStartTime",h.$g),g=h.S(k,"timeShiftBufferDepth",h.eb),v=h.S(k,"maxSegmentDuration",h.eb),b=k.getAttribute("type")||"static",y=I.a.dash.ignoreSuggestedPresentationDelay,E=null,y||(E=h.S(k,"suggestedPresentationDelay",h.eb)),E=I.c?I.c.presentationTimeline:(w=Math.max(I.a.dash.defaultPresentationDelay,1.5*p),new yr(m,null!=E?E:w,I.a.dash.autoCorrectDrift));for(var t={Ob:"static"!=b,presentationTimeline:E,Da:null,ea:null,oa:null,F:null,bandwidth:0,Qe:!1},n=f,i=zi.S(k,"mediaPresentationDuration",zi.eb),r=[],a=0,o=zi.$(k,"Period"),s=0;s<o.length;s++){var u,c=o[s],a=zi.S(c,"start",zi.eb,a),l=zi.S(c,"duration",zi.eb),d=null;if(s!=o.length-1?null!=(u=zi.S(o[s+1],"start",zi.eb))&&(d=u-a):null!=i&&(d=i-a),u=nn,d&&l&&Math.abs(d-l)>u&&X.u("There is a gap/overlap between Periods",c),null==d&&(d=l),c=function(e,t,n,i){if(t.Da=Ir(i.node,null,n),t.ea=i,t.Da.id||(X.info("No Period ID given for Period with start time "+i.start+",  Assigning a default"),t.Da.id="__shaka_period_"+i.start),zi.$(i.node,"EventStream").forEach(e.ah.bind(e,i.start,i.duration)),n=zi.$(i.node,"AdaptationSet").map(e.Zg.bind(e,t)).filter(Zt.jb),t.Ob){t=[];for(var r=B(n),a=r.next();!a.done;a=r.next())for(var o=(a=B(a.value.kh)).next();!o.done;o=a.next())t.push(o.value);if(t.length!=new Set(t).size)throw new Pe(2,4,4018)}var s=n.filter(function(e){return!e.pe});if(n.filter(function(e){return e.pe}).forEach(function(e){var t=e.streams[0],n=e.pe;s.forEach(function(e){e.id==n&&e.streams.forEach(function(e){e.trickModeVideo=t})})}),t=Sr(s,"video"),r=Sr(s,"audio"),!t.length&&!r.length)throw new Pe(2,4,4004);n=e.a.disableAudio,r.length&&!n||(r=[null]);n=e.a.disableVideo,t.length&&!n||(t=[null]);for(n=[],a=0;a<r.length;a++)for(o=0;o<t.length;o++)!function(e,t,n,i){if(t||n)if(t&&n){var r=t.drmInfos,a=n.drmInfos;if(!r.length||!a.length||0<jt(r,a).length){a=jt(t.drmInfos,n.drmInfos);for(var o=0;o<t.streams.length;o++)for(var s=0;s<n.streams.length;s++)r=(n.streams[s].bandwidth||0)+(t.streams[o].bandwidth||0),r={id:e.j++,language:t.language,primary:t.Hd||n.Hd,audio:t.streams[o],video:n.streams[s],bandwidth:r,drmInfos:a,allowedByApplication:!0,allowedByKeySystem:!0},i.push(r)}}else for(a=t||n,o=0;o<a.streams.length;o++)r=a.streams[o].bandwidth||0,r={id:e.j++,language:a.language||"und",primary:a.Hd,audio:t?a.streams[o]:null,video:n?a.streams[o]:null,bandwidth:r,drmInfos:a.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},i.push(r)}(e,r[a],t[o],n);if(t=[],!e.a.disableText)for(e=Sr(s,"text"),r=0;r<e.length;r++)t.push.apply(t,e[r].streams);return{startTime:i.start,textStreams:t,variants:n}}(I,t,n,{start:a,duration:d,node:c,Ed:null==d||s==o.length-1}),r.push(c),l=t.Da.id,I.s.includes(l)||(I.s.push(l),I.c&&(I.b.filterNewPeriod(c),I.c.periods.push(c))),null==d){s!=o.length-1&&X.u("Skipping Period",s+1,"and any subsequent Periods:","Period",s+1,"does not have a valid start time.",r[s+1]),a=null;break}a+=d}if(null==I.c&&I.b.filterAllPeriods(r),w=null!=i?(a!=i&&X.u("@mediaPresentationDuration does not match the total duration of all","Periods."),S=r,T=i,!1):(S=r,T=a,!0),T=T,S=S,E.Bc("static"==b),"static"!=b&&w||E.Ua(T||1/0),E.W()&&!isNaN(I.a.availabilityWindowOverride)&&(g=I.a.availabilityWindowOverride),null==g&&(g=1/0),E.ie(g),E.Nd(v||1),I.c){e.C(0);break}if(I.c={presentationTimeline:E,periods:S,offlineSessionIds:[],minBufferTime:p||0},E.Af())return A=h.$(k,"UTCTiming"),V(e,function(e,n,t){t=t.map(function(e){return{scheme:e.getAttribute("schemeIdUri"),value:e.getAttribute("value")}});var i=e.a.dash.clockSyncUri;return!t.length&&i&&t.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:i}),Zt.Pf(t,function(e){var t=e.scheme;switch(e=e.value,t){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return kr(this,n,e,"HEAD");case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return kr(this,n,e,"GET");case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return t=Date.parse(e),isNaN(t)?0:t-Date.now();case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":return X.ba("NTP UTCTiming scheme is not supported"),Promise.reject();default:return X.ba("Unrecognized scheme in UTCTiming element",t),Promise.reject()}}.bind(e)).catch(function(){return X.ba("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),0})}(I,f,A),4);e.C(0);break;case 4:if(A=e.A,!I.b)return e.return();E.sf(A),x(e)}})});var I,k,C})}(t,e.data,e.uri)}).then(function(){var e=(Date.now()-n)/1e3;return ue(t.B,1,e),e})}function Sr(e,t){return e.filter(function(e){return e.contentType==t})}function Ar(e,t){e.w<0||e.l.R(Math.max(3,e.w-t,ce(e.B)))}function Ir(e,t,n){t=t||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,Pd:null,audioSamplingRate:null},n=n||t.Ga;for(var i=zi.cc,r=zi.Rf,a=zi.$(e,"BaseURL").map(zi.Pc),o=e.getAttribute("contentType")||t.contentType,s=e.getAttribute("mimeType")||t.mimeType,u=e.getAttribute("codecs")||t.codecs,r=zi.S(e,"frameRate",r)||t.frameRate,c=e.getAttribute("sar")||t.pixelAspectRatio,l=zi.$(e,"InbandEventStream"),d=t.emsgSchemeIdUris.slice(),h=(l=B(l)).next();!h.done;h=l.next())h=h.value.getAttribute("schemeIdUri"),d.includes(h)||d.push(h);return l=function(e){for(var t=0;t<e.length;++t){var n=e[t],i=n.getAttribute("schemeIdUri");if(i&&(n=n.getAttribute("value")))switch(i){case"urn:mpeg:dash:outputChannelPositionList:2012":return n.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":var r=parseInt(n,10);if(r)return r;X.u("Channel parsing failure! Ignoring scheme and value",i,n);continue;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(!(r=parseInt(n,16))){X.u("Channel parsing failure! Ignoring scheme and value",i,n);continue}for(e=0;r;)1&r&&++e,r>>=1;return e;default:X.u("Unrecognized audio channel scheme:",i,n)}}return null}(l=zi.$(e,"AudioChannelConfiguration"))||t.Pd,h=zi.S(e,"audioSamplingRate",i)||t.audioSamplingRate,o=o||Cr(s,u),{Ga:Qt(n,a),yc:zi.Nc(e,"SegmentBase")||t.yc,ob:zi.Nc(e,"SegmentList")||t.ob,Ac:zi.Nc(e,"SegmentTemplate")||t.Ac,width:zi.S(e,"width",i)||t.width,height:zi.S(e,"height",i)||t.height,contentType:o,mimeType:s,codecs:u,frameRate:r,pixelAspectRatio:c,emsgSchemeIdUris:d,id:e.getAttribute("id"),Pd:l,audioSamplingRate:h}}function kr(e,t,n,i){return(t=Xe(t=Qt(t,[n]),e.a.retryParameters)).method=i,t=e.b.networkingEngine.request(4,t),ze(e.g,t),t.promise.then(function(e){if("HEAD"==i){if(!e.headers||!e.headers.date)return X.u("UTC timing response is missing","expected date header"),0;e=e.headers.date}else e=vt(e.data);return e=Date.parse(e),isNaN(e)?(X.u("Unable to parse date from UTC timing response"),0):e-Date.now()})}function Cr(e,t){return Cn(at(e,t))?"text":e.split("/")[0]}function xr(e,t,n,i){this.b=e,this.type=t,this.a=n,this.segments=i||null}function Nr(e,t,n,i){this.id=e,this.name=t,this.a=n,this.value=void 0===i?null:i}function Pr(e,t){this.name=e,this.value=t}function Mr(e,t,n){return(e=e.getAttribute(t))?e.value:n||null}function Rr(e,t){this.b=t,this.a=e}_("shaka.media.ManifestParser.registerParserByExtension",br.Xd),br.gc=function(e,t){br.dc[e]=t},_("shaka.media.ManifestParser.registerParserByMime",br.gc),br.eh=function(){var e={};if(ut()){for(var t in br.dc)e[t]=!0;for(var n in br.wc)e[n]=!0}t={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};for(var i,r=(n=B(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!r.done;r=n.next())e[r=r.value]=ut()?!!br.dc[r]:ct(r);for(i in t)e[i]=ut()?!!br.wc[i]:ct(t[i]);return e},br.create=function(n,i,r,a){return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return z(e,2),V(e,br.dg(n,i,r,a),4);case 4:return t=e.A,e.return(new t);case 2:throw(t=W(e)).severity=2,t}})})},br.dg=function(r,a,o,s){return G(function e(){var t,n,i;return q(e,function(e){switch(e.o){case 1:if(i=br,s){if(n=i.dc[s.toLowerCase()])return e.return(n);X.u("Could not determine manifest type using MIME type ",s)}if(t=i.getExtension(r)){if(n=i.wc[t])return e.return(n);X.u("Could not determine manifest type for extension ",t)}else X.u("Could not find extension for ",r);if(s){e.C(2);break}return V(e,i.og(r,a,o),3);case 3:if(s=e.A){if(i=br.dc[s])return e.return(i);X.u("Could not determine manifest type using MIME type",s)}case 2:throw new Pe(2,4,4e3,r)}})})},br.og=function(n,i,r){return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return(t=Xe([n],r)).method="HEAD",V(e,i.request(0,t).promise,2);case 2:return t=e.A,t=t.headers["content-type"],e.return(t?t.toLowerCase().split(";").shift():"")}})})},br.getExtension=function(e){return 1==(e=new he(e).Ca.split("/").pop().split(".")).length?"":e.pop().toLowerCase()},br.isSupported=function(e,t){return!!ut()&&(t in br.dc||br.getExtension(e)in br.wc)},_("shaka.media.PresentationTimeline",yr),yr.prototype.getDuration=yr.prototype.ra=function(){return this.g},yr.prototype.getMaxSegmentDuration=yr.prototype.mg=function(){return this.a},yr.prototype.setDuration=yr.prototype.Ua=function(e){this.g=e},yr.prototype.getPresentationStartTime=yr.prototype.sg=function(){return this.f},yr.prototype.setClockOffset=yr.prototype.sf=function(e){this.s=e},yr.prototype.setStatic=yr.prototype.Bc=function(e){this.v=e},yr.prototype.setSegmentAvailabilityDuration=yr.prototype.ie=function(e){this.j=e},yr.prototype.setDelay=yr.prototype.sh=function(e){this.ad=e},yr.prototype.getDelay=yr.prototype.ag=function(){return this.ad},yr.prototype.notifySegments=yr.prototype.$b=function(e,t){var n;0!=e.length&&(n=e[e.length-1].endTime+t,this.Od(e[0].startTime+t),this.a=e.reduce(function(e,t){return Math.max(e,t.endTime-t.startTime)},this.a),this.b=Math.max(this.b,n),null!=this.f&&this.w&&(this.f=(Date.now()+this.s)/1e3-this.b-this.a),X.I("notifySegments:","maxSegmentDuration="+this.a))},yr.prototype.notifyMinSegmentStartTime=yr.prototype.Od=function(e){this.c=null==this.c?e:Math.min(this.c,e)},yr.prototype.notifyMaxSegmentDuration=yr.prototype.Nd=function(e){this.a=Math.max(this.a,e),X.I("notifyNewSegmentDuration:","maxSegmentDuration="+this.a)},yr.prototype.offset=function(e){null!=this.c&&(this.c+=e),null!=this.b&&(this.b+=e)},yr.prototype.isLive=yr.prototype.W=function(){return 1/0==this.g&&!this.v},yr.prototype.isInProgress=yr.prototype.Bb=function(){return 1/0!=this.g&&!this.v},yr.prototype.getSegmentAvailabilityStart=yr.prototype.rc=function(){if(1/0==this.j)return this.l;var e=this.Sb()-this.j;return Math.max(this.l,e)},yr.prototype.setUserSeekStart=yr.prototype.vf=function(e){this.l=e},yr.prototype.getSegmentAvailabilityEnd=yr.prototype.Sb=function(){return this.W()||this.Bb()?Math.min(Math.max(0,(Date.now()+this.s)/1e3-this.a-this.f),this.g):this.g},yr.prototype.getSafeSeekRangeStart=yr.prototype.qc=function(e){var t=Math.max(this.c,this.l);if(1/0==this.j)return t;var n=this.Sb()-this.j;return e=Math.min(n+e,this.ab()),Math.max(t,e)},yr.prototype.getSeekRangeStart=yr.prototype.Rb=function(){return this.qc(0)},yr.prototype.getSeekRangeEnd=yr.prototype.ab=function(){var e=this.W()||this.Bb()?this.ad:0;return Math.max(0,this.Sb()-e)},yr.prototype.usingPresentationStartTime=yr.prototype.Af=function(){return!(null==this.f||null!=this.b&&this.w)},_("shaka.dash.DashParser",wr),(e=wr.prototype).configure=function(e){this.a=e},e.start=function(n,i){var r=this;return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return r.f=[n],r.b=i,V(e,Tr(r),2);case 2:if(t=e.A,r.b&&Ar(r,t),!r.b)throw new Pe(2,7,7001);return e.return(r.c)}})})},e.stop=function(){return this.a=this.b=null,this.f=[],this.c=null,this.s=[],this.v={},null!=this.l&&(this.l.stop(),this.l=null),this.g.destroy()},e.update=function(){Tr(this).catch(function(e){this.b&&this.b.onError(e)}.bind(this))},e.onExpirationUpdated=function(){},e.Zg=function(t,e){if(t.oa=Ir(e,t.Da,null),"image"==t.oa.contentType)return X.u("Skipping Image AdaptationSet",t.oa),null;var n=!1,i=(d=zi.$(e,"Role")).map(function(e){return e.getAttribute("value")}).filter(Zt.jb),r=void 0,a="text"==t.oa.contentType;a&&(r="subtitle");for(var o=0;o<d.length;o++){var s=d[o].getAttribute("schemeIdUri");if(null==s||"urn:mpeg:dash:role:2011"==s)switch(s=d[o].getAttribute("value"),s){case"main":n=!0;break;case"caption":case"subtitle":r=s}}var u=null,c=!1;zi.$(e,"EssentialProperty").forEach(function(e){"http://dashif.org/guidelines/trickmode"==e.getAttribute("schemeIdUri")?u=e.getAttribute("value"):c=!0}),o=zi.$(e,"Accessibility");var l=new Map,d={};for(s=(o=B(o)).next();!s.done;d={lc:d.lc},s=o.next()){var s=(h=s.value).getAttribute("schemeIdUri"),h=h.getAttribute("value");"urn:scte:dash:cc:cea-608:2015"==s||"urn:scte:dash:cc:cea-708:2015"==s?(d.lc=1,null!=h?h.split(";").forEach(function(n){return function(e){var t;e.includes("=")?(t=(e=e.split("="))[0].startsWith("CC")?e[0]:"CC"+e[0],e=e[1].split(",")[0].split(":").pop()):(t="CC"+n.lc,n.lc+=2),l.set(t,Q(e))}}(d)):l.set("CC1","und")):"urn:mpeg:dash:role:2011"==s&&null!=h&&(i.push(h),"captions"==h&&(r="caption"))}if(c)return null;var f=Wi(d=zi.$(e,"ContentProtection"),this.a.dash.customScheme,this.a.dash.ignoreDrmInfo);if(d=Q(e.getAttribute("lang")||"und"),o=e.getAttribute("label"),(s=zi.$(e,"Label"))&&s.length&&((s=s[0]).textContent&&(o=s.textContent)),0!=(i=(s=zi.$(e,"Representation")).map(this.bh.bind(this,t,f,r,d,o,n,i,l)).filter(function(e){return!!e})).length)return t.oa.contentType&&"application"!=t.oa.contentType||(t.oa.contentType=Cr(i[0].mimeType,i[0].codecs),i.forEach(function(e){e.type=t.oa.contentType})),i.forEach(function(t){f.drmInfos.forEach(function(e){t.keyId&&e.keyIds.push(t.keyId)})}),a=s.map(function(e){return e.getAttribute("id")}).filter(Zt.jb),{id:t.oa.id||"__fake__"+this.j++,contentType:t.oa.contentType,language:d,Hd:n,streams:i,drmInfos:f.drmInfos,pe:u,kh:a};if(this.a.dash.ignoreEmptyAdaptationSet||a)return null;throw new Pe(2,4,4003)},e.bh=function(e,t,n,i,r,a,o,s,u){if(e.F=Ir(u,e.oa,null),l=e.F,c=l.yc?1:0,c+=l.ob?1:0,!(0!=(c+=l.Ac?1:0)?(1!=c&&(X.u("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",l),l.yc?(X.info("Using SegmentBase by default."),l.ob=null):X.info("Using SegmentList by default."),l.Ac=null),!0):"text"==l.contentType||"application"==l.contentType||(X.u("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',l),!1)))return X.u("Skipping Representation",e.F),null;var c;e.bandwidth=zi.S(u,"bandwidth",zi.Zc)||0;var l="text"==(l=e.F.contentType)||"application"==l;try{var d,h,f,p=this.lh.bind(this);f=e.F.yc?function(e,t){var n=Number(Ji(e,fr,"presentationTimeOffset"))||0,i=Ji(e,fr,"timescale"),r=1;i&&(r=zi.Zc(i)||1),n=n/r||0,i=dr(e,fr);var a=e.F.contentType,r=e.F.mimeType.split("/")[1];if("text"!=a&&"mp4"!=r&&"webm"!=r)throw X.error("SegmentBase specifies an unsupported container type.",e.F),new Pe(2,4,4006);if("webm"==r&&!i)throw X.error("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",e.F),new Pe(2,4,4005);a=Zi(e,fr,"RepresentationIndex");var o,s=Ji(e,fr,"indexRange"),u=e.F.Ga,s=zi.$c(s||"");if(a&&((o=a.getAttribute("sourceURL"))&&(u=Qt(e.F.Ga,[o])),s=zi.S(a,"range",zi.$c,s)),!s)throw X.error("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",e.F),new Pe(2,4,4002);return{createSegmentIndex:(r=hr(e,t,i,u,s.start,s.end,r,n)).createSegmentIndex,findSegmentPosition:r.findSegmentPosition,getSegmentReference:r.getSegmentReference,initSegmentReference:i,Fa:n}}(e,p):e.F.ob?pr(e,this.v):e.F.Ac?gr(e,p,this.v,!!this.c):(d=e.F.Ga,h=e.ea.duration||0,{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(e){return 0<=e&&e<h?1:null},getSegmentReference:function(e){return 1!=e?null:new tr(1,0,h,function(){return d},0,null)},initSegmentReference:null,Fa:0})}catch(e){if(l&&4002==e.code)return null;throw e}return u=function(e,t,n,i){var r=Wi(e,t,i);if(n.Ke)e=1==n.drmInfos.length&&!n.drmInfos[0].keySystem,t=0==r.drmInfos.length,(0==n.drmInfos.length||e&&!t)&&(n.drmInfos=r.drmInfos),n.Ke=!1;else if(0<r.drmInfos.length&&(n.drmInfos=n.drmInfos.filter(function(t){return r.drmInfos.some(function(e){return e.keySystem==t.keySystem})}),0==n.drmInfos.length))throw new Pe(2,4,4008);return r.Fe||n.Fe}(u=zi.$(u,"ContentProtection"),this.a.dash.customScheme,t,this.a.dash.ignoreDrmInfo),{id:this.j++,originalId:e.F.id,createSegmentIndex:f.createSegmentIndex,findSegmentPosition:f.findSegmentPosition,getSegmentReference:f.getSegmentReference,initSegmentReference:f.initSegmentReference,presentationTimeOffset:f.Fa,mimeType:e.F.mimeType,codecs:e.F.codecs,frameRate:e.F.frameRate,pixelAspectRatio:e.F.pixelAspectRatio,bandwidth:e.bandwidth,width:e.F.width,height:e.F.height,kind:n,encrypted:0<t.drmInfos.length,keyId:u,language:i,label:r,type:e.oa.contentType,primary:a,trickModeVideo:null,emsgSchemeIdUris:e.F.emsgSchemeIdUris,roles:o,channelsCount:e.F.Pd,audioSamplingRate:e.F.audioSamplingRate,closedCaptions:s}},e.ah=function(i,r,e){var a=zi.cc,o=e.getAttribute("schemeIdUri")||"",s=e.getAttribute("value")||"",u=zi.S(e,"timescale",a)||1;zi.$(e,"Event").forEach(function(e){var t=zi.S(e,"presentationTime",a)||0,n=zi.S(e,"duration",a)||0,n=(t=t/u+i)+n/u;null!=r&&(t=Math.min(t,i+r),n=Math.min(n,i+r)),e={schemeIdUri:o,value:s,startTime:t,endTime:n,id:e.getAttribute("id")||"",eventElement:e},this.b.onTimelineRegionAdded(e)}.bind(this))},e.lh=function(e,t,n){return e=Er(e,t,n,this.a.retryParameters),e=this.b.networkingEngine.request(1,e),ze(this.g,e),e.promise.then(function(e){return e.data})},br.Xd("mpd",wr),br.gc("application/dash+xml",wr),br.gc("video/vnd.mpeg.dash.mpd",wr),Nr.prototype.toString=function(){var e="#"+this.name,t=this.a?this.a.map(function(e){return e.name+"="+(isNaN(Number(e.value))?'"'+e.value+'"':e.value)}):[];return this.value&&t.unshift(this.value),0<t.length&&(e+=":"+t.join(",")),e},Nr.prototype.getAttribute=function(t){var e=this.a.filter(function(e){return e.name==t});return e.length?e[0]:null};var Lr={Pb:function(e,t){return e.filter(function(e){return e.name==t})},xb:function(e,t){t=Lr.Pb(e,t);return t.length?t[0]:null},ud:function(e,n,i){return e.filter(function(e){var t=e.getAttribute("TYPE");return e=e.getAttribute("GROUP-ID"),t.value==n&&e.value==i})},od:function(e,t){return Qt([e],[t])[0]},Dd:function(e){return/^#(?!EXT)/m.test(e)}};function Ur(e){this.b=e,this.a=0}function _r(e){Or(e,/[ \t]+/gm)}function Or(e,t){t.lastIndex=e.a;t=null==(t=t.exec(e.b))?null:{position:t.index,length:t[0].length,oh:t};return e.a==e.b.length||null==t||t.position!=e.a?null:(e.a+=t.length,t.oh)}function Dr(e){return e.a!=e.b.length&&(e=Or(e,/[^ \t\n]*/gm))?e[0]:null}function Fr(){this.a=0}function jr(e,t,n){var i=(t=(t=vt(t)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(i[0]))throw new Pe(2,4,4015);t=0;for(var r=1;r<i.length;r++)if(!Lr.Dd(i[r])){var a=Kr(e,i[r]);if(--e.a,Br.includes(a.name)){t=1;break}"EXT-X-STREAM-INF"==a.name&&(r+=1)}for(r=[],a=1;a<i.length;)if(Lr.Dd(i[a]))a+=1;else{var o=Kr(e,i[a]);if(Gr.includes(o.name)){if(1!=t)throw new Pe(2,4,4017);return new xr(n,t,r,e=function(t,n,e,i){var r=[],a=[];return e.forEach(function(e){if(/^(#EXT)/.test(e))e=Kr(t,e),(Br.includes(e.name)?i:a).push(e);else{if(Lr.Dd(e))return[];e=Lr.od(n,e.trim()),r.push(new Rr(e,a)),a=[]}}),r}(e,n,i=i.splice(a,i.length-a),r))}r.push(o),a+=1,"EXT-X-STREAM-INF"==o.name&&(o.a.push(new Pr("URI",i[a])),a+=1)}return new xr(n,t,r)}function Kr(e,t){e=e.a++;if(!(a=t.match(/^#(EXT[^:]*)(?::(.*))?$/)))throw new Pe(2,4,4016,t);var n,i,t=a[1],r=a[2],a=[];if(r){(i=Or(r=new Ur(r),/^([^,=]+)(?:,|$)/g))&&(n=i[1]);for(var o=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;i=Or(r,o);)a.push(new Pr(i[1],i[2]||i[3]))}return new Nr(e,t,a,n)}var Br="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-MAP EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST".split(" "),Gr="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE".split(" ");function Vr(e){try{var t=Vr.parse(e);return _e({uri:e,Ud:e,data:t.data,headers:{"content-type":t.contentType}})}catch(e){return Le(e)}}function zr(){var e=this;this.a=this.f=null,this.Z=1,this.H=new Map,this.O=new Set,this.b=new Map,this.c=null,this.B="",this.w=new Fr,this.L=0,this.j=new ke(function(){var n;n=e,G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return(X.info("Updating manifest..."),n.f)?(z(e,2),V(e,n.update(),4)):e.return();case 4:t=n.L,n.j.R(t),H(e,0);break;case 2:if(t=W(e),!n.f)return e.return();t.severity=1,n.f.onError(t),n.j.R(.1),x(e)}})})}),this.g=ua,this.v=null,this.G=0,this.J=1/0,this.l=new Ve,this.K=[],this.s=new Map,this.Y=!1}function Hr(e){e.forEach(function(e){var t;e&&(t=(t=e.stream.codecs.split(",")).filter(function(e){return"mp4a.40.34"!=e}),e.stream.codecs=t.join(","))})}function Wr(c,l,d){return G(function e(){var n,i,r,a,o,s,u;return q(e,function(e){switch(e.o){case 1:return(n=ea(l,"URI"),c.b.has(n))?e.return(c.b.get(n)):(i=ea(l,"TYPE").toLowerCase(),u=tn,"subtitles"==i&&(i=u.Oa),r=Q(Mr(l,"LANGUAGE","und")),a=Mr(l,"NAME"),s=l.getAttribute("DEFAULT"),o="YES"==s,u=Mr(l,"CHANNELS"),t="audio"==i&&u?(t=u.split("/")[0],parseInt(t,10)):null,s=t,u=Mr(l,"CHARACTERISTICS"),V(e,qr(c,n,d,i,r,o,a,s,null,u),2));var t;case 2:return(u=e.A,c.b.has(n))?e.return(c.b.get(n)):null==u?e.return(null):(c.H.set(l.id,u),c.b.set(n,u),e.return(u))}})})}function qr(M,R,L,U,_,O,D,F,j,K){return G(function e(){var h,f,p,m,g,v,b,y,E,w,T,S,A,I,k,C,x,N,P;return q(e,function(e){switch(e.o){case 1:return f=(h=Lr).od(M.B,R),V(e,oa(M,Xe([f],M.a.retryParameters),0),2);case 2:if(S=e.A,f=S.uri,1!=(P=jr(M.w,S.data,f)).type)throw new Pe(2,4,4017);p=[],P.segments.forEach(function(e){e=h.Pb(e.b,"EXT-X-KEY"),p.push.apply(p,e)}),m=!1,g=[],v=null;for(var t=B(p),n=t.next();!n.done;n=t.next())if(E=n.value,"NONE"!=(y=ea(E,"METHOD"))){if(m=!0,"AES-128"==y)return X.u("Unsupported HLS Encryption",y),M.Y=!0,e.return(null);b=ea(E,"KEYFORMAT"),(E=(y=sa[b])?y(E):null)?(E.keyIds.length&&(v=E.keyIds[0]),g.push(E)):X.u("Unsupported HLS KEYFORMAT",b)}if(m&&!g.length)throw new Pe(2,4,4026);return i=M,r=P,a=ca,l=Lr.xb(r.a,"EXT-X-PLAYLIST-TYPE"),d=Lr.xb(r.a,"EXT-X-ENDLIST"),d=l&&"VOD"==l.value||d,l=l&&"EVENT"==l.value&&!d,l=!d&&!l,d?aa(i,a.ub):(aa(i,l?a.ve:a.Df),a=ta(r.a,"EXT-X-TARGETDURATION"),a=Number(a.value),i.G=Math.max(a,i.G),i.J=Math.min(a,i.J)),w=function(e,t){if(1==t.length)return t[0];e=Qr(e,t);if(null!=e)return e;throw new Pe(2,4,4025,t)}(U,L),V(e,(o=M,s=U,u=w,c=P,G(function e(){var t,n,i,r,a;return q(e,function(e){switch(e.o){case 1:return(t=tn,n=c.segments[0].a,r=new he(n),i=r.Ca.split(".").pop(),r=ra[s],r=r[i])?e.return(r):s==t.Oa?u&&"vtt"!=u&&"wvtt"!=u?e.return("application/mp4"):e.return("text/vtt"):((a=Xe([n],o.a.retryParameters)).method="HEAD",V(e,oa(o,a,1),2));case 2:if(a=e.A,!(a=a.headers["content-type"]))throw new Pe(2,4,4021,i);return e.return(a.split(";")[0])}})})),3);case 3:return T=e.A,ia.includes(T)&&(w=""),I=(A=h.xb(P.a,"EXT-X-MEDIA-SEQUENCE"))?Number(A.value):0,z(e,4),V(e,Jr(M,R,P,I,T,w),6);case 6:C=e.A,H(e,5);break;case 4:if(4035==(k=W(e)).code)return X.ba("Skipping unsupported HLS stream",T,R),e.return(null);throw k;case 5:if(S=C[0].startTime,A=C[C.length-1].endTime,I=A-S,k=new ir(C),C=Xr(P),P=void 0,"text"==U&&(P="subtitle"),x=[],K)for(n=(t=B(K.split(","))).next();!n.done;n=t.next())N=n.value,x.push(N);return P={id:M.Z++,originalId:D,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:k.find.bind(k),getSegmentReference:k.get.bind(k),initSegmentReference:C,presentationTimeOffset:0,mimeType:T,codecs:w,kind:P,encrypted:m,keyId:v,language:_,label:D,type:U,primary:O,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:x,channelsCount:F,audioSamplingRate:null,closedCaptions:j},e.return({stream:P,zc:k,drmInfos:g,jd:R,Jf:f,Ld:S,Ph:A,duration:I})}var o,s,u,c,i,r,a,l,d})})}function Xr(e){var t=Lr.Pb(e.a,"EXT-X-MAP");if(!t.length)return null;if(1<t.length)throw new Pe(2,4,4020);var n=ea(t=t[0],"URI"),i=Lr.od(e.b,n);return e=0,n=null,(t=Mr(t,"BYTERANGE"))&&(e=t.split("@"),t=Number(e[0]),n=(e=Number(e[1]))+t-1),new er(function(){return[i]},e,n)}function Yr(e,t,n,i){var r=t.b,a=t.a;t=ta(r,"EXTINF").value.split(","),t=i+Number(t[0]);var o=0,s=null;return(r=Lr.xb(r,"EXT-X-BYTERANGE"))&&(o=r.value.split("@"),r=Number(o[0]),s=(o=o[1]?Number(o[1]):e.a+1)+r-1),new tr(n,i,t,function(){return[a]},o,s)}function $r(t){t.c&&(t.K.forEach(function(e){t.c.$b(e,0)}),t.K=[])}function Jr(v,b,y,E,w,T){return G(function e(){var n,i,r,a,h,f,p,m,g;return q(e,function(e){switch(e.o){case 1:return n=y.segments,i=[],r=n[0].a,a=Yr(null,n[0],E,0),h=Xr(y),V(e,(o=v,s=b,u=h,c=a,l=w,d=T,G(function e(){var i,r,a;return q(e,function(e){switch(e.o){case 1:if(o.v){if(r=o.b.get(s),r=r.zc,r=r.get(c.position))return X.I("Found segment start time in previous manifest"),e.return(r.startTime);X.debug("Unable to find segment start time in previous manifest!")}if(X.I("Fetching segment to find start time"),l=l.toLowerCase(),ia.includes(l))throw X.ba("Raw formats are not yet supported.  Skipping "+l),new Pe(1,4,4035);if("video/webm"==l)throw X.ba("WebM in HLS is not yet supported.  Skipping."),new Pe(1,4,4035);if("video/mp4"==l||"audio/mp4"==l)return i=[Zr(o,c)],u&&i.push(Zr(o,u)),V(e,Promise.all(i),3);e.C(2);break;case 3:return r=e.A,i=r[0],r=r[1]||r[0],e.return(function(e,t,n,i){var r=0;if((new Di).P("moov",Fi).P("trak",Fi).P("mdia",Fi).za("mdhd",function(e){e.reader.V(0==e.version?8:16),r=e.reader.M(),e.parser.stop()}).parse(i,!0),!r)throw X.error("Unable to find timescale in init segment!"),new Pe(2,4,4030,e,t);var a=0,o=!1;if((new Di).P("moof",Fi).P("traf",Fi).za("tfdt",function(e){a=(0==e.version?e.reader.M():e.reader.fc())/r,o=!0,e.parser.stop()}).parse(n,!0),!o)throw new Pe(2,4,4030,e,t);return a}(s,i.uri,i.data,r.data));case 2:if("video/mp2t"==l)return V(e,Zr(o,c),5);e.C(4);break;case 5:return a=e.A,e.return(function(e,t,n){function i(){a.seek(o+188),71!=(s=a.Ea())&&(a.seek(o+192),s=a.Ea()),71!=s&&(a.seek(o+204),s=a.Ea()),71!=s&&r(),a.nf(1)}function r(){throw new Pe(2,4,4030,e,t)}for(var a=new Ui(new DataView(n),0),o=0,s=0;;)if(o=a.va(),71!=(s=a.Ea())&&r(),8191==(8191&(n=a.xc())))i();else if(16384&n){if(0!=(n=(48&a.Ea())>>4)&&2!=n||r(),3==n&&(n=a.Ea(),a.V(n)),1==a.M()>>8){a.V(3),0!=(n=a.Ea()>>6)&&1!=n||r(),0==a.Ea()&&r(),n=a.Ea();var u=a.xc(),c=a.xc();return(1073741824*((14&n)>>1)+((65534&u)<<14|(65534&c)>>1))/9e4}i()}else i()}(s,a.uri,a.data));case 4:if("application/mp4"==l||l.startsWith("text/"))return V(e,Zr(o,c),7);e.C(6);break;case 7:return a=e.A,e.return((t=l,n=d,e=a.data,Cn(t=at(t,n))?(xn(n=new In(null),t),n.Rc(e)):0));case 6:throw new Pe(2,4,4030,s)}var t,n})})),2);case 2:f=e.A,X.debug("First segment",r.split("/").pop(),"starts at",f);for(var t=0;t<n.length;++t)p=n[t],m=i[i.length-1],g=0==t?f:m.endTime,g=Yr(m,p,E+t,g),i.push(g);return v.K.push(i),$r(v),e.return(i)}var o,s,u,c,l,d})})}function Zr(a,o){return G(function e(){var t,n,i,r;return q(e,function(e){switch(e.o){case 1:return(r=1,t=Er(o.c(),o.b,o.b+2048-1,a.a.retryParameters),n=Er(o.c(),o.b,o.a,a.a.retryParameters),a.a.hls.useFullSegmentsForStartTime)?e.return(oa(a,n,r)):(z(e,2),V(e,oa(a,t,r),4));case 4:return i=e.A,e.return(i);case 2:if(7001==(i=W(e)).code)throw i;return X.ba("Unable to fetch a partial HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",t.uris[0]),V(e,oa(a,n,r),5);case 5:return r=e.A,e.return(r)}})})}function Qr(e,t){for(var n=na[e],i=0;i<n.length;i++)for(var r=0;r<t.length;r++)if(n[i].test(t[r].trim()))return t[r].trim();return"text"==e?"":null}function ea(e,t){e=e.getAttribute(t);if(!e)throw new Pe(2,4,4023,t);return e.value}function ta(e,t){e=Lr.xb(e,t);if(!e)throw new Pe(2,4,4024,t);return e}_("shaka.net.DataUriPlugin",Vr),Vr.parse=function(e){var t=e.split(":");if(t.length<2||"data"!=t[0])throw X.error("Bad data URI, failed to parse scheme"),new Pe(2,1,1004,e);if((t=t.slice(1).join(":").split(",")).length<2)throw X.error("Bad data URI, failed to extract encoding and MIME type"),new Pe(2,1,1004,e);var n=t[0];e=d.decodeURIComponent(t.slice(1).join(",")),n=(t=n.split(";"))[0];var i=!1;return 1<t.length&&"base64"==t[t.length-1]&&(i=!0,t.pop()),{data:i?At.Za(e).buffer:Et(e),contentType:n}},qe("data",Vr),_("shaka.hls.HlsParser",zr),(e=zr.prototype).configure=function(e){this.a=e},e.start=function(n,i){var r=this;return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return r.f=i,V(e,oa(r,Xe([n],r.a.retryParameters),0),2);case 2:return t=e.A,r.B=t.uri,V(e,(p=r,m=t.data,G(function e(){var i,r,a,o,s,l,d,h,f;return q(e,function(e){switch(e.o){case 1:if(0!=(l=jr(p.w,m,p.B)).type)throw new Pe(2,4,4022);return V(e,(u=p,c=l,G(function e(){var t,n,i,r,a,o,s;return q(e,function(e){switch(e.o){case 1:return t=Lr,s=Zt,n=c.a,r=t.Pb(c.a,"EXT-X-MEDIA"),i=r.filter(function(e){return"SUBTITLES"==ea(e,"TYPE")}.bind(u)),i=i.map(function(r){var a=this;return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return a.a.disableText?e.return(null):(z(e,2),V(e,(n=a,i=r,G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return ea(i,"TYPE"),V(e,Wr(n,i,[]),2);case 2:return t=e.A,e.return(t.stream)}})})),4));case 4:return e.return(e.A);case 2:if(t=W(e),a.a.hls.ignoreTextStreamFailures)return e.return(null);throw t}var n,i})})}.bind(u)),r=r.filter(function(e){return"CLOSED-CAPTIONS"==ea(e,"TYPE")}),function(e,t){for(var n=B(t),i=n.next();!i.done;i=n.next()){ea(i=i.value,"TYPE");var r=Mr(i,"LANGUAGE")||"und";r=Q(r);var a=ea(i,"GROUP-ID");i=ea(i,"INSTREAM-ID"),e.s.get(a)||e.s.set(a,new Map),e.s.get(a).set(i,r)}}(u,r),V(e,Promise.all(i),2);case 2:return a=e.A,o=t.Pb(n,"EXT-X-STREAM-INF"),o=o.map(function(e){return S=this,A=e,I=c,G(function e(){var t,n,i,r,c,l,d,h,f,p,m,g,v,b,y,E,w,T;return q(e,function(e){switch(e.o){case 1:return t=tn,n=Lr,f=[],S.a.disableVideo||f.push("avc1.42E01E"),S.a.disableAudio||f.push("mp4a.40.2"),E=f.join(","),g=Mr(A,"CODECS",E),i=function(e){for(var t=new Set,n=[],i=(e=B(e)).next();!i.done;i=e.next()){var r=ot(i=i.value)[0];t.has(r)?X.debug("Ignoring duplicate codec"):(n.push(i),t.add(r))}return n}(g.split(/\s*,\s*/)),r=A.getAttribute("RESOLUTION"),l=c=null,d=Mr(A,"FRAME-RATE"),h=Number(ea(A,"BANDWIDTH")),r&&(p=r.value.split("x"),c=p[0],l=p[1]),v=(v=(v=n.Pb(I.a,"EXT-X-MEDIA")).filter(function(e){return"CLOSED-CAPTIONS"!=ea(e,"TYPE")})).filter(function(e){var t=Mr(e,"URI")||"";return"SUBTITLES"==(Mr(e,"TYPE")||"")||""!=t}),f=Mr(A,"AUDIO"),E=Mr(A,"VIDEO"),f?v=n.ud(v,"AUDIO",f):E&&(v=n.ud(v,"VIDEO",E)),(g=Qr(t.Oa,i))&&((p=Mr(A,"SUBTITLES"))&&(m=n.ud(v,"SUBTITLES",p)).length&&(w=S.H.get(m[0].id))&&(w.stream.codecs=g),Ke(i,g)),w=v.map(function(e){return Wr(this,e,i)}.bind(S)),g=[],v=[],V(e,Promise.all(w),2);case 2:if(w=(w=e.A).filter(function(e){return null!=e}),f?g=w:E&&(v=w),X.debug("Guessing stream type for",A.toString()),E=!1,g.length||v.length?g.length?(w=ea(A,"URI"),T=g[0].jd,w==T?(X.debug("Guessing audio-only."),y=t.jc,E=!0):(X.debug("Guessing video."),y=t.tb)):(X.debug("Guessing audio."),y=t.jc):1==i.length?(T=Qr(t.tb,i),y=r||d||T?(X.debug("Guessing video-only."),t.tb):(X.debug("Guessing audio-only."),t.jc)):(X.debug("Guessing multiplexed audio+video."),y=t.tb,i=[i.join(",")]),E){e.C(3);break}return V(e,(a=S,o=A,s=i,u=y,G(function e(){var t,n,i,r;return q(e,function(e){switch(e.o){case 1:return(t=tn,n=ea(o,"URI"),a.b.has(n))?e.return(a.b.get(n)):(i=Mr(o,"CLOSED-CAPTIONS"),r=null,u==t.tb&&i&&"NONE"!=i&&(r=a.s.get(i)),V(e,qr(a,n,s,u,"und",!1,null,null,r,null),2));case 2:return null==(r=e.A)?e.return(null):a.b.has(n)?e.return(a.b.get(n)):(a.b.set(n,r),e.return(r))}})})),4);case 4:b=e.A;case 3:if(b)b.stream.type==t.jc?g=[b]:v=[b];else if(null===b)return X.debug("streamInfo is null"),e.return([]);return v&&Hr(v),g&&Hr(g),e.return(function(e,t,n,i,r,a,o){n.forEach(function(e){(e=e.stream)&&(e.width=Number(r)||void 0,e.height=Number(a)||void 0,e.frameRate=Number(o)||void 0)}.bind(e));var s=!!e.a&&e.a.disableAudio;t.length&&!s||(t=[null]);s=!!e.a&&e.a.disableVideo,n.length&&!s||(n=[null]);s=[];for(var u=(t=B(t)).next();!u.done;u=t.next()){u=u.value;for(var c=B(n),l=c.next();!l.done;l=c.next()){var d=l.value;l=u?u.stream:null;var h=d?d.stream:null,f=u?u.drmInfos:null,p=d?d.drmInfos:null;d=(d?d.jd:"")+" - "+(u?u.jd:"");var m=void 0;if(l&&h){if(f.length&&p.length&&!(0<jt(f,p).length)){X.u("Incompatible DRM info in HLS variant.  Skipping.");continue}m=jt(f,p)}else l?m=f:h&&(m=p);e.O.has(d)?X.debug("Skipping variant which only differs in text streams."):(l=function(e,t,n,i,r){return{id:e.Z++,language:t?t.language:"und",primary:!!t&&t.primary||!!n&&n.primary,audio:t,video:n,bandwidth:i,drmInfos:r,allowedByApplication:!0,allowedByKeySystem:!0}}(e,l,h,i,m),s.push(l),e.O.add(d))}}return s}(S,g,v,h,c,l,d))}var a,o,s,u})});var S,A,I}.bind(u)),V(e,Promise.all(o),3);case 3:return o=e.A,s=(s=o.reduce(s.nd,[])).filter(function(e){return null!=e}),e.return({startTime:0,variants:s,textStreams:a.filter(function(e){return null!=e})})}})})),2);case 2:if(i=e.A,!p.f)throw new Pe(2,7,7001);if(p.Y&&0==i.variants.length)throw X.info("No stream is created, because we don't support AES-128","encryption yet"),new Pe(2,4,4034);p.f.filterAllPeriods([i]),r=1/0,o=1/(a=0);for(var t=B(p.b.values()),n=t.next();!n.done;n=t.next())s=n.value,r=Math.min(r,s.Ld),a=Math.max(a,s.Ld),"text"!=s.stream.type&&(o=Math.min(o,s.duration));if(p.g!=ca.ub?(p.c=new yr(0,3*p.G),p.c.Bc(!1)):(p.c=new yr(null,0),p.c.Bc(!0)),$r(p),p.g!=ca.ub){for(p.L=p.J,p.g==ca.ve&&(l=p.c.ad,isNaN(p.a.availabilityWindowOverride)||(l=p.a.availabilityWindowOverride),p.c.ie(l)),d=0;95443.7176888889<=a;)d+=95443.7176888889,a-=95443.7176888889;if(d)for(X.debug("Offsetting live streams by",d,"to compensate for rollover"),n=(t=B(p.b.values())).next();!n.done;n=t.next())(h=n.value).Ld<95443.7176888889?(X.I("Offset applied to",h.stream.type),h.stream.presentationTimeOffset=-d,h.zc.offset(d)):X.I("Offset NOT applied to",h.stream.type)}else for(p.c.Ua(o),p.c.offset(-r),n=(t=B(p.b.values())).next();!n.done;n=t.next())(f=n.value).stream.presentationTimeOffset=r,f.zc.offset(-r),rr(f.zc,o);p.v={presentationTimeline:p.c,periods:[i],offlineSessionIds:[],minBufferTime:0},x(e)}var u,c})})),3);case 3:return 0<(t=r.L)&&r.j.R(t),e.return(r.v)}var p,m})})},e.stop=function(){this.j&&(this.j.stop(),this.j=null);var e=[];return this.l&&(e.push(this.l.destroy()),this.l=null),this.a=this.f=null,this.H.clear(),this.O.clear(),this.b.clear(),this.v=null,Promise.all(e)},e.update=function(){if(this.g!=ca.ub){for(var e=[],t=B(this.b.values()),n=t.next();!n.done;n=t.next())e.push(function(o,s){return G(function e(){var t,n,i,r,a;return q(e,function(e){switch(e.o){case 1:return t=Lr,n=ca,r=s.Jf,V(e,oa(o,Xe([r],o.a.retryParameters),0),2);case 2:if(r=e.A,1!=(i=jr(o.w,r.data,r.uri)).type)throw new Pe(2,4,4017);return r=(a=t.xb(i.a,"EXT-X-MEDIA-SEQUENCE"))?Number(a.value):0,a=s.stream,V(e,Jr(o,s.jd,i,r,a.mimeType,a.codecs),3);case 3:a=e.A,s.zc.a=a,a=a[a.length-1],t.xb(i.a,"EXT-X-ENDLIST")&&(aa(o,n.ub),o.c.Ua(a.endTime)),x(e)}})})}(this,n.value));return Promise.all(e)}},e.onExpirationUpdated=function(){};var na={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]},ia=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"],ra={audio:{mp4:"audio/mp4",mp4a:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},video:{mp4:"video/mp4",mp4v:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",cmfv:"video/mp4",ts:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",ttml:"application/ttml+xml"}};function aa(e,t){e.g=t,e.c&&e.c.Bc(e.g==ca.ub),e.g!=ca.ub||e.j.stop()}function oa(e,t,n){if(!e.l)throw new Pe(2,7,7001);return t=e.f.networkingEngine.request(n,t),ze(e.l,t),t.promise}var sa={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(e){var t=ea(e,"METHOD");Xn("HLS SAMPLE-AES-CENC","SAMPLE-AES-CENC will no longer be supported, see Issue #1227");var n=["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"];return n.includes(t)?(t=ea(e,"URI"),t=Vr.parse(t),t=en("com.widevine.alpha",[{initDataType:"cenc",initData:t=new Uint8Array(t.data)}]),(e=Mr(e,"KEYID"))&&(t.keyIds=[e.toLowerCase().substr(2)]),t):(X.error("Widevine in HLS is only supported with [",n.join(", "),"], not",t),null)}},ua="VOD",ca={ub:ua,Df:"EVENT",ve:"LIVE"};function la(){this.a=new Map}function da(e,t,n){ha(e,t).text=n}function ha(e,t){return e.a.has(t)||e.a.set(t,new fa),e.a.get(t)}function fa(){this.text=this.variant=null}function pa(e,t){this.a=e,this.b=new Set([e]);for(var n=B(t=t||[]),i=n.next();!i.done;i=n.next())this.add(i.value)}function ma(e,t){var n,i;return!(i=!!e.audio!=!!t.audio||!!e.video!=!!t.video||e.language!=t.language)&&(i=e.audio&&t.audio)&&(i=e.audio,n=t.audio,i=!(i.channelsCount==n.channelsCount&&ga(i,n)&&va(i.roles,n.roles))),!i&&(i=e.video&&t.video)&&(i=!(ga(i=e.video,n=t.video)&&va(i.roles,n.roles))),!i}function ga(e,t){if(e.mimeType==t.mimeType){var n=e.codecs.split(",").map(function(e){return ot(e)[0]}),i=t.codecs.split(",").map(function(e){return ot(e)[0]});if(n.length==i.length){n.sort(),i.sort();for(var r=0;r<n.length;r++)if(n[r]!=i[r])return;return 1}}}function va(e,t){var n=new Set(e),i=new Set(t);if(n.delete("main"),i.delete("main"),n.size==i.size){for(var r=(n=B(n)).next();!r.done;r=n.next())if(!i.has(r.value))return;return 1}}function ba(e){this.a=e,this.b=new ya(e.language,"",e.audio&&e.audio.channelsCount?e.audio.channelsCount:0,"")}function ya(e,t,n,i){this.c=e,this.f=t,this.a=n,this.b=void 0===i?"":i}function Ea(){this.a=Sa,this.b=(new Map).set(Sa,2).set(Ta,1)}function wa(e,t,n){e.b.set(Sa,n).set(Ta,t)}br.Xd("m3u8",zr),br.gc("application/x-mpegurl",zr),br.gc("application/vnd.apple.mpegurl",zr),pa.prototype.add=function(e){return ma(this.a,e)?(this.b.add(e),!0):(X.u("Rejecting variant - not compatible with root."),!1)},pa.prototype.values=function(){return this.b.values()},ba.prototype.create=function(e){var t=this,n=e.filter(function(e){return ma(t.a,e)});return n.length?new pa(n[0],n):this.b.create(e)},ya.prototype.create=function(e){var t,n,i=[];a=e,t=this.c,i=(n=ne(Q(t),a.map(te)))?a.filter(function(e){return n==te(e)}):[];var r,a,o,s=e.filter(function(e){return e.primary}),i=i.length?i:s.length?s:e;for(a=i,r=this.f,(e=a.filter(function(e){return!!e.audio&&(r?e.audio.roles.includes(r):0==e.audio.roles.length)})).length?i=e:X.u("No exact match for variant role could be found."),this.a&&((e=zn.Ie(i,this.a)).length?i=e:X.u("No exact match for the channel count could be found.")),this.b&&(a=i,o=this.b,(e=a.filter(function(e){return!!e.audio&&e.audio.label.toLowerCase()==o.toLowerCase()})).length?i=e:X.u("No exact match for variant label could be found.")),e=new pa(i[0]),s=(i=B(i)).next();!s.done;s=i.next())s=s.value,ma(e.a,s)&&e.add(s);return e};var Ta=0,Sa=1;function Aa(e,t){this.g=e,this.j=ka(e),this.a=e.a.currentTime,this.f=Date.now()/1e3,this.b=!1,this.l=t,this.c=function(){}}function Ia(e){this.a=e}function ka(e){if(e.a.paused||0==e.a.playbackRate||0==e.a.buffered.length)var t=!1;else e:{t=e.a.buffered,e=e.a.currentTime;for(var n=0;n<t.length;n++){var i=t.start(n),r=t.end(n);if(!(e<i-.1||r-.5<e)){t=!0;break e}}t=!1}return t}function Ca(e,t,n,i,r){var a=this;this.a=e,this.B=t,this.w=n,this.s=r,this.f=new Ze,this.l=!1,this.v=e.readyState,this.c=!1,this.b=i,this.j=!1,this.f.m(e,"waiting",function(){return xa(a)}),this.g=new ke(function(){xa(a)}).Ia(.25)}function xa(e){if(0!=e.a.readyState){if(e.a.seeking){if(!e.l)return}else e.l=!1;var t,n,i,r,a,o,s,u;if(!e.a.paused)if(e.a.readyState!=e.v&&(e.c=!1,e.v=e.a.readyState),(t=!e.b)||(i=ka(n=(t=e.b).g),r=n.a.currentTime,a=Date.now()/1e3,t.a==r&&t.j==i||(t.f=a,t.a=r,t.j=i,t.b=!1),(i=(r=a-t.f)>=t.l&&i&&!t.b)&&(t.c(t.a,r),t.b=!0,t.a=n.a.currentTime),t=!i),t){a=e.w.smallGapLimit,t=e.a.currentTime;e:{if((n=e.a.buffered)&&n.length&&!(1==n.length&&n.end(0)-n.start(0)<1e-6))for(i=lt()||ft("Trident/")||ft("Tizen")||ft("CrKey")?.5:.1,r=0;r<n.length;r++)if(n.start(r)>t&&(0==r||n.end(r-1)-t<=i)){i=r;break e}i=null}null==i||0==i&&!e.j||(r=n.start(i),(o=e.B.ab())<=r||(a=(o=r-t)<=a,s=!1,o<.001||(a||e.c||(e.c=!0,(u=new D("largegap",{currentTime:t,gapSize:o})).cancelable=!0,e.s(u),e.w.jumpLargeGaps&&!u.defaultPrevented?s=!0:X.info("Ignoring large gap at",t,"size",o)),(a||s)&&(0==i?X.info("Jumping forward",o,"seconds because of gap before start time of",r):X.info("Jumping forward",o,"seconds because of gap starting at",n.end(i-1),"and ending at",r),e.a.currentTime=r))))}}}function Na(e){var t=this;this.c=e,this.a=new Set,this.b=new ke(function(){Pa(t,!1)}).Ia(.25)}function Pa(e,t){for(var n=B(e.a),i=n.next();!i.done;i=n.next())i.value.g(e.c.currentTime,t)}function Ma(e){for(var t=[],n=(e=B(e)).next();!n.done;n=e.next())for(var i=(n=B(n.value.variants)).next();!i.done;i=n.next())t.push(i.value);return t}function Ra(e,t){for(var n=null,i=B(e),r=i.next();!r.done;r=i.next())t>=(r=r.value).startTime&&(n=r);return n}function La(e){this.c=e,this.a=null,this.b=function(){}}function Ua(e){var t=this;this.a=e,this.f=!1,this.c=this.a.Qc(),this.b=new ke(function(){t.a.Ue(.25*t.c)})}function _a(e){e.b.stop();var t=e.f?0:e.c;if(0<=t)try{return void(e.a.Qc()!=t&&e.a.fe(t))}catch(e){}e.b.Ia(.25),0!=e.a.Qc()&&e.a.fe(0)}function Oa(e,t,n,i){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?i():(t=Da.get(t),n.Ha(e,t,i))}Aa.prototype.release=function(){this.g=null,this.c=function(){}},Ca.prototype.release=function(){this.f&&(this.f.release(),this.f=null),null!=this.g&&(this.g.stop(),this.g=null),this.b&&(this.b.release(),this.b=null),this.a=this.B=this.s=null},Ca.prototype.Sd=function(){this.j=!0,xa(this)},Na.prototype.release=function(){this.b.stop();for(var e=B(this.a),t=e.next();!t.done;t=e.next())t.value.release();this.a.clear()},La.prototype.release=function(){this.a=this.c=null,this.b=function(){}},La.prototype.g=function(e){var t=this.a,n=this.c.periods;t!=(e=Ra(n,e)||n[0])&&this.b(e),this.a=e},Ua.prototype.release=function(){this.b&&(this.b.stop(),this.b=null),this.a=null},Ua.prototype.set=function(e){this.c=e,_a(this)};var Da=new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]]);function Fa(e,t,n){var i=this;this.a=e,this.g=t,this.f=n,this.j=!1,this.b=new Ze,this.c=new Va(e),Oa(this.a,HTMLMediaElement.HAVE_METADATA,this.b,function(){Ba(i,i.f)})}function ja(e){return e.j?e.a.currentTime:e.f}function Ka(e,t){0<e.a.readyState?za(e.c,t):Oa(e.a,HTMLMediaElement.HAVE_METADATA,e.b,function(){Ba(e,e.f)})}function Ba(e,t){Math.abs(e.a.currentTime-t)<.001?Ga(e):(e.b.Ha(e.a,"seeking",function(){Ga(e)}),za(e.c,0==e.a.currentTime?t:e.a.currentTime))}function Ga(e){e.j=!0,e.b.m(e.a,"seeking",function(){return e.g()})}function Va(e){var t=this;this.b=e,this.j=10,this.g=this.c=this.f=0,this.a=new ke(function(){t.f<=0?(X.u(["Failed to move playhead from",t.c,"to",t.g].join(" ")),t.a.stop()):t.b.currentTime!=t.c?t.a.stop():(t.b.currentTime=t.g,t.f--)})}function za(e,t){e.c=e.b.currentTime,e.g=t,e.f=e.j,e.b.currentTime=t,e.a.Ia(.1)}function Ha(e){var t=this;this.a=e,this.f=!1,this.c=null,this.b=new Ze,Oa(this.a,HTMLMediaElement.HAVE_CURRENT_DATA,this.b,function(){null==t.c?t.f=!0:(t.b.Ha(t.a,"seeking",function(){t.f=!0}),t.a.currentTime=Math.max(0,t.a.currentTime+t.c))})}function Wa(e,t,n,i,r,a){var o=this;this.c=e,this.a=t.presentationTimeline,this.G=t.minBufferTime||0,this.j=n,this.B=r,this.s=null,this.f=new Ca(e,t.presentationTimeline,n,function(n,e){if(!e.stallEnabled)return null;var i=e.stallSkip,e=new Aa(new Ia(n),e.stallThreshold);return function(e,t){e.c=t}(e,function(e,t){X.debug("Stall detected at "+e+" for "+t+" seconds."),i?(X.debug("Seeking forward "+i+" seconds to break stall."),n.currentTime+=i):(X.debug("Pausing and unpausing to break stall."),n.pause(),n.play())}),e}(e,n),a),this.b=new Fa(e,function(){e:{var e=o.f;e.l=!0,e.j=!1,e.c=!1,e=ja(o.b);var t=Xa(o,e);if(.001<Math.abs(t-e)){var n=Date.now()/1e3;if(!o.s||o.s<n-1){o.s=n,Ka(o.b,t),e=void 0;break e}}X.I("Seek to "+e),o.B(),e=void 0}return e},(e=this,null==(i=i)?i=1/0>e.a.ra()?e.a.Rb():e.a.ab():i<0&&(i=e.a.ab()+i),qa(e,Ya(e,i)))),this.l=new ke(function(){var e,t,n;0==o.c.readyState||o.c.paused||(e=ja(o.b),t=o.a.Rb(),(n=o.a.ab())-t<3&&(t=n-3),e<t&&(t=Xa(o,e),X.info("Jumping forward "+(t-e)+" seconds to catch up with the seek range."),o.c.currentTime=t))}).Ia(.25)}function qa(e,t){var n=e.a.ra();return n<=t?n-e.j.durationBackoff:t}function Xa(e,t){var n=Yt.bind(null,e.c.buffered),i=Math.max(e.G,e.j.rebufferingGoal),r=e.j.safeSeekOffset,a=e.a.Rb(),o=e.a.ab(),s=e.a.ra();o-a<3&&(a=o-3);var u=e.a.qc(i),c=e.a.qc(r),i=e.a.qc(i+r);return s<=t?(X.I("Playhead past duration."),qa(e,t)):o<t?(X.I("Playhead past end."),o):t<a?n(c)?(X.I("Playhead before start & start is buffered"),c):(X.I("Playhead before start & start is unbuffered"),i):u<=t||n(t)?(X.I("Playhead in safe region or in buffered region."),t):(X.I("Playhead outside safe region & in unbuffered region."),i)}function Ya(e,t){var n=e.a.Rb();return t<n||(n=e.a.ab())<t?n:t}function $a(e){var i=this;this.b=function(){},this.a=new Set,this.f=e,this.c=new ke(function(){for(var e=i.f(),t=B(i.a),n=t.next();!n.done;n=t.next())(n=n.value).endTime<e.start&&i.a.delete(n)}).Ia(2)}function Ja(e){var n=this;this.j=e,this.f=new Map,this.a=function(){},this.b=function(){},this.c=function(){},this.l=[{Mb:null,Lb:Qa,Ab:function(e,t){return n.a(e,t)}},{Mb:Za,Lb:Qa,Ab:function(e,t){return n.a(e,t)}},{Mb:eo,Lb:Qa,Ab:function(e,t){return n.a(e,t)}},{Mb:Qa,Lb:Za,Ab:function(e,t){return n.b(e,t)}},{Mb:Qa,Lb:eo,Ab:function(e,t){return n.b(e,t)}},{Mb:Za,Lb:eo,Ab:function(e,t){return n.c(e,t)}},{Mb:eo,Lb:Za,Ab:function(e,t){return n.c(e,t)}}]}Fa.prototype.release=function(){this.b&&(this.b.release(),this.b=null),null!=this.c&&(this.c.release(),this.c=null),this.g=function(){},this.a=null},Va.prototype.release=function(){this.a&&(this.a.stop(),this.a=null),this.b=null},Ha.prototype.release=function(){this.b&&(this.b.release(),this.b=null),this.a=null},Ha.prototype.v=function(e){this.c=this.f?this.c:e},Ha.prototype.g=function(){return(this.f?this.a.currentTime:this.c)||0},Ha.prototype.w=function(){},Wa.prototype.release=function(){this.b&&(this.b.release(),this.b=null),this.f&&(this.f.release(),this.f=null),this.l&&(this.l.stop(),this.l=null),this.c=this.b=this.a=this.j=null,this.B=function(){}},Wa.prototype.v=function(e){Ka(this.b,e)},Wa.prototype.g=function(){var e=ja(this.b);return 0<this.c.readyState&&!this.c.paused?Ya(this,e):e},Wa.prototype.w=function(){this.f.Sd()},$a.prototype.release=function(){this.b=function(){},this.a.clear(),this.c.stop()},Ja.prototype.release=function(){this.j=null,this.f.clear(),this.a=function(){},this.b=function(){},this.c=function(){}},Ja.prototype.g=function(e,t){for(var n=B(this.j.a),i=n.next();!i.done;i=n.next()){i=i.value;var r=this.f.get(i),a=e<i.startTime?Za:e>i.endTime?eo:Qa;this.f.set(i,a);for(var o=B(this.l),s=o.next();!s.done;s=o.next())(s=s.value).Mb==r&&s.Lb==a&&s.Ab(i,t)}};var Za=1,Qa=2,eo=3;function to(e,t){this.a=t,this.c=e,this.g=null,this.s=1,this.B=Promise.resolve(),this.j=[],this.l=new Map,this.b=new Map,this.w=!1,this.J=null,this.H=this.f=this.v=!1,this.G=0}function no(e){return ro(e,"audio")}function io(e){return ro(e,"video")}function ro(e,t){t=e.b.get(t);return t?t.mb||t.stream:null}function ao(o,s){return G(function e(){var t,n,i,r,a;return q(e,function(e){switch(e.o){case 1:return t=tn,V(e,Kn(o.a.U,t.Oa),2);case 2:return o.G++,o.H=!1,n=o.G,i=o.a.U,r=new Map,a=new Set,r.set(t.Oa,s),a.add(s),V(e,i.init(r,!1),3);case 3:return o.f?e.return():V(e,po(o,a),4);case 4:if(o.f)return e.return();a=o.a.U.g.isTextVisible()||o.g.alwaysStreamText,o.G!=n||o.b.has(t.Oa)||o.H||!a||(a=o.a.yb(),a=To(o,a),a=ho(s,a,0),o.b.set(t.Oa,a),ko(o,a,0)),x(e)}})})}function oo(e,t){var n,i=e.b.get("video");!i||(n=i.stream)&&(X.debug("setTrickPlay",t),t?(t=n.trickModeVideo)&&!i.mb&&(X.debug("Engaging trick mode stream",t),uo(e,t,!1,0,!1),i.mb=n):(n=i.mb)&&(X.debug("Restoring non-trick-mode stream",n),uo(e,n,!(i.mb=null),0,!1)))}function so(e,t,n,i){var r,a=!1;return t.video&&(r=uo(e,t.video,n,i,!1),a=a||r),t.audio&&(e=uo(e,t.audio,n,i,!1),a=a||e),a}function uo(t,e,n,i,r){var a=t.b.get(e.type);if(!a&&"text"==e.type&&t.g.ignoreTextStreamFailures)return ao(t,e),!0;if(!a)return!1;var o=So(t,e),s=Array.from(t.b.values()).every(function(e){return e.Ba==a.Ba});return n&&o!=a.Ba&&s?(X.debug("switch: switching to stream in another Period; clearing buffer and changing Periods"),t.b.forEach(function(e){co(t,e)}),!0):(a.mb&&(X.debug("switch during trick play mode",e),e.trickModeVideo?(e=(a.mb=e).trickModeVideo,X.debug("switch found trick play stream",e)):(a.mb=null,X.debug("switch found no special trick play stream"))),!(!(s=t.j[o])||!s.hc)&&(!(!(s=t.l.get(e.id))||!s.hc)&&(a.stream!=e||r?("text"==e.type&&Ln(t.a.U,at(e.mimeType,e.codecs)),a.stream=e,a.Tc=!0,X.debug("switch: switching to Stream "+Po(a)),function(e,t,n){if(!t.Fb)return!1;var i=e.a.yb(),r=On(e.a.U,t.type),a=vo(e,t,i,r,n);return n=a&&a.a?a.a-a.b:null,a&&!n&&(n=(a.endTime-a.Rc())*t.stream.bandwidth/8),!isNaN(n)&&((a=t.stream.initSegmentReference)&&(n+=(a.a?a.a-a.b:null)||0),a=e.a.getBandwidthEstimate(),8*n/a<r-i-Math.max(e.c.minBufferTime||0,e.g.rebufferingGoal)||t.Fb.b.a>n)}(t,a,o)&&(X.info("Aborting current segment request to switch."),a.Fb.abort()),n&&(a.vb?a.kd=!0:a.kb?(a.qb=!0,a.Kc=i,a.kd=!0):(Co(a),Io(t,a,!0,i).catch(function(e){t.a&&t.a.onError(e)}))),!0):(X.debug("switch: Stream "+Po(a)+" already active"),!1))))}function co(t,e){var n=Po(e);e.vb?X.debug(n,"clear: already clearing the buffer"):e.qb?X.debug(n,"clear: already waiting"):e.kb?(X.debug(n,"clear: currently updating"),e.qb=!0,e.Kc=0):null==_n(t.a.U,e.type)?(X.debug(n,"clear: nothing buffered"),null==e.hb&&ko(t,e,0)):(X.debug(n,"clear: handling right now"),Co(e),Io(t,e,!1,0).catch(function(e){t.a&&t.a.onError(e)}))}function lo(u,c,l,d,h){return G(function e(){var i,r,a,o,s;return q(e,function(e){switch(e.o){case 1:return o=u.a.yb(),i=To(u,o),s=tn,r=new Map,a=new Set,c&&(r.set(s.jc,c),a.add(c)),l&&(r.set(s.tb,l),a.add(l)),d&&(r.set(s.Oa,d),a.add(d)),o=u.a.U,s=u.g.forceTransmuxTS,V(e,o.init(r,s),2);case 2:return u.f?e.return():((n=(t=u).c.presentationTimeline.ra())<1/0?t.a.U.Ua(n):t.a.U.Ua(Math.pow(2,32)),V(e,po(u,a),3));case 3:if(u.f)return e.return();r.forEach(function(e,t){u.b.has(t)||(e=ho(e,i,h),u.b.set(t,e),ko(u,e,0))}),x(e)}var t,n})})}function ho(e,t,n){return{stream:e,type:e.type,Yb:null,cb:null,mb:null,Tc:!0,Ba:t,endOfStream:!1,kb:!1,hb:null,qb:!1,Kc:0,kd:!1,vb:!1,Wd:!1,tc:!1,Zd:n||0,Fb:null}}function fo(e,t){var n=e.j[t];if(n)return X.debug("(all) Period "+t+" is being or has been set up"),n.promise;X.debug("(all) setting up Period "+t),n={promise:new Me,hc:!1},e.j[t]=n;for(var i=new Set,r=B(e.c.periods[t].variants),a=r.next();!a.done;a=r.next())(a=a.value).video&&i.add(a.video),a.video&&a.video.trickModeVideo&&i.add(a.video.trickModeVideo),a.audio&&i.add(a.audio);for(a=(r=B(e.c.periods[t].textStreams)).next();!a.done;a=r.next())i.add(a.value);return e.B=e.B.then(function(){if(!this.f)return po(this,i)}.bind(e)).then(function(){this.f||(this.j[t].promise.resolve(),this.j[t].hc=!0,X.I("(all) setup Period "+t))}.bind(e)).catch(function(e){this.f||(this.j[t].promise.catch(function(){}),this.j[t].promise.reject(),delete this.j[t],X.u("(all) failed to setup Period "+t),this.a.onError(e))}.bind(e)),n.promise}function po(l,d){return G(function e(){var i,r,a,o,s,u,c;return q(e,function(e){switch(e.o){case 1:i=[];for(var t=B(d),n=t.next();!n.done;n=t.next())r=n.value,(a=l.l.get(r.id))?(X.debug("(all) Stream "+r.id+" is being or has been set up"),i.push(a.promise)):(X.I("(all) setting up Stream "+r.id),l.l.set(r.id,{promise:new Me,hc:!1}),i.push(r.createSegmentIndex()));return z(e,2),V(e,Promise.all(i),4);case 4:if(l.f)return e.return();H(e,3);break;case 2:if(o=W(e),l.f)return e.return();for(n=(e=B(d)).next();!n.done;n=e.next())s=n.value,l.l.get(s.id).promise.catch(function(){}),l.l.get(s.id).promise.reject(),l.l.delete(s.id);throw o;case 3:for(n=(t=B(d)).next();!n.done;n=t.next())u=n.value,(c=l.l.get(u.id)).hc||(c.promise.resolve(),c.hc=!0,X.I("(all) setup Stream "+u.id));x(e)}})})}function mo(t,e){if(!t.f){var n=Po(e);if(!e.kb&&null!=e.hb&&!e.vb)if(e.hb=null,e.qb)X.debug(n,"skipping update and clearing the buffer"),Io(t,e,e.kd,e.Kc);else{try{var i=function(t,e){if(Eo(e))return jn(t.a.U,e.stream.originalId||""),null;var n=Po(e),i=t.a.yb(),r=go(t,e,i);X.N(n,"timeNeeded="+r);var a=So(t,e.stream),o=To(t,r),s=function(e,t,n){return"text"==t?null==(e=e.a).b||e.b<n?0:e.b-Math.max(n,e.a):$t(e=Dn(e,t),n)}(t.a.U,e.type,i);X.N(n,"update_:","presentationTime="+i,"bufferedAhead="+s);var u=Math.max(t.c.minBufferTime||0,t.g.rebufferingGoal,t.g.bufferingGoal)*t.s;if(r>=t.c.presentationTimeline.ra())return X.debug(n,"buffered to end of presentation"),e.endOfStream=!0,"video"==e.type&&(r=t.b.get("text"))&&"application/cea-608"==r.stream.mimeType&&(r.endOfStream=!0),null;if(e.endOfStream=!1,(e.Ba=o)!=a)return X.debug(n,"need Period "+o,"presentationTime="+i,"timeNeeded="+r,"currentPeriodIndex="+a),null;if(u<=s)return X.N(n,"buffering goal met"),.5;if(n=On(t.a.U,e.type),!(n=vo(t,e,i,n,a)))return 1;var c=1/0;return Array.from(t.b.values()).forEach(function(e){Eo(e)||(e=go(t,e,i),c=Math.min(c,e))}),r>=c+t.c.presentationTimeline.a?1:(e.Zd=0,function(e,l,d,t,h){var n=Po(l),f=e.c.periods[t];X.I(n,"fetchAndAppend_:","presentationTime="+d,"currentPeriod.startTime="+f.startTime,"reference.position="+h.position,"reference.startTime="+h.startTime,"reference.endTime="+h.endTime);var p=l.stream,i=e.c.presentationTimeline.ra(),r=e.c.periods[t+1];t=function(e,t,n,i,r){if(!t.Tc)return Promise.resolve();var a=Po(t);return n=e.c.periods[n].startTime-t.stream.presentationTimeOffset,X.I(a,"setting timestamp offset to "+n),X.I(a,"setting append window start to "+i),X.I(a,"setting append window end to "+r),i=function(e,t,n,i,r){return"text"==t?(e.a.v=n,(e=e.a).f=i,e.j=r,Promise.resolve()):Promise.all([Bn(e,t,e.If.bind(e,t)),Bn(e,t,e.vh.bind(e,t,n)),Bn(e,t,e.rh.bind(e,t,i,r))])}(e.a.U,t.type,n,i,r),t.stream.initSegmentReference?(X.I(a,"fetching init segment"),e=Ao(e,t,t.stream.initSegmentReference).then(function(e){if(!this.f)return X.I(a,"appending init segment"),Fn(this.a.U,t.type,e,null,null,t.stream.closedCaptions&&0<t.stream.closedCaptions.size)}.bind(e)).catch(function(e){return t.Tc=!0,Promise.reject(e)}),Promise.all([i,e])):i}(e,l,t,Math.max(0,f.startTime-.1),r?r.startTime+.01:i),l.kb=!0,l.Tc=!1,X.N(n,"fetching segment"),i=Ao(e,l,h),Promise.all([t,i]).then(function(e){if(!this.f&&!this.v)return t=this,n=l,i=d,r=f,a=p,o=h,s=e[1],u=Po(n),c=a.closedCaptions&&0<a.closedCaptions.size,null!=a.emsgSchemeIdUris&&0<a.emsgSchemeIdUris.length&&(new Di).za("emsg",t.K.bind(t,r,o,a.emsgSchemeIdUris)).parse(s),function(e,t,n){var i=Po(t);X.N(i,"checking buffer length");var r=Math.max(e.g.bufferBehind,e.c.presentationTimeline.a),a=_n(e.a.U,t.type);if(null==a)return X.N(i,"buffer behind okay because nothing buffered:","presentationTime="+n,"bufferBehind="+r),Promise.resolve();var o=n-a,s=o-r;return s<=0?(X.N(i,"buffer behind okay:","presentationTime="+n,"bufferedBehind="+o,"bufferBehind="+r,"underflow="+-s),Promise.resolve()):(X.I(i,"buffer behind too large:","presentationTime="+n,"bufferedBehind="+o,"bufferBehind="+r,"overflow="+s),e.a.U.remove(t.type,a,a+s).then(function(){this.f||X.I(i,"evicted "+s+" seconds")}.bind(e)))}(t,n,i).then(function(){if(!this.f)return X.I(u,"appending media segment"),Fn(this.a.U,n.type,s,o.startTime+r.startTime,o.endTime+r.startTime,c)}.bind(t)).then(function(){if(!this.f)return X.N(u,"appended media segment"),n.Yb=a,n.cb=o,Promise.resolve()}.bind(t));var t,n,i,r,a,o,s,u,c}.bind(e)).then(function(){this.f||this.v||(l.kb=!1,l.Wd=!1,l.qb||this.a.Sd(),ko(this,l,0),function(e,t,n){if(!e.w){var i=Po(t);if(1==(t=Array.from(e.b.values())).length&&"text"==t[0].type||(e.w=t.every(function(e){return"text"==e.type||!e.qb&&!e.vb&&e.cb})),e.w){for(X.debug(i,"startup complete"),n=So(e,n),e.j[n]||fo(e,n).then(function(){this.f||(X.I(i,"calling onCanSwitch()..."),this.a.Xe())}.bind(e)).catch(Zt.Uc),n=0;n<e.c.periods.length;++n)fo(e,n).catch(Zt.Uc);e.a.Xg&&(X.I(i,"calling onStartupComplete()..."),e.a.Xg())}}}(this,l,p),X.I(n,"finished fetch and append"))}.bind(e)).catch(function(e){this.f||this.v||(l.kb=!1,"text"==l.type&&this.g.ignoreTextStreamFailures?(1001==e.code?X.u(n,"Text stream failed to download. Proceeding without it."):X.u(n,"Text stream failed to parse. Proceeding without it."),this.b.delete("text")):7001==e.code?(l.kb=!1,l.hb=null,ko(this,l,0)):3017==e.code?function(e,t,n){var i=Po(t);if(Array.from(e.b.values()).some(function(e){return e!=t&&e.Wd}))X.debug(i,"MediaSource threw QuotaExceededError:","waiting for another stream to recover...");else{var r=Math.round(100*e.s);if(20<r)e.s-=.2;else{if(!(4<r))return X.error(i,"MediaSource threw QuotaExceededError too many times"),t.tc=!0,e.v=!0,e.a.onError(n);e.s-=.04}X.u(i,"MediaSource threw QuotaExceededError:","reducing buffering goals by "+(100-Math.round(100*e.s))+"%"),t.Wd=!0}ko(e,t,4)}(this,l,e):(X.error(n,"failed fetch and append: code="+e.code),l.tc=!0,e.severity=2,No(this,e)))}.bind(e))}(t,e,i,a,n),null)}(t,e);null!=i&&(ko(t,e,i),e.tc=!1)}catch(e){return void No(t,e)}i=Array.from(t.b.values()),function(e,t){var s=Po(t),n=So(e,t.stream);{var u,c;t.Ba!=n&&(u=t.Ba,(c=Array.from(e.b.values())).every(function(e){return e.Ba==u||Eo(e)})?c.every(wo)?(X.debug(s,"all need Period "+u),fo(e,u).then(function(){if(!this.f)if(c.every(function(e){var t=wo(e),n=So(this,e.stream);return!!Eo(e)||t&&e.Ba==u&&n!=u}.bind(this))){var e=this.c.periods[u];X.I(s,"calling onChooseStreams()...");var t=this.a.Ye(e),n=new Map;t.variant&&t.variant.video&&n.set("video",t.variant.video),t.variant&&t.variant.audio&&n.set("audio",t.variant.audio),t.text&&n.set("text",t.text);for(var i=(t=B(this.b.keys())).next();!i.done;i=t.next())if(i=i.value,!n.has(i)&&"text"!=i)return X.error(s,"invalid Streams chosen: missing "+i+" Stream"),void this.a.onError(new Pe(2,5,5005));for(i=(t=B(Array.from(n.keys()))).next();!i.done;i=t.next())if(i=i.value,!this.b.has(i)){if("text"!=i)return X.error(s,"invalid Streams chosen: unusable "+i+" Stream"),void this.a.onError(new Pe(2,5,5005));lo(this,null,null,n.get("text"),e.startTime),n.delete(i)}for(i=(t=B(Array.from(this.b.keys()))).next();!i.done;i=t.next()){i=i.value;var r,a=this.b.get(i),o=n.get(i);o?((r=Eo(a))&&(a.Ba=u,a.Zd=e.startTime),uo(this,o,!1,0,!1),r&&Eo(a)||ko(this,this.b.get(i),0)):this.b.delete(i)}X.I(s,"calling onCanSwitch()..."),this.a.Xe()}else X.debug(s,"ignoring transition to Period",u,"since another is happening")}.bind(e)).catch(Zt.Uc)):X.debug(s,"all MediaStates need Period "+u+", but not all MediaStates are idle"):X.debug(s,"not all MediaStates need Period "+u))}}(t,e),t.w&&i.every(function(e){return e.endOfStream})&&(X.I(n,"calling endOfStream()..."),t.a.U.endOfStream().then(function(){var e;this.f||0!=(e=this.a.U.ra())&&e<this.c.presentationTimeline.ra()&&this.c.presentationTimeline.Ua(e)}.bind(t)))}}}function go(e,t,n){return t.Yb&&t.cb?(n=So(e,t.Yb),e.c.periods[n].startTime+t.cb.endTime):Math.max(n,t.Zd)}function vo(e,t,n,i,r){var a=Po(t);return t.cb&&t.stream==t.Yb?(i=t.cb.position+1,X.N(a,"next position known:","position="+i),yo(e,t,r,i)):null==(a=t.cb?(X.I(a,"next position unknown: another Stream buffered"),a=So(e,t.Yb),bo(e,t,e.c.periods[a].startTime+t.cb.endTime,r)):(X.I(a,"next position unknown: nothing buffered"),bo(e,t,i||n,r)))?null:((n=null)==i&&(n=yo(e,t,r,Math.max(0,a-1))),n||yo(e,t,r,a))}function bo(e,t,n,i){var r=Po(t);return e=e.c.periods[i],X.debug(r,"looking up segment:","presentationTime="+n,"currentPeriod.startTime="+e.startTime),n=Math.max(0,n-e.startTime),null==(t=t.stream.findSegmentPosition(n))&&X.u(r,"cannot find segment:","currentPeriod.startTime="+e.startTime,"lookupTime="+n),t}function yo(e,t,n,i){var r=Po(t);return n=e.c.periods[n],(t=t.stream.getSegmentReference(i))?(e=(i=e.c.presentationTimeline).rc(),i=i.Sb(),n.startTime+t.endTime<e||n.startTime+t.startTime>i?(X.N(r,"segment is not available:","currentPeriod.startTime="+n.startTime,"reference.startTime="+t.startTime,"reference.endTime="+t.endTime,"availabilityStart="+e,"availabilityEnd="+i),null):t):(X.I(r,"segment does not exist:","currentPeriod.startTime="+n.startTime,"position="+i),null)}function Eo(e){return e&&"text"==e.type&&"application/cea-608"==e.stream.mimeType}function wo(e){return!e.kb&&null==e.hb&&!e.qb&&!e.vb}function To(e,t){t=Ra(e.c.periods,t+nn);return t?e.c.periods.indexOf(t):0}function So(e,t){for(var n=e.c.periods,i=0;i<n.length;i++){for(var r=n[i],a=new Set,o=B(r.variants),s=o.next();!s.done;s=o.next())(s=s.value).audio&&a.add(s.audio),s.video&&a.add(s.video),s.video&&s.video.trickModeVideo&&a.add(s.video.trickModeVideo);for(o=(r=B(r.textStreams)).next();!o.done;o=r.next())a.add(o.value);if(a.has(t))return i}return-1}function Ao(e,t,n){var i=Er(n.c(),n.b,n.a,e.g.retryParameters);return X.N("fetching: reference=",n),e=e.a.Zb.request(1,i),(t.Fb=e).promise.then(function(e){return t.Fb=null,e.data})}function Io(r,a,o,s){return G(function e(){var t,n,i;return q(e,function(e){switch(e.o){case 1:return t=Po(a),a.qb=!1,a.kd=!1,a.Kc=0,a.vb=!0,a.Yb=null,a.cb=null,X.debug(t,"clearing buffer"),V(e,s?(n=r.a.yb(),i=r.a.U.ra(),r.a.U.remove(a.type,n+s,i)):Kn(r.a.U,a.type).then(function(){if(!this.f&&o)return this.a.U.flush(a.type)}.bind(r)),2);case 2:if(r.f)return e.return();X.debug(t,"cleared buffer"),a.vb=!1,a.endOfStream=!1,ko(r,a,0),x(e)}})})}function ko(n,i,e){X.N(Po(i),"updating in "+e+" seconds"),i.hb=new Ie(function(){return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return z(e,2),V(e,mo(n,i),4);case 4:H(e,0);break;case 2:t=W(e),n.a&&n.a.onError(t),x(e)}})})}).R(e)}function Co(e){null!=e.hb&&(e.hb.stop(),e.hb=null)}function xo(t){return G(function e(){return q(e,function(e){if(1===e.o){if(t.Fb)return V(e,t.Fb.abort(),0);e.C(0)}})})}function No(e,t){xe(e.J).then(function(){this.f||(this.a.onError(t),t.handled||this.g.failureCallback(t))}.bind(e))}function Po(e){return"("+e.type+":"+e.stream.id+")"}function Mo(e,t,n,i,r,a){if(200<=n&&n<=299&&202!=n)return{uri:r||i,Ud:i,data:t,headers:e,fromCache:!!e["x-shaka-from-cache"]};r=null;try{r=yt(t)}catch(e){}throw X.debug("HTTP error text:",r),new Pe(401==n||403==n?2:1,1,1001,i,n,r,e,a)}function Ro(e,t,n,i){var r=new Ro.b;it(t.headers).forEach(function(e,t){r.append(t,e)});var a,o=new Ro.a,s={Ae:!1,zf:!1};return e=new Re(e=Ro.s(e,n,{body:t.body||void 0,headers:r,method:t.method,signal:o.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},s,i),function(){return s.Ae=!0,o.abort(),Promise.resolve()}),(t=t.retryParameters.timeout)&&((a=new ke(function(){s.zf=!0,o.abort()})).R(t/1e3),e.finally(function(){a.stop()})),e}function Lo(s,t,u,n){var i=new Lo.f,r=Date.now(),c=0;return new Re(new Promise(function(a,o){for(var e in i.open(t.method,s,!0),i.responseType="arraybuffer",i.timeout=t.retryParameters.timeout,i.withCredentials=t.allowCrossSiteCredentials,i.onabort=function(){o(new Pe(1,1,7001,s,u))},i.onload=function(e){for(var t=(e=e.target).getAllResponseHeaders().trim().split("\r\n"),n={},i=(t=B(t)).next();!i.done;i=t.next())n[(i=i.value.split(": "))[0].toLowerCase()]=i.slice(1).join(": ");try{var r=Mo(n,e.response,e.status,s,e.responseURL,u);a(r)}catch(e){o(e)}},i.onerror=function(e){o(new Pe(1,1,1002,s,e,u))},i.ontimeout=function(){o(new Pe(1,1,1003,s,u))},i.onprogress=function(e){var t=Date.now();(100<t-r||e.lengthComputable&&e.loaded==e.total)&&(n(t-r,e.loaded-c,e.total-e.loaded),c=e.loaded,r=t)},t.headers)i.setRequestHeader(e.toLowerCase(),t.headers[e]);i.send(t.body)}),function(){return i.abort(),Promise.resolve()})}function Uo(){this.a=this.f=this.b=0,this.c=new Map,this.g=0}function _o(e,t,n){this.j=e,this.b=new Map,this.c=!1,this.g=t,this.f=n,this.a=new Uo}function Oo(c,e,l,t,d,h){var f=function(e,t){e.b+=t;var n=e.g;return e.g++,e.c.set(n,t),n}(c.a,t);t=c.b.get(e)||Promise.resolve(),c.b.set(e,t.then(function(){return G(function e(){var r,a,o,s,u;return q(e,function(e){switch(e.o){case 1:return V(e,(n=c,i=l,G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return V(e,n.j.request(1,i).promise,2);case 2:return t=e.A,e.return(t.data)}})})),2);case 2:if(r=e.A,c.c)throw new Pe(2,9,7001);if(d)for(var t in a=new Uint8Array(r),(o=new Vi(a)).data)u=Number(t),s=o.data[u],u=o.a[u],c.f(s,u);return c.a.close(f,r.byteLength),t=c.a,c.g(0==t.b?0:t.f/t.b,c.a.a),e.return(h(r))}var n,i})})}))}function Do(e,t){var n=this;this.c=e,this.b=e.objectStore(t),this.a=new Me,e.onabort=function(e){e.preventDefault(),n.a.reject()},e.onerror=function(e){e.preventDefault(),n.a.reject()},e.oncomplete=function(){n.a.resolve()}}function Fo(i,r){return new Promise(function(t,e){var n=i.b.openCursor();n.onerror=e,n.onsuccess=function(e){if(!(e=e.target.result))return t();r(e.key,e.value,e),e.continue()}})}function jo(e){this.b=e,this.a=[]}function Ko(e,t){return Bo(e,t,"readwrite")}function Bo(e,t,n){var i=new Do(n=e.b.transaction([t],n),t);return e.a.push(i),i.promise().then(function(){Ke(e.a,i)},function(){Ke(e.a,i)}),i}function Go(e,t,n){this.b=new jo(e),this.c=t,this.a=n}function Vo(e){return Promise.reject(new Pe(2,9,9011,"Cannot add new value to "+e))}function zo(e,t,n,i){t=(e=Ko(e.b,t)).store();for(var r={},a=(n=B(n)).next();!a.done;r={key:r.key},a=n.next())r.key=a.value,t.delete(r.key).onsuccess=function(e){return function(){return i(e.key)}}(r);return e.promise()}function Ho(u,c,l){return G(function e(){var t,n,i,r,a,o,s;return q(e,function(e){switch(e.o){case 1:for(t=Bo(u.b,c,"readonly"),n=t.store(),i={},r=[],a={},o=B(l),s=o.next();!s.done;a={request:a.request,key:a.key},s=o.next())a.key=s.value,a.request=n.get(a.key),a.request.onsuccess=function(e){return function(){null==e.request.result&&r.push(e.key),i[e.key]=e.request.result}}(a);return V(e,t.promise(),2);case 2:if(r.length)throw new Pe(2,9,9012,"Could not find values for "+r);return e.return(l.map(function(e){return i[e]}))}})})}function Wo(e){this.a=new jo(e)}function qo(){this.a=new Map}function Xo(e,t,n){if(!(e=e.a.get(t)))throw new Pe(2,9,9013,"Could not find mechanism with name "+t);if(!(t=e.getCells().get(n)))throw new Pe(2,9,9013,"Could not find cell with name "+n);return t}function Yo(e,t){$o.set(e,t)}to.prototype.destroy=function(){var a=this;return G(function e(){var i,r;return q(e,function(e){switch(e.o){case 1:i=[];for(var t=B(a.b.values()),n=t.next();!n.done;n=t.next())Co(r=n.value),i.push(xo(r));return V(e,Promise.all(i),2);case 2:a.b.clear(),a.l.clear(),a.a=null,a.c=null,a.B=null,a.j=null,a.g=null,a.f=!0,x(e)}})})},to.prototype.configure=function(e){this.g=e,this.J=new Ce({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0},!0)},to.prototype.start=function(){var i=this;return G(function e(){var t,n;return q(e,function(e){switch(e.o){case 1:return t=i.a.yb(),n=To(i,t),(n=i.a.Ye(i.c.periods[n])).variant||n.text?V(e,lo(i,n.variant?n.variant.audio:null,n.variant?n.variant.video:null,n.text,t),2):(X.error("init: no Streams chosen"),e.return(new Pe(2,5,5005)));case 2:if(i.f)return e.return();X.debug("init: completed initial Stream setup"),i.a&&i.a.Og&&(X.I("init: calling onInitialStreamsSetup()..."),i.a.Og()),x(e)}})})},to.prototype.K=function(e,t,n,i){var r=i.reader.Vd(),a=i.reader.Vd(),o=i.reader.M(),s=i.reader.M(),u=i.reader.M(),c=i.reader.M();i=i.reader.Gb(i.reader.T.byteLength-i.reader.va()),e=e.startTime+t.startTime+s/o,n.includes(r)&&("urn:mpeg:dash:event:2012"==r?this.a.Pg():this.a.onEvent(new D("emsg",{detail:{startTime:e,endTime:e+u/o,schemeIdUri:r,value:a,timescale:o,presentationTimeDelta:s,eventDuration:u,id:c,messageData:i}})))},_("shaka.net.HttpFetchPlugin",Ro),Ro.s=function(d,h,f,p,m){return G(function e(){var t,n,a,o,s,u,i,c,r,l;return q(e,function(e){switch(e.o){case 1:return i=Ro.g,r=Ro.c,o=a=0,s=Date.now(),z(e,2),V(e,i(d,f),4);case 4:return t=e.A,u=t.clone().body.getReader(),c=(i=t.headers.get("Content-Length"))?parseInt(i,10):0,new r({start:function(r){!function i(){return G(function e(){var t,n;return q(e,function(e){switch(e.o){case 1:return z(e,2),V(e,u.read(),4);case 4:t=e.A,H(e,3);break;case 2:return n=W(e),X.I("error reading from stream",n.message),e.return();case 3:t.done||(a+=t.value.byteLength),(100<(n=Date.now())-s||t.done)&&(m(n-s,a-o,c-a),o=a,s=n),t.done?r.close():(r.enqueue(t.value),i()),x(e)}})})}()}}),V(e,t.arrayBuffer(),5);case 5:n=e.A,H(e,3);break;case 2:if(r=W(e),p.Ae)throw new Pe(1,1,7001,d,h);if(p.zf)throw new Pe(1,1,1003,d,h);throw new Pe(1,1,1002,d,r,h);case 3:return l={},t.headers.forEach(function(e,t){l[t.trim()]=e}),e.return(Mo(l,n,t.status,d,t.url,h))}})})},Ro.isSupported=function(){if(!d.ReadableStream)return!1;try{new ReadableStream({})}catch(e){return!1}return!(!d.fetch||!d.AbortController)},Ro.isSupported,Ro.g=d.fetch,Ro.a=d.AbortController,Ro.c=d.ReadableStream,Ro.b=d.Headers,Ro.isSupported()&&(qe("http",Ro,2),qe("https",Ro,2)),_("shaka.net.HttpXHRPlugin",Lo),Lo.f=d.XMLHttpRequest,qe("http",Lo,1),qe("https",Lo,1),Uo.prototype.close=function(e,t){var n;this.c.has(e)&&(n=this.c.get(e),this.c.delete(e),this.f+=n,this.a+=t)},_o.prototype.destroy=function(){return this.c=!0,Promise.all(this.b.values()).then(function(){},function(){})},Do.prototype.abort=function(){try{this.c.abort()}catch(e){}return this.a.catch(function(){})},Do.prototype.store=function(){return this.b},Do.prototype.promise=function(){return this.a},jo.prototype.destroy=function(){return Promise.all(this.a.map(function(e){return e.abort()}))},(e=Go.prototype).destroy=function(){return this.b.destroy()},e.hasFixedKeySpace=function(){return!0},e.addSegments=function(){return Vo(this.c)},e.removeSegments=function(e,t){return zo(this,this.c,e,t)},e.getSegments=function(n){var i=this;return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return V(e,Ho(i,i.c,n),2);case 2:return t=e.A,e.return(t.map(function(e){return i.Ee(e)}))}})})},e.addManifests=function(){return Vo(this.a)},e.updateManifestExpiration=function(t,n){var e=Ko(this.b,this.a),i=e.store();return i.get(t).onsuccess=function(e){(e=e.target.result)&&(e.expiration=n,i.put(e,t))},e.promise()},e.removeManifests=function(e,t){return zo(this,this.a,e,t)},e.getManifests=function(n){var i=this;return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return V(e,Ho(i,i.a,n),2);case 2:return t=e.A,e.return(t.map(function(e){return i.Lc(e)}))}})})},e.getAllManifests=function(){var i=this;return G(function e(){var t,n;return q(e,function(e){switch(e.o){case 1:return t=Bo(i.b,i.a,"readonly"),n=new Map,V(e,Fo(t,function(e,t){n.set(e,i.Lc(t))}),2);case 2:return V(e,t.promise(),3);case 3:return e.return(n)}})})},e.Ee=function(e){return e},e.Lc=function(e){return e},e.add=function(s,u){var c=this;return G(function e(){var i,r,a,o;return q(e,function(e){switch(e.o){case 1:i=Ko(c.b,s),r=i.store(),a=[];for(var t=B(u),n=t.next();!n.done;n=t.next())o=n.value,r.add(o).onsuccess=function(e){a.push(e.target.result)};return V(e,i.promise(),2);case 2:return e.return(a)}})})},Wo.prototype.destroy=function(){return this.a.destroy()},Wo.prototype.getAll=function(){var i=this;return G(function e(){var t,n;return q(e,function(e){switch(e.o){case 1:return t=Bo(i.a,"session-ids","readonly"),n=[],V(e,Fo(t,function(e,t){n.push(t)}),2);case 2:return V(e,t.promise(),3);case 3:return e.return(n)}})})},Wo.prototype.add=function(e){for(var t=Ko(this.a,"session-ids"),n=t.store(),i=(e=B(e)).next();!i.done;i=e.next())n.add(i.value);return t.promise()},Wo.prototype.remove=function(i){var n=this;return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return V(e,Fo(t=Ko(n.a,"session-ids"),function(e,t,n){0<=i.indexOf(t.sessionId)&&n.delete()}),2);case 2:return V(e,t.promise(),0)}})})},qo.prototype.destroy=function(){for(var e=[],t=B(this.a.values()),n=t.next();!n.done;n=t.next())e.push(n.value.destroy());return this.a.clear(),Promise.all(e)},qo.prototype.init=function(){var n=this;$o.forEach(function(e,t){e=e();e?n.a.set(t,e):X.info("Skipping "+t+" as it is not supported on this platform")});for(var e=[],t=B(this.a.values()),i=t.next();!i.done;i=t.next())e.push(i.value.init());return Promise.all(e)},qo.prototype.erase=function(){var i=this;return G(function e(){var t,n;return q(e,function(e){switch(e.o){case 1:return t=Array.from(i.a.values()),(n=0<t.length)||$o.forEach(function(e){(e=e())&&t.push(e)}),V(e,Promise.all(t.map(function(e){return e.erase()})),2);case 2:if(!n)return V(e,Promise.all(t.map(function(e){return e.destroy()})),0);e.C(0)}})})},_("shaka.offline.StorageMuxer.register",Yo),_("shaka.offline.StorageMuxer.unregister",function(e){$o.delete(e)});var $o=new Map;function Jo(e){Go.apply(this,arguments)}function Zo(e){return function(e){var t=e.streams.filter(function(e){return"audio"==e.contentType}),i=e.streams.filter(function(e){return"video"==e.contentType});{var r,n,a;t.every(function(e){return e.variantIds})&&i.every(function(e){return e.variantIds})||(t.forEach(function(e){e.variantIds=[]}),i.forEach(function(e){e.variantIds=[]}),r=0,i.length&&!t.length&&(X.debug("Found video-only content. Creating variants for video."),n=r++,i.forEach(function(e){e.variantIds.push(n)})),!i.length&&t.length&&(X.debug("Found audio-only content. Creating variants for audio."),a=r++,t.forEach(function(e){e.variantIds.push(a)})),i.length&&t.length&&(X.debug("Found audio-video content. Creating variants."),t.forEach(function(n){i.forEach(function(e){var t=r++;n.variantIds.push(t),e.variantIds.push(t)})})))}}(e),e.streams.forEach(function(){}),{startTime:e.startTime,streams:e.streams.map(Qo)}}function Qo(e){var t=e.initSegmentUri?ts(e.initSegmentUri):null;return{id:e.id,originalId:null,primary:e.primary,presentationTimeOffset:e.presentationTimeOffset,contentType:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,kind:e.kind,language:e.language,label:e.label,width:e.width,height:e.height,initSegmentKey:t,encrypted:e.encrypted,keyId:e.keyId,segments:e.segments.map(es),variantIds:e.variantIds}}function es(e){var t=ts(e.uri);return{startTime:e.startTime,endTime:e.endTime,dataKey:t}}function ts(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new Pe(2,9,9004,"Could not parse uri "+e)}function ns(e,t,n,i){Go.call(this,e,t,n),this.f=i}function is(){this.g=this.c=this.b=this.a=this.f=null}function rs(e,t,n,i){this.a=e,this.g=t,this.f=n,this.c=i,this.b=["offline:",e,"/",t,"/",n,"/",i].join("")}function as(e){if(null==(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e)))return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var n=e[2];if(!n)return null;var i=e[3];return i&&null!=t?new rs(t,n,i,Number(e[4])):null}function os(e,t){this.b=e,this.a=t}function ss(n,t,i){var e=t.streams.filter(function(e){return"audio"==e.contentType}),r=t.streams.filter(function(e){return"video"==e.contentType}),e=function(e,t,n){for(var i=new Set,r=B(t),a=r.next();!a.done;a=r.next()){var o=B(a.value.variantIds);for(a=o.next();!a.done;a=o.next())i.add(a.value)}for(r=B(n),a=r.next();!a.done;a=r.next())for(o=B(a.value.variantIds),a=o.next();!a.done;a=o.next())i.add(a.value);for(r=new Map,i=B(i),a=i.next();!a.done;a=i.next())a=a.value,r.set(a,{id:a,language:"",primary:!1,audio:null,video:null,bandwidth:0,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0});for(t=B(t),i=t.next();!i.done;i=t.next())for(i=i.value,a=us(e,i),o=B(i.variantIds),i=o.next();!i.done;i=o.next())(i=r.get(i.value)).language=a.language,i.primary=i.primary||a.primary,i.audio=a;for(n=B(n),t=n.next();!t.done;t=n.next())for(i=t.value,t=us(e,i),a=B(i.variantIds),i=a.next();!i.done;i=a.next())(i=r.get(i.value)).primary=i.primary||t.primary,i.video=t;return r}(n,e,r),r=t.streams.filter(function(e){return"text"==e.contentType}).map(function(e){return us(n,e)});return t.streams.forEach(function(e){e=e.segments.map(function(e,t){return cs(n,t,e)}),i.$b(e,t.startTime)}),{startTime:t.startTime,variants:Array.from(e.values()),textStreams:r}}function us(n,e){var t,i,r=new ir(a=e.segments.map(function(e,t){return cs(n,t,e)})),a={id:e.id,originalId:e.originalId,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return r.find(e)},getSegmentReference:function(e){return r.get(e)},initSegmentReference:null,presentationTimeOffset:e.presentationTimeOffset,mimeType:e.mimeType,codecs:e.codecs,width:e.width||void 0,height:e.height||void 0,frameRate:e.frameRate||void 0,pixelAspectRatio:e.pixelAspectRatio||void 0,kind:e.kind,encrypted:e.encrypted,keyId:e.keyId,language:e.language,label:e.label||null,type:e.contentType,primary:e.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null};return null!=e.initSegmentKey&&(a.initSegmentReference=(t=n,e=e.initSegmentKey,i=new rs("segment",t.b,t.a,e),new er(function(){return[i.toString()]},0,null))),a}function cs(e,t,n){var i=new rs("segment",e.b,e.a,n.dataKey);return new tr(t,n.startTime,n.endTime,function(){return[i.toString()]},0,null)}function ls(){this.a=null}function ds(e){var t=as(e);return t&&"manifest"==t.a?ds.j(e):t&&"segment"==t.a?ds.l(t.key(),t):Le(new Pe(2,1,9004,e))}function hs(v,b,y){return G(function e(){var l,p,m,g;return q(e,function(e){switch(e.o){case 1:l=[];for(var t=[],n=B(y),i=n.next();!i.done;i=n.next()){i=i.value;for(var r=!1,a=B(t),o=a.next();!o.done;o=a.next())if(o=o.value,s=o.info,u=i,s.keySystem==u.keySystem&&s.licenseUri==u.licenseUri&&Be(s.audioCapabilities,u.audioCapabilities,c)&&Be(s.videoCapabilities,u.videoCapabilities,c)){o.sessionIds.push(i.sessionId),r=!0;break}r||t.push({info:i,sessionIds:[i.sessionId]})}p=B(t),m=p.next();case 2:if(m.done){e.C(4);break}return g=m.value,d=v,h=b,f=g,g=G(function e(){var u,c,l;return q(e,function(e){switch(e.o){case 1:return u=new It({Zb:h,onError:function(){},Wc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),z(e,2),u.configure(d),V(e,(t=u,n=f.info.keySystem,i=f.info.licenseUri,r=f.info.serverCertificate,a=f.info.audioCapabilities,o=f.info.videoCapabilities,(s=new Map).set(n,{audioCapabilities:a,videoCapabilities:o,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:n,drmInfos:[{keySystem:n,licenseServerUri:i,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:r,initData:null,keyIds:null}]}),Lt(t,s)),4);case 4:H(e,3);break;case 2:return c=W(e),X.u("Error initializing EME",c),V(e,u.destroy(),5);case 5:return e.return([]);case 3:return z(e,6),V(e,xt(u),8);case 8:H(e,7);break;case 6:return c=W(e),X.u("Error setting server certificate",c),V(e,u.destroy(),9);case 9:return e.return([]);case 7:return l=[],V(e,Promise.all(f.sessionIds.map(function(n){return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return z(e,2),V(e,(r=u,a=n,G(function e(){var t,n,i;return q(e,function(e){switch(e.o){case 1:return V(e,Ut(r,a),2);case 2:return(t=e.A)?(n=[],(i=r.b.get(t))&&(i.Va=new Me,n.push(i.Va)),X.N("Attempting to remove session",a),n.push(t.remove()),V(e,Promise.all(n),0)):(X.N("Ignoring attempt to remove missing session",a),e.return())}})})),4);case 4:l.push(n),H(e,0);break;case 2:t=W(e),X.u("Error deleting offline session",t),x(e)}var r,a})})})),10);case 10:return V(e,u.destroy(),11);case 11:return e.return(l)}var t,n,i,r,a,o,s})}),V(e,g,5);case 5:g=e.A,l=l.concat(g),m=p.next(),e.C(2);break;case 4:return e.return(l)}var d,h,f,s,u;function c(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType}})})}function fs(e,t){var n=vu(),i=this;this.j=t,this.c=e,this.f=n,this.l=null,this.g=[],this.b=this.a=null,this.s=!0,this.v=Promise.resolve().then(function(){return r=i,G(function e(){return q(e,function(e){if(1===e.o){if(r.s){var t,n=!(0==r.g.length||r.a&&!r.a.zb)&&(r.a&&(r.a.Sa.Eb(),r.a=null),(t=(n=r.g.shift()).create(r.f))?(n.Sa.ac(),r.a={node:t.node,payload:t.payload,zb:t.zb,Sa:n.Sa}):n.Sa.Xc(),!0);return n=n?Promise.resolve():r.a?(i=r,G(function e(){var t,n;return q(e,function(e){switch(e.o){case 1:return i.c=i.j.pg(i.c,i.f,i.a.node,i.a.payload),z(e,2),i.b=i.j.Qf(i.c,i.f,i.a.payload),V(e,i.b.promise,4);case 4:i.b=null,i.c==i.a.node&&(i.a.Sa.Vc(),i.a=null),H(e,0);break;case 2:return 7001==(t=W(e)).code?i.a.Sa.Eb():i.a.Sa.onError(t),i.a=null,i.b=null,V(e,(n=i).j.handleError(i.f,t),5);case 5:n.c=e.A,x(e)}})})):(r.j.Ng(r.c),r.l=new Me,r.l),V(e,n,1)}e.C(0)}var i})});var r})}function ps(e,t){var n={ac:function(){},Vc:function(){},Eb:function(){},onError:function(){},Xc:function(){},Qh:function(){}};return e.g.push({create:t,Sa:n}),e.b&&e.b.abort(),ms(e),n}function ms(e){e.l&&(e.l.resolve(),e.l=null)}function gs(e){this.a=null;for(var t=0;t<e.textTracks.length;++t){var n=e.textTracks[t];n.mode="disabled","Shaka Player TextTrack"==n.label&&(this.a=n)}this.a||(this.a=e.addTextTrack("subtitles","Shaka Player TextTrack")),this.a.mode="hidden"}function vs(e){if(e.startTime>=e.endTime)return X.u("Invalid cue times: "+e.startTime+" - "+e.endTime),null;var t=new VTTCue(e.startTime,e.endTime,e.payload);t.lineAlign=e.lineAlign,t.positionAlign=e.positionAlign,e.size&&(t.size=e.size);try{t.align=e.textAlign}catch(e){}return"center"==e.textAlign&&"center"!=t.align&&(t.align="middle"),"vertical-lr"==e.writingMode?t.vertical="lr":"vertical-rl"==e.writingMode&&(t.vertical="rl"),1==e.lineInterpretation&&(t.snapToLines=!1),null!=e.line&&(t.line=e.line),null!=e.position&&(t.position=e.position),t}function bs(e,t){var n=e.mode;e.mode="showing"==n?"showing":"hidden";for(var i=e.cues,r=i.length-1;0<=r;r--){var a=i[r];a&&t(a)&&e.removeCue(a)}e.mode=n}function ys(e,t,n,i,r){var a,o=r in i,s=!0;for(a in t){var u=r+"."+a,c=o?i[r]:n[a];o||a in n?void 0===t[a]?void 0===c||o?delete e[a]:e[a]=Fe(c):c.constructor==Object&&t[a]&&t[a].constructor==Object?(e[a]||(e[a]=Fe(c)),u=ys(e[a],t[a],c,i,u),s=s&&u):typeof t[a]!=typeof c||null==t[a]||"function"!=typeof t[a]&&t[a].constructor!=c.constructor?(X.Hc("Invalid config, wrong type for "+u),s=!1):("function"==typeof n[a]&&n[a].length!=t[a].length&&X.ba("Unexpected number of arguments for "+u),e[a]=t[a]):(X.Hc("Invalid config, unrecognized key "+u),s=!1)}return s}function Es(e,t){for(var n={},i=n,r=0,a=0;!((r=e.indexOf(".",r))<0);)0!=r&&"\\"==e[r-1]||(i[a=e.substring(a,r).replace(/\\\./g,".")]={},i=i[a],a=r+1),r+=1;return i[e.substring(a).replace(/\\\./g,".")]=t,n}function ws(){}function Ts(){var e=5e5,t=1/0;navigator.connection&&(navigator.connection.downlink&&(e=1e6*navigator.connection.downlink),navigator.connection.saveData&&(t=360));var n={retryParameters:Ne(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:_t,fairPlayTransform:!0,updateExpirationTime:1},i={retryParameters:Ne(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,dash:{customScheme:function(e){if(e)return null},clockSyncUri:"",ignoreDrmInfo:!1,xlinkFailGracefully:!1,defaultPresentationDelay:10,ignoreMinBufferTime:!1,autoCorrectDrift:!0,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1},hls:{ignoreTextStreamFailures:!1,useFullSegmentsForStartTime:!1}},r={retryParameters:Ne(),failureCallback:function(e){return X.error("Unhandled streaming error",e),[e]},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0};(ft("Web0S")||ft("Tizen")||ft("CrKey"))&&(r.stallSkip=0);var a={trackSelectionCallback:function(t){return G(function e(){return q(e,function(e){if(1===e.o)return e.return(t)})})},progressCallback:function(e,t){return[e,t]},usePersistentLicense:!0},o={drm:n,manifest:i,streaming:r,offline:a,abrFactory:Hn,abr:{enabled:!0,defaultBandwidthEstimate:e,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:t,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayFactory:function(){return null}};return a.trackSelectionCallback=function(t){return G(function e(){return q(e,function(e){if(1===e.o)return e.return(function(e,t){var n=e.filter(function(e){return"variant"==e.type}),i=[],r=ne(t,n.map(function(e){return e.language}));r&&(i=n.filter(function(e){return Q(e.language)==r})),0==i.length&&(i=n.filter(function(e){return e.primary})),0==i.length&&(1<new Set(n.map(function(e){return e.language})).size&&X.u("Could not choose a good audio track based on language preferences or primary tracks.  An arbitrary language will be stored!"),i=n);var a=i.filter(function(e){return e.height&&e.height<=480});{var o;a.length&&(a.sort(function(e,t){return t.height-e.height}),i=a.filter(function(e){return e.height==a[0].height})),n=[],i.length&&(o=Math.floor(i.length/2),i.sort(function(e,t){return e.bandwidth-t.bandwidth}),n.push(i[o]))}for(i=B(e),o=i.next();!o.done;o=i.next())"text"==(o=o.value).type&&n.push(o);return n}(t,o.preferredAudioLanguage))})})},o}function Ss(e,t,n){var i={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return ys(e,t,n||Ts(),i,"")}function As(){this.a=null,this.b=[]}function Is(e,t){var n;null==e.a?e.a={timestamp:Date.now()/1e3,state:t,duration:0}:(n=Date.now()/1e3,e.a.duration=n-e.a.timestamp,e.a.state!=t&&(e.b.push(e.a),e.a={timestamp:n,state:t,duration:0}))}function ks(e,t){var n=0;e.a&&e.a.state==t&&(n+=e.a.duration);for(var i=B(e.b),r=i.next();!r.done;r=i.next())n+=(r=r.value).state==t?r.duration:0;return n}function Cs(){this.b=this.c=null,this.a=[]}function xs(){this.f=this.w=this.j=this.b=this.l=this.s=this.v=this.g=this.B=NaN,this.a=new As,this.c=new Cs}function Ns(e,t){var n,s=this;j.call(this),this.l=Eu,this.a=null,this.Ma=!1,this.g=new Ze,this.ld=this.s=this.rb=this.c=this.w=this.f=this.Cc=this.G=this.Dc=this.J=this.La=this.v=this.H=this.j=this.L=null,this.kf=1e9,this.Fc=new Set,this.Wa=!0,this.na=null,this.jf=!1,this.Ve=0,this.ka=null,this.Z=new la,this.b=Gs(this),this.Gc={width:1/0,height:1/0},this.B=null,this.sb=new ya(this.b.preferredAudioLanguage,this.b.preferredVariantRole,this.b.preferredAudioChannelCount),this.ia=this.b.preferredTextLanguage,this.Ja=this.b.preferredTextRole,this.md=[],t&&t(this),this.L=(n=this,new He(function(e,t){n.s&&n.s.segmentDownloaded(e,t)})),this.g.m(d,"online",function(){s.$d()}),this.K={name:"detach"},this.O={name:"attach"},this.wa={name:"unload"},this.Gd={name:"manifest-parser"},this.Fd={name:"manifest"},this.Ka={name:"media-source"},this.qd={name:"drm-engine"},this.Y={name:"load"},this.Md={name:"src-equals-drm-engine"},this.Na={name:"src-equals"};var i=new Map;i.set(this.O,function(e,t){return Oe((n=s,t=t,null==(e=e).D&&(e.D=t.D,n.g.m(e.D,"error",function(){var e=au(n);e&&n.pb(e)})),n.a=e.D,Promise.resolve()));var n}),i.set(this.K,function(e){return e.D&&(s.g.xa(e.D,"error"),e.D=null),s.a=null,Oe(e=Promise.resolve())}),i.set(this.wa,function(e){return Oe(Us(s,e))}),i.set(this.Ka,function(e){var r,a;return r=s,a=e,Oe(e=G(function e(){var t,n,i;return q(e,function(e){switch(e.o){case 1:return t=new(d.muxjs?Wt:qt),n=r.b.textDisplayFactory,i=new n,r.Ad=n,V(e,(i=new Pn(a.D,t,i)).w,2);case 2:r.H=i,x(e)}})}))}),i.set(this.Gd,function(e,t){var r,a,o;return Oe((r=s,a=e,o=t,G(function e(){var t,n,i;return q(e,function(e){switch(e.o){case 1:if(a.Ya=o.Ya,a.mimeType=o.mimeType,a.uri=o.uri,t=a.uri,n=r.L,r.rb=t,a.Ya){r.w=a.Ya(),e.C(2);break}return i=r,V(e,br.create(t,n,r.b.manifest.retryParameters,a.mimeType),3);case 3:i.w=e.A;case 2:i=Fe(r.b.manifest),o.D&&"AUDIO"===o.D.nodeName&&(i.disableVideo=!0),r.w.configure(i),x(e)}})})))}),i.set(this.Fd,function(e){return function(r,e){var a=e.uri,e=r.L;r.Cc=new $a(function(){return r.Ib()}),function(e,t){e.b=t}(r.Cc,function(e){ru(r,"timelineregionadded",e)});var o={networkingEngine:e,filterNewPeriod:function(e){return r.sd(e)},filterAllPeriods:function(e){return Vs(r,e)},onTimelineRegionAdded:function(e){var t=r.Cc;e:{for(var n=B(t.a),i=n.next();!i.done;i=n.next())if((i=i.value).schemeIdUri==e.schemeIdUri&&i.id==e.id&&i.startTime==e.startTime&&i.endTime==e.endTime){n=i;break e}n=null}null==n&&(t.a.add(e),t.b(e))},onEvent:function(e){return r.dispatchEvent(e)},onError:function(e){return r.pb(e)}};return new Re(Promise.resolve().then(function(){return G(function e(){var i;return q(e,function(e){switch(e.o){case 1:return V(e,(i=r).w.start(a,o),2);case 2:if(i.c=e.A,r.dispatchEvent(new D("manifestparsed")),0==r.c.periods.length)throw new Pe(2,4,4014);(n=r.c.periods).some(function(e){return e.variants.some(t)})&&(X.debug("Found variant with audio and video content, so filtering out audio-only content in all periods."),n.forEach(function(e){e.variants=e.variants.filter(t)})),x(e)}function t(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")}var n})})}),function(){return X.info("Aborting parser step..."),r.w.stop()})}(s,e)}),i.set(this.qd,function(){var n;return Oe((n=s,G(function e(){return q(e,function(e){switch(e.o){case 1:return n.j=_s(n,{Zb:n.L,onError:function(e){n.pb(e)},Wc:function(e){ou(n,e)},onExpirationUpdated:function(e,t){su(n,e,t)},onEvent:function(e){n.dispatchEvent(e)}}),n.j.configure(n.b.drm),V(e,kt(n.j,Ma(n.c.periods),n.c.offlineSessionIds),2);case 2:Vs(n,n.c.periods),x(e)}})})))}),i.set(this.Y,function(e,t){return Oe((p=s,m=e,g=t,G(function e(){var c,l,d,h,f;return q(e,function(e){switch(e.o){case 1:return m.startTime=g.startTime,c=m.D,d=m.uri,p.rb=d,p.J=new Ua({Qc:function(){return m.D.playbackRate},fe:function(e){m.D.playbackRate=e},Ue:function(e){m.D.currentTime+=e}}),p.B=new xs,l=function(){return Xs(p)},d=function(){return qs(p)},p.g.m(c,"playing",l),p.g.m(c,"pause",l),p.g.m(c,"ended",l),p.g.m(c,"ratechange",d),d=p.b.abrFactory,p.s&&p.ld==d||(p.ld=d,p.s=new d,p.s.configure(p.b.abr)),function(e,t){for(var n=0;n<t.length;n++){for(var i=t[n],r=new Map,a=B(i.variants),o=a.next();!o.done;o=a.next())if((o=o.value).video&&o.video.closedCaptions)for(var s,u=B((o=o.video).closedCaptions.keys()),c=u.next();!c.done;c=u.next())c=c.value,r.has(c)||(s={id:e.kf++,originalId:c,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"application/cea-608",codecs:"",kind:"caption",encrypted:!1,keyId:null,language:o.closedCaptions.get(c),label:null,type:"text",primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:o.roles,channelsCount:null,audioSamplingRate:null,closedCaptions:null},r.set(c,s));for(r=B(r.values()),a=r.next();!a.done;a=r.next())i.textStreams.push(a.value)}}(p,p.c.periods),p.sb=new ya(p.b.preferredAudioLanguage,p.b.preferredVariantRole,p.b.preferredAudioChannelCount),p.ia=p.b.preferredTextLanguage,o=p.c.presentationTimeline,s=p.b.playRangeStart,u=p.b.playRangeEnd,0<s&&(o.W()?X.u("|playRangeStart| has been configured for live content. Ignoring the setting."):o.vf(s)),u<o.ra()&&(o.W()?X.u("|playRangeEnd| has been configured for live content. Ignoring the setting."):o.Ua(u)),V(e,p.j.kc(c),2);case 2:return p.s.init(function(e,t,n){t=void 0!==t&&t,n=void 0===n?0:n,X.debug("switch_");e:{for(var i=B(p.c.periods),r=i.next();!r.done;r=i.next())if((r=r.value).variants.includes(e)){i=r;break e}i=null}Ks(p,i,e,!0),p.f&&so(p.f,e,t,n)&&Zs(p)}),p.v=(r=p,a=m.startTime,new Wa(r.a,r.c,r.b.streaming,a,function(){r.La&&Pa(r.La,!0),r.f&&function(n){function e(e){var t=n.a.U;return e="text"==e?null!=(e=t.a).a&&null!=e.b&&(i>=e.a&&i<e.b):Yt(e=Dn(t,e),i,r)}var i=n.a.yb(),r=n.g.smallGapLimit,t=!1,a=To(n,i);if(Y(n.b.values(),function(e){return e.Ba==a}))for(var o=B(n.b.keys()),s=o.next();!s.done;s=o.next())e(s=s.value)||(co(n,n.b.get(s)),t=!0);else Y(n.b.keys(),e)||(X.debug("(all): seeked: unbuffered seek: clearing all buffers"),n.b.forEach(function(e){co(n,e)}),t=!0);t||X.debug("(all): seeked: buffered seek: presentationTime="+i)}(r.f),r.G&&Ds(r)},function(e){return r.dispatchEvent(e)})),p.La=function(n){var e=new La(n.c);!function(e,t){e.b=t}(e,function(){Qs(n)});var t=new Ja(n.Cc);!function(e,t,n,i){e.a=t,e.b=n,e.c=i}(t,function(e){ru(n,"timelineregionenter",e)},function(e){ru(n,"timelineregionexit",e)},function(e,t){t||(ru(n,"timelineregionenter",e),ru(n,"timelineregionexit",e))});var i=new Na(n.a);return i.a.add(e),i.a.add(t),i}(p),d=Math.max(p.c.minBufferTime,p.b.streaming.rebufferingGoal),Os(p,d),p.f=new to((i=p).c,{yb:function(){return i.v.g()},getBandwidthEstimate:function(){return i.s.getBandwidthEstimate()},U:i.H,Zb:i.L,Ye:i.Lg.bind(i),Xe:i.Mf.bind(i),onError:i.pb.bind(i),onEvent:function(e){return i.dispatchEvent(e)},Pg:i.Qg.bind(i),Sd:i.Vg.bind(i)}),p.f.configure(p.b.streaming),zn.De(p.c,p.b.preferredAudioChannelCount),p.l=wu,p.dispatchEvent(new D("streaming")),V(e,p.f.start(),3);case 3:p.b.streaming.startAtSegmentBoundary&&(h=p.v.g(),s=h,u=no((o=p).f),a=io(o.f),n=fu(o),u=t(u,s),f=null!=(a=t(a,s))&&null!=u?Math.max(a,u):null!=a?a:null!=u?u:s,p.v.v(f)),p.c.periods.forEach(p.sd.bind(p)),Qs(p),Zs(p),h=fu(p)||p.c.periods[0],f=h.variants.some(function(e){return e.primary}),p.b.preferredAudioLanguage||f||X.u("No preferred audio language set.  We will choose an arbitrary language initially"),Ys(p,h.variants),p.g.Ha(c,"loadedmetadata",function(){p.B.b=Date.now()/1e3-g.le}),x(e)}function t(e,t){if(!e)return null;t=e.findSegmentPosition(t-n.startTime);return null!=t&&(t=e.getSegmentReference(t))?t.startTime+n.startTime:null}var n,i,r,a,o,s,u})})));var p,m,g}),i.set(this.Md,function(e){var n,i;return n=s,i=e,Oe(e=G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return t=tn,n.j=_s(n,{Zb:n.L,onError:function(e){n.pb(e)},Wc:function(e){ou(n,e)},onExpirationUpdated:function(e,t){su(n,e,t)},onEvent:function(e){n.dispatchEvent(e)}}),n.j.configure(n.b.drm),t={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"video/mp4",codecs:"",encrypted:!0,keyId:null,language:"und",label:null,type:t.tb,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},V(e,kt(n.j,[t],[]),2);case 2:return V(e,n.j.kc(i.D),0)}})}))}),i.set(this.Na,function(e,t){return function(t,n,e){function i(){return Xs(t)}{var r;n.uri=e.uri,n.startTime=e.startTime,t.rb=n.uri,t.B=new xs,t.v=new Ha(n.D),null!=n.startTime&&t.v.v(n.startTime),t.J=new Ua({Qc:function(){return n.D.playbackRate},fe:function(e){n.D.playbackRate=e},Ue:function(e){n.D.currentTime+=e}}),Os(t,t.b.streaming.rebufferingGoal),t.g.m(n.D,"playing",i),t.g.m(n.D,"pause",i),t.g.m(n.D,"ended",i),t.g.m(n.D,"ratechange",function(){return qs(t)}),"none"!=t.a.preload&&t.g.Ha(n.D,"loadedmetadata",function(){t.B.b=Date.now()/1e3-e.le}),t.a.audioTracks&&(t.g.m(t.a.audioTracks,"addtrack",function(){return Qs(t)}),t.g.m(t.a.audioTracks,"removetrack",function(){return Qs(t)}),t.g.m(t.a.audioTracks,"change",function(){return Qs(t)})),t.a.textTracks&&(r=t.a.textTracks,t.g.m(r,"addtrack",function(){return Qs(t)}),t.g.m(r,"removetrack",function(){return Qs(t)}),t.g.m(r,"change",function(){return Qs(t)}))}n.D.src=n.uri,(ft("Tizen")||ft("Web0S"))&&n.D.load(),t.l=Tu,t.dispatchEvent(new D("streaming"));var a=new Me;Oa(t.a,HTMLMediaElement.HAVE_METADATA,t.g,function(){a.resolve()});var o=!1;return t.md.push(function(){o=!0}),Oa(t.a,HTMLMediaElement.HAVE_CURRENT_DATA,t.g,function(){return G(function e(){return q(e,function(e){switch(e.o){case 1:if(o)return e.return();if(!function(e){var t=e.b.preferredAudioLanguage;{var n;""!=t&&(e.cd(t),""!=(n=e.b.preferredVariantRole)&&e.cd(t,n))}}(t),js(t).find(function(e){return"disabled"!=e.mode})){e.C(2);break}return V(e,new Promise(function(e){t.g.Ha(t.a.textTracks,"change",e),new ke(e).R(1)}),2);case 2:if(o)return e.return();!function(e){var t=e.b.preferredTextLanguage;{var n;""!=t&&(e.dd(t),""!=(n=e.b.preferredTextRole)&&e.dd(t,n))}}(t),x(e)}})})}),t.a.error?a.reject(au(t)):"none"==t.a.preload&&(X.ba('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),a.resolve()),t.g.Ha(t.a,"error",function(){a.reject(au(t))}),new Re(a,function(){return a.reject(new Pe(2,7,7001)),Promise.resolve()})}(s,e,t)}),this.ya=new fs(this.K,{pg:function(e,t,n,i){var r=null;return e==s.K&&(r=n==s.K?s.K:s.O),e==s.O&&(r=n==s.K||t.D!=i.D?s.K:n==s.O?s.O:n==s.Ka||n==s.Y?s.Ka:n==s.Na?s.Md:null),e==s.Ka&&(r=n==s.Y&&t.D==i.D?s.Gd:s.wa),e==s.Gd&&(r=gu(s.Y,s.Fd,s.wa,n,t,i)),e==s.Fd&&(r=gu(s.Y,s.qd,s.wa,n,t,i)),e==s.qd&&(r=gu(s.Y,s.Y,s.wa,n,t,i)),e==s.Md&&(r=n==s.Na&&t.D==i.D?s.Na:s.wa),e!=s.Y&&e!=s.Na||(r=s.wa),e==s.wa&&(r=i.D&&t.D==i.D?s.O:s.K),r},Qf:function(e,t,n){return s.dispatchEvent(new D("onstatechange",{state:e.name})),i.get(e)(t,n)},handleError:function(t,n){return G(function e(){return q(e,function(e){switch(e.o){case 1:return X.u("The walker saw an error:"),n instanceof Pe?X.u("Error Code:",n.code):(X.u("Error Message:",n.message),X.u("Error Stack:",n.stack)),V(e,Us(s,t),2);case 2:return e.return(t.D?s.O:s.K)}})})},Ng:function(e){s.dispatchEvent(new D("onstateidle",{state:e.name}))}}),e&&this.kc(e,!0)}v(Jo,Go),Jo.prototype.updateManifestExpiration=function(t,n){var e=Ko(this.b,this.a),i=e.store(),r=new Me;return i.get(t).onsuccess=function(e){(e=e.target.result)?(e.expiration=n,i.put(e),r.resolve()):r.reject(new Pe(2,9,9012,"Could not find values for "+t))},e.promise().then(function(){return r})},Jo.prototype.Lc=function(e){return{originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,periods:e.periods.map(Zo),sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata}},Jo.prototype.Ee=function(e){return{data:e.data}},v(ns,Go),ns.prototype.hasFixedKeySpace=function(){return this.f},ns.prototype.addSegments=function(e){return this.f?Vo(this.c):this.add(this.c,e)},ns.prototype.addManifests=function(e){return this.f?Vo(this.a):this.add(this.a,e)},ns.prototype.Lc=function(e){return null==e.expiration&&(e.expiration=1/0),e},(e=is.prototype).init=function(){var n=this,i=new Me,t=d.indexedDB.open("shaka_offline_db",4);return t.onsuccess=function(e){e=e.target.result;var t=(t=(n.f=e).objectStoreNames).contains("manifest")&&t.contains("segment")?(X.debug("Mounting v1 idb storage cell"),new Jo(e,"segment","manifest")):null;n.a=t,t=(t=e.objectStoreNames).contains("manifest-v2")&&t.contains("segment-v2")?(X.debug("Mounting v2 idb storage cell"),new ns(e,"segment-v2","manifest-v2",!0)):null,n.b=t,t=(t=e.objectStoreNames).contains("manifest-v3")&&t.contains("segment-v3")?(X.debug("Mounting v3 idb storage cell"),new ns(e,"segment-v3","manifest-v3",!1)):null,n.c=t,e=e.objectStoreNames.contains("session-ids")?(X.debug("Mounting session ID idb storage cell"),new Wo(e)):null,n.g=e,i.resolve()},t.onupgradeneeded=function(e){e=e.target.result;for(var t=B(["segment-v3","manifest-v3","session-ids"]),n=t.next();!n.done;n=t.next())n=n.value,e.objectStoreNames.contains(n)||e.createObjectStore(n,{autoIncrement:!0})},t.onerror=function(e){i.reject(new Pe(2,9,9001,t.error)),e.preventDefault()},i},e.destroy=function(){var t=this;return G(function e(){return q(e,function(e){switch(e.o){case 1:if(t.a)return V(e,t.a.destroy(),2);e.C(2);break;case 2:if(t.b)return V(e,t.b.destroy(),4);e.C(4);break;case 4:if(t.c)return V(e,t.c.destroy(),6);e.C(6);break;case 6:if(t.g)return V(e,t.g.destroy(),8);e.C(8);break;case 8:t.f&&t.f.close(),x(e)}})})},e.getCells=function(){var e=new Map;return this.a&&e.set("v1",this.a),this.b&&e.set("v2",this.b),this.c&&e.set("v3",this.c),e},e.getEmeSessionCell=function(){return this.g},e.erase=function(){var i=this;return G(function e(){return q(e,function(e){switch(e.o){case 1:if(i.a)return V(e,i.a.destroy(),2);e.C(2);break;case 2:if(i.b)return V(e,i.b.destroy(),4);e.C(4);break;case 4:if(i.c)return V(e,i.c.destroy(),6);e.C(6);break;case 6:return i.f&&i.f.close(),V(e,(t=new Me,(n=d.indexedDB.deleteDatabase("shaka_offline_db")).onblocked=function(){X.u("Deleting","shaka_offline_db","is being blocked")},n.onsuccess=function(){t.resolve()},n.onerror=function(e){t.reject(new Pe(2,9,9001,n.error)),e.preventDefault()},t),8);case 8:return i.f=null,i.a=null,i.b=null,i.c=null,V(e,i.init(),0)}var t,n})})},Yo("idb",function(){return ft("CrKey")||!d.indexedDB?null:new is}),rs.prototype.Ta=function(){return this.g},rs.prototype.ua=function(){return this.f},rs.prototype.key=function(){return this.c},rs.prototype.toString=function(){return this.b},(e=ls.prototype).configure=function(){},e.start=function(r){var a=this;return G(function e(){var t,n,i;return q(e,function(e){switch(e.o){case 1:return(i=as(r),null==(a.a=i)||"manifest"!=i.a)?e.return(Promise.reject(new Pe(2,1,9004,i))):(t=new qo,C(e,2),V(e,t.init(),4));case 4:return V(e,Xo(t,i.Ta(),i.ua()),5);case 5:return V(e,e.A.getManifests([i.key()]),6);case 6:return n=e.A,n=n[0],i=new os(i.Ta(),i.ua()),e.return(function(t,e){var n=new yr(null,0);n.Ua(e.duration);var i=e.periods.map(function(e){return ss(t,e,n)}),r=e.drmInfo?[e.drmInfo]:[];return e.drmInfo&&i.forEach(function(e){e.variants.forEach(function(e){e.drmInfos=r})}),{presentationTimeline:n,minBufferTime:2,offlineSessionIds:e.sessionIds,periods:i}}(i,n));case 2:return N(e),V(e,t.destroy(),7);case 7:P(e,0)}})})},e.stop=function(){return Promise.resolve()},e.update=function(){},e.onExpirationUpdated=function(o,s){var u=this;return G(function e(){var t,n,i,r,a;return q(e,function(e){switch(e.o){case 1:return t=u.a,a=new qo,z(e,2,3),V(e,a.init(),5);case 5:return V(e,Xo(a,t.Ta(),t.ua()),6);case 6:return V(e,(n=e.A).getManifests([t.key()]),7);case 7:if(i=e.A,r=i[0],i=r.sessionIds.includes(o),r=null==r.expiration||r.expiration>s,i&&r)return X.debug("Updating expiration for stored content"),V(e,n.updateManifestExpiration(t.key(),s),3);e.C(3);break;case 3:return N(e),V(e,a.destroy(),10);case 10:P(e,0);break;case 2:a=W(e),X.error("There was an error updating",t,a),e.C(3)}})})},br.gc("application/x-offline-manifest",ls),_("shaka.offline.OfflineScheme",ds),ds.j=function(e){return _e(e={uri:e,Ud:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}})},ds.l=function(e,t){var n=new qo;return _e(void 0).ma(function(){return n.init()}).ma(function(){return Xo(n,t.Ta(),t.ua())}).ma(function(e){return e.getSegments([t.key()])}).ma(function(e){return{uri:t,Ud:t,data:e[0].data,headers:{}}}).finally(function(){return n.destroy()})},qe("offline",ds),fs.prototype.destroy=function(){var i=this;return G(function e(){return q(e,function(e){switch(e.o){case 1:return i.s=!1,i.b&&i.b.abort(),ms(i),V(e,i.v,2);case 2:i.a&&i.a.Sa.Eb();for(var t=B(i.g),n=t.next();!n.done;n=t.next())n.value.Sa.Eb();i.a=null,i.g=[],i.j=null,x(e)}})})},_("shaka.text.SimpleTextDisplayer",gs),gs.prototype.remove=function(t,n){return!!this.a&&(bs(this.a,function(e){return e.startTime<n&&e.endTime>t}),!0)},gs.prototype.append=function(e){var t=vs,n=e.map(function(e){var t;return e.nestedCues.length&&(t=e.nestedCues.map(function(e){return e.spacer?"\n":e.payload+" "}).join("").replace(/ $/m,""),(e=e.clone()).nestedCues=[],e.payload=t),e}),i=[];e=this.a.cues?Array.from(this.a.cues):[];for(var r={},a=(n=B(n)).next();!a.done;r={Vb:r.Vb},a=n.next())r.Vb=a.value,e.some(function(t){return function(e){return e.startTime==t.Vb.startTime&&e.endTime==t.Vb.endTime&&e.text==t.Vb.payload}}(r))||(a=t(r.Vb))&&i.push(a);i.slice().sort(function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:"line"in VTTCue.prototype?i.indexOf(t)-i.indexOf(e):i.indexOf(e)-i.indexOf(t)}).forEach(function(e){this.a.addCue(e)}.bind(this))},gs.prototype.destroy=function(){return this.a&&bs(this.a,function(){return 1}),this.a=null,Promise.resolve()},gs.prototype.isTextVisible=function(){return"showing"==this.a.mode},gs.prototype.setTextVisibility=function(e){this.a.mode=e?"showing":"hidden"},_("shaka.util.ConfigUtils.mergeConfigObjects",ys),_("shaka.util.ConfigUtils.convertToConfigObject",Es),_("shaka.util.PlayerConfiguration",ws),ws.mergeConfigObjects=Ss,O(Ns,j),_("shaka.Player",Ns),Ns.prototype.destroy=function(){var n=this;return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return n.l==yu?e.return():(n.l=yu,t=ps(n.ya,function(){return{node:n.K,payload:vu(),zb:!1}}),V(e,new Promise(function(e){t.ac=function(){X.info("Preparing to destroy walker...")},t.Vc=function(){e(),n.dispatchEvent(new D("loaded"))},t.Eb=function(){e()},t.onError=function(){e()},t.Xc=function(){e()}}),2));case 2:return V(e,n.ya.destroy(),3);case 3:if(n.g&&(n.g.release(),n.g=null),n.ld=null,n.s=null,n.b=null,n.L)return V(e,n.L.destroy(),5);e.C(0);break;case 5:n.L=null,x(e)}})})},Ns.version="v2.5.18";var Ps=["2","5"],Jn=new function(e){this.a=e,this.c=Yn,this.b=$n}(new qn(Number(Ps[0]),Number(Ps[1]))),Ms=["output-restricted","internal-error"],Rs={};function Ls(){if(!(d.Promise&&d.Uint8Array&&Array.prototype.forEach))return!1;var e=ht();return!(e&&e<12||!(d.MediaKeys&&d.navigator&&d.navigator.requestMediaKeySystemAccess&&d.MediaKeySystemAccess&&d.MediaKeySystemAccess.prototype.getConfiguration))&&(!!ut()||ct("application/x-mpegurl"))}function Us(n,i){return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return n.l!=yu&&(n.l=Eu),t=n.md.map(function(e){return e()}),n.md=[],V(e,Promise.all(t),2);case 2:if(n.dispatchEvent(new D("unloading")),i.Ya=null,i.mimeType=null,i.startTime=null,i.uri=null,i.D&&(n.g.xa(i.D,"loadedmetadata"),n.g.xa(i.D,"playing"),n.g.xa(i.D,"pause"),n.g.xa(i.D,"ended"),n.g.xa(i.D,"ratechange")),n.La&&(n.La.release(),n.La=null),n.Dc&&(n.Dc.stop(),n.Dc=null),n.w)return V(e,n.w.stop(),4);e.C(3);break;case 4:n.w=null;case 3:if(n.s)return V(e,n.s.stop(),5);e.C(5);break;case 5:if(n.f)return V(e,n.f.destroy(),8);e.C(7);break;case 8:n.f=null;case 7:if(n.J&&(n.J.release(),n.J=null),n.v&&(n.v.release(),n.v=null),n.H)return V(e,n.H.destroy(),10);e.C(9);break;case 10:n.H=null;case 9:if(i.D&&i.D.src)return V(e,new Promise(function(e){return new ke(e).R(.1)}),12);e.C(11);break;case 12:i.D.removeAttribute("src"),i.D.load();case 11:if(n.j)return V(e,n.j.destroy(),14);e.C(13);break;case 14:n.j=null;case 13:n.Z.a.clear(),n.rb=null,n.G=null,n.Fc.clear(),n.c=null,n.B=null,n.Ad=null,n.Wa=!0,Ws(n),x(e)}})})}function _s(e,t){return new It(t,e.b.drm.updateExpirationTime)}function Os(e,t){e.G=new Ea,e.G.a=Ta,wa(e.G,t,Math.min(.5,t/2)),Ws(e),e.Dc=new ke(function(){Ds(e)}).Ia(.25)}function Ds(e){switch(e.l){case Tu:var t=!!e.a.ended||Xt(e.a.buffered)>=e.a.duration-1;break;case wu:e:if(e.a.ended||Un(e.H))t=!0;else{if(e.c.presentationTimeline.W()){var n=e.c.presentationTimeline.Sb();if(Xt(e.a.buffered)>=n){t=!0;break e}}t=!1}break;default:t=!1}var i=$t(e.a.buffered,e.a.currentTime),r=t,a=(n=e.G).b.get(n.a),t=n.a,i=r||a<=i?Sa:Ta;t!=(n.a=i)&&Ws(e)}function Fs(t){var e;if(t.w&&(r=Fe(t.b.manifest),t.a&&"AUDIO"===t.a.nodeName&&(r.disableVideo=!0),t.w.configure(r)),t.j&&t.j.configure(t.b.drm),t.f){t.f.configure(t.b.streaming);try{t.c.periods.forEach(t.sd.bind(t))}catch(e){t.pb(e)}var n=no(t.f),i=io(t.f),r=fu(t),n=zn.Me(n,i,r.variants);t.s&&n&&n.allowedByApplication&&n.allowedByKeySystem?Ys(t,r.variants):(X.debug("Choosing new streams after changing configuration"),$s(t,r))}t.H&&(r=t.b.textDisplayFactory,t.Ad!=r)&&(n=new r,e=(i=t.H).g,i.g=n,e&&(n.setTextVisibility(e.isTextVisible()),e.destroy()),i.a&&(i.a.c=n),t.Ad=r,!t.f||(n=(r=t.f).b.get("text"))&&uo(r,n.stream,!0,0,!0)),t.s&&(t.s.configure(t.b.abr),t.b.abr.enabled&&!t.Wa?t.s.enable():t.s.disable(),iu(t)),t.G&&(r=t.b.streaming.rebufferingGoal,t.c&&(r=Math.max(r,t.c.minBufferTime)),wa(t.G,r,Math.min(.5,r/2)))}function js(e){return Array.from(e.a.textTracks).filter(function(e){return"metadata"!=e.kind&&"chapters"!=e.kind&&"Shaka Player TextTrack"!=e.label})}function Ks(e,t,n,i){ha(e.Z,t).variant=n,(e=e.B.c).c!=n&&(e.c=n,e.a.push({timestamp:Date.now()/1e3,id:n.id,type:"variant",fromAdaptation:i,bandwidth:n.bandwidth}))}function Bs(e,t,n,i){da(e.Z,t,n),(e=e.B.c).b!=n&&(e.b=n,e.a.push({timestamp:Date.now()/1e3,id:n.id,type:"text",fromAdaptation:i,bandwidth:null}))}function Gs(t){var e=Ts();return e.streaming.failureCallback=function(e){t.W()&&[1001,1002,1003].includes(e.code)&&(e.severity=1,X.u("Live streaming error.  Retrying automatically..."),t.$d())},e.textDisplayFactory=function(){return new gs(t.a)},e}function Vs(e,t){var n,i,r=e.f?no(e.f):null,a=e.f?io(e.f):null;if(t.forEach(zn.filterNewPeriod.bind(null,e.j,r,a)),n=function(e){return e.variants.some(zn.Xb)},i=0,t.forEach(function(e){i+=n(e)?1:0}),0==(r=i))throw new Pe(2,4,4032);if(r<t.length)throw new Pe(2,4,4011);t.forEach(function(e){zn.we(e.variants,this.b.restrictions,this.Gc)&&this.f&&fu(this)==e&&Qs(this),uu(this,e.variants)}.bind(e))}function zs(e,t,n,i){return n=void 0!==n&&n,i=void 0===i?0:i,e.Wa?(e.na=t,e.jf=n,e.Ve=i,!0):((t=so(e.f,t,n,i))&&eu(e),t)}function Hs(e,t){if(e.Wa)return e.ka=t,!0;t=uo(e.f,t,!0,0,!1);return t&&tu(e),t}function Ws(e){var t,n=e.Wb();e.B&&e.G&&e.v&&((t=e.J).f=n,_a(t),Xs(e)),e.dispatchEvent(new D("buffering",{buffering:n}))}function qs(e){var t=e.a.playbackRate;0!=t&&e.J.set(t)}function Xs(e){var t;e.B&&e.G&&(t=e.B.a,e.G.a==Ta?Is(t,"buffering"):e.a.paused?Is(t,"paused"):e.a.ended?Is(t,"ended"):Is(t,"playing"))}function Ys(t,e){try{uu(t,e)}catch(e){return t.pb(e),null}var n=e.filter(function(e){return zn.Xb(e)}),n=t.sb.create(n);return t.s.setVariants(Array.from(n.values())),t.s.chooseVariant()}function $s(e,t){var n=Js(e,t,!1),i=zn.mc(t.textStreams,e.ia,e.Ja)[0]||null,r=!1;i&&(e.b.streaming.alwaysStreamText||e.bb())&&(Bs(e,t,i,!0),r=Hs(e,i)),(n||r)&&Zs(e)}function Js(e,t,n){n=void 0===n||n;var i=Ys(e,t.variants),r=!1;return i&&(Ks(e,t,i,!0),r=zs(e,i,!0)),n&&r&&Zs(e),r}function Zs(e){cu(e,new D("adaptation"))}function Qs(e){cu(e,new D("trackschanged"))}function eu(e){cu(e,new D("variantchanged"))}function tu(e){cu(e,new D("textchanged"))}function nu(e){cu(e,new D("texttrackvisibility"))}function iu(e){cu(e,new D("abrstatuschanged",{Jg:e.b.abr.enabled}))}function ru(e,t,n){e.dispatchEvent(new D(t,{detail:{schemeIdUri:n.schemeIdUri,value:n.value,startTime:n.startTime,endTime:n.endTime,id:n.id,eventElement:n.eventElement}}))}function au(e){if(!e.a.error)return null;var t=e.a.error.code;if(1==t)return null;var n=e.a.error.msExtendedCode;return n&&(n<0&&(n+=Math.pow(2,32)),n=n.toString(16)),new Pe(2,3,3016,t,n,e.a.error.message)}function ou(e,i){var t,r,n,a,o;e.f&&(t=fu(e),r=!1,0==(n=Object.keys(i)).length&&X.u("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks."),(a=1==n.length&&"00"==n[0])&&X.u("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks."),n.length&&e.c.periods.forEach(function(e){e.variants.forEach(function(n){zn.yg(n).forEach(function(e){var t=n.allowedByKeySystem;e.keyId&&(e=i[a?"00":e.keyId],n.allowedByKeySystem=!!e&&!Ms.includes(e)),t!=n.allowedByKeySystem&&(r=!0)})})}),n=no(e.f),o=io(e.f),(n=zn.Me(n,o,t.variants))&&!n.allowedByKeySystem&&(X.debug("Choosing new variants after key status changed"),Js(e,t)),r&&(Qs(e),Ys(e,t.variants)))}function su(e,t,n){e.w&&e.w.onExpirationUpdated&&e.w.onExpirationUpdated(t,n),e.dispatchEvent(new D("expirationupdated"))}function uu(e,t){for(var n=e.j?rt(e.j.Y):{},i=(i=Object.keys(n)).length&&"00"==i[0],r=!1,a=!1,o=[],s=[],u=B(t),c=u.next();!c.done;c=u.next()){var l=[];(c=c.value).audio&&l.push(c.audio),c.video&&l.push(c.video);for(var d,h=(l=B(l)).next();!h.done;h=l.next())(h=h.value).keyId&&((d=n[i?"00":h.keyId])?Ms.includes(d)&&(s.includes(d)||s.push(d)):o.includes(h.keyId)||o.push(h.keyId));c.allowedByApplication?c.allowedByKeySystem&&(r=!0):a=!0}if(!r)throw new Pe(2,4,4012,{hasAppRestrictions:a,missingKeys:o,restrictedKeyStatuses:s})}function cu(t,n){G(function e(){return q(e,function(e){switch(e.o){case 1:return V(e,Promise.resolve(),2);case 2:t.l!=yu&&t.dispatchEvent(n),x(e)}})})}function lu(e){for(var t=new Set,n=(e=B(e)).next();!n.done;n=e.next())(n=n.value).language?t.add(Q(n.language)):t.add("und");return t}function du(e){for(var t=new Map,n=(e=B(e)).next();!n.done;n=e.next()){var i=n.value,n="und",r=[];for(i.language&&(n=Q(i.language)),(r="variant"==i.type?i.audioRoles:i.roles)&&r.length||(r=[""]),t.has(n)||t.set(n,new Set),r=(i=B(r)).next();!r.done;r=i.next())r=r.value,t.get(n).add(r)}var a=[];return t.forEach(function(e,t){for(var n=B(e),i=n.next();!i.done;i=n.next())a.push({language:t,role:i.value})}),a}function hu(e){return null==(e=fu(e))?[]:e.variants.filter(function(e){return zn.Xb(e)})}function fu(e){for(var t=e.v.g(),n=null,i=(e=B(e.c.periods)).next();!i.done;i=e.next())(i=i.value).startTime<=t&&(n=i);return n}function pu(e){var t=fu(e);return ha(e.Z,t).variant}function mu(){return new Pe(2,7,7e3)}function gu(e,t,n,i,r,a){return i==e&&r.D==a.D&&r.uri==a.uri&&r.mimeType==a.mimeType&&r.Ya==a.Ya?t:n}function vu(){return{Ya:null,D:null,mimeType:null,startTime:null,le:null,uri:null}}function bu(n){return new Promise(function(e,t){n.Eb=function(){return t(mu())},n.Vc=function(){return e()},n.onError=function(e){return t(e)},n.Xc=function(){return t(mu())}})}Ns.registerSupportPlugin=function(e,t){Rs[e]=t},Ns.isBrowserSupported=Ls,Ns.probeSupport=function(){return Dt().then(function(e){for(var t,n=br.eh(),i={},r=B('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",")),a=r.next();!a.done;a=r.next()){i[a=a.value]=ut()?!!Cn(a)||(MediaSource.isTypeSupported(a)||an(a)):ct(a);var o=a.split(";")[0];i[o]=i[o]||i[a]}for(t in e={manifest:n,media:i,drm:e},Rs)e[t]=Rs[t]();return e})},Ns.prototype.attach=Ns.prototype.kc=function(e,t){if(t=void 0===t||t,this.l==yu)return Promise.reject(mu());var n=vu();n.D=e,ut()||(t=!1);var i=t?this.Ka:this.O,t=ps(this.ya,function(){return{node:i,payload:n,zb:!1}});return t.ac=function(){return X.info("Starting attach...")},bu(t)},Ns.prototype.detach=function(){var e=this;if(this.l==yu)return Promise.reject(mu());var t=ps(this.ya,function(){return{node:e.K,payload:vu(),zb:!1}});return t.ac=function(){return X.info("Starting detach...")},bu(t)},Ns.prototype.unload=Ns.prototype.re=function(n){var i=this;if(n=void 0===n||n,this.l==yu)return Promise.reject(mu());ut()||(n=!1);var r=vu(),e=ps(this.ya,function(e){var t=e.D&&n?i.Ka:e.D?i.O:i.K;return r.D=e.D,{node:t,payload:r,zb:!1}});return e.ac=function(){return X.info("Starting unload...")},bu(e)},Ns.prototype.load=function(e,t,n){if(this.l==yu)return Promise.reject(mu());this.dispatchEvent(new D("loading"));var i=vu();i.uri=e,i.le=Date.now()/1e3,n&&"string"!=typeof n&&(Xn("Loading with a manifest parser factory","Please register a manifest parser and for the mime-type."),i.Ya=function(){return new n}),n&&"string"==typeof n&&(i.mimeType=n),void 0!==t&&(i.startTime=t);var r=function(e,t){if(t.Ya)return!1;if(!ut())return!0;var n=t.mimeType,i=t.uri||"";return!!(n=n||{mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"}[br.getExtension(i)])&&(""!=(t.D||pt()).canPlayType(n)&&(!br.isSupported(i,n)||dt()&&e.b.streaming.useNativeHlsOnSafari))}(this,i)?this.Na:this.Y,a=ps(this.ya,function(e){return null==e.D?null:(i.D=e.D,{node:r,payload:i,zb:!0})});return a.ac=function(){return X.info("Starting load of "+e+"...")},new Promise(function(e,t){a.Xc=function(){return t(new Pe(2,7,7002))},a.Vc=function(){return e()},a.Eb=function(){return t(mu())},a.onError=function(e){return t(e)}})},Ns.prototype.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=Es(e,t));var n=Ss(this.b,e,Gs(this));return Fs(this),n},Ns.prototype.getConfiguration=function(){var e=Gs(this);return Ss(e,this.b,Gs(this)),e},Ns.prototype.resetConfiguration=Ns.prototype.mh=function(){for(var e in this.b)delete this.b[e];Ss(this.b,Gs(this),Gs(this)),Fs(this)},Ns.prototype.getLoadMode=Ns.prototype.fg=function(){return this.l},Ns.prototype.getMediaElement=Ns.prototype.ng=function(){return this.a},Ns.prototype.getNetworkingEngine=Ns.prototype.pc=function(){return this.L},Ns.prototype.getAssetUri=Ns.prototype.Oc=function(){return this.rb},Ns.prototype.getManifestUri=Ns.prototype.lg=function(){return Xn("getManifestUri",'Please use "getAssetUri" instead.'),this.Oc()},Ns.prototype.isLive=Ns.prototype.W=function(){return this.c?this.c.presentationTimeline.W():!(!this.a||!this.a.src)&&1/0==this.a.duration},Ns.prototype.isInProgress=Ns.prototype.Bb=function(){return!!this.c&&this.c.presentationTimeline.Bb()},Ns.prototype.isAudioOnly=Ns.prototype.Re=function(){if(this.c){if(!this.c.periods.length)return!1;var e=this.c.periods[0].variants;return!!e.length&&!e[0].video}return!(!this.a||!this.a.src)&&(this.a.videoTracks?0==this.a.videoTracks.length:0==this.a.videoHeight)},Ns.prototype.seekRange=Ns.prototype.Ib=function(){if(this.c){var e=this.c.presentationTimeline;return{start:e.Rb(),end:e.ab()}}return this.a&&this.a.src&&(e=this.a.seekable).length?{start:e.start(0),end:e.end(e.length-1)}:{start:0,end:0}},Ns.prototype.keySystem=function(){return Mt(this.drmInfo())},Ns.prototype.drmInfo=function(){return this.j?this.j.a:null},Ns.prototype.getExpiration=Ns.prototype.nc=function(){return this.j?this.j.nc():1/0},Ns.prototype.isBuffering=Ns.prototype.Wb=function(){return!!this.G&&this.G.a==Ta},Ns.prototype.getPlaybackRate=Ns.prototype.yd=function(){var e;return e=!this.J||(e=this.J).f?0:e.c},Ns.prototype.trickPlay=Ns.prototype.qe=function(e){0==e?X.ba("A trick play rate of 0 is unsupported!"):(this.a.paused&&this.a.play(),this.J&&this.J.set(e),this.l==wu&&oo(this.f,1<Math.abs(e)))},Ns.prototype.cancelTrickPlay=Ns.prototype.ze=function(){this.l==Tu&&this.J.set(1),this.l==wu&&(this.J.set(1),oo(this.f,!1))},Ns.prototype.getVariantTracks=Ns.prototype.Ub=function(){if(this.c&&this.v){for(var e=pu(this),t=[],n=B(hu(this)),i=n.next();!i.done;i=n.next()){i=i.value;var r=zn.ue(i);r.active=i==e,t.push(r)}return t}return this.a&&this.a.audioTracks?Array.from(this.a.audioTracks).map(function(e){return zn.Ne(e)}):[]},Ns.prototype.getTextTracks=Ns.prototype.ib=function(){if(this.c&&this.v){for(var e=function(e){var t=fu(e);if(null==t)return null;{var n;ha(e.Z,t).text||(n=zn.mc(t.textStreams,e.ia,e.Ja)).length&&da(e.Z,t,n[0])}return ha(e.Z,t).text}(this),t=[],n=B(null==(o=fu(a=this))?[]:o.textStreams.filter(function(e){return!a.Fc.has(e)})),i=n.next();!i.done;i=n.next()){i=i.value;var r=zn.fd(i);r.active=i==e,t.push(r)}return t}var a,o;return this.a&&this.a.src&&this.a.textTracks?js(this).map(function(e){return zn.Bg(e)}):[]},Ns.prototype.selectTextTrack=Ns.prototype.ae=function(t){if(this.c&&this.f){var e=fu(this),n=e.textStreams.find(function(e){return e.id==t.id});n?(Bs(this,e,n,!1),Hs(this,n),this.ia=n.language):X.error("No stream with id",t.id)}else if(this.a&&this.a.src&&this.a.textTracks){for(n=(e=B(e=js(this))).next();!n.done;n=e.next())n=n.value,zn.Bd(n)==t.id?n.mode=this.Ma?"showing":"hidden":n.mode="disabled";tu(this)}},Ns.prototype.selectEmbeddedTextTrack=Ns.prototype.ph=function(){Xn("selectEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. Please use SelectTextTrack.");var e=this.ib().filter(function(e){return"application/cea-608"==e.mimeType});0<e.length?this.ae(e[0]):X.u("Unable to find the text track embedded in the video.")},Ns.prototype.usingEmbeddedTextTrack=Ns.prototype.Jh=function(){Xn("usingEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. There should be no reason to know if the player is playing embedded text.");var e=this.ib().filter(function(e){return e.active})[0];return!!e&&"application/cea-608"==e.mimeType},Ns.prototype.selectVariantTrack=Ns.prototype.qf=function(t,e,n){if(n=void 0===n?0:n,this.c&&this.f){var i=fu(this);this.b.abr.enabled&&X.ba("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var r=i.variants.find(function(e){return e.id==t.id});r?zn.Xb(r)?(Ks(this,i,r,!1),zs(this,r,e,n),this.sb=new ba(r),Ys(this,i.variants)):X.error("Unable to switch to restricted track",t.id):X.error("No variant with id",t.id)}else if(this.a&&this.a.audioTracks){for(n=(e=B(e=Array.from(this.a.audioTracks))).next();!n.done;n=e.next())n=n.value,zn.Bd(n)==t.id&&(n.enabled=!0);eu(this)}},Ns.prototype.getAudioLanguagesAndRoles=Ns.prototype.Wf=function(){return du(this.Ub())},Ns.prototype.getTextLanguagesAndRoles=Ns.prototype.xg=function(){return du(this.ib())},Ns.prototype.getAudioLanguages=Ns.prototype.Vf=function(){return Array.from(lu(this.Ub()))},Ns.prototype.getTextLanguages=Ns.prototype.wg=function(){return Array.from(lu(this.ib()))},Ns.prototype.selectAudioLanguage=Ns.prototype.cd=function(e,t){if(this.c&&this.v){var n=fu(this);this.sb=new ya(e,t||"",0,""),Js(this,n)}else if(this.a&&this.a.audioTracks){for(var i=Array.from(this.a.audioTracks),n=Q(e),r=null,a=null,o=(i=B(i)).next();!o.done;o=i.next()){o=o.value;var s=zn.Ne(o);Q(s.language)==n&&(r=o,t?s.roles.includes(t)&&(a=o):0==s.roles.length&&(a=o))}a?(a.enabled=!0,eu(this)):r&&(r.enabled=!0,eu(this))}},Ns.prototype.selectTextLanguage=Ns.prototype.dd=function(e,t){var n,i,r;this.c&&this.v?(n=fu(this),this.ia=e,this.Ja=t||"",(i=zn.mc(n.textStreams,this.ia,this.Ja)[0]||null)&&(Bs(this,n,i,!1),(this.b.streaming.alwaysStreamText||this.bb())&&Hs(this,i))):(r=Q(e),(n=this.ib().filter(function(e){return Q(e.language)==r&&(!t||e.roles.includes(t))})[0])&&this.ae(n))},Ns.prototype.selectVariantsByLabel=Ns.prototype.qh=function(e){if(this.c&&this.v){for(var t=fu(this),n=null,i=B(hu(this)),r=i.next();!r.done;r=i.next())if((r=r.value).audio.label==e){n=r;break}null==n?X.u("No variants were found with label: "+e+". Ignoring the request to switch."):(this.sb=new ya(n.language,"",0,e),Js(this,t))}},Ns.prototype.isTextTrackVisible=Ns.prototype.bb=function(){var e=this.Ma;return this.H?this.H.g.isTextVisible():this.a&&this.a.src&&this.a.textTracks?js(this).some(function(e){return"showing"==e.mode}):e},Ns.prototype.setTextTrackVisibility=Ns.prototype.je=function(o){var s=this;return G(function e(){var i,r,a;return q(e,function(e){switch(e.o){case 1:if(s.Ma==(i=!!o))return e.return();if(s.Ma=i,s.l!=wu){if(s.a&&s.a.src&&s.a.textTracks)for(var t=B(js(s)),n=t.next();!n.done;n=t.next())"disabled"!=(r=n.value).mode&&(r.mode=i?"showing":"hidden");e.C(2);break}if(s.H.g.setTextVisibility(i),s.b.streaming.alwaysStreamText){e.C(2);break}if(!i){!function(e){e.H=!0;var t=e.b.get("text");t&&(Co(t),xo(t).catch(function(){}),e.b.delete("text"))}(s.f),e.C(2);break}if(ro(s.f,"text")){e.C(2);break}if(a=fu(s),0<(a=zn.mc(a.textStreams,s.ia,s.Ja)).length)return V(e,ao(s.f,a[0]),2);e.C(2);break;case 2:nu(s),x(e)}})})},Ns.prototype.getPlayheadTimeAsDate=Ns.prototype.rg=function(){if(!this.W())return X.u("getPlayheadTimeAsDate is for live streams!"),null;var e=this.ya.f,t=0;if(this.v)t=this.v.g();else if(e){if(null==e.startTime)return new Date;t=e.startTime}return this.c?new Date(1e3*(this.c.presentationTimeline.f+this.a.currentTime)):this.a&&this.a.getStartDate?(e=this.a.getStartDate(),isNaN(e.getTime())?(X.u("EXT-X-PROGRAM-DATETIME required to get playhead time as Date!"),null):new Date(e.getTime()+1e3*t)):(X.u("No way to get playhead time as Date!"),null)},Ns.prototype.getPresentationStartTimeAsDate=Ns.prototype.ug=function(){if(!this.W())return X.u("getPresentationStartTimeAsDate is for live streams!"),null;if(this.c)return new Date(1e3*this.c.presentationTimeline.f);if(this.a&&this.a.getStartDate){var e=this.a.getStartDate();return isNaN(e.getTime())?(X.u("EXT-X-PROGRAM-DATETIME required to get presentation start time as Date!"),null):e}return X.u("No way to get presentation start time as Date!"),null},Ns.prototype.getBufferedInfo=Ns.prototype.wd=function(){var e={total:[],audio:[],video:[],text:[]};return this.l==Tu&&(e.total=Jt(this.a.buffered)),this.l==wu&&this.H.wd(e),e},Ns.prototype.getStats=function(){if(this.l!=wu&&this.l!=Tu)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,switchHistory:[],stateHistory:[]};Xs(this),(t=this.a).getVideoPlaybackQuality&&(t=t.getVideoPlaybackQuality(),n=this.B,i=Number(t.totalVideoFrames),n.v=Number(t.droppedVideoFrames),n.s=i,this.B.l=Number(t.corruptedVideoFrames)),t=this.j?(t=this.j).K||NaN:NaN,this.B.j=t,this.l==wu&&((t=pu(this))&&(this.B.w=t.bandwidth),t&&t.video&&(n=this.B,i=t.video.height||NaN,n.B=t.video.width||NaN,n.g=i),t=this.s.getBandwidthEstimate(),this.B.f=t);for(var e=this.B,t=e.B,n=e.g,i=e.w,r=e.s,a=e.v,o=e.l,s=e.f,u=e.b,c=ks(e.a,"playing"),l=ks(e.a,"paused"),d=ks(e.a,"buffering"),h=e.j,f=function(e){function t(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}}for(var n=[],i=B(e.b),r=i.next();!r.done;r=i.next())n.push(t(r.value));return e.a&&n.push(t(e.a)),n}(e.a),p=[],m=(e=B(e.c.a)).next();!m.done;m=e.next())m=m.value,p.push({timestamp:m.timestamp,id:m.id,type:m.type,fromAdaptation:m.fromAdaptation,bandwidth:m.bandwidth});return{width:t,height:n,streamBandwidth:i,decodedFrames:r,droppedFrames:a,corruptedFrames:o,estimatedBandwidth:s,loadLatency:u,playTime:c,pauseTime:l,bufferingTime:d,licenseTime:h,stateHistory:f,switchHistory:p}},Ns.prototype.addTextTrack=function(a,o,s,u,c,l){var d=this;return G(function e(){var t,n,i,r;return q(e,function(e){switch(e.o){case 1:if(d.l==Tu)throw X.error("Cannot add text when loaded with src="),Error("State error!");if(d.l!=wu)throw X.error("Must call load() and wait for it to resolve before adding text tracks."),Error("State error!");if(t=fu(d),r=tn,i=d.c.periods.indexOf(t),i=(i=i+1)>=d.c.periods.length?d.c.presentationTimeline.ra():d.c.periods[i].startTime,1/0==(i=i-t.startTime))throw new Pe(1,4,4033);return n=new tr(1,0,i,function(){return[a]},0,null),i={id:d.kf++,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return 1},getSegmentReference:function(e){return 1==e?n:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:u,codecs:c||"",kind:s,encrypted:!1,keyId:null,language:o,label:l||null,type:r.Oa,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},d.Fc.add(i),t.textStreams.push(i),V(e,ao(d.f,i),2);case 2:return(r=ro(d.f,"text"))&&da(d.Z,t,r),d.Fc.delete(i),X.debug("Choosing new streams after adding a text stream"),$s(d,t),Qs(d),e.return(zn.fd(i))}})})},Ns.prototype.setMaxHardwareResolution=Ns.prototype.ee=function(e,t){this.Gc.width=e,this.Gc.height=t},Ns.prototype.retryStreaming=Ns.prototype.$d=function(){if(this.l==wu){var e=this.f;if(e.f)X.error("Unable to retry after StreamingEngine is destroyed!"),e=!1;else if(e.v)X.error("Unable to retry after StreamingEngine encountered a fatal error!"),e=!1;else{for(var t=B(e.b.values()),n=t.next();!n.done;n=t.next()){var i=Po(n=n.value);n.tc&&(X.info(i,"Retrying after failure..."),n.tc=!1,ko(e,n,.1))}e=!0}}else e=!1;return e},Ns.prototype.getManifest=Ns.prototype.jg=function(){return this.c},Ns.prototype.getManifestParserFactory=Ns.prototype.kg=function(){return this.w?this.w.constructor:null},(e=Ns.prototype).sd=function(e){var t=this.f?no(this.f):null,n=this.f?io(this.f):null;if(zn.filterNewPeriod(this.j,t,n,e),!(t=e.variants).some(zn.Xb))throw new Pe(2,4,4011);if(uu(this,e.variants),zn.we(t,this.b.restrictions,this.Gc)&&this.f&&fu(this)==e&&Qs(this),e=this.j?this.j.a:null)for(n=(t=B(t)).next();!n.done;n=t.next())for(var i=(n=B(n.value.drmInfos)).next();!i.done;i=n.next())if((i=i.value).keySystem==e.keySystem)for(var r=(i=B(i.initData||[])).next();!r.done;r=i.next())r=r.value,Pt(this.j,r.initDataType,r.initData)},e.Lg=function(e){X.debug("onChooseStreams_",e);try{X.N("onChooseStreams_, choosing variant from ",e.variants),X.N("onChooseStreams_, choosing text from ",e.textStreams),this.Wa=!0,this.s.disable(),iu(this),X.debug("Choosing new streams after period changed");var t=Ys(this,e.variants),n=zn.mc(e.textStreams,this.ia,this.Ja)[0]||null;this.na&&(e.variants.includes(this.na)&&(t=this.na),this.na=null),this.ka&&(e.textStreams.includes(this.ka)&&(n=this.ka),this.ka=null),t&&Ks(this,e,t,!0),n&&Bs(this,e,n,!0);var i=this.f,r=i.b.get("video");o=r?i.c.periods[r.Ba]:(a=i.b.get("audio"))?i.c.periods[a.Ba]:null;var a,o,r=t?t.audio:null;!o&&n&&((i=r)&&(e=n,a=Q(this.b.preferredTextLanguage),o=Q(r.language),i=J(r=Q(e.language),a)&&!J(o,r)),i&&(this.Ma=!0),this.Ma&&this.H.g.setTextVisibility(!0),nu(this));t=this.b.streaming.alwaysStreamText||this.bb()?{variant:t,text:n}:{variant:t,text:null};return X.N("onChooseStreams_, chose variant ",t.variant),X.N("onChooseStreams_, chose text ",t.text),t}catch(e){return this.pb(e),{variant:null,text:null}}},e.Mf=function(){X.debug("canSwitch_"),this.Wa=!1,this.b.abr.enabled&&(this.s.enable(),iu(this)),this.na&&(so(this.f,this.na,this.jf,this.Ve),eu(this),this.na=null),this.ka&&(uo(this.f,this.ka,!0,0,!1),tu(this),this.ka=null)},e.Qg=function(){this.w&&this.w.update&&this.w.update()},e.Vg=function(){this.v&&this.v.w()},e.pb=function(e){var t;this.l!=yu&&(t=new D("error",{detail:e}),this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0))};var yu=0,Eu=1,wu=2,Tu=3;function Su(e,t){var n=ss(new os(e.Ta(),e.ua()),t.periods[0],new yr(null,0)),i=t.appMetadata||{},n=Au(n);return{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:n,appMetadata:i}}function Au(e){for(var t=[],n=zn.qg(e.variants),i=(n=B(n)).next();!i.done;i=n.next())t.push(zn.ue(i.value));for(n=(e=B(e.textStreams)).next();!n.done;n=e.next())t.push(zn.fd(n.value));return t}function Iu(){this.a={}}function ku(e,t){t=e.a[t];return null==t&&(t=0,X.error("Asking for bitrate of stream not given to the estimator")),0==t&&X.u("Using bitrate of 0, this stream won't affect progress"),t}function Cu(e){this.a=!1,this.b=new Me,this.c=e}function xu(e){var a=new Pu;e.periods.forEach(function(e,t){var n,i=Mu(e.variants);if(0==t)for(var r=(i=B(i.a)).next();!r.done;r=i.next())a.add(r.value);else n=i,(t=a).a=t.a.filter(function(e){return n.contains(e)})});for(var t=(e=B(e.periods)).next();!t.done;t=e.next())(t=t.value).variants=t.variants.filter(function(e){return a.contains(new Nu(e))})}function Nu(e){var t=e.audio;e=e.video,this.b=t?t.mimeType:null,this.a=t?t.codecs.split(".")[0]:null,this.f=e?e.mimeType:null,this.c=e?e.codecs.split(".")[0]:null}function Pu(){this.a=[]}function Mu(e){for(var t=new Pu,n=(e=B(e)).next();!n.done;n=e.next())t.add(new Nu(n.value));return t}function Ru(e){var n=this;if(e&&e.constructor!=Ns)throw new Pe(2,9,9008);this.b=this.a=null,e?(this.a=e.b,this.b=e.pc()):(this.a=Ts(),this.b=new He),this.f=!1,this.c=[],this.g=[];var i=!e;this.j=new Cu(function(){return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return t=function(){},V(e,Promise.all(n.g.map(function(e){return e.then(t,t)})),2);case 2:if(i)return V(e,n.b.destroy(),3);e.C(3);break;case 3:n.a=null,n.b=null,x(e)}})})})}function Lu(){if(ut())e:{for(var e=B($o.values()),t=e.next();!t.done;t=e.next())if(t=(t=t.value)()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}function Uu(e,t){for(var n=[],i=B(e.periods),r=i.next();!r.done;r=i.next())for(var a=(r=B(r.value.streams)).next();!a.done;a=r.next())a=a.value,t&&"video"==a.contentType?n.push({contentType:at(a.mimeType,a.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=a.contentType||n.push({contentType:at(a.mimeType,a.codecs),robustness:e.drmInfo.audioRobustness});return n}function _u(e){if(e.j.a)throw new Pe(2,9,7001)}function Ou(){if(!Lu())throw new Pe(2,9,9e3)}function Du(t,n){return G(function e(){return q(e,function(e){switch(e.o){case 1:return t.g.push(n),C(e,2),V(e,n,4);case 4:return e.return(e.A);case 2:N(e),Ke(t.g,n),P(e,0)}})})}Ns.LoadMode={DESTROYED:yu,NOT_LOADED:Eu,MEDIA_SOURCE:wu,SRC_EQUALS:Tu},Cu.prototype.destroy=function(){var e=this;return this.a?this.b:(this.a=!0,this.c().then(function(){e.b.resolve()},function(){e.b.resolve()}))},Pu.prototype.add=function(e){this.contains(e)||this.a.push(e)},Pu.prototype.contains=function(t){return this.a.some(function(e){return t.b==e.b&&t.a==e.a&&t.f==e.f&&t.c==e.c})},_("shaka.offline.Storage",Ru),Ru.support=Lu,Ru.prototype.destroy=function(){return this.j.destroy()},Ru.prototype.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=Es(e,t));var n=e,i=!1;return null!=n.trackSelectionCallback&&(i=!0,n.offline=n.offline||{},n.offline.trackSelectionCallback=n.trackSelectionCallback,delete n.trackSelectionCallback),null!=n.progressCallback&&(i=!0,n.offline=n.offline||{},n.offline.progressCallback=n.progressCallback,delete n.progressCallback),null!=n.usePersistentLicense&&(i=!0,n.offline=n.offline||{},n.offline.usePersistentLicense=n.usePersistentLicense,delete n.usePersistentLicense),i&&Xn("Storage.configure with OfflineConfig","Please configure storage with a player configuration."),Ss(this.a,e)},Ru.prototype.getConfiguration=function(){var e=Ts();return Ss(e,this.a,Ts()),e},Ru.prototype.getNetworkingEngine=Ru.prototype.pc=function(){return this.b},Ru.prototype.store=function(n,e,i){var v,b,y,k,r=this;return Du(this,(v=this,b=n,y=e||{},k=function(){return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return i&&"string"!=typeof i?(Xn("Storing with a manifest parser factory","Please register a manifest parser and for the mime-type."),e.return(new i)):V(e,br.create(n,r.b,r.a.manifest.retryParameters,i),2);case 2:return t=e.A,e.return(t)}})})},G(function e(){var t,r,d,f,p,m,g;return q(e,function(e){switch(e.o){case 1:return(Ou(),v.f)?e.return(Promise.reject(new Pe(2,9,9006))):(v.f=!0,V(e,(a=v,o=b,l=k,G(function e(){var t,n,i,r;return q(e,function(e){switch(e.o){case 1:return t=null,r=a.b,r={networkingEngine:r,filterAllPeriods:function(){},filterNewPeriod:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){t=e}},V(e,l(),2);case 2:return(n=e.A).configure(a.a.manifest),_u(a),C(e,3),V(e,n.start(o,r),5);case 5:return i=e.A,_u(a),r=function(e){for(var t=new Set,n=(e=B(e.periods)).next();!n.done;n=e.next()){for(var i=B((n=n.value).textStreams),r=i.next();!r.done;r=i.next())t.add(r.value);for(n=B(n.variants),i=n.next();!i.done;i=n.next())(i=i.value).audio&&t.add(i.audio),i.video&&t.add(i.video)}return t}(i),V(e,Promise.all(K(r,function(e){return e.createSegmentIndex()})),6);case 6:if(_u(a),t)throw t;return e.return(i);case 3:return N(e),V(e,n.stop(),7);case 7:P(e,0)}})})),2));case 2:if(m=e.A,_u(v),!(!m.presentationTimeline.W()&&!m.presentationTimeline.Bb()))throw new Pe(2,9,9005,b);return t=null,r=new qo,f=d=null,z(e,3,4),V(e,(s=v,u=m,c=function(e){f=f||e},G(function e(){var r,a,o;return q(e,function(e){switch(e.o){case 1:return r=new It({Zb:s.b,onError:c,Wc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),a=Ma(u.periods),o=s.a,r.configure(o.drm),V(e,(t=r,n=a,i=o.offline.usePersistentLicense,t.B=[],t.H=i,Ct(t,n)),2);case 2:return V(e,xt(r),3);case 3:return V(e,Nt(r),4);case 4:return e.return(r)}var t,n,i})})),6);case 6:if(t=e.A,_u(v),f)throw f;return V(e,(h=v,n=m,i=t,G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return t={width:1/0,height:1/0},function(e,t,n){for(var i=(e=B(e.periods)).next();!i.done;i=e.next())(i=i.value).variants=i.variants.filter(function(e){return zn.Jd(e,t,n)})}(n,h.a.restrictions,t),function(e){for(var t=(e=B(e.periods)).next();!t.done;t=e.next())(t=t.value).variants=t.variants.filter(function(e){var t=!0;return e.audio&&(t=t&&Rn(e.audio)),e.video&&(t=t&&Rn(e.video)),t})}(n),function(e,t){for(var n=B(e.periods),i=n.next();!i.done;i=n.next())(i=i.value).variants=i.variants.filter(function(e){return Ft(t,e)})}(n,i),xu(n),t=h.a.preferredAudioChannelCount,zn.De(n,t),V(e,(a=n,o=function(d){return G(function e(){var i,r,a,o,s,u,c,l;return q(e,function(e){switch(e.o){case 1:i=zn,r=[];for(var t=B(d.variants),n=t.next();!n.done;n=t.next())a=n.value,r.push(i.ue(a));for(n=(t=B(d.textStreams)).next();!n.done;n=t.next())o=n.value,r.push(i.fd(o));return V(e,h.a.offline.trackSelectionCallback(r),2);case 2:for(s=e.A,u=new Set,c=new Set,n=(t=B(s)).next();!n.done;n=t.next())"variant"==(l=n.value).type&&u.add(l.id),"text"==l.type&&c.add(l.id);d.variants=d.variants.filter(function(e){return u.has(e.id)}),d.textStreams=d.textStreams.filter(function(e){return c.has(e.id)}),x(e)}})})},G(function e(){var t,n,i,r;return q(e,function(e){switch(e.o){case 1:t=null,n=B(a.periods),i=n.next();case 2:if(i.done){e.C(0);break}return r=i.value,t&&(r.variants=r.variants.filter(function(e){return t.contains(new Nu(e))})),V(e,o(r),5);case 5:t=Mu(r.variants),i=n.next(),e.C(2)}})})),2);case 2:(function(e){if(0==e.periods.length)throw new Pe(2,4,4014);for(var t=(e=B(e.periods)).next();!t.done;t=e.next())!function(e){var t=new Set(e.variants.map(function(e){return e.video})),n=new Set(e.variants.map(function(e){return e.audio}));e=e.textStreams,1<t.size&&X.u("Multiple video tracks selected to be stored");for(var i=(t=B(n)).next();!i.done;i=t.next()){i=i.value;for(var r=B(n),a=r.next();!a.done;a=r.next())a=a.value,i!=a&&i.language==a.language&&X.u("Similar audio tracks were selected to be stored",i.id,a.id)}for(n=B(e),t=n.next();!t.done;t=n.next())for(t=t.value,i=B(e),r=i.next();!r.done;r=i.next())r=r.value,t!=r&&t.language==r.language&&X.u("Similar text tracks were selected to be stored",t.id,r.id)}(t.value)})(n),x(e)}var a,o})})),7);case 7:return V(e,r.init(),8);case 8:return _u(v),V(e,function(e){var i=null;if(e.a.forEach(function(e,n){e.getCells().forEach(function(e,t){e.hasFixedKeySpace()||i||(i={path:{Ta:n,ua:t},ua:e})})}),i)return i;throw new Pe(2,9,9013,"Could not find a cell that supports add-operations")}(r),9);case 9:return d=e.A,_u(v),V(e,(E=v,w=d.ua,T=t,S=m,A=b,I=y,G(function e(){var f,p,m,g,v,b,y;return q(e,function(e){switch(e.o){case 1:return c=A,d=I,h=null==(l=S).expiration?1/0:l.expiration,f={offlineUri:null,originalManifestUri:c,duration:l.presentationTimeline.ra(),size:0,expiration:h,tracks:l=Au(l.periods[0]),appMetadata:d},p=S.periods.some(function(e){return e.variants.some(function(e){return e.drmInfos&&e.drmInfos.length})}),b=S.periods.some(function(e){return e.variants.some(function(e){return e.drmInfos.some(function(e){return e.initData&&e.initData.length})})}),g=null,(m=p&&!b)&&(y=T.a,g=Fu.get(y.keySystem)),v=new _o(E.b,function(e,t){f.size=t,E.a.offline.progressCallback(f,e)},function(e,t){m&&E.a.offline.usePersistentLicense&&g==t&&Pt(T,"cenc",e)}),C(e,2),n=E,i=v,r=w,a=T,o=S,s=A,c=I,u=new Iu,h=o.periods.map(function(e){return function(e,t,n,i,r,a){for(var o=B(a.variants),s=o.next();!s.done;s=o.next())!function(e,t){var n,i,r=t.audio,a=t.video;r&&!a&&(e.a[r.id]=r.bandwidth||t.bandwidth),!r&&a&&(e.a[a.id]=a.bandwidth||t.bandwidth),r&&a&&(n=r.bandwidth||393216,(i=a.bandwidth||t.bandwidth-n)<=0&&(X.u("Audio bit rate consumes variants bandwidth. Setting video bandwidth to match variant's bandwidth."),i=t.bandwidth),e.a[r.id]=n,e.a[a.id]=i)}(i,s.value);for(o=B(a.textStreams),s=o.next();!s.done;s=o.next())i.a[s.value.id]=52;o=function(e){for(var t=new Set,n=B(e.textStreams),i=n.next();!i.done;i=n.next())t.add(i.value);for(e=B(e.variants),n=e.next();!n.done;n=e.next())(n=n.value).audio&&t.add(n.audio),n.video&&t.add(n.video);return t}(a);var u=new Map;for(o=B(o),s=o.next();!s.done;s=o.next()){s=s.value;var c=function(r,a,o,s,e,u){var c={id:u.id,originalId:u.originalId,primary:u.primary,presentationTimeOffset:u.presentationTimeOffset||0,contentType:u.type,mimeType:u.mimeType,codecs:u.codecs,frameRate:u.frameRate,pixelAspectRatio:u.pixelAspectRatio,kind:u.kind,language:u.language,label:u.label,width:u.width||null,height:u.height||null,initSegmentKey:null,encrypted:u.encrypted,keyId:u.keyId,segments:[],variantIds:[]};e=e.presentationTimeline.rc();var l=u.id,t=u.initSegmentReference;return t&&(t=Er(t.c(),t.b,t.a,r.a.streaming.retryParameters),Oo(a,l,t,.5*ku(s,u.id),!0,function(n){return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return V(e,o.addSegments([{data:n}]),2);case 2:t=e.A,r.c.push(t[0]),c.initSegmentKey=t[0],x(e)}})})})),function(e,t,n){for(var i=null==(t=e.findSegmentPosition(t))?null:e.getSegmentReference(t);i;)n(i),i=e.getSegmentReference(++t)}(u,e,function(i){var e,t,n=Er(i.c(),i.b,i.a,r.a.streaming.retryParameters);Oo(a,l,n,(e=s,t=u.id,n=(n=i).endTime-n.startTime,ku(e,t)*n),!1,function(n){return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return V(e,o.addSegments([{data:n}]),2);case 2:t=e.A,r.c.push(t[0]),c.segments.push({startTime:i.startTime,endTime:i.endTime,dataKey:t[0]}),x(e)}})})})}),c}(e,t,n,i,r,s);u.set(s.id,c)}return a.variants.forEach(function(e){e.audio&&u.get(e.audio.id).variantIds.push(e.id),e.video&&u.get(e.video.id).variantIds.push(e.id)}),{startTime:a.startTime,streams:Array.from(u.values())}}(n,i,r,u,o,e)}),l=a.a,d=n.a.offline.usePersistentLicense,l&&d&&(l.initData=[]),y=b={originalManifestUri:s,duration:o.presentationTimeline.ra(),size:0,expiration:a.nc(),periods:h,sessionIds:d?Rt(a):[],drmInfo:l,appMetadata:c},V(e,(t=v,G(function e(){return q(e,function(e){switch(e.o){case 1:return V(e,Promise.all(t.b.values()),2);case 2:return e.return(t.a.a)}})})),4);case 4:if(y.size=e.A,b.expiration=T.nc(),y=Rt(T),b.sessionIds=E.a.offline.usePersistentLicense?y:[],p&&E.a.offline.usePersistentLicense&&!y.length)throw new Pe(2,9,9007);return e.return(b);case 2:return N(e),V(e,v.destroy(),5);case 5:P(e,0)}var t,n,i,r,a,o,s,u,c,l,d,h})})),10);case 10:if(p=e.A,_u(v),f)throw f;return V(e,d.ua.addManifests([p]),11);case 11:return m=e.A,_u(v),m=new rs("manifest",d.path.Ta,d.path.ua,m[0]),e.return(Su(m,p));case 4:return N(e),v.f=!1,v.c=[],V(e,r.destroy(),12);case 12:if(t)return V(e,t.destroy(),13);e.C(13);break;case 13:P(e,0);break;case 3:if(g=W(e),d)return V(e,d.ua.removeSegments(v.c,function(){}),15);e.C(15);break;case 15:throw f||g}var E,w,T,S,A,I,h,n,i,s,u,c,a,o,l})})))},Ru.prototype.getStoreInProgress=Ru.prototype.vg=function(){return this.f},Ru.prototype.remove=function(e){return Du(this,(v=this,b=e,G(function e(){var f,p,m,g;return q(e,function(e){switch(e.o){case 1:return(Ou(),null==(g=as(b))||"manifest"!=g.a)?e.return(Promise.reject(new Pe(2,9,9004,b))):(f=g,p=new qo,C(e,2),V(e,p.init(),4));case 4:return V(e,Xo(p,f.Ta(),f.ua()),5);case 5:return V(e,(m=e.A).getManifests([f.key()]),6);case 6:return g=e.A,g=g[0],V(e,Promise.all([(l=v,d=g,h=p,G(function e(){return q(e,function(e){if(1===e.o)return V(e,(r=l.b,a=l.a.drm,o=h,s=d,G(function e(){var t,n,i;return q(e,function(e){switch(e.o){case 1:return s.drmInfo?(t=function(e){var t=Array.from(e.a.keys());if(!t.length)throw new Pe(2,9,9e3,"No supported storage mechanisms found");return e.a.get(t[0]).getEmeSessionCell()}(o),n=s.sessionIds.map(function(e){return{sessionId:e,keySystem:s.drmInfo.keySystem,licenseUri:s.drmInfo.licenseServerUri,serverCertificate:s.drmInfo.serverCertificate,audioCapabilities:Uu(s,!1),videoCapabilities:Uu(s,!0)}}),V(e,hs(a,r,n),2)):e.return();case 2:return i=e.A,V(e,t.remove(i),3);case 3:return V(e,t.add(n.filter(function(e){return-1==i.indexOf(e.sessionId)})),0)}})})),0);var r,a,o,s})})),(n=v,i=m,r=f,o=function(e){var t=[];return e.periods.forEach(function(e){e.streams.forEach(function(e){null!=e.initSegmentKey&&t.push(e.initSegmentKey),e.segments.forEach(function(e){t.push(e.dataKey)})})}),t}(a=g),s=o.length+1,u=0,c=Su(r,a),Promise.all([i.removeSegments(o,t),i.removeManifests([r.key()],t)]))]),2);case 2:return N(e),V(e,p.destroy(),8);case 8:P(e,0)}function t(){u+=1,n.a.offline.progressCallback(c,u/s)}var n,i,r,a,o,s,u,c,l,d,h})})));var v,b},Ru.prototype.removeEmeSessions=Ru.prototype.jh=function(){return Du(this,(d=this,G(function e(){var r,a,n,o,i,s,u,c,l;return q(e,function(e){switch(e.o){case 1:return Ou(),r=d.b,a=d.a.drm,n=new qo,o=!1,C(e,2),V(e,n.init(),4);case 4:for(i=[],t=function(e){return i.push(e)},n.a.forEach(function(e){t(e.getEmeSessionCell())}),s=Promise.resolve(),u={},c=B(i),l=c.next();!l.done;u={ed:u.ed},l=c.next())u.ed=l.value,s=s.then(function(i){return function(){return G(function e(){var t,n;return q(e,function(e){switch(e.o){case 1:return V(e,i.ed.getAll(),2);case 2:return t=e.A,V(e,hs(a,r,t),3);case 3:return n=e.A,V(e,i.ed.remove(n),4);case 4:n.length!=t.length&&(o=!0),x(e)}})})}}(u));return V(e,s,2);case 2:return N(e),V(e,n.destroy(),6);case 6:P(e,3);break;case 3:return e.return(!o)}var t})})));var d},Ru.prototype.list=function(){return Du(this,G(function e(){var r,t,a;return q(e,function(e){switch(e.o){case 1:return Ou(),r=[],t=new qo,C(e,2),V(e,t.init(),4);case 4:return a=Promise.resolve(),i=function(n,t){a=a.then(function(){return G(function e(){return q(e,function(e){switch(e.o){case 1:return V(e,t.getAllManifests(),2);case 2:e.A.forEach(function(e,t){e=Su(new rs("manifest",n.Ta,n.ua,t),e);r.push(e)}),x(e)}})})})},t.a.forEach(function(e,n){e.getCells().forEach(function(e,t){i({Ta:n,ua:t},e)})}),V(e,a,2);case 2:return N(e),V(e,t.destroy(),6);case 6:P(e,3);break;case 3:return e.return(r)}var i})}))},Ru.deleteAll=function(){return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return t=new qo,C(e,2),V(e,t.erase(),2);case 2:return N(e),V(e,t.destroy(),5);case 5:P(e,0)}})})};var Fu=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb");function ju(){for(var e=0;e<Gu.length;++e)try{Gu[e].Lf()}catch(e){X.ba("Error installing polyfill!",e)}}Rs.offline=Lu,_("shaka.polyfill.installAll",ju);var Ku,Bu,Gu=[];function Vu(e,t){for(var n={priority:t=t||0,Lf:e},i=0;i<Gu.length;i++)if(Gu[i].priority<t)return void Gu.splice(i,0,n);Gu.push(n)}function zu(e){var t,n=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase();"function"==typeof Event?t=new Event(n,e):(t=document.createEvent("Event")).initEvent(n,e.bubbles,e.cancelable),e.target.dispatchEvent(t)}function Hu(e,t,n){"input"==e&&"range"===this.type&&(e="change"),HTMLInputElement.prototype.originalAddEventListener.call(this,e,t,n)}function Wu(){var i=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(e){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];return(t=i.apply(this,t)).abort=function(){},t}}function qu(e,t){X.debug("PatchedMediaKeysApple.requestMediaKeySystemAccess");try{var n=new Xu(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function Xu(e,t){if(X.debug("PatchedMediaKeysApple.MediaKeySystemAccess"),(this.keySystem=e).startsWith("com.apple.fps"))for(var n=B(t),i=n.next();!i.done;i=n.next()){var r=i.value;if("required"==r.persistentState)i=null;else{var a,o=!(i={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:r.initDataTypes,sessionTypes:["temporary"],label:r.label}),s=!1;if(r.audioCapabilities)for(var u=B(r.audioCapabilities),c=u.next();!c.done;c=u.next())(c=c.value).contentType&&(o=!0,a=c.contentType.split(";")[0],WebKitMediaKeys.isTypeSupported(this.keySystem,a)&&(i.audioCapabilities.push(c),s=!0));if(r.videoCapabilities)for(c=(r=B(r.videoCapabilities)).next();!c.done;c=r.next())(u=c.value).contentType&&(o=!0,c=u.contentType.split(";")[0],WebKitMediaKeys.isTypeSupported(this.keySystem,c)&&(i.videoCapabilities.push(u),s=!0));o||(s=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),i=s?i:null}if(i)return void(this.a=i)}throw(n=Error("Unsupported keySystem")).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function Yu(e){X.debug("PatchedMediaKeysApple.setMediaKeys");var t=this.mediaKeys;return t&&t!=e&&Ju(t,null),delete this.mediaKeys,(this.mediaKeys=e)?Ju(e,this):Promise.resolve()}function $u(e){X.debug("PatchedMediaKeysApple.MediaKeys"),this.b=new WebKitMediaKeys(e),this.a=new Ze}function Ju(e,t){if(e.a.Hb(),!t)return Promise.resolve();e.a.m(t,"webkitneedkey",Qu);try{return Oa(t,HTMLMediaElement.HAVE_METADATA,e.a,function(){t.webkitSetMediaKeys(e.b)}),Promise.resolve()}catch(e){return Promise.reject(e)}}function Zu(e){X.debug("PatchedMediaKeysApple.MediaKeySession"),j.call(this),this.b=null,this.g=e,this.c=this.a=null,this.f=new Ze,this.sessionId="",this.expiration=NaN,this.closed=new Me,this.keyStatuses=new tc}function Qu(e){if(X.debug("PatchedMediaKeysApple.onWebkitNeedKey_",e),e=new Uint8Array(e.initData),new DataView(e.buffer,e.byteOffset,e.byteLength).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=Et(e=bt(e.subarray(4),!0));var t=new Event("encrypted");t.initDataType="skd",t.initData=e,this.dispatchEvent(t)}function ec(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.a=t,e.dispatchEvent(new D("keystatuseschange"))}function tc(){this.size=0,this.a=void 0}function nc(e,t){X.debug("PatchedMediaKeysMs.requestMediaKeySystemAccess");try{var n=new ic(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function ic(e,t){X.debug("PatchedMediaKeysMs.MediaKeySystemAccess"),this.keySystem=e;for(var n=!1,i=0;i<t.length;++i){var r=t[i],a={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:r.initDataTypes,sessionTypes:["temporary"],label:r.label},o=!1;if(r.audioCapabilities)for(var s=0;s<r.audioCapabilities.length;++s){var u,c=r.audioCapabilities[s];c.contentType&&(o=!0,u=c.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,u)&&(a.audioCapabilities.push(c),n=!0))}if(r.videoCapabilities)for(s=0;s<r.videoCapabilities.length;++s)(c=r.videoCapabilities[s]).contentType&&(o=!0,u=c.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,u)&&(a.videoCapabilities.push(c),n=!0));if(o||(n=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),"required"==r.persistentState&&(n=!1),n)return void(this.a=a)}throw(n=Error("Unsupported keySystem")).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function rc(e){X.debug("PatchedMediaKeysMs.setMediaKeys");var t=this.mediaKeys;return t&&t!=e&&oc(t,null),delete this.mediaKeys,(this.mediaKeys=e)?oc(e,this):Promise.resolve()}function ac(e){X.debug("PatchedMediaKeysMs.MediaKeys"),this.b=new MSMediaKeys(e),this.a=new Ze}function oc(e,t){if(e.a.Hb(),!t)return Promise.resolve();e.a.m(t,"msneedkey",uc);try{return Oa(t,HTMLMediaElement.HAVE_METADATA,e.a,function(){t.msSetMediaKeys(e.b)}),Promise.resolve()}catch(e){return Promise.reject(e)}}function sc(e){X.debug("PatchedMediaKeysMs.MediaKeySession"),j.call(this),this.c=null,this.g=e,this.b=this.a=null,this.f=new Ze,this.sessionId="",this.expiration=NaN,this.closed=new Me,this.keyStatuses=new lc}function uc(e){var t;X.debug("PatchedMediaKeysMs.onMsNeedKey_",e),e.initData&&((t=document.createEvent("CustomEvent")).initCustomEvent("encrypted",!1,!1,null),t.initDataType="cenc",t.initData=function(e){if(!e)return e;var t=new Vi(e);if(t.data.length<=1)return e;e=[];for(var n={},i=(t=B(t.data)).next();!i.done;n={Sc:n.Sc},i=t.next())n.Sc=i.value,e.some(function(t){return function(e){return At.Xa(e,t.Sc)}}(n))||e.push(n.Sc);return At.concat.apply(At,I(e))}(e.initData).buffer,this.dispatchEvent(t))}function cc(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.a=t,e.dispatchEvent(new D("keystatuseschange"))}function lc(){this.size=0,this.a=void 0}function dc(){return X.debug("PatchedMediaKeysNop.requestMediaKeySystemAccess"),Promise.reject(Error("The key system specified is not supported."))}function hc(e){return X.debug("PatchedMediaKeysNop.setMediaKeys"),null==e?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function fc(){throw new TypeError("Illegal constructor.")}function pc(){throw new TypeError("Illegal constructor.")}_("shaka.polyfill.register",Vu),Vu(function(){xl()},-1),Vu(function(){var e;d.Document&&((e=Element.prototype).requestFullscreen=e.requestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen||e.webkitRequestFullscreen,(e=Document.prototype).exitFullscreen=e.exitFullscreen||e.mozCancelFullScreen||e.msExitFullscreen||e.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",zu),document.addEventListener("webkitfullscreenerror",zu),document.addEventListener("mozfullscreenchange",zu),document.addEventListener("mozfullscreenerror",zu),document.addEventListener("MSFullscreenChange",zu),document.addEventListener("MSFullscreenError",zu))}),Vu(function(){X.debug("InputEvent.install"),ft("Trident/")&&!HTMLInputElement.prototype.originalAddEventListener&&(X.info("Patching input event support on IE."),HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=Hu)}),Vu(function(){navigator.languages||Object.defineProperty(navigator,"languages",{get:function(){return navigator.language?[navigator.language]:["en"]}})}),Vu(function(){X.debug("mathRound.install")}),Vu(function(){X.debug("MediaSource.install");var t,n,i,r,e=ht();d.MediaSource?d.cast&&cast.__platform__&&cast.__platform__.canDisplayType?(X.info("Patching Chromecast MSE bugs."),r=MediaSource.isTypeSupported,MediaSource.isTypeSupported=function(e){var t=e.split(/ *; */);return t.shift(),t.some(function(e){return e.startsWith("codecs=")})?cast.__platform__.canDisplayType(e):r(e)}):e?(i=MediaSource.isTypeSupported,MediaSource.isTypeSupported=function(e){return"mp2t"!=e.split(/ *; */)[0].split("/")[1].toLowerCase()&&i(e)},e<=12?(X.info("Patching Safari 11 & 12 MSE bugs."),Wu(),n=SourceBuffer.prototype.remove,SourceBuffer.prototype.remove=function(e,t){return n.call(this,e,t-.001)}):(X.info("Patching Safari 13 MSE bugs."),Wu())):ft("Tizen 2")||ft("Tizen 3")||ft("Tizen 4")?(t=MediaSource.isTypeSupported,MediaSource.isTypeSupported=function(e){return"opus"!=ot(e)[0]&&t(e)}):X.info("Using native MSE as-is."):X.info("No MSE implementation available.")}),Xu.prototype.createMediaKeys=function(){X.debug("PatchedMediaKeysApple.MediaKeySystemAccess.createMediaKeys");var e=new $u(this.keySystem);return Promise.resolve(e)},Xu.prototype.getConfiguration=function(){return X.debug("PatchedMediaKeysApple.MediaKeySystemAccess.getConfiguration"),this.a},$u.prototype.createSession=function(e){if(X.debug("PatchedMediaKeysApple.MediaKeys.createSession"),"temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new Zu(this.b)},$u.prototype.setServerCertificate=function(e){return X.debug("PatchedMediaKeysApple.MediaKeys.setServerCertificate"),e&&new Uint8Array(e),Promise.resolve(!0)},O(Zu,j),(e=Zu.prototype).generateRequest=function(e,t){X.debug("PatchedMediaKeysApple.MediaKeySession.generateRequest"),this.a=new Me;try{this.b=this.g.createSession("video/mp4",new Uint8Array(t)),this.sessionId=this.b.sessionId||"",this.f.m(this.b,"webkitkeymessage",this.Ah.bind(this)),this.f.m(this.b,"webkitkeyadded",this.xh.bind(this)),this.f.m(this.b,"webkitkeyerror",this.yh.bind(this)),ec(this,"status-pending")}catch(e){this.a.reject(e)}return this.a},e.load=function(){return X.debug("PatchedMediaKeysApple.MediaKeySession.load"),Promise.reject(Error("MediaKeySession.load not yet supported"))},e.update=function(e){X.debug("PatchedMediaKeysApple.MediaKeySession.update"),this.c=new Me;try{this.b.update(new Uint8Array(e))}catch(e){this.c.reject(e)}return this.c},e.close=function(){X.debug("PatchedMediaKeysApple.MediaKeySession.close");try{this.b.close(),this.closed.resolve(),this.f.Hb()}catch(e){this.closed.reject(e)}return this.closed},e.remove=function(){return X.debug("PatchedMediaKeysApple.MediaKeySession.remove"),Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},e.Ah=function(e){X.debug("PatchedMediaKeysApple.onWebkitKeyMessage_",e),this.a&&(this.a.resolve(),this.a=null),this.dispatchEvent(new D("message",{messageType:null==this.keyStatuses.a?"license-request":"license-renewal",message:e.message.buffer}))},e.xh=function(e){X.debug("PatchedMediaKeysApple.onWebkitKeyAdded_",e),this.c&&(ec(this,"usable"),this.c.resolve(),this.c=null)},e.yh=function(e){if(X.debug("PatchedMediaKeysApple.onWebkitKeyError_",e),(e=Error("EME PatchedMediaKeysApple key error")).errorCode=this.b.error,null!=this.a)this.a.reject(e),this.a=null;else if(null!=this.c)this.c.reject(e),this.c=null;else switch(this.b.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:ec(this,"output-not-allowed");break;default:ec(this,"internal-error")}},(e=tc.prototype).forEach=function(e){this.a&&e(this.a,Ku)},e.get=function(e){if(this.has(e))return this.a},e.has=function(e){var t=Ku;return!(!this.a||!At.Xa(new Uint8Array(e),new Uint8Array(t)))},e.entries=function(){},e.keys=function(){},e.values=function(){},Vu(function(){d.HTMLVideoElement&&d.WebKitMediaKeys&&(X.info("Using Apple-prefixed EME"),Ku=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Yu,d.MediaKeys=$u,d.MediaKeySystemAccess=Xu,navigator.requestMediaKeySystemAccess=qu)}),ic.prototype.createMediaKeys=function(){X.debug("PatchedMediaKeysMs.MediaKeySystemAccess.createMediaKeys");var e=new ac(this.keySystem);return Promise.resolve(e)},ic.prototype.getConfiguration=function(){return X.debug("PatchedMediaKeysMs.MediaKeySystemAccess.getConfiguration"),this.a},ac.prototype.createSession=function(e){if(X.debug("PatchedMediaKeysMs.MediaKeys.createSession"),"temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new sc(this.b)},ac.prototype.setServerCertificate=function(){return X.debug("PatchedMediaKeysMs.MediaKeys.setServerCertificate"),Promise.resolve(!1)},O(sc,j),(e=sc.prototype).generateRequest=function(e,t){X.debug("PatchedMediaKeysMs.MediaKeySession.generateRequest"),this.a=new Me;try{this.c=this.g.createSession("video/mp4",new Uint8Array(t),null),this.f.m(this.c,"mskeymessage",this.Ug.bind(this)),this.f.m(this.c,"mskeyadded",this.Sg.bind(this)),this.f.m(this.c,"mskeyerror",this.Tg.bind(this)),cc(this,"status-pending")}catch(e){this.a.reject(e)}return this.a},e.load=function(){return X.debug("PatchedMediaKeysMs.MediaKeySession.load"),Promise.reject(Error("MediaKeySession.load not yet supported"))},e.update=function(e){X.debug("PatchedMediaKeysMs.MediaKeySession.update"),this.b=new Me;try{this.c.update(new Uint8Array(e))}catch(e){this.b.reject(e)}return this.b},e.close=function(){X.debug("PatchedMediaKeysMs.MediaKeySession.close");try{this.c.close(),this.closed.resolve(),this.f.Hb()}catch(e){this.closed.reject(e)}return this.closed},e.remove=function(){return X.debug("PatchedMediaKeysMs.MediaKeySession.remove"),Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},e.Ug=function(e){X.debug("PatchedMediaKeysMs.onMsKeyMessage_",e),this.a&&(this.a.resolve(),this.a=null),this.dispatchEvent(new D("message",{messageType:null==this.keyStatuses.a?"license-request":"license-renewal",message:e.message.buffer}))},e.Sg=function(e){X.debug("PatchedMediaKeysMs.onMsKeyAdded_",e),this.a?(X.debug("Simulating completion for a PR persistent license."),cc(this,"usable"),this.a.resolve(),this.a=null):this.b&&(cc(this,"usable"),this.b.resolve(),this.b=null)},e.Tg=function(e){if(X.debug("PatchedMediaKeysMs.onMsKeyError_",e),(e=Error("EME PatchedMediaKeysMs key error")).errorCode=this.c.error,null!=this.a)this.a.reject(e),this.a=null;else if(null!=this.b)this.b.reject(e),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:cc(this,"output-not-allowed");break;default:cc(this,"internal-error")}},(e=lc.prototype).forEach=function(e){this.a&&e(this.a,Bu)},e.get=function(e){if(this.has(e))return this.a},e.has=function(e){var t=Bu;return!(!this.a||!At.Xa(new Uint8Array(e),new Uint8Array(t)))},e.entries=function(){},e.keys=function(){},e.values=function(){},Vu(function(){!d.HTMLVideoElement||!d.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(X.info("Using ms-prefixed EME v20140218"),Bu=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=rc,d.MediaKeys=ac,d.MediaKeySystemAccess=ic,navigator.requestMediaKeySystemAccess=nc)}),fc.prototype.createSession=function(){},fc.prototype.setServerCertificate=function(){},pc.prototype.getConfiguration=function(){},pc.prototype.createMediaKeys=function(){},Vu(function(){!d.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(X.info("EME not available."),navigator.requestMediaKeySystemAccess=dc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=hc,d.MediaKeys=fc,d.MediaKeySystemAccess=pc)},-10);var mc,gc="";function vc(e){return gc?gc+e.charAt(0).toUpperCase()+e.slice(1):e}function bc(e,t){X.debug("PatchedMediaKeysWebkit.requestMediaKeySystemAccess");try{var n=new Ec(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function yc(e){X.debug("PatchedMediaKeysWebkit.setMediaKeys");var t=this.mediaKeys;return t&&t!=e&&Tc(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&Tc(e,this),Promise.resolve()}function Ec(e,t){X.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess");var n=!1;"org.w3.clearkey"==(this.a=this.keySystem=e)&&(n=!(this.a="webkit-org.w3.clearkey"));for(var i=!1,r=(r=document.getElementsByTagName("video")).length?r[0]:document.createElement("video"),a=0;a<t.length;++a){var o=t[a],s={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:o.initDataTypes,sessionTypes:["temporary"],label:o.label},u=!1;if(o.audioCapabilities)for(var c=0;c<o.audioCapabilities.length;++c){var l,d=o.audioCapabilities[c];d.contentType&&(u=!0,l=d.contentType.split(";")[0],r.canPlayType(l,this.a)&&(s.audioCapabilities.push(d),i=!0))}if(o.videoCapabilities)for(c=0;c<o.videoCapabilities.length;++c)(d=o.videoCapabilities[c]).contentType&&(u=!0,r.canPlayType(d.contentType,this.a)&&(s.videoCapabilities.push(d),i=!0));if(u||(i=r.canPlayType("video/mp4",this.a)||r.canPlayType("video/webm",this.a)),"required"==o.persistentState&&(n?(s.persistentState="required",s.sessionTypes=["persistent-license"]):i=!1),i)return void(this.b=s)}throw n="org.w3.clearkey"!=e&&"com.widevine.alpha"!=e?"Unsupported keySystem":"None of the requested configurations were supported.",(n=Error(n)).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function wc(e){X.debug("PatchedMediaKeysWebkit.MediaKeys"),this.g=e,this.b=null,this.a=new Ze,this.c=[],this.f={}}function Tc(e,t){e.b=t,e.a.Hb();var n=gc;t&&(e.a.m(t,n+"needkey",e.Yg.bind(e)),e.a.m(t,n+"keymessage",e.Dh.bind(e)),e.a.m(t,n+"keyadded",e.Bh.bind(e)),e.a.m(t,n+"keyerror",e.Ch.bind(e)))}function Sc(e,t){var n=e.f[t];return n?(X.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",n),n):(n=e.c.shift())?(n.sessionId=t,e.f[t]=n,X.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",n),n):null}function Ac(e,t,n){X.debug("PatchedMediaKeysWebkit.MediaKeySession"),j.call(this),this.f=e,this.j=!1,this.a=this.b=null,this.c=t,this.g=n,this.sessionId="",this.expiration=NaN,this.closed=new Me,this.keyStatuses=new Cc}function Ic(t,e,n){if(t.j)return Promise.reject(Error("The session is already initialized."));t.j=!0;try{var i,r,a="persistent-license"==t.g?n?new Uint8Array(Et("LOAD_SESSION|"+n)):(i=Et("PERSISTENT|"),(r=new Uint8Array(i.byteLength+e.byteLength)).set(new Uint8Array(i),0),r.set(new Uint8Array(e),i.byteLength),r):new Uint8Array(e)}catch(e){return Promise.reject(e)}t.b=new Me;var o=vc("generateKeyRequest");try{t.f[o](t.c,a)}catch(e){if("InvalidStateError"!=e.name)return t.b=null,Promise.reject(e);new ke(function(){try{t.f[o](t.c,a)}catch(e){t.b.reject(e),t.b=null}}).R(.01)}return t.b}function kc(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.a=t,e.dispatchEvent(new D("keystatuseschange"))}function Cc(){this.size=0,this.a=void 0}function xc(e){var t="picture-in-picture"==(e=e.target).webkitPresentationMode?(document.pictureInPictureElement=e,new Event("enterpictureinpicture")):(document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),new Event("leavepictureinpicture"));e.dispatchEvent(t)}function Nc(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function Pc(){var e=document.pictureInPictureElement;return e?(e.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function Mc(){return!!this.hasAttribute("disablePictureInPicture")||!this.webkitSupportsPresentationMode("picture-in-picture")}function Rc(e){e?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}function Lc(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function Uc(e,t,n){return new d.TextTrackCue(e,t,n)}function _c(e,t,n){return new d.TextTrackCue(e+"-"+t+"-"+n,e,t,n)}function Oc(){}Ec.prototype.createMediaKeys=function(){X.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var e=new wc(this.a);return Promise.resolve(e)},Ec.prototype.getConfiguration=function(){return X.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration"),this.b},(e=wc.prototype).createSession=function(e){if(X.debug("PatchedMediaKeysWebkit.MediaKeys.createSession"),"temporary"!=(e=e||"temporary")&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.b||document.createElement("video");return t.src||(t.src="about:blank"),e=new Ac(t,this.g,e),this.c.push(e),e},e.setServerCertificate=function(){return X.debug("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate"),Promise.resolve(!1)},e.Yg=function(e){X.debug("PatchedMediaKeysWebkit.onWebkitNeedKey_",e);var t=document.createEvent("CustomEvent");t.initCustomEvent("encrypted",!1,!1,null),t.initDataType="cenc",e.initData instanceof ArrayBuffer?t.initData=e.initData:t.initData=e.initData.buffer,this.b.dispatchEvent(t)},e.Dh=function(e){X.debug("PatchedMediaKeysWebkit.onWebkitKeyMessage_",e);var t=Sc(this,e.sessionId);t?(e=new D("message",{messageType:null==t.keyStatuses.a?"licenserequest":"licenserenewal",message:e.message}),X.debug("PatchedMediaKeysWebkit.MediaKeySession.generated"),t.b&&(t.b.resolve(),t.b=null),t.dispatchEvent(e)):X.error("Session not found",e.sessionId)},e.Bh=function(e){X.debug("PatchedMediaKeysWebkit.onWebkitKeyAdded_",e),(e=Sc(this,e.sessionId))&&(X.debug("PatchedMediaKeysWebkit.MediaKeySession.ready"),kc(e,"usable"),e.a&&e.a.resolve(),e.a=null)},e.Ch=function(e){X.debug("PatchedMediaKeysWebkit.onWebkitKeyError_",e);var t=Sc(this,e.sessionId);t&&t.handleError(e)},O(Ac,j),(e=Ac.prototype).handleError=function(e){X.debug("PatchedMediaKeysWebkit.MediaKeySession.handleError",e);var t=Error("EME v0.1b key error"),n=e.errorCode;n.systemCode=e.systemCode,t.errorCode=n,!e.sessionId&&this.b?(45==e.systemCode&&(t.message="Unsupported session type."),this.b.reject(t),this.b=null):e.sessionId&&this.a?(this.a.reject(t),this.a=null):(t=e.systemCode,e.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?kc(this,"output-restricted"):kc(this,1==t?"expired":"internal-error"))},e.ke=function(e,t){if(this.a)this.a.then(this.ke.bind(this,e,t)).catch(this.ke.bind(this,e,t));else{var n,i;this.a=e,i="webkit-org.w3.clearkey"==this.c?(n=vt(t),"oct"!=(i=JSON.parse(n)).keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),n=At.Za(i.keys[0].k),At.Za(i.keys[0].kid)):(n=new Uint8Array(t),null);var r=vc("addKey");try{this.f[r](this.c,n,i,this.sessionId)}catch(e){this.a.reject(e),this.a=null}}},e.generateRequest=function(e,t){return X.debug("PatchedMediaKeysWebkit.MediaKeySession.generateRequest"),Ic(this,t,null)},e.load=function(e){return X.debug("PatchedMediaKeysWebkit.MediaKeySession.load"),"persistent-license"==this.g?Ic(this,null,e):Promise.reject(Error("Not a persistent session."))},e.update=function(e){X.debug("PatchedMediaKeysWebkit.MediaKeySession.update",e);var t=new Me;return this.ke(t,e),t},e.close=function(){if(X.debug("PatchedMediaKeysWebkit.MediaKeySession.close"),"persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=vc("cancelKeyRequest");try{this.f[e](this.c,this.sessionId)}catch(e){}}return this.closed.resolve(),this.closed},e.remove=function(){return X.debug("PatchedMediaKeysWebkit.MediaKeySession.remove"),"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()},(e=Cc.prototype).forEach=function(e){this.a&&e(this.a,mc)},e.get=function(e){if(this.has(e))return this.a},e.has=function(e){var t=mc;return!(!this.a||!At.Xa(new Uint8Array(e),new Uint8Array(t)))},e.entries=function(){},e.keys=function(){},e.values=function(){},Vu(function(){if(!(!d.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)X.info("Using webkit-prefixed EME v0.1b"),gc="webkit";else{if(!HTMLMediaElement.prototype.generateKeyRequest)return;X.info("Using nonprefixed EME v0.1b")}mc=new Uint8Array([0]).buffer,navigator.requestMediaKeySystemAccess=bc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=yc,d.MediaKeys=wc,d.MediaKeySystemAccess=Ec}}),Vu(function(){var e;d.HTMLVideoElement&&((e=HTMLVideoElement.prototype).requestPictureInPicture&&document.exitPictureInPicture||!e.webkitSupportsPresentationMode||(X.debug("PiPWebkit.install"),document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,e.requestPictureInPicture=Nc,Object.defineProperty(e,"disablePictureInPicture",{get:Mc,set:Rc,enumerable:!0,configurable:!0}),document.exitPictureInPicture=Pc,document.addEventListener("webkitpresentationmodechanged",xc,!0)))}),Vu(function(){var t;X.debug("VideoPlayPromise.install"),d.HTMLMediaElement&&(t=HTMLMediaElement.prototype.play,HTMLMediaElement.prototype.play=function(){var e=t.apply(this);return e&&e.catch(function(){}),e})}),Vu(function(){var e;!d.HTMLVideoElement||!(e=HTMLVideoElement.prototype).getVideoPlaybackQuality&&"webkitDroppedFrameCount"in e&&(e.getVideoPlaybackQuality=Lc)}),Vu(function(){if(d.VTTCue)X.info("Using native VTTCue.");else if(d.TextTrackCue){var e=TextTrackCue.length;if(3==e)X.info("Using VTTCue polyfill from 3 argument TextTrackCue."),d.VTTCue=Uc;else if(6==e)X.info("Using VTTCue polyfill from 6 argument TextTrackCue."),d.VTTCue=_c;else{try{var t=!!Uc(1,2,"")}catch(e){t=!1}t&&(X.info("Using VTTCue polyfill from 3 argument TextTrackCue."),d.VTTCue=Uc)}}else X.error("VTTCue not available.")}),_("shaka.text.TtmlTextParser",Oc),Oc.prototype.parseInit=function(){},Oc.prototype.parseMedia=function(e,t){var n=vt(e),i=[],r=new DOMParser,a=null;if(""==n)return i;try{a=r.parseFromString(n,"text/xml")}catch(e){throw new Pe(2,2,2005,"Failed to parse TTML.")}if(a){if(n=a.getElementsByTagName("parsererror")[0])throw new Pe(2,2,2005,n.textContent);if(!(r=a.getElementsByTagName("tt")[0]))throw new Pe(2,2,2005,"TTML does not contain <tt> tag.");var o=zi.getAttributeNS(r,"http://www.w3.org/ns/ttml#parameter","frameRate"),s=zi.getAttributeNS(r,"http://www.w3.org/ns/ttml#parameter","subFrameRate"),u=zi.getAttributeNS(r,"http://www.w3.org/ns/ttml#parameter","frameRateMultiplier"),c=zi.getAttributeNS(r,"http://www.w3.org/ns/ttml#parameter","tickRate"),a=r.getAttribute("xml:space")||"default",n=zi.getAttributeNS(r,"http://www.w3.org/ns/ttml#styling","extent");if("default"!=a&&"preserve"!=a)throw new Pe(2,2,2005,"Invalid xml:space value: "+a);a="default"==a,o=new sl(o,s,u,c),s=$c(r.getElementsByTagName("metadata")[0]),u=$c(r.getElementsByTagName("styling")[0]),c=$c(r.getElementsByTagName("layout")[0]);for(var l=[],d=0;d<c.length;d++){var h,f,p=c[d],m=u,g=n,v=new Tn,b=p.getAttribute("xml:id");b?(v.id=b,b=null,g&&(b=jc.exec(g)||Bc.exec(g)),g=b?Number(b[1]):null,b=b?Number(b[2]):null,!(h=tl(p,m,"extent"))||null!=(h=(f=jc.exec(h))||Bc.exec(h))&&(v.width=null!=g?100*Number(h[1])/g:Number(h[1]),v.height=null!=b?100*Number(h[2])/b:Number(h[2]),v.widthUnits=f||null!=g?Sn:0,v.heightUnits=f||null!=b?Sn:0),!(p=tl(p,m,"origin"))||null!=(h=(f=jc.exec(p))||Bc.exec(p))&&(v.viewportAnchorX=null!=b?100*Number(h[1])/b:Number(h[1]),v.viewportAnchorY=null!=g?100*Number(h[2])/g:Number(h[2]),v.viewportAnchorUnits=f||null!=g?Sn:0)):(X.u("TtmlTextParser parser encountered a region with no id. Region will be ignored."),v=null),v&&l.push(v)}for(n=function e(t){if(!t)return[];var n=[];t=B(t.childNodes);for(var i=t.next();!i.done;i=t.next())i=i.value,i instanceof Element&&(i.hasAttribute("begin")?n.push(i):n=n.concat(e(i)));return n}(r.getElementsByTagName("body")[0]),r=(n=B(n)).next();!r.done;r=n.next())(r=function e(t,n,i,r,a,o,s,u,c){if(c&&"br"==t.nodeName)return t=new sn(0,0,""),t.spacer=!0,t;var l=/^[\s\n]*$/.test(t.textContent),d=t.nodeType==Node.ELEMENT_NODE&&!t.hasAttribute("begin")&&!t.hasAttribute("end");if(t.nodeType!=Node.ELEMENT_NODE||d&&l||d&&!c)return null;l=al(t.getAttribute("begin"),i);d=al(t.getAttribute("end"),i);var h=al(t.getAttribute("dur"),i);null==d&&null!=h&&(d=l+h);if(!c&&(null==l||null==d))throw new Pe(2,2,2001);l=c&&null==l?0:l+n;d=c&&null==d?0:d+n;h="";c=[];if(Array.from(t.childNodes).find(function(e){return e.nodeType===Node.TEXT_NODE&&/\S+/.test(e.textContent)}))h=Jc(t,u);else for(var f=B(t.childNodes),p=f.next();!p.done;p=f.next())(p=e(p.value,n,i,r,a,o,s,u,!0))&&(p.startTime=p.startTime||l,p.endTime=p.endTime||d,c.push(p));n=new sn(l,d,h);n.nestedCues=c;{var m;(o=rl(t,"region",o,"")[0])&&o.getAttribute("xml:id")&&(m=o.getAttribute("xml:id"),n.region=s.filter(function(e){return e.id==m})[0])}r=rl(t,"backgroundImage",r,"#","http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt")[0];Zc(n,t,o,r,a);return n}(r.value,t.periodStart,o,s,u,c,l,a,!1))&&i.push(r)}return i};var Dc,Fc,jc=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,Kc=/^(\d+px|\d+em)$/,Bc=/^(\d+)px (\d+)px$/,Gc=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Vc=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,zc=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,Hc=/^(\d*(?:\.\d*)?)f$/,Wc=/^(\d*(?:\.\d*)?)t$/,qc=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,Xc={left:vn,center:"center",right:"end",start:vn,end:"end"},Yc={left:"line-left",center:"center",right:"line-right"};function $c(e){var t=[];if(!e)return t;for(var n=B(e.childNodes),i=n.next();!i.done;i=n.next())(i=i.value).nodeType==Node.ELEMENT_NODE&&"br"!==i.nodeName&&(i=$c(i),t=t.concat(i));return t.length||t.push(e),t}function Jc(e,t){for(var n="",i=B(e.childNodes),r=i.next();!r.done;r=i.next())"br"==(r=r.value).nodeName&&e.childNodes[0]!==r?n+="\n":r.childNodes&&0<r.childNodes.length?n+=Jc(r,t):t?n+=r=(r=r.textContent.trim()).replace(/\s+/g," "):n+=r.textContent;return n}function Zc(e,t,n,i,r){"rtl"==el(t,n,r,"direction")&&(e.direction="rtl");var a,o=el(t,n,r,"writingMode");"tb"==o||"tblr"==o?e.writingMode="vertical-lr":"tbrl"==o?e.writingMode="vertical-rl":"rltb"==o||"rl"==o?e.direction="rtl":o&&(e.direction=pn),(o=el(t,n,r,"textAlign"))?(e.positionAlign=Yc[o],e.lineAlign=Xc[o],e.textAlign=dn[o.toUpperCase()]):e.textAlign="start",(o=el(t,n,r,"displayAlign"))&&(e.displayAlign=fn[o.toUpperCase()]),(o=el(t,n,r,"color"))&&(e.color=o),(o=el(t,n,r,"backgroundColor"))&&(e.backgroundColor=o),(o=el(t,n,r,"fontFamily"))&&(e.fontFamily=o),(o=el(t,n,r,"fontWeight"))&&"bold"==o&&(e.fontWeight=700),(o=el(t,n,r,"wrapOption"))&&"noWrap"==o&&(e.wrapLine=!1),(o=el(t,n,r,"lineHeight"))&&o.match(Kc)&&(e.lineHeight=o),(o=el(t,n,r,"fontSize"))&&o.match(Kc)&&(e.fontSize=o),(o=el(t,n,r,"fontStyle"))&&(e.fontStyle=wn[o.toUpperCase()]),i&&(o=i.getAttribute("imagetype"),a=i.getAttribute("encoding"),i=i.textContent.trim(),"PNG"==o&&"Base64"==a&&i&&(e.backgroundImage="data:image/png;base64,"+i)),(n=tl(n,r,"textDecoration"))&&Qc(e,n),(t=nl(t,r,"textDecoration"))&&Qc(e,t)}function Qc(e,t){for(var n=t.split(" "),i=0;i<n.length;i++)switch(n[i]){case"underline":e.textDecoration.includes("underline")||e.textDecoration.push("underline");break;case"noUnderline":e.textDecoration.includes("underline")&&Ke(e.textDecoration,"underline");break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&Ke(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&Ke(e.textDecoration,"overline")}}function el(e,t,n,i){return(e=nl(e,n,i))?e:tl(t,n,i)}function tl(e,t,n){if(!e)return null;for(var i=$c(e),r=0;r<i.length;r++){var a=zi.getAttributeNS(i[r],"http://www.w3.org/ns/ttml#styling",n);if(a)return a}return il(e,t,n)}function nl(e,t,n){var i=zi.getAttributeNS(e,"http://www.w3.org/ns/ttml#styling",n);return i||il(e,t,n)}function il(e,t,n){e=rl(e,"style",t,"");for(var i=null,r=0;r<e.length;r++){var a=zi.getAttributeNS(e[r],"http://www.w3.org/ns/ttml#styling",n);(a=a||nl(e[r],t,n))&&(i=a)}return i}function rl(e,t,n,i,r){var a=[];if(!e||n.length<1)return a;var o=e;for(e=null;o&&!(e=r?zi.getAttributeNS(o,r,t):o.getAttribute(t))&&(o=o.parentNode)instanceof Element;);if(t=e)for(r=(t=B(t=t.split(" "))).next();!r.done;r=t.next())for(r=r.value,o=(e=B(n)).next();!o.done;o=e.next())if(i+(o=o.value).getAttribute("xml:id")==r){a.push(o);break}return a}function al(e,t){var n,i,r,a,o=null;return Gc.test(e)?(o=Gc.exec(e),n=Number(o[1]),i=Number(o[2]),r=Number(o[3]),a=Number(o[4]),o=(r+=(a+=(Number(o[5])||0)/t.b)/t.frameRate)+60*i+3600*n):Vc.test(e)?o=ol(Vc,e):zc.test(e)?o=ol(zc,e):Hc.test(e)?(o=Hc.exec(e),o=Number(o[1])/t.frameRate):Wc.test(e)?(o=Wc.exec(e),o=Number(o[1])/t.a):qc.test(e)&&(o=ol(qc,e)),o}function ol(e,t){t=e.exec(t);return null==t||""==t[0]?null:(Number(t[4])||0)/1e3+(Number(t[3])||0)+60*(Number(t[2])||0)+3600*(Number(t[1])||0)}function sl(e,t,n,i){this.frameRate=Number(e)||30,this.b=Number(t)||1,this.a=Number(i),0==this.a&&(this.a=e?this.frameRate*this.b:1),n&&(e=/^(\d+) (\d+)$/g.exec(n))&&(this.frameRate*=Number(e[1])/Number(e[2]))}function ul(){this.a=new Oc}function cl(){}function ll(e,t,n){var i;if(i=/^align:(start|middle|center|end|left|right)$/.exec(t))t=i[1],e.textAlign="middle"==t?ln:dn[t.toUpperCase()];else if(i=/^vertical:(lr|rl)$/.exec(t))e.writingMode="lr"==i[1]?"vertical-lr":"vertical-rl";else if(i=/^size:([\d.]+)%$/.exec(t))e.size=Number(i[1]);else if(i=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(t))e.position=Number(i[1]),i[2]&&(t=i[2],e.positionAlign="line-left"==t||"start"==t?"line-left":"line-right"==t||"end"==t?"line-right":"center");else{if(!(i=/^region:(.*)$/.exec(t))){e:{if(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))e.lineInterpretation=1,e.line=Number(n[1]),n[2]&&(e.lineAlign=bn[n[2].toUpperCase()]);else{if(!(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))){e=!1;break e}e.lineInterpretation=gn,e.line=Number(n[1]),n[2]&&(e.lineAlign=bn[n[2].toUpperCase()])}e=!0}return e}(t=function(e,t){e=e.filter(function(e){return e.id==t});return e.length?e[0]:(X.u("VTT parser could not find a region with id: ",t," The region will be ignored."),null)}(n,i[1]))&&(e.region=t)}return 1}function dl(e){if(null==(e=Or(e,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g)))return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:Number(e[4])/1e3+n+60*t+3600*(Number(e[1])||0)}function hl(){this.a=null}function fl(e){return document.createElement(e)}function pl(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function ml(){}function gl(){Dc?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(Dc=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=vl):console.debug("EmeEncryptionSchemePolyfill: EME not found")}function vl(n,i){var r=this;return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return console.assert(r==navigator,'bad "this" for requestMediaKeySystemAccess'),V(e,Dc.call(r,n,i),2);case 2:return kl(t=e.A)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=Dc,e.return(t)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=bl,e.return(bl.call(r,n,i)))}})})}function bl(c,l){var d=this;return G(function e(){var i,r,a,o,s,u;return q(e,function(e){switch(e.o){case 1:console.assert(d==navigator,'bad "this" for requestMediaKeySystemAccess'),i=Il(c),r=[];for(var t=B(l),n=t.next();!n.done;n=t.next())s=n.value,a=yl(s.videoCapabilities,i),o=yl(s.audioCapabilities,i),s.videoCapabilities&&s.videoCapabilities.length&&!a.length||s.audioCapabilities&&s.audioCapabilities.length&&!o.length||((s=Object.assign({},s)).videoCapabilities=a,s.audioCapabilities=o,r.push(s));if(!r.length)throw(u=Error("Unsupported keySystem or supportedConfigurations.")).name="NotSupportedError",u.code=DOMException.NOT_SUPPORTED_ERR,u;return V(e,Dc.call(d,c,r),2);case 2:return u=e.A,e.return(new Al(u,i))}})})}function yl(e,t){return e&&e.filter(function(e){return!e.encryptionScheme||e.encryptionScheme==t})}function El(){}function wl(){navigator.mediaCapabilities?(Fc=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=Tl):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}function Tl(n){var i=this;return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return console.assert(i==navigator.mediaCapabilities,'bad "this" for decodingInfo'),V(e,Fc.call(i,n),2);case 2:return(t=e.A,n.keySystemConfiguration)?kl(t.keySystemAccess)?(console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=Fc,e.return(t)):(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=Sl,e.return(Sl.call(i,n))):e.return(t)}})})}function Sl(a){var o=this;return G(function e(){var t,n,i,r;return q(e,function(e){switch(e.o){case 1:return console.assert(o==navigator.mediaCapabilities,'bad "this" for decodingInfo'),t=null,a.keySystemConfiguration&&(i=a.keySystemConfiguration,r=i.keySystem,n=i.audio&&i.audio.encryptionScheme,i=i.video&&i.video.encryptionScheme,t=Il(r),r={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:a},n&&n!=t||i&&i!=t)?e.return(r):V(e,Fc.call(o,a),2);case 2:return(r=e.A).keySystemAccess&&(r.keySystemAccess=new Al(r.keySystemAccess,t)),e.return(r)}})})}function Al(e,t){this.b=e,this.a=t,this.keySystem=e.keySystem}function Il(e){return e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.adobe")||e.startsWith("org.w3")?"cenc":e.startsWith("com.apple")?"cbcs-1-9":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function kl(e){var t=(e=e.getConfiguration()).audioCapabilities&&e.audioCapabilities[0];return!(!(e=e.videoCapabilities&&e.videoCapabilities[0]||t)||void 0===e.encryptionScheme)}function Cl(){}function xl(){gl(),wl()}kn["application/ttml+xml"]=Oc,_("shaka.text.Mp4TtmlParser",ul),ul.prototype.parseInit=function(e){var t=!1;if((new Di).P("moov",Fi).P("trak",Fi).P("mdia",Fi).P("minf",Fi).P("stbl",Fi).za("stsd",ji).P("stpp",function(e){t=!0,e.parser.stop()}).parse(e),!t)throw new Pe(2,2,2007)},ul.prototype.parseMedia=function(e,t){var n=!1,i=[];if((new Di).P("mdat",Ki(function(e){n=!0,i=i.concat(this.a.parseMedia(e,t))}.bind(this))).parse(e),!n)throw new Pe(2,2,2007);return i},kn['application/mp4; codecs="stpp"']=ul,kn['application/mp4; codecs="stpp.ttml.im1t"']=ul,kn['application/mp4; codecs="stpp.TTML.im1t"']=ul,_("shaka.text.VttTextParser",cl),cl.prototype.parseInit=function(){},cl.prototype.parseMedia=function(e,t){var n=vt(e);if(n=(n=n.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m),!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new Pe(2,2,2e3);var i=t.segmentStart;if(null==i&&n[i=0].includes("X-TIMESTAMP-MAP")){var r=n[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),a=n[0].match(/MPEGTS:(\d+)/m);if(r&&a){if(null==(i=dl(new Ur(r[1]))))throw new Pe(2,2,2e3);i=t.periodStart+(Number(a[1])/9e4-i)}}a=[];for(var o=n[0].split("\n"),r=1;r<o.length;r++)if(/^Region:/.test(o[r])){var s=new Ur(o[r]),u=new Tn;Dr(s),_r(s);for(var c,l=Dr(s);l;){e:{var d=u,h=l;if(c=/^id=(.*)$/.exec(h))d.id=c[1];else if(c=/^width=(\d{1,2}|100)%$/.exec(h))d.width=Number(c[1]);else if(c=/^lines=(\d+)$/.exec(h))d.height=Number(c[1]),d.heightUnits=2;else if(c=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(h))d.regionAnchorX=Number(c[1]),d.regionAnchorY=Number(c[2]);else if(c=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(h))d.viewportAnchorX=Number(c[1]),d.viewportAnchorY=Number(c[2]);else{if(!/^scroll=up$/.exec(h)){c=!1;break e}d.scroll="up"}c=!0}c||X.u("VTT parser encountered an invalid VTTRegion setting: ",l," The setting will be ignored."),_r(s),l=Dr(s)}a.push(u)}for(r=[],s=1;s<n.length;s++){if(c=o=n[s].split("\n"),d=i,o=a,1==c.length&&!c[0]||/^NOTE($|[ \t])/.test(c[0])||"STYLE"==c[0])o=null;else{u=null,c[0].includes("--\x3e")||(u=c[0],c.splice(0,1)),h=dl(l=new Ur(c[0]));var f=Or(l,/[ \t]+--\x3e[ \t]+/g),p=dl(l);if(null==h||null==f||null==p)throw new Pe(2,2,2001);for(c=new sn(h+d,p+d,c.slice(1).join("\n").trim()),_r(l),d=Dr(l);d;)ll(c,d,o)||X.u("VTT parser encountered an invalid VTT setting: ",d," The setting will be ignored."),_r(l),d=Dr(l);null!=u&&(c.id=u),o=c}o&&r.push(o)}return r},kn["text/vtt"]=cl,kn['text/vtt; codecs="vtt"']=cl,kn['text/vtt; codecs="wvtt"']=cl,_("shaka.text.Mp4VttParser",hl),hl.prototype.parseInit=function(e){var t=!1;if((new Di).P("moov",Fi).P("trak",Fi).P("mdia",Fi).za("mdhd",function(e){0==e.version?(e.reader.V(4),e.reader.V(4),this.a=e.reader.M(),e.reader.V(4)):(e.reader.V(8),e.reader.V(8),this.a=e.reader.M(),e.reader.V(8)),e.reader.V(4)}.bind(this)).P("minf",Fi).P("stbl",Fi).za("stsd",ji).P("wvtt",function(){t=!0}).parse(e),!this.a)throw new Pe(2,2,2008);if(!t)throw new Pe(2,2,2008)},hl.prototype.parseMedia=function(e,s){var u=this;if(!this.a)throw X.error("No init segment for MP4+VTT!"),new Pe(2,2,2008);var t,c=0,l=[],d=[],n=!1,h=!1,i=!1,f=null;if((new Di).P("moof",Fi).P("traf",Fi).za("tfdt",function(e){n=!0,c=0==e.version?e.reader.M():e.reader.fc()}).za("tfhd",function(e){var t=e.flags;(e=e.reader).V(4),1&t&&e.V(8),2&t&&e.V(4),f=8&t?e.M():null}).za("trun",function(e){h=!0;var t=e.version,n=e.flags,i=(e=e.reader).M();1&n&&e.V(4),4&n&&e.V(4);for(var r=[],a=0;a<i;a++){var o={duration:null,sampleSize:null,me:null};256&n&&(o.duration=e.M()),512&n&&(o.sampleSize=e.M()),1024&n&&e.V(4),2048&n&&(o.me=0==t?e.M():e.lf()),r.push(o)}l=r}).P("mdat",Ki(function(e){i=!0,t=e})).parse(e),!i&&!n&&!h)throw new Pe(2,2,2008);var p=c,m=new Ui(new DataView(t.buffer,t.byteOffset,t.byteLength),0);return l.forEach(function(e){var t=e.duration||f,n=e.me?c+e.me:p;p=n+(t||0);var i=0;do{var r=m.M();i+=r;var a=m.M(),o=null;"vttc"==(a=Gi(a))?8<r&&(o=m.Gb(r-8)):("vtte"!=a&&X.error("Unknown box "+a+"! Skipping!"),m.V(r-8)),t?o&&d.push(function(e,t,n){var i,r,a;return(new Di).P("payl",Ki(function(e){i=vt(e)})).P("iden",Ki(function(e){r=vt(e)})).P("sttg",Ki(function(e){a=vt(e)})).parse(e),i?function(e,t,n,i,r){if(e=new sn(i,r,e),t&&(e.id=t),n)for(t=new Ur(n),n=Dr(t);n;)ll(e,n,[])||X.u("VTT parser encountered an invalid VTT setting: ",n," The setting will be ignored."),_r(t),n=Dr(t);return e}(i,r,a,t,n):null}(o,s.periodStart+n/u.a,s.periodStart+p/u.a)):X.error("WVTT sample duration unknown, and no default found!")}while(e.sampleSize&&i<e.sampleSize)}),d.filter(Zt.jb)},kn['application/mp4; codecs="wvtt"']=hl,_("shaka.util.Dom.createHTMLElement",fl),_("shaka.util.Dom.createVideoElement",function(){var e=document.createElement("video");return e.muted=!0,e.width=600,e.height=400,e}),_("shaka.util.Dom.asHTMLElement",function(e){return e}),_("shaka.util.Dom.asHTMLMediaElement",function(e){return e}),_("shaka.util.Dom.removeAllChildren",pl),_("EmeEncryptionSchemePolyfill",ml),ml.install=gl,_("McEncryptionSchemePolyfill",El),El.install=wl,Al.prototype.getConfiguration=function(){var e=this.b.getConfiguration();if(e.videoCapabilities)for(var t=B(e.videoCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.a;if(e.audioCapabilities)for(n=(t=B(e.audioCapabilities)).next();!n.done;n=t.next())n.value.encryptionScheme=this.a;return e},Al.prototype.createMediaKeys=function(){return this.b.createMediaKeys()},_("EncryptionSchemePolyfills",Cl),Cl.install=xl,void 0!==t&&t.Sf&&(t.Sf=Cl);for(var Nl={ach:{h:"Lwo",i:"Acholi"},ady:{h:"",i:"Adyghe"},af:{h:"Afrikaans",i:"Afrikaans"},"af-NA":{h:"Afrikaans (Namibia)",i:"Afrikaans (Namibia)"},"af-ZA":{h:"Afrikaans (South Africa)",i:"Afrikaans (South Africa)"},ak:{h:"Ti",i:"Akan"},ar:{h:"",i:"Arabic"},"ar-AR":{h:"",i:"Arabic"},"ar-MA":{h:"",i:"Arabic (Morocco)"},"ar-SA":{h:" ()",i:"Arabic (Saudi Arabia)"},"ay-BO":{h:"Aymar aru",i:"Aymara"},az:{h:"Azrbaycan dili",i:"Azerbaijani"},"az-AZ":{h:"Azrbaycan dili",i:"Azerbaijani"},"be-BY":{h:"",i:"Belarusian"},bg:{h:"",i:"Bulgarian"},"bg-BG":{h:"",i:"Bulgarian"},bn:{h:"",i:"Bengali"},"bn-IN":{h:" ()",i:"Bengali (India)"},"bn-BD":{h:"()",i:"Bengali (Bangladesh)"},"bs-BA":{h:"Bosanski",i:"Bosnian"},ca:{h:"Catal",i:"Catalan"},"ca-ES":{h:"Catal",i:"Catalan"},cak:{h:"Maya Kaqchikel",i:"Kaqchikel"},"ck-US":{h:" (tsalagi)",i:"Cherokee"},cs:{h:"etina",i:"Czech"},"cs-CZ":{h:"etina",i:"Czech"},cy:{h:"Cymraeg",i:"Welsh"},"cy-GB":{h:"Cymraeg",i:"Welsh"},da:{h:"Dansk",i:"Danish"},"da-DK":{h:"Dansk",i:"Danish"},de:{h:"Deutsch",i:"German"},"de-AT":{h:"Deutsch (sterreich)",i:"German (Austria)"},"de-DE":{h:"Deutsch (Deutschland)",i:"German (Germany)"},"de-CH":{h:"Deutsch (Schweiz)",i:"German (Switzerland)"},dsb:{h:"Dolnoserbina",i:"Lower Sorbian"},el:{h:"",i:"Greek"},"el-GR":{h:"",i:"Greek (Greece)"},en:{h:"English",i:"English"},"en-GB":{h:"English (UK)",i:"English (UK)"},"en-AU":{h:"English (Australia)",i:"English (Australia)"},"en-CA":{h:"English (Canada)",i:"English (Canada)"},"en-IE":{h:"English (Ireland)",i:"English (Ireland)"},"en-IN":{h:"English (India)",i:"English (India)"},"en-PI":{h:"English (Pirate)",i:"English (Pirate)"},"en-UD":{h:"English (Upside Down)",i:"English (Upside Down)"},"en-US":{h:"English (US)",i:"English (US)"},"en-ZA":{h:"English (South Africa)",i:"English (South Africa)"},"en@pirate":{h:"English (Pirate)",i:"English (Pirate)"},eo:{h:"Esperanto",i:"Esperanto"},"eo-EO":{h:"Esperanto",i:"Esperanto"},es:{h:"Espaol",i:"Spanish"},"es-AR":{h:"Espaol (Argentine)",i:"Spanish (Argentina)"},"es-419":{h:"Espaol (Latinoamrica)",i:"Spanish (Latin America)"},"es-CL":{h:"Espaol (Chile)",i:"Spanish (Chile)"},"es-CO":{h:"Espaol (Colombia)",i:"Spanish (Colombia)"},"es-EC":{h:"Espaol (Ecuador)",i:"Spanish (Ecuador)"},"es-ES":{h:"Espaol (Espaa)",i:"Spanish (Spain)"},"es-LA":{h:"Espaol (Latinoamrica)",i:"Spanish (Latin America)"},"es-NI":{h:"Espaol (Nicaragua)",i:"Spanish (Nicaragua)"},"es-MX":{h:"Espaol (Mxico)",i:"Spanish (Mexico)"},"es-US":{h:"Espaol (Estados Unidos)",i:"Spanish (United States)"},"es-VE":{h:"Espaol (Venezuela)",i:"Spanish (Venezuela)"},et:{h:"eesti keel",i:"Estonian"},"et-EE":{h:"Eesti (Estonia)",i:"Estonian (Estonia)"},eu:{h:"Euskara",i:"Basque"},"eu-ES":{h:"Euskara",i:"Basque"},fa:{h:"",i:"Persian"},"fa-IR":{h:"",i:"Persian"},"fb-LT":{h:"Leet Speak",i:"Leet"},ff:{h:"Fulah",i:"Fulah"},fi:{h:"Suomi",i:"Finnish"},"fi-FI":{h:"Suomi",i:"Finnish"},"fo-FO":{h:"Froyskt",i:"Faroese"},fr:{h:"Franais",i:"French"},"fr-CA":{h:"Franais (Canada)",i:"French (Canada)"},"fr-FR":{h:"Franais (France)",i:"French (France)"},"fr-BE":{h:"Franais (Belgique)",i:"French (Belgium)"},"fr-CH":{h:"Franais (Suisse)",i:"French (Switzerland)"},"fy-NL":{h:"Frysk",i:"Frisian (West)"},ga:{h:"Gaeilge",i:"Irish"},"ga-IE":{h:"Gaeilge (Gaelic)",i:"Irish (Gaelic)"},gl:{h:"Galego",i:"Galician"},"gl-ES":{h:"Galego",i:"Galician"},"gn-PY":{h:"Avae'",i:"Guarani"},"gu-IN":{h:"",i:"Gujarati"},"gx-GR":{h:" ",i:"Classical Greek"},he:{h:"",i:"Hebrew"},"he-IL":{h:"",i:"Hebrew"},hi:{h:"",i:"Hindi"},"hi-IN":{h:"",i:"Hindi"},hr:{h:"Hrvatski",i:"Croatian"},"hr-HR":{h:"Hrvatski",i:"Croatian"},hsb:{h:"Hornjoserbina",i:"Upper Sorbian"},ht:{h:"Kreyl",i:"Haitian Creole"},hu:{h:"Magyar",i:"Hungarian"},"hu-HU":{h:"Magyar",i:"Hungarian"},"hy-AM":{h:"",i:"Armenian"},id:{h:"Bahasa Indonesia",i:"Indonesian"},"id-ID":{h:"Bahasa Indonesia",i:"Indonesian"},is:{h:"slenska",i:"Icelandic"},"is-IS":{h:"slenska (Iceland)",i:"Icelandic (Iceland)"},it:{h:"Italiano",i:"Italian"},"it-IT":{h:"Italiano",i:"Italian"},ja:{h:"",i:"Japanese"},"ja-JP":{h:"",i:"Japanese"},"jv-ID":{h:"Basa Jawa",i:"Javanese"},"ka-GE":{h:"",i:"Georgian"},"kk-KZ":{h:"",i:"Kazakh"},km:{h:"",i:"Khmer"},"km-KH":{h:"",i:"Khmer"},kab:{h:"Taqbaylit",i:"Kabyle"},kn:{h:"",i:"Kannada"},"kn-IN":{h:" (India)",i:"Kannada (India)"},ko:{h:"",i:"Korean"},"ko-KR":{h:" ()",i:"Korean (Korea)"},ku:{h:"Kurd",i:"Kurdish"},"ku-TR":{h:"Kurd",i:"Kurdish"},la:{h:"Latin",i:"Latin"},"la-VA":{h:"Latin",i:"Latin"},lb:{h:"Ltzebuergesch",i:"Luxembourgish"},"li-NL":{h:"Lmbrgs",i:"Limburgish"},lt:{h:"Lietuvi",i:"Lithuanian"},"lt-LT":{h:"Lietuvi",i:"Lithuanian"},lv:{h:"Latvieu",i:"Latvian"},"lv-LV":{h:"Latvieu",i:"Latvian"},mai:{h:", ",i:"Maithili"},"mg-MG":{h:"Malagasy",i:"Malagasy"},mk:{h:"",i:"Macedonian"},"mk-MK":{h:" ()",i:"Macedonian (Macedonian)"},ml:{h:"",i:"Malayalam"},"ml-IN":{h:"",i:"Malayalam"},"mn-MN":{h:"",i:"Mongolian"},mr:{h:"",i:"Marathi"},"mr-IN":{h:"",i:"Marathi"},ms:{h:"Bahasa Melayu",i:"Malay"},"ms-MY":{h:"Bahasa Melayu",i:"Malay"},mt:{h:"Malti",i:"Maltese"},"mt-MT":{h:"Malti",i:"Maltese"},my:{h:"",i:"Burmese"},nb:{h:"Norsk (bokml)",i:"Norwegian (bokmal)"},"nb-NO":{h:"Norsk (bokml)",i:"Norwegian (bokmal)"},ne:{h:"",i:"Nepali"},"ne-NP":{h:"",i:"Nepali"},nl:{h:"Nederlands",i:"Dutch"},"nl-BE":{h:"Nederlands (Belgi)",i:"Dutch (Belgium)"},"nl-NL":{h:"Nederlands (Nederland)",i:"Dutch (Netherlands)"},"nn-NO":{h:"Norsk (nynorsk)",i:"Norwegian (nynorsk)"},no:{h:"Norsk",i:"Norwegian"},oc:{h:"Occitan",i:"Occitan"},"or-IN":{h:"",i:"Oriya"},pa:{h:"",i:"Punjabi"},"pa-IN":{h:" ( )",i:"Punjabi (India)"},pl:{h:"Polski",i:"Polish"},"pl-PL":{h:"Polski",i:"Polish"},"ps-AF":{h:"",i:"Pashto"},pt:{h:"Portugus",i:"Portuguese"},"pt-BR":{h:"Portugus (Brasil)",i:"Portuguese (Brazil)"},"pt-PT":{h:"Portugus (Portugal)",i:"Portuguese (Portugal)"},"qu-PE":{h:"Qhichwa",i:"Quechua"},"rm-CH":{h:"Rumantsch",i:"Romansh"},ro:{h:"Romn",i:"Romanian"},"ro-RO":{h:"Romn",i:"Romanian"},ru:{h:"",i:"Russian"},"ru-RU":{h:"",i:"Russian"},"sa-IN":{h:"",i:"Sanskrit"},"se-NO":{h:"Davvismegiella",i:"Northern Smi"},"si-LK":{h:"",i:"Sinhala (Sri Lanka)"},sk:{h:"Slovenina",i:"Slovak"},"sk-SK":{h:"Slovenina (Slovakia)",i:"Slovak (Slovakia)"},sl:{h:"Slovenina",i:"Slovenian"},"sl-SI":{h:"Slovenina",i:"Slovenian"},"so-SO":{h:"Soomaaliga",i:"Somali"},sq:{h:"Shqip",i:"Albanian"},"sq-AL":{h:"Shqip",i:"Albanian"},sr:{h:"",i:"Serbian"},"sr-RS":{h:" (Serbia)",i:"Serbian (Serbia)"},su:{h:"Basa Sunda",i:"Sundanese"},sv:{h:"Svenska",i:"Swedish"},"sv-SE":{h:"Svenska",i:"Swedish"},sw:{h:"Kiswahili",i:"Swahili"},"sw-KE":{h:"Kiswahili",i:"Swahili (Kenya)"},ta:{h:"",i:"Tamil"},"ta-IN":{h:"",i:"Tamil"},te:{h:"",i:"Telugu"},"te-IN":{h:"",i:"Telugu"},tg:{h:" ",i:"Tajik"},"tg-TJ":{h:"",i:"Tajik"},th:{h:"",i:"Thai"},"th-TH":{h:" ()",i:"Thai (Thailand)"},tl:{h:"Filipino",i:"Filipino"},"tl-PH":{h:"Filipino",i:"Filipino"},tlh:{h:"tlhIngan-Hol",i:"Klingon"},tr:{h:"Trke",i:"Turkish"},"tr-TR":{h:"Trke",i:"Turkish"},"tt-RU":{h:"",i:"Tatar"},uk:{h:"",i:"Ukrainian"},"uk-UA":{h:"",i:"Ukrainian"},ur:{h:"",i:"Urdu"},"ur-PK":{h:"",i:"Urdu"},uz:{h:"O'zbek",i:"Uzbek"},"uz-UZ":{h:"O'zbek",i:"Uzbek"},vi:{h:"Ting Vit",i:"Vietnamese"},"vi-VN":{h:"Ting Vit",i:"Vietnamese"},"xh-ZA":{h:"isiXhosa",i:"Xhosa"},yi:{h:"",i:"Yiddish"},"yi-DE":{h:" (German)",i:"Yiddish (German)"},zh:{h:"",i:"Chinese"},"zh-HANS":{h:"",i:"Chinese Simplified"},"zh-HANT":{h:"",i:"Chinese Traditional"},"zh-CN":{h:"",i:"Chinese Simplified (China)"},"zh-HK":{h:"",i:"Chinese Traditional (Hong Kong)"},"zh-SG":{h:"",i:"Chinese Simplified (Singapore)"},"zh-TW":{h:"",i:"Chinese Traditional (Taiwan)"},"zu-ZA":{h:"isiZulu",i:"Zulu"}},Pl=B(Object.keys(Nl)),Ml=Pl.next();!Ml.done;Ml=Pl.next()){var Rl=Ml.value;Nl[Rl.toLowerCase()]=Nl[Rl]}function Ll(e,t,n,i,r,a,o){function s(e){return"variant"==e.type?e.audioRoles?e.audioRoles.join(", "):void 0:e.roles.join(", ")}var u=e.filter(function(e){return 1==e.active})[0],c=Dl(t,"shaka-back-to-overflow-button");Bl(t),t.appendChild(c),c=new Map;for(var l=B(e),d=l.next();!d.done;d=l.next())d=d.value,c.has(d.language)||c.set(d.language,new Set),c.get(d.language).add(s(d));for(c=new Set,u=u?u.language+": "+s(u):"",l={},d=(e=B(e)).next();!d.done;l={ic:l.ic},d=e.next()){l.ic=d.value,d=l.ic.language;var h=s(l.ic),f=d+": "+h;if(!c.has(f)){c.add(f);var p=fl("button");p.addEventListener("click",function(e){return function(){n(e.ic)}}(l));var m=fl("span");switch(p.appendChild(m),m.textContent=function(e,t){if(!e&&!t)return"";switch(e){case"mul":return t.resolve("MULTIPLE_LANGUAGES");case"und":return t.resolve("UNDETERMINED_LANGUAGE");case"zxx":return t.resolve("NOT_APPLICABLE")}var n=ee(e);return e in Nl?Nl[e].h:n in Nl?Nl[n].h+" ("+e+")":t.resolve("UNRECOGNIZED_LANGUAGE")+" ("+e+")"}(d,a),o){case ch:h?m.textContent=h:(X.ba("Track #"+l.ic.id+" does not have a role, but the UI is configured to only show role."),m.textContent="?");break;case lh:h&&(m.textContent+=": "+h)}i&&f==u&&(p.appendChild(jl()),m.classList.add("shaka-chosen-item"),p.setAttribute("aria-selected","true"),r.textContent=m.textContent),t.appendChild(p)}}}function Ul(e,t){this.parent=e,this.controls=t,this.eventManager=new Ze,this.localization=this.controls.La,this.player=this.controls.$a(),this.video=this.controls.sc()}function _l(e,t,n,i){Ul.call(this,e,t);var r=this;this.container=fl("div"),this.container.classList.add("shaka-range-container"),this.container.classList.add.apply(this.container.classList,I(n)),this.a=!1,this.bar=document.createElement("input"),this.bar.classList.add("shaka-range-element"),this.bar.classList.add.apply(this.bar.classList,I(i)),this.bar.type="range",this.bar.step="any",this.bar.min="0",this.bar.max="1",this.bar.value="0",this.container.appendChild(this.bar),this.parent.appendChild(this.container),this.eventManager.m(this.bar,"mousedown",function(){r.controls.Cb()&&(r.a=!0,r.onChangeStart())}),this.eventManager.m(this.bar,"touchstart",function(e){r.controls.Cb()&&(r.a=!0,Ol(r,e),r.onChangeStart())}),this.eventManager.m(this.bar,"input",function(){r.onChange()}),this.eventManager.m(this.bar,"touchmove",function(e){r.a&&(Ol(r,e),r.onChange())}),this.eventManager.m(this.bar,"touchend",function(e){r.a&&(r.a=!1,Ol(r,e),r.onChangeEnd())}),this.eventManager.m(this.bar,"mouseup",function(){r.a&&(r.a=!1,r.onChangeEnd())})}function Ol(e,t){t.preventDefault();var n=t.changedTouches[0],i=e.bar.getBoundingClientRect(),r=parseFloat(e.bar.min),t=parseFloat(e.bar.max);(n=r+(t-r)/i.width*(n.clientX-i.left))<r?n=r:t<n&&(n=t),e.bar.value=n}function Dl(e,t){t=e.getElementsByClassName(t);return t.length?t[0]:null}function Fl(e){(e=e&&Dl(e,"shaka-chosen-item"))&&e.parentElement.focus()}function jl(){var e=fl("i");return e.classList.add("material-icons-round"),e.classList.add("shaka-chosen-item"),e.textContent="done",e.setAttribute("aria-hidden","true"),e}function Kl(e,t){e&&(t?(e.classList.add("shaka-displayed"),e.classList.remove("shaka-hidden")):(e.classList.add("shaka-hidden"),e.classList.remove("shaka-displayed")))}function Bl(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function Gl(e,t){_l.call(this,e,t,["shaka-seek-bar-container"],["shaka-seek-bar","shaka-no-propagation","shaka-show-controls-on-mouse-over"]);var n=this;this.c=this.controls.g,this.b=new ke(function(){n.video.currentTime=n.getValue()}),this.f=!1,this.eventManager.m(this.localization,"locale-updated",function(){return zl(n)}),this.eventManager.m(this.localization,"locale-changed",function(){return zl(n)}),this.setValue(this.video.currentTime),Vl(this),zl(this)}function Vl(e){var t=e.c.seekBarColors,n=e.getValue(),i=e.video.buffered.length,r=i?e.video.buffered.start(0):0,a=i?e.video.buffered.end(i-1):0,o=e.player.Ib(),s=o.end-o.start;e.setRange(o.start,o.end),e.player.W()&&s<5?Kl(e.container,!1):(Kl(e.container,!0),0==i?e.container.style.background=t.base:(i=(Math.max(r,o.start)-o.start)/s||0,a=(Math.min(a,o.end)-o.start)/s||0,n=(Math.min(Math.max(n,o.start),o.end)-o.start)/s||0,e.container.style.background="linear-gradient("+["to right",(e.c.showUnbufferedStart?t.base:t.played)+" "+100*i+"%",t.played+" "+100*i+"%",t.played+" "+100*n+"%",t.buffered+" "+100*n+"%",t.buffered+" "+100*a+"%",t.base+" "+100*a+"%"].join()+")"))}function zl(e){e.bar.setAttribute("aria-label",e.localization.resolve("SEEK"))}function Hl(e,t,n,i){var r,a=this;j.call(this),this.O=!0,this.g=i,this.l=new yi(n,e,this.g.castReceiverAppId),this.Ja=!0,this.c=this.l.sc(),this.B=n,this.s=this.l.$a(),this.wa=e,this.f=t,this.j=null,this.Z=!1,this.H=[],this.Wa=[],this.Na=!1,this.K=new ke(function(){a.f.style.cursor="none",a.Na=!1,Xl(a)}),this.Y=new ke(function(){a.a.removeAttribute("shown"),a.v.R(2)}),this.v=new ke(function(){for(var e=B(a.H),t=e.next();!t.done;t=e.next())Kl(t.value,!1)}),this.ya=new ke(function(){a.Cb()&&Zl(a)}),this.w=null,this.Ka=[],this.La=((t=new re("en")).aa("ar",new Map([["AUTO_QUALITY",""],["BACK",""],["CAPTIONS"," "],["CAST","..."],["ENTER_PICTURE_IN_PICTURE",'   "  "'],["EXIT_FULL_SCREEN","   "],["EXIT_PICTURE_IN_PICTURE",'   "  "'],["FAST_FORWARD"," "],["FULL_SCREEN"," "],["LANGUAGE",""],["LIVE",""],["MORE_SETTINGS","  "],["MULTIPLE_LANGUAGES"," "],["MUTE"," "],["NOT_APPLICABLE"," "],["OFF",""],["ON",""],["PAUSE"," "],["PICTURE_IN_PICTURE","  "],["PLAY",""],["RESOLUTION"," "],["REWIND",""],["SEEK"," "],["SKIP_TO_LIVE","   "],["UNDETERMINED_LANGUAGE"," "],["UNMUTE"," "],["UNRECOGNIZED_LANGUAGE"," "],["VOLUME"," "]])),t.aa("de",new Map([["AUTO_QUALITY","Automatisch"],["BACK","Zurck"],["CAPTIONS","Untertitel"],["CAST","Streamen..."],["ENTER_PICTURE_IN_PICTURE","Bild-im-Bild-Modus aktivieren"],["EXIT_FULL_SCREEN","Vollbildmodus beenden"],["EXIT_PICTURE_IN_PICTURE","Bild-im-Bild-Modus beenden"],["FAST_FORWARD","Vorspulen"],["FULL_SCREEN","Vollbildmodus"],["LANGUAGE","Sprache"],["LIVE","Live"],["MORE_SETTINGS","Weitere Einstellungen"],["MULTIPLE_LANGUAGES","Mehrere Sprachen"],["MUTE","Stummschalten"],["NOT_APPLICABLE","Nicht zutreffend"],["OFF","Aus"],["ON","Ein"],["PAUSE","Pause"],["PICTURE_IN_PICTURE","Bild im Bild"],["PLAY","Wiedergabe"],["RESOLUTION","Auflsung"],["REWIND","Zurckspulen"],["SEEK","Suche"],["SKIP_TO_LIVE","Zum Live-Videostream wechseln"],["UNDETERMINED_LANGUAGE","Unbestimmt"],["UNMUTE","Stummschaltung aufheben"],["UNRECOGNIZED_LANGUAGE","Unbekannt"],["VOLUME","Lautstrke"]])),t.aa("en",new Map([["AUTO_QUALITY","Auto"],["BACK","Back"],["CAPTIONS","Captions"],["CAST","Cast..."],["ENTER_PICTURE_IN_PICTURE","Enter Picture-in-Picture"],["EXIT_FULL_SCREEN","Exit full screen"],["EXIT_PICTURE_IN_PICTURE","Exit Picture-in-Picture"],["FAST_FORWARD","Fast-forward"],["FULL_SCREEN","Full screen"],["LANGUAGE","Language"],["LIVE","Live"],["MORE_SETTINGS","More settings"],["MULTIPLE_LANGUAGES","Multiple languages"],["MUTE","Mute"],["NOT_APPLICABLE","Not applicable"],["OFF","Off"],["ON","On"],["PAUSE","Pause"],["PICTURE_IN_PICTURE","Picture-in-Picture"],["PLAY","Play"],["RESOLUTION","Resolution"],["REWIND","Rewind"],["SEEK","Seek"],["SKIP_TO_LIVE","Skip ahead to live"],["UNDETERMINED_LANGUAGE","Undetermined"],["UNMUTE","Unmute"],["UNRECOGNIZED_LANGUAGE","Unrecognized"],["VOLUME","Volume"]])),t.aa("en-GB",new Map([["AUTO_QUALITY","Auto"],["BACK","Back"],["CAPTIONS","Captions"],["CAST","Cast..."],["ENTER_PICTURE_IN_PICTURE","Enter picture-in-picture"],["EXIT_FULL_SCREEN","Exit full screen"],["EXIT_PICTURE_IN_PICTURE","Exit picture-in-picture"],["FAST_FORWARD","Fast-forward"],["FULL_SCREEN","Full screen"],["LANGUAGE","Language"],["LIVE","Live"],["MORE_SETTINGS","More settings"],["MULTIPLE_LANGUAGES","Multiple languages"],["MUTE","Mute"],["NOT_APPLICABLE","Not applicable"],["OFF","Off"],["ON","On"],["PAUSE","Pause"],["PICTURE_IN_PICTURE","Picture-in-picture"],["PLAY","Play"],["RESOLUTION","Resolution"],["REWIND","Rewind"],["SEEK","Seek"],["SKIP_TO_LIVE","Skip ahead to live"],["UNDETERMINED_LANGUAGE","Undetermined"],["UNMUTE","Unmute"],["UNRECOGNIZED_LANGUAGE","Unrecognised"],["VOLUME","volume"]])),t.aa("es",new Map([["AUTO_QUALITY","Automtico"],["BACK","Atrs"],["CAPTIONS","Subttulos"],["CAST","Enviar..."],["ENTER_PICTURE_IN_PICTURE","Activar el modo imagen en imagen"],["EXIT_FULL_SCREEN","Salir del modo de pantalla completa"],["EXIT_PICTURE_IN_PICTURE","Salir del modo imagen en imagen"],["FAST_FORWARD","Avanzar rpidamente"],["FULL_SCREEN","Pantalla completa"],["LANGUAGE","Idioma"],["LIVE","En directo"],["MORE_SETTINGS","Ms opciones"],["MULTIPLE_LANGUAGES","Varios idiomas"],["MUTE","Silenciar"],["NOT_APPLICABLE","No aplicable"],["OFF","No"],["ON","S"],["PAUSE","Pausar"],["PICTURE_IN_PICTURE","Imagen en imagen"],["PLAY","Reproducir"],["RESOLUTION","Resolucin"],["REWIND","Rebobinar"],["SEEK","Buscar"],["SKIP_TO_LIVE","Ir al vdeo en directo"],["UNDETERMINED_LANGUAGE","Sin especificar"],["UNMUTE","Activar sonido"],["UNRECOGNIZED_LANGUAGE","No reconocida"],["VOLUME","Volumen"]])),t.aa("es-419",new Map([["AUTO_QUALITY","Automtico"],["BACK","Atrs"],["CAPTIONS","Subttulos"],["CAST","Transmitir..."],["ENTER_PICTURE_IN_PICTURE","Ingresar al modo de pantalla en pantalla"],["EXIT_FULL_SCREEN","Salir de pantalla completa"],["EXIT_PICTURE_IN_PICTURE","Salir del modo de pantalla en pantalla"],["FAST_FORWARD","Avanzar"],["FULL_SCREEN","Pantalla completa"],["LANGUAGE","Idioma"],["LIVE","En directo"],["MORE_SETTINGS","Ms opciones de configuracin"],["MULTIPLE_LANGUAGES","Varios idiomas"],["MUTE","Silenciar"],["NOT_APPLICABLE","No aplicable"],["OFF","Desactivado"],["ON","Activado"],["PAUSE","Detener"],["PICTURE_IN_PICTURE","Pantalla en pantalla"],["PLAY","Reproducir"],["RESOLUTION","Resolucin"],["REWIND","Retroceder"],["SEEK","Buscar"],["SKIP_TO_LIVE","Adelantar hasta la transmisin en vivo"],["UNDETERMINED_LANGUAGE","Sin especificar"],["UNMUTE","Dejar de silenciar"],["UNRECOGNIZED_LANGUAGE","No reconocida"],["VOLUME","Volumen"]])),t.aa("fr",new Map([["AUTO_QUALITY","Automatique"],["BACK","Retour"],["CAPTIONS","Sous-titres"],["CAST","Caster"],["ENTER_PICTURE_IN_PICTURE","Utiliser le mode Picture-in-Picture"],["EXIT_FULL_SCREEN","Quitter le mode plein cran"],["EXIT_PICTURE_IN_PICTURE","Quitter le modePIP (Picture-in-picture)"],["FAST_FORWARD","Avance rapide"],["FULL_SCREEN","Plein cran"],["LANGUAGE","Langue"],["LIVE","En direct"],["MORE_SETTINGS","Plus de paramtres"],["MULTIPLE_LANGUAGES","Plusieurs langues"],["MUTE","Couper le son"],["NOT_APPLICABLE","Non applicable"],["OFF","Dsactive"],["ON","Active"],["PAUSE","Pause"],["PICTURE_IN_PICTURE","Picture-in-Picture"],["PLAY","Visionner"],["RESOLUTION","Rsolution"],["REWIND","Retour arrire"],["SEEK","Chercher"],["SKIP_TO_LIVE","Accder  la partie la plus rcente du direct"],["UNDETERMINED_LANGUAGE","Langue indtermine"],["UNMUTE","Ractiver le son"],["UNRECOGNIZED_LANGUAGE","Non reconnu"],["VOLUME","Volume"]])),t.aa("it",new Map([["AUTO_QUALITY","Automatica"],["BACK","Indietro"],["CAPTIONS","Sottotitoli"],["CAST","Trasmetti..."],["ENTER_PICTURE_IN_PICTURE","Attiva Picture in picture"],["EXIT_FULL_SCREEN","Esci da schermo intero"],["EXIT_PICTURE_IN_PICTURE","Esci da Picture in picture"],["FAST_FORWARD","Avanti veloce"],["FULL_SCREEN","Schermo intero"],["LANGUAGE","Lingua"],["LIVE","Dal vivo"],["MORE_SETTINGS","Altre impostazioni"],["MULTIPLE_LANGUAGES","Pi lingue"],["MUTE","Disattiva audio"],["NOT_APPLICABLE","Non applicabile"],["OFF","Disattivo"],["ON","Attivo"],["PAUSE","Metti in pausa"],["PICTURE_IN_PICTURE","Picture in picture"],["PLAY","Riproduci"],["RESOLUTION","Risoluzione"],["REWIND","Riavvolgi"],["SEEK","Cerca"],["SKIP_TO_LIVE","Passa alla trasmissione dal vivo"],["UNDETERMINED_LANGUAGE","Indeterminata"],["UNMUTE","Riattiva audio"],["UNRECOGNIZED_LANGUAGE","Non riconosciuto"],["VOLUME","Volume"]])),t.aa("ja",new Map([["AUTO_QUALITY",""],["BACK",""],["CAPTIONS",""],["CAST","..."],["ENTER_PICTURE_IN_PICTURE","  "],["EXIT_FULL_SCREEN",""],["EXIT_PICTURE_IN_PICTURE","  "],["FAST_FORWARD",""],["FULL_SCREEN",""],["LANGUAGE",""],["LIVE",""],["MORE_SETTINGS",""],["MULTIPLE_LANGUAGES",""],["MUTE",""],["NOT_APPLICABLE",""],["OFF",""],["ON",""],["PAUSE",""],["PICTURE_IN_PICTURE","  "],["PLAY",""],["RESOLUTION",""],["REWIND",""],["SEEK",""],["SKIP_TO_LIVE",""],["UNDETERMINED_LANGUAGE",""],["UNMUTE",""],["UNRECOGNIZED_LANGUAGE",""],["VOLUME",""]])),t.aa("ko",new Map([["AUTO_QUALITY",""],["BACK",""],["CAPTIONS",""],["CAST","..."],["ENTER_PICTURE_IN_PICTURE","PIP  "],["EXIT_FULL_SCREEN"," "],["EXIT_PICTURE_IN_PICTURE","PIP  "],["FAST_FORWARD"," "],["FULL_SCREEN",""],["LANGUAGE",""],["LIVE",""],["MORE_SETTINGS"," "],["MULTIPLE_LANGUAGES"," "],["MUTE",""],["NOT_APPLICABLE","  "],["OFF"," "],["ON",""],["PAUSE",""],["PICTURE_IN_PICTURE","PIP "],["PLAY",""],["RESOLUTION",""],["REWIND",""],["SEEK",""],["SKIP_TO_LIVE","  "],["UNDETERMINED_LANGUAGE",""],["UNMUTE"," "],["UNRECOGNIZED_LANGUAGE","  "],["VOLUME",""]])),t.aa("nl",new Map([["AUTO_QUALITY","Automatisch"],["BACK","Terug"],["CAPTIONS","Ondertiteling"],["CAST","Casten..."],["ENTER_PICTURE_IN_PICTURE","Scherm-in-scherm openen"],["EXIT_FULL_SCREEN","Volledig scherm sluiten"],["EXIT_PICTURE_IN_PICTURE","Scherm-in-scherm afsluiten"],["FAST_FORWARD","Vooruitspoelen"],["FULL_SCREEN","Volledig scherm"],["LANGUAGE","Taal"],["LIVE","Live"],["MORE_SETTINGS","Meer instellingen"],["MULTIPLE_LANGUAGES","Meerdere talen"],["MUTE","Dempen"],["NOT_APPLICABLE","Niet van toepassing"],["OFF","Uit"],["ON","Aan"],["PAUSE","Onderbreken"],["PICTURE_IN_PICTURE","Scherm-in-scherm"],["PLAY","Afspelen"],["RESOLUTION","Resolutie"],["REWIND","Terugspoelen"],["SEEK","Zoeken"],["SKIP_TO_LIVE","Doorgaan naar live"],["UNDETERMINED_LANGUAGE","Onbepaald"],["UNMUTE","Dempen opheffen"],["UNRECOGNIZED_LANGUAGE","Onbekend"],["VOLUME","Volume"]])),t.aa("pl",new Map([["AUTO_QUALITY","Automatycznie"],["BACK","Wstecz"],["CAPTIONS","Napisy"],["CAST","Przesyaj..."],["ENTER_PICTURE_IN_PICTURE","Wcz tryb obrazu wobrazie"],["EXIT_FULL_SCREEN","Zamknij peny ekran"],["EXIT_PICTURE_IN_PICTURE","Wycz tryb obrazu wobrazie"],["FAST_FORWARD","Przewi do przodu"],["FULL_SCREEN","Peny ekran"],["LANGUAGE","Jzyk"],["LIVE","Na ywo"],["MORE_SETTINGS","Wicej ustawie"],["MULTIPLE_LANGUAGES","Wiele jzykw"],["MUTE","Wycisz"],["NOT_APPLICABLE","Nie dotyczy"],["OFF","Wyczone"],["ON","Wczone"],["PAUSE","Wstrzymaj"],["PICTURE_IN_PICTURE","Obraz wobrazie"],["PLAY","Odtwrz"],["RESOLUTION","Rozdzielczo"],["REWIND","Przewi do tyu"],["SEEK","Szukaj"],["SKIP_TO_LIVE","Przejd do transmisji na ywo"],["UNDETERMINED_LANGUAGE","Nie okrelono"],["UNMUTE","Wycz wyciszenie"],["UNRECOGNIZED_LANGUAGE","Nierozpoznany"],["VOLUME","Gono"]])),t.aa("pt-BR",new Map([["CAPTIONS","Legendas"],["CAST","Transmitir..."],["EXIT_FULL_SCREEN","Sair do modo tela cheia"],["EXIT_PICTURE_IN_PICTURE","Sair de picture-in-picture"],["FULL_SCREEN","Tela cheia"],["LANGUAGE","Idioma"],["LIVE","Ao vivo"],["MORE_SETTINGS","Mais definies"],["MUTE","Desativar som"],["OFF","Desativado"],["ON","Ativado"],["PAUSE","Pausar"],["PICTURE_IN_PICTURE","Picture-in-picture"],["PLAY","Reproduzir"],["REWIND","Retroceder"],["SEEK","Procurar"],["UNMUTE","Ativar som"],["UNRECOGNIZED_LANGUAGE","No reconhecido"],["VOLUME","Volume"]])),t.aa("pt-PT",new Map([["AUTO_QUALITY","Automtico"],["BACK","Anterior"],["CAPTIONS","Legendas"],["CAST","Transmitir..."],["ENTER_PICTURE_IN_PICTURE","Entrar no modo ecr no ecr"],["EXIT_FULL_SCREEN","Sair do modo de ecr inteiro"],["EXIT_PICTURE_IN_PICTURE","Sair do modo ecr no ecr"],["FAST_FORWARD","Avanar"],["FULL_SCREEN","Ecr inteiro"],["LANGUAGE","Idioma"],["LIVE","Em direto"],["MORE_SETTINGS","Mais definies"],["MULTIPLE_LANGUAGES","Vrios idiomas"],["MUTE","Desativar som"],["NOT_APPLICABLE","No aplicvel"],["OFF","Desligado"],["ON","Ligado"],["PAUSE","Colocar em pausa"],["PICTURE_IN_PICTURE","Ecr no ecr"],["PLAY","Reproduzir"],["RESOLUTION","Resoluo"],["REWIND","Rebobinar"],["SEEK","Procurar"],["SKIP_TO_LIVE","Avanar para o direto"],["UNDETERMINED_LANGUAGE","Indeterminado"],["UNMUTE","Reativar o som"],["UNRECOGNIZED_LANGUAGE","No reconhecido"],["VOLUME","Volume"]])),t.aa("ru",new Map([["AUTO_QUALITY",""],["BACK",""],["CAPTIONS",""],["CAST","..."],["ENTER_PICTURE_IN_PICTURE",'   "  "'],["EXIT_FULL_SCREEN"," "],["EXIT_PICTURE_IN_PICTURE",'   "  "'],["FAST_FORWARD"," "],["FULL_SCREEN"," "],["LANGUAGE",""],["LIVE"," "],["MORE_SETTINGS"," "],["MULTIPLE_LANGUAGES"," "],["MUTE"," "],["NOT_APPLICABLE",""],["OFF",""],["ON",""],["PAUSE",""],["PICTURE_IN_PICTURE","  "],["PLAY",""],["RESOLUTION",""],["REWIND"," "],["SEEK",""],["SKIP_TO_LIVE","     "],["UNDETERMINED_LANGUAGE"," "],["UNMUTE"," "],["UNRECOGNIZED_LANGUAGE"," "],["VOLUME",""]])),t.aa("th",new Map([["AUTO_QUALITY",""],["BACK",""],["CAPTIONS",""],["CAST","..."],["ENTER_PICTURE_IN_PICTURE",""],["EXIT_FULL_SCREEN",""],["EXIT_PICTURE_IN_PICTURE",""],["FAST_FORWARD",""],["FULL_SCREEN",""],["LANGUAGE",""],["LIVE",""],["MORE_SETTINGS",""],["MULTIPLE_LANGUAGES",""],["MUTE",""],["NOT_APPLICABLE",""],["OFF",""],["ON",""],["PAUSE",""],["PICTURE_IN_PICTURE",""],["PLAY",""],["RESOLUTION",""],["REWIND",""],["SEEK",""],["SKIP_TO_LIVE",""],["UNDETERMINED_LANGUAGE",""],["UNMUTE",""],["UNRECOGNIZED_LANGUAGE",""],["VOLUME",""]])),t.aa("tr",new Map([["AUTO_QUALITY","Otomatik"],["BACK","Geri"],["CAPTIONS","Altyazlar"],["CAST","Yaynla..."],["ENTER_PICTURE_IN_PICTURE","Pencere iinde Pencere moduna gir"],["EXIT_FULL_SCREEN","Tam ekrandan k"],["EXIT_PICTURE_IN_PICTURE","Pencere inde Pencereden k"],["FAST_FORWARD","leri sar"],["FULL_SCREEN","Tam ekran"],["LANGUAGE","Dil"],["LIVE","Canl"],["MORE_SETTINGS","Daha fazla ayar"],["MULTIPLE_LANGUAGES","Birden ok dil"],["MUTE","Sesi kapat"],["NOT_APPLICABLE","Geerli deil"],["OFF","Kapal"],["ON","Ak"],["PAUSE","Duraklat"],["PICTURE_IN_PICTURE","Pencere inde Pencere"],["PLAY","Oynat"],["RESOLUTION","znrlk"],["REWIND","Geri sar"],["SEEK","Ara"],["SKIP_TO_LIVE","Canl yayna atla"],["UNDETERMINED_LANGUAGE","Belirsiz"],["UNMUTE","Sesi a"],["UNRECOGNIZED_LANGUAGE","Tannmayan"],["VOLUME","Ses"]])),t.aa("zh",new Map([["AUTO_QUALITY",""],["BACK",""],["CAPTIONS",""],["CAST",""],["ENTER_PICTURE_IN_PICTURE",""],["EXIT_FULL_SCREEN",""],["EXIT_PICTURE_IN_PICTURE",""],["FAST_FORWARD",""],["FULL_SCREEN",""],["LANGUAGE",""],["LIVE",""],["MORE_SETTINGS",""],["MULTIPLE_LANGUAGES",""],["MUTE",""],["NOT_APPLICABLE",""],["OFF",""],["ON",""],["PAUSE",""],["PICTURE_IN_PICTURE",""],["PLAY",""],["RESOLUTION",""],["REWIND",""],["SEEK",""],["SKIP_TO_LIVE",""],["UNDETERMINED_LANGUAGE",""],["UNMUTE",""],["UNRECOGNIZED_LANGUAGE",""],["VOLUME",""]])),t.aa("zh-TW",new Map([["AUTO_QUALITY",""],["BACK",""],["CAPTIONS",""],["CAST","..."],["ENTER_PICTURE_IN_PICTURE",""],["EXIT_FULL_SCREEN",""],["EXIT_PICTURE_IN_PICTURE",""],["FAST_FORWARD",""],["FULL_SCREEN",""],["LANGUAGE",""],["LIVE",""],["MORE_SETTINGS",""],["MULTIPLE_LANGUAGES",""],["MUTE",""],["NOT_APPLICABLE",""],["OFF",""],["ON",""],["PAUSE",""],["PICTURE_IN_PICTURE",""],["PLAY",""],["RESOLUTION",""],["REWIND",""],["SEEK",""],["SKIP_TO_LIVE",""],["UNDETERMINED_LANGUAGE",""],["UNMUTE",""],["UNRECOGNIZED_LANGUAGE",""],["VOLUME",""]])),t.Be(navigator.languages||[]),t),this.b=new Ze,this.configure(this.g),(r=this).b.m(r.s,"buffering",function(){r.O&&Kl(r.G,r.s.Wb())}),r.O&&Kl(r.G,r.s.Wb()),r.b.m(d,"keydown",function(e){r.ka.add(e.key);var t=r.Ic();"Tab"==e.key&&(r.a.classList.add("shaka-keyboard-navigation"),Xl(r),r.b.m(d,"mousedown",r.rb.bind(r))),"Escape"==e.key&&r.v.gb(),t&&r.ka.has("Tab")&&function(e,t){var n=e.H.filter(function(e){return e.classList.contains("shaka-displayed")})[0];if(n.childNodes.length){for(var i=n.firstElementChild;i&&i.classList.contains("shaka-hidden");)i=i.nextElementSibling;for(n=n.lastElementChild;n&&n.classList.contains("shaka-hidden");)n=n.previousElementSibling;var r=document.activeElement;e.ka.has("Shift")?r==i&&(t.preventDefault(),n.focus()):r==n&&(t.preventDefault(),i.focus())}}(r,e)}),r.b.m(d,"click",function(){return r.uc()}),r.b.m(r.c,"play",r.L.bind(r)),r.b.m(r.c,"pause",r.L.bind(r)),r.b.m(r.c,"ended",r.L.bind(r)),r.b.m(r.f,"mousemove",r.ia.bind(r)),r.b.m(r.f,"touchmove",r.ia.bind(r),{passive:!0}),r.b.m(r.f,"touchend",r.ia.bind(r),{passive:!0}),r.b.m(r.f,"mouseleave",r.sb.bind(r)),r.b.m(r.l,"caststatuschanged",function(){$l(r)}),r.b.m(r.f,"keyup",function(e){var t=document.activeElement,n=!(!t||!t.classList)&&t.classList.contains("shaka-volume-bar"),i=t&&t.classList&&t.classList.contains("shaka-seek-bar");if(r.a.contains(t)&&r.ia(e),r.ka.delete(e.key),r.g.enableKeyboardPlaybackControls)switch(e.key){case"ArrowLeft":n||Jl(r,r.c.currentTime-5);break;case"ArrowRight":n||Jl(r,r.c.currentTime+5);break;case"Home":Jl(r,r.s.Ib().start);break;case"End":Jl(r,r.s.Ib().end);break;case" ":i&&Yl(r)}}),screen.orientation&&r.b.m(screen.orientation,"change",function(){r.c&&0!=r.c.readyState&&!r.l.ha()&&r.g.enableFullscreenOnRotation&&(screen.orientation.type.includes("landscape")&&!document.fullscreenElement?r.f.requestFullscreen({navigationUI:"hide"}):screen.orientation.type.includes("portrait")&&document.fullscreenElement&&document.exitFullscreen())}),this.ka=new Set,$l(this),this.ya.Ia(.125)}_("shaka.ui.Element",Ul),Ul.prototype.destroy=function(){return this.eventManager.release(),this.video=this.player=this.localization=this.eventManager=this.controls=this.parent=null,Promise.resolve()},v(_l,Ul),_("shaka.ui.RangeElement",_l),_l.prototype.setRange=function(e,t){this.bar.min=e,this.bar.max=t},_l.prototype.onChangeStart=function(){},_l.prototype.onChange=function(){},_l.prototype.onChangeEnd=function(){},_l.prototype.getValue=function(){return parseFloat(this.bar.value)},_l.prototype.setValue=function(e){this.a||(this.bar.value=e)},_("shaka.ui.Utils.getFirstDescendantWithClassName",Dl),_("shaka.ui.Utils.setDisplay",Kl),_("shaka.ui.Utils.removeAllChildren",Bl),v(Gl,_l),_("shaka.ui.SeekBar",Gl),Gl.prototype.destroy=function(){var t=this;return G(function e(){return q(e,function(e){if(1===e.o)return t.b&&(t.b.stop(),t.b=null),V(e,_l.prototype.destroy.call(t),0)})})},Gl.prototype.onChangeStart=function(){this.f=!this.video.paused,this.controls.ge(!0),this.video.pause()},Gl.prototype.onChange=function(){this.video.duration&&(Vl(this),this.b.R(.125))},Gl.prototype.onChangeEnd=function(){this.b.gb(),this.controls.ge(!1),this.f&&this.video.play()},O(Hl,j),_("shaka.ui.Controls",Hl);var Wl=new Map;function ql(e,t){Wl.set(e,t)}function Xl(e){var t=e.c.paused&&!e.Z,n=e.a.classList.contains("shaka-keyboard-navigation");t||e.Na||n||(n=e,d.matchMedia("hover: hover").matches&&n.Wa.some(function(e){return e.matches(":hover")}))?(Zl(e),e.a.setAttribute("shown","true"),e.Y.stop()):e.Y.R(e.g.fadeDelay)}function Yl(e){e.O&&e.c.duration&&(e.s.ze(),e.c.paused?e.c.play():e.c.pause())}function $l(e){var t=e.l.ha();e.dispatchEvent(new D("caststatuschanged",{Jg:t})),t?e.a.setAttribute("casting","true"):e.a.removeAttribute("casting")}function Jl(e,t){e.c.currentTime=t,e.Cb()&&Zl(e)}function Zl(e){if(e.j)if(e.j.setValue(e.c.currentTime),Vl(e.j),e.j.container.classList.contains("shaka-hidden"))for(var t=B(e.H),n=t.next();!n.done;n=t.next())n.value.classList.add("shaka-low-position");else for(var n=(t=B(e.H)).next();!n.done;n=t.next())n.value.classList.remove("shaka-low-position");e.dispatchEvent(new D("timeandseekrangeupdated"))}function Ql(e,t){Ul.call(this,e,t);var n=this;this.f=this.controls.g,this.g=this.controls.a,this.c=[],this.b=fl("button"),this.b.classList.add("shaka-overflow-menu-button"),this.b.classList.add("shaka-no-propagation"),this.b.classList.add("material-icons-round"),this.b.textContent="more_vert",this.parent.appendChild(this.b),this.a=fl("div"),this.a.classList.add("shaka-overflow-menu"),this.a.classList.add("shaka-no-propagation"),this.a.classList.add("shaka-show-controls-on-mouse-over"),this.a.classList.add("shaka-settings-menu"),this.g.appendChild(this.a),function(e){for(var t=0;t<e.f.overflowMenuButtons.length;t++){var n=e.f.overflowMenuButtons[t];id.get(n)?(n=id.get(n),e.c.push(n.create(e.a,e.controls))):X.ba("Unrecognized overflow menu element requested:",n)}}(this);for(var i=this.controls.f.getElementsByClassName("shaka-back-to-overflow-button"),r=0;r<i.length;r++)this.eventManager.m(i[r],"click",function(){n.controls.uc(),Kl(n.a,!0),n.a.childNodes.length&&n.a.childNodes[0].focus(),Xl(n.controls)});this.eventManager.m(this.localization,"locale-updated",function(){td(n)}),this.eventManager.m(this.localization,"locale-changed",function(){td(n)}),this.eventManager.m(this.controls,"submenuopen",function(){Kl(n.a,!1)}),this.eventManager.m(this.a,"touchstart",function(e){n.controls.uf(Date.now()),e.stopPropagation()}),this.eventManager.m(this.b,"click",function(){!function(e){{var t;e.controls.Ic()?e.controls.uc():(Kl(e.a,!0),Xl(e.controls),t=function(e){return 0==e.classList.contains("shaka-hidden")},function(e,t){for(var n=B(e),i=n.next();!i.done;i=n.next())if(t(i.value))return 1}(e.a.childNodes,t)&&$(e.a.childNodes,t)[0].focus())}}(n)}),td(this)}function ed(e,t){id.set(e,t)}function td(e){e.b.setAttribute("aria-label",e.localization.resolve("MORE_SETTINGS"))}function nd(){}Hl.prototype.destroy=function(){var t=this;return G(function e(){return q(e,function(e){switch(e.o){case 1:if(t.b&&(t.b.release(),t.b=null),t.K&&(t.K.stop(),t.K=null),t.Y&&(t.Y.stop(),t.Y=null),t.v&&(t.v.stop(),t.v=null),t.ya&&(t.ya.stop(),t.ya=null),t.a&&(t.f.removeChild(t.a),t.a=null),t.l)return V(e,t.l.destroy(),3);e.C(2);break;case 3:t.l=null;case 2:if(t.wa)return V(e,t.wa.destroy(),5);e.C(4);break;case 5:t.wa=null;case 4:return t.s=null,t.B=null,t.c=null,t.La=null,t.ka.clear(),V(e,Promise.all(t.Ka.map(function(e){return e.destroy()})),6);case 6:if(t.Ka=[],t.j)return V(e,t.j.destroy(),0);e.C(0)}})})},Hl.registerElement=ql,Hl.prototype.allowCast=Hl.prototype.Kf=function(e){this.Ja=e,$l(this)},Hl.prototype.loadComplete=Hl.prototype.Hg=function(){this.L()},Hl.prototype.configure=function(e){var t;this.g=e,this.l.Ce(e.castReceiverAppId),this.j&&(this.j.destroy(),this.j=null),this.Ma&&(this.Ma.destroy(),this.Ma=null),this.a?(pl(this.a),this.f.removeChild(this.G)):((t=this).a=fl("div"),t.a.classList.add("shaka-controls-container"),t.f.appendChild(t.a),t.b.m(t.a,"touchstart",function(e){t.c.duration&&(t.Cb()?t.w=Date.now():(t.ia(e),e.preventDefault()))},{passive:!1}),t.b.m(t.a,"click",function(){t.O&&(t.Ic()?t.v.gb():Yl(t))}),t.b.m(t.a,"dblclick",function(){t.g.doubleClickForFullscreen&&t.oe()})),function(e){e.f.classList.add("shaka-video-container"),e.B.classList.add("shaka-video");var t=fl("div");t.classList.add("shaka-skim-container"),t.classList.add("shaka-fade-out-on-mouse-out"),e.a.appendChild(t),e.g.addBigPlayButton&&((t=fl("div")).classList.add("shaka-play-button-container"),e.a.appendChild(t),e.Ma=new hd(t,e)),e.G=fl("div"),e.G.classList.add("shaka-spinner-container"),e.f.appendChild(e.G);var n=fl("div");if(n.classList.add("shaka-spinner"),e.G.appendChild(n),(t=document.createElementNS("http://www.w3.org/2000/svg","svg")).setAttribute("class","shaka-spinner-svg"),t.setAttribute("viewBox","0 0 30 30"),n.appendChild(t),(n=document.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("class","shaka-spinner-path"),n.setAttribute("cx","15"),n.setAttribute("cy","15"),n.setAttribute("r","14.5"),n.setAttribute("fill","none"),n.setAttribute("stroke-width","1"),n.setAttribute("stroke-miterlimit","10"),t.appendChild(n),function(e){e.na=fl("div"),e.na.classList.add("shaka-bottom-controls"),e.a.appendChild(e.na),e.J=fl("div"),e.J.classList.add("shaka-controls-button-panel"),e.J.classList.add("shaka-no-propagation"),e.J.classList.add("shaka-show-controls-on-mouse-over"),e.na.appendChild(e.J),e.b.m(e.J,"click",function(){e.uc()});for(var t=0;t<e.g.controlPanelElements.length;t++){var n=e.g.controlPanelElements[t];Wl.get(n)?(n=Wl.get(n),e.Ka.push(n.create(e.J,e))):X.ba("Unrecognized control panel element requested:",n)}}(e),e.H=Array.from(e.f.getElementsByClassName("shaka-settings-menu")),e.g.addSeekBar)e.j=new Gl(e.na,e);else for(t=B(e.H),n=t.next();!n.done;n=t.next())n.value.classList.add("shaka-low-position");e.Wa=Array.from(e.f.getElementsByClassName("shaka-show-controls-on-mouse-over"))}(this),this.L();for(var n=(e=B(this.f.getElementsByClassName("shaka-no-propagation"))).next();!n.done;n=e.next()){n=n.value;function i(e){return e.stopPropagation()}this.b.m(n,"click",i),this.b.m(n,"dblclick",i)}},Hl.prototype.setEnabledShakaControls=Hl.prototype.ce=function(e){(this.O=e)?(Kl(this.a,!0),Kl(this.G,this.s.Wb()),this.B.tabIndex=-1,this.B.controls=!1):(Kl(this.a,!1),Kl(this.G,!1)),this.L()},Hl.prototype.setSeeking=Hl.prototype.ge=function(e){this.Z=e},Hl.prototype.setEnabledNativeControls=Hl.prototype.tf=function(e){this.B.controls=e,this.B.tabIndex=e?0:-1,e&&this.ce(!1)},Hl.prototype.getCastProxy=Hl.prototype.Xf=function(){return this.l},Hl.prototype.getLocalization=Hl.prototype.ig=function(){return this.La},Hl.prototype.toggleFullScreen=Hl.prototype.oe=function(){var n=this;return G(function e(){var t;return q(e,function(e){switch(e.o){case 1:if(document.fullscreenElement){document.exitFullscreen(),e.C(0);break}if(z(e,3),document.pictureInPictureElement)return V(e,document.exitPictureInPicture(),5);e.C(5);break;case 5:H(e,4);break;case 3:t=W(e),n.dispatchEvent(new D("error",{detail:t}));case 4:return V(e,n.f.requestFullscreen({navigationUI:"hide"}),0)}})})},Hl.prototype.getVideoContainer=Hl.prototype.zg=function(){return this.f},Hl.prototype.getVideo=Hl.prototype.sc=function(){return this.c},Hl.prototype.getLocalVideo=Hl.prototype.hg=function(){return this.B},Hl.prototype.getPlayer=Hl.prototype.$a=function(){return this.s},Hl.prototype.getLocalPlayer=Hl.prototype.gg=function(){return this.wa},Hl.prototype.getControlsContainer=Hl.prototype.$f=function(){return this.a},Hl.prototype.getConfig=Hl.prototype.Yf=function(){return this.g},Hl.prototype.isSeeking=Hl.prototype.Fg=function(){return this.Z},Hl.prototype.isCastAllowed=Hl.prototype.Dg=function(){return this.Ja},Hl.prototype.getDisplayTime=Hl.prototype.Le=function(){return this.j?this.j.getValue():this.c.currentTime},Hl.prototype.setLastTouchEventTime=Hl.prototype.uf=function(e){this.w=e},Hl.prototype.anySettingsMenusAreOpen=Hl.prototype.Ic=function(){return this.H.some(function(e){return e.classList.contains("shaka-displayed")})},Hl.prototype.hideSettingsMenus=Hl.prototype.uc=function(){this.v.gb()},Hl.prototype.ia=function(e){"mousemove"==e.type&&(this.a.classList.remove("shaka-keyboard-navigation"),Xl(this)),"touchstart"==e.type||"touchmove"==e.type||"touchend"==e.type||"keyup"==e.type?this.w=Date.now():this.w+1e3<Date.now()&&(this.w=null),this.w&&"mousemove"==e.type||(this.f.style.cursor="",this.Na=!0,this.v.stop(),this.Cb()||(Zl(this),Xl(this)),this.K.stop(),"touchend"!=e.type&&"keyup"!=e.type&&this.w||this.K.R(3))},Hl.prototype.sb=function(){this.w||this.K.gb()},Hl.prototype.L=function(){this.c.ended&&!this.c.paused&&this.c.pause(),Xl(this)},Hl.prototype.isOpaque=Hl.prototype.Cb=function(){return!!this.O&&(null!=this.a.getAttribute("shown")||null!=this.a.getAttribute("casting"))},Hl.prototype.rb=function(){this.b.xa(d,"mousedown")},v(Ql,Ul),_("shaka.ui.OverflowMenu",Ql),Ql.prototype.destroy=function(){var t=this;return G(function e(){return q(e,function(e){switch(e.o){case 1:return t.g=null,V(e,Promise.all(t.c.map(function(e){return e.destroy()})),2);case 2:return t.c=[],V(e,Ul.prototype.destroy.call(t),0)}})})},Ql.registerElement=ed,nd.prototype.create=function(e,t){return new Ql(e,t)},ql("overflow_menu",new nd);var id=new Map;function rd(e,t,n){Ul.call(this,e,t);var i=this;!function(e,t){e.button=fl("button"),e.icon=fl("i"),e.icon.classList.add("material-icons-round"),e.icon.textContent=t,e.button.appendChild(e.icon);t=fl("label");t.classList.add("shaka-overflow-button-label"),e.nameSpan=fl("span"),t.appendChild(e.nameSpan),e.currentSelection=fl("span"),e.currentSelection.classList.add("shaka-current-selection-span"),t.appendChild(e.currentSelection),e.button.appendChild(t),e.parent.appendChild(e.button)}(this,n),function(e){e.menu=fl("div"),e.menu.classList.add("shaka-no-propagation"),e.menu.classList.add("shaka-show-controls-on-mouse-over"),e.menu.classList.add("shaka-settings-menu"),e.backButton=fl("button"),e.backButton.classList.add("shaka-back-to-overflow-button"),e.menu.appendChild(e.backButton);var t=fl("i");t.classList.add("material-icons-round"),t.textContent="arrow_back",e.backButton.appendChild(t),e.backSpan=fl("span"),e.backButton.appendChild(e.backSpan),e.controls.a.appendChild(e.menu)}(this),this.eventManager.m(this.button,"click",function(){i.controls.dispatchEvent(new D("submenuopen")),Kl(i.menu,!0),Fl(i.menu)})}function ad(e,t){rd.call(this,e,t,"language");var n=this;this.button.classList.add("shaka-language-button"),this.menu.classList.add("shaka-audio-languages"),this.eventManager.m(this.localization,"locale-updated",function(){sd(n)}),this.eventManager.m(this.localization,"locale-changed",function(){sd(n)}),this.eventManager.m(this.player,"trackschanged",function(){var e=0<n.player.Ub().length;Kl(n.button,e),od(n)}),this.eventManager.m(this.player,"variantchanged",function(){od(n)}),sd(this),od(this)}function od(t){Ll(t.player.Ub(),t.menu,function(e){t.player.cd(e.language,e.roles[0])},!0,t.currentSelection,t.localization,t.controls.g.trackLabelFormat),Fl(t.menu),t.controls.dispatchEvent(new D("languageselectionupdated"))}function sd(e){e.backButton.setAttribute("aria-label",e.localization.resolve("BACK")),e.button.setAttribute("aria-label",e.localization.resolve("LANGUAGE")),e.nameSpan.textContent=e.localization.resolve("LANGUAGE"),e.backSpan.textContent=e.localization.resolve("LANGUAGE")}function ud(){}function cd(e,t){Ul.call(this,e,t);var n=this;this.button=fl("button"),this.parent.appendChild(this.button),this.eventManager.m(this.localization,"locale-updated",function(){dd(n)}),this.eventManager.m(this.localization,"locale-changed",function(){dd(n)}),this.eventManager.m(this.video,"play",function(){dd(n)}),this.eventManager.m(this.video,"pause",function(){dd(n)}),this.eventManager.m(this.button,"click",function(){ld(n)?n.video.play():n.video.pause()})}function ld(e){return e.video.paused&&!e.controls.Z}function dd(e){e.button.setAttribute("aria-label",e.localization.resolve(ld(e)?"PLAY":"PAUSE"))}function hd(e,t){cd.call(this,e,t);var n=this;this.button.classList.add("shaka-play-button"),this.button.classList.add("shaka-no-propagation"),fd(this),dd(this),this.eventManager.m(this.video,"play",function(){fd(n)}),this.eventManager.m(this.video,"pause",function(){fd(n)})}function fd(e){ld(e)?e.button.setAttribute("icon","play"):e.button.setAttribute("icon","pause")}function pd(e,t){Ul.call(this,e,t);var i=this;this.b=this.controls.l,this.a=fl("button"),this.a.classList.add("shaka-cast-button"),this.a.setAttribute("aria-pressed","false"),this.c=fl("i"),this.c.classList.add("material-icons-round"),this.c.textContent="cast",this.a.appendChild(this.c);t=fl("label");t.classList.add("shaka-overflow-button-label"),this.g=fl("span"),t.appendChild(this.g),this.f=fl("span"),this.f.classList.add("shaka-current-selection-span"),t.appendChild(this.f),this.a.appendChild(t),this.parent.appendChild(this.a),vd(this),md(this),this.eventManager.m(this.localization,"locale-updated",function(){vd(i)}),this.eventManager.m(this.localization,"locale-changed",function(){vd(i)}),this.eventManager.m(this.a,"click",function(){var n;n=i,G(function e(){var t;return q(e,function(e){switch(e.o){case 1:if(n.b.ha()){n.b.yf(),e.C(0);break}return z(e,3),n.a.disabled=!0,V(e,n.b.cast(),5);case 5:n.a.disabled=!1,H(e,0);break;case 3:t=W(e),n.a.disabled=!1,8004!=t.code&&n.controls.dispatchEvent(new D("error",{detail:t})),x(e)}})})}),this.eventManager.m(this.controls,"caststatuschanged",function(){md(i)})}function md(e){var t=e.b.ye()&&e.controls.Ja,n=e.b.ha();Kl(e.a,t),e.c.textContent=n?"cast_connected":"cast",t&&(n?e.a.setAttribute("aria-pressed","true"):e.a.setAttribute("aria-pressed","false")),gd(e)}function gd(e){e.f.textContent=e.b.ha()?e.b.bd():e.localization.resolve("OFF")}function vd(e){e.a.setAttribute("aria-label",e.localization.resolve("CAST")),e.g.textContent=e.localization.resolve("CAST"),gd(e)}function bd(){}function yd(e,t){Ul.call(this,e,t);var n=this;this.a=fl("button"),this.a.classList.add("material-icons-round"),this.a.classList.add("shaka-fast-forward-button"),this.a.textContent="fast_forward",this.parent.appendChild(this.a),Ed(this),this.eventManager.m(this.localization,"locale-updated",function(){Ed(n)}),this.eventManager.m(this.localization,"locale-changed",function(){Ed(n)}),this.eventManager.m(this.a,"click",function(){var e;n.video.duration&&(e=n.player.yd(),n.player.qe(e<0||4<e?1:2*e))})}function Ed(e){e.a.setAttribute("aria-label",e.localization.resolve("FAST_FORWARD"))}function wd(){}function Td(e,t){Ul.call(this,e,t);var n=this;this.a=fl("button"),this.a.classList.add("shaka-fullscreen-button"),this.a.classList.add("material-icons-round"),document.fullscreenEnabled||this.a.classList.add("shaka-hidden"),this.a.textContent="fullscreen",this.parent.appendChild(this.a),Sd(this),this.eventManager.m(this.localization,"locale-updated",function(){Sd(n)}),this.eventManager.m(this.localization,"locale-changed",function(){Sd(n)}),this.eventManager.m(this.a,"click",function(){n.controls.oe()}),this.eventManager.m(document,"fullscreenchange",function(){n.a.textContent=document.fullscreenElement?"fullscreen_exit":"fullscreen",Sd(n)})}function Sd(e){e.a.setAttribute("aria-label",e.localization.resolve(document.fullscreenElement?"EXIT_FULL_SCREEN":"FULL_SCREEN"))}function Ad(){}function Id(e,t){Ul.call(this,e,t);var n=this;this.a=fl("button"),this.a.classList.add("shaka-mute-button"),this.a.classList.add("material-icons-round"),this.a.textContent="volume_up",this.parent.appendChild(this.a),kd(this),this.eventManager.m(this.localization,"locale-updated",function(){kd(n)}),this.eventManager.m(this.localization,"locale-changed",function(){kd(n)}),this.eventManager.m(this.a,"click",function(){n.video.muted=!n.video.muted}),this.eventManager.m(this.video,"volumechange",function(){kd(n),n.a.textContent=n.video.muted?"volume_off":"volume_up"})}function kd(e){e.a.setAttribute("aria-label",e.localization.resolve(e.video.muted?"UNMUTE":"MUTE"))}function Cd(){}function xd(e,t){Ul.call(this,e,t);var i=this;this.g=this.controls.B,this.a=fl("button"),this.a.classList.add("shaka-pip-button"),this.c=fl("i"),this.c.classList.add("material-icons-round"),this.c.textContent="picture_in_picture_alt",this.a.appendChild(this.c);t=fl("label");t.classList.add("shaka-overflow-button-label"),this.f=fl("span"),this.f.textContent=this.localization.resolve("PICTURE_IN_PICTURE"),t.appendChild(this.f),this.b=fl("span"),this.b.classList.add("shaka-current-selection-span"),t.appendChild(this.b),this.a.appendChild(t),Nd(this),this.parent.appendChild(this.a),document.pictureInPictureEnabled&&!this.video.disablePictureInPicture||Kl(this.a,!1),this.eventManager.m(this.localization,"locale-updated",function(){Nd(i)}),this.eventManager.m(this.localization,"locale-changed",function(){Nd(i)}),this.eventManager.m(this.a,"click",function(){var n;n=i,G(function e(){var t;return q(e,function(e){switch(e.o){case 1:return z(e,2),document.pictureInPictureElement?V(e,document.exitPictureInPicture(),5):(document.fullscreenElement&&document.exitFullscreen(),V(e,n.video.requestPictureInPicture(),5));case 5:H(e,0);break;case 2:t=W(e),n.controls.dispatchEvent(new D("error",{detail:t})),x(e)}})})}),this.eventManager.m(this.g,"enterpictureinpicture",function(){i.c.textContent="branding_watermark",i.a.setAttribute("aria-label",i.localization.resolve("EXIT_PICTURE_IN_PICTURE")),i.b.textContent=i.localization.resolve("ON")}),this.eventManager.m(this.g,"leavepictureinpicture",function(){i.c.textContent="picture_in_picture_alt",i.a.setAttribute("aria-label",i.localization.resolve("ENTER_PICTURE_IN_PICTURE")),i.b.textContent=i.localization.resolve("OFF")}),this.eventManager.m(this.controls,"caststatuschanged",function(e){e.newStatus?document.pictureInPictureEnabled&&!i.video.disablePictureInPicture&&Kl(i.a,!1):document.pictureInPictureEnabled&&!i.video.disablePictureInPicture&&Kl(i.a,!0)}),this.eventManager.m(this.player,"trackschanged",function(){var t;t=i,G(function e(){return q(e,function(e){if(1===e.o){if(document.pictureInPictureEnabled&&!t.video.disablePictureInPicture)if(t.player&&t.player.Re()){if(Kl(t.a,!1),document.pictureInPictureElement)return V(e,document.exitPictureInPicture(),0)}else Kl(t.a,!0);else Kl(t.a,!1);e.C(0)}})})})}function Nd(e){e.f.textContent=e.localization.resolve("PICTURE_IN_PICTURE"),e.a.setAttribute("aria-label",e.localization.resolve(document.pictureInPictureElement?"EXIT_PICTURE_IN_PICTURE":"ENTER_PICTURE_IN_PICTURE")),e.b.textContent=e.localization.resolve(document.pictureInPictureElement?"ON":"OFF")}function Pd(){}function Md(e,t){Ul.call(this,e,t);var a=this;this.a=fl("button"),this.a.classList.add("shaka-current-time"),Rd(this,"0:00"),this.parent.appendChild(this.a),this.eventManager.m(this.a,"click",function(){a.player.W()&&(a.video.currentTime=a.player.Ib().end)}),this.eventManager.m(this.controls,"timeandseekrangeupdated",function(){var e=a.controls.Z,t=a.controls.Le(),n=a.video.duration,i=a.player.Ib(),r=i.end-i.start;a.player.W()?(n=3600<=r,1<=(t=Math.max(0,Math.floor(i.end-t)))||e?(Rd(a,"- "+Ld(t,n)),a.a.disabled=!1):(Rd(a,a.localization.resolve("LIVE")),a.a.disabled=!0)):(t=Ld(t,e=3600<=n),n&&(t+=" / "+Ld(n,e)),Rd(a,t),a.a.disabled=!0)}),this.eventManager.m(this.player,"trackschanged",function(){a.player.W()&&a.a.setAttribute("aria-label",a.localization.resolve("SKIP_TO_LIVE"))})}function Rd(e,t){t!=e.a.textContent&&(e.a.textContent=t)}function Ld(e,t){var n=Math.floor(e/3600),i=Math.floor(e/60%60),e=Math.floor(e%60);return e<10&&(e="0"+e),e=i+":"+e,t&&(i<10&&(e="0"+e),e=n+":"+e),e}function Ud(){}function _d(e,t){rd.call(this,e,t,"settings");var n=this;this.button.classList.add("shaka-resolution-button"),this.menu.classList.add("shaka-resolutions"),this.eventManager.m(this.localization,"locale-updated",function(){Dd(n)}),this.eventManager.m(this.localization,"locale-changed",function(){Dd(n)}),this.eventManager.m(this.player,"variantchanged",function(){Od(n)}),this.eventManager.m(this.player,"trackschanged",function(){Od(n)}),this.eventManager.m(this.player,"abrstatuschanged",function(){Od(n)}),Od(this),Dd(this)}function Od(i){var r,e,a,n=i.player.Ub();n.length&&!n[0].height?(Kl(i.menu,!1),Kl(i.button,!1)):(Kl(i.button,!0),n.sort(function(e,t){return t.height-e.height}),(r=n.find(function(e){return e.active}))&&(n=n.filter(function(e){return e.language==r.language&&e.channelsCount==r.channelsCount})),n=n.filter(function(t,e){return n.findIndex(function(e){return e.height==t.height})==e}),e=Dl(i.menu,"shaka-back-to-overflow-button"),Bl(i.menu),i.menu.appendChild(e),a=i.player.getConfiguration().abr.enabled,n.forEach(function(e){var t=fl("button");t.classList.add("explicit-resolution"),i.eventManager.m(t,"click",i.b.bind(i,e));var n=fl("span");n.textContent=e.height+"p",t.appendChild(n),a||e!=r||(t.setAttribute("aria-selected","true"),t.appendChild(jl()),n.classList.add("shaka-chosen-item"),i.currentSelection.textContent=n.textContent),i.menu.appendChild(t)}),(e=fl("button")).classList.add("shaka-enable-abr-button"),i.eventManager.m(e,"click",function(){this.player.configure({abr:{enabled:!0}}),Od(this)}.bind(i)),i.a=fl("span"),i.a.classList.add("shaka-auto-span"),i.a.textContent=i.localization.resolve("AUTO_QUALITY"),e.appendChild(i.a),a&&(e.setAttribute("aria-selected","true"),e.appendChild(jl()),i.a.classList.add("shaka-chosen-item"),i.currentSelection.textContent=i.localization.resolve("AUTO_QUALITY")),i.menu.appendChild(e),Fl(i.menu),i.controls.dispatchEvent(new D("resolutionselectionupdated")))}function Dd(e){e.button.setAttribute("aria-label",e.localization.resolve("RESOLUTION")),e.backButton.setAttribute("aria-label",e.localization.resolve("RESOLUTION")),e.backSpan.textContent=e.localization.resolve("RESOLUTION"),e.nameSpan.textContent=e.localization.resolve("RESOLUTION"),e.a.textContent=e.localization.resolve("AUTO_QUALITY"),e.player.getConfiguration().abr.enabled&&(e.currentSelection.textContent=e.localization.resolve("AUTO_QUALITY"))}function Fd(){}function jd(e,t){Ul.call(this,e,t);var n=this;this.a=fl("button"),this.a.classList.add("material-icons-round"),this.a.classList.add("shaka-rewind-button"),this.a.textContent="fast_rewind",this.parent.appendChild(this.a),Kd(this),this.eventManager.m(this.localization,"locale-updated",function(){Kd(n)}),this.eventManager.m(this.localization,"locale-changed",function(){Kd(n)}),this.eventManager.m(this.a,"click",function(){var e;n.video.duration&&(e=n.player.yd(),n.player.qe(0<e||e<-4?-1:2*e))})}function Kd(e){e.a.setAttribute("aria-label",e.localization.resolve("REWIND"))}function Bd(){}function Gd(e,t){cd.call(this,e,t);var n=this;this.button.classList.add("shaka-small-play-button"),this.button.classList.add("material-icons-round"),Vd(this),dd(this),this.eventManager.m(this.video,"play",function(){Vd(n)}),this.eventManager.m(this.video,"pause",function(){Vd(n)})}function Vd(e){e.button.textContent=ld(e)?"play_arrow":"pause"}function zd(){}function Hd(e,t){Ul.call(this,e,t);t=fl("div");t.classList.add("shaka-spacer"),t.setAttribute("aria-hidden",!0),this.parent.appendChild(t)}function Wd(){}function qd(e,t){var n=this;this.f=!1,this.c=[],this.l=e,this.j=t,this.a=fl("div"),this.a.classList.add("shaka-text-container"),this.a.style.textAlign="center",this.a.style.display="flex",this.a.style.flexDirection="column",this.a.style.alignItems="center",this.a.style.justifyContent="flex-end",this.j.appendChild(this.a),this.g=new ke(function(){Xd(n)}).Ia(.25),this.b=new Map}function Xd(t){function n(e){return t.c.includes(e)&&t.f&&e.startTime<=i&&e.endTime>=i}for(var e,i=t.l.currentTime,r=B(t.b.keys()),a=r.next();!a.done;a=r.next())n(a=a.value)||(e=t.b.get(a),t.a.removeChild(e),t.b.delete(a));for(r=new Set(t.b.values()),e=(a=B(Array.from(t.a.childNodes))).next();!e.done;e=a.next())e=e.value,r.has(e)||t.a.removeChild(e);for(a=(r=B(r=t.c.filter(function(e){return n(e)&&!t.b.has(e)}).sort(function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime-t.endTime}))).next();!a.done;a=r.next())!function(e,t,n){if(n.nestedCues.length){var i=fl("p");i.style.width="100%",$d(i,n,!1);for(var r=0;r<n.nestedCues.length;r++)Yd(i,n.nestedCues[r],!0);t.appendChild(i),e.b.set(n,i)}else e.b.set(n,Yd(t,n,!1))}(t,t.a,a.value)}function Yd(e,t,n){var i=fl("span");return n&&i.classList.add("shaka-nested-cue"),t.spacer?i.style.display="block":$d(i,t,!0),e.appendChild(i),i}function $d(e,t,n){var i,r=e.style;r.whiteSpace="pre-line",e.textContent=t.payload,n&&(r.backgroundColor=t.backgroundColor),r.color=t.color,r.direction=t.direction,t.backgroundImage&&(r.backgroundImage="url('"+t.backgroundImage+"')",r.backgroundRepeat="no-repeat",r.backgroundSize="contain",r.backgroundPosition="center",""==t.backgroundColor&&(r.backgroundColor="transparent")),t.backgroundImage&&t.region&&(e=Sn,i=t.region.widthUnits==e?"%":"px",r.height=t.region.height+(t.region.heightUnits==e?"%":"px"),r.width=t.region.width+i),r.justifyContent="before"==t.displayAlign?"flex-start":"center"==t.displayAlign?"center":"flex-end",t.nestedCues.length&&(r.display="flex",r.flexDirection="row",r.margin="0",r.alignItems=r.justifyContent,r.justifyContent="center"),n&&(r.maxWidth="100%"),r.fontFamily=t.fontFamily,r.fontWeight=t.fontWeight.toString(),r.fontSize=t.fontSize,r.fontStyle=t.fontStyle,t.line?1==t.lineInterpretation&&(r.position="absolute",t.writingMode==mn?t.lineAlign==vn?r.top=t.line+"%":"end"==t.lineAlign&&(r.bottom=t.line+"%"):"vertical-lr"==t.writingMode?t.lineAlign==vn?r.left=t.line+"%":"end"==t.lineAlign&&(r.right=t.line+"%"):t.lineAlign==vn?r.right=t.line+"%":"end"==t.lineAlign&&(r.left=t.line+"%")):t.region&&t.region.id&&!n&&(n=Sn,e=t.region.widthUnits==n?"%":"px",i=t.region.viewportAnchorUnits==n?"%":"px",r.height=t.region.height+(t.region.heightUnits==n?"%":"px"),r.width=t.region.width+e,r.position="absolute",r.top=t.region.viewportAnchorY+i,r.left=t.region.viewportAnchorX+i),r.lineHeight=t.lineHeight,t.position&&(t.writingMode==mn?r.paddingLeft=t.position:r.paddingTop=t.position),"line-left"==t.positionAlign?r.cssFloat="left":"line-right"==t.positionAlign&&(r.cssFloat="right"),r.textAlign=t.textAlign,r.textDecoration=t.textDecoration.join(" "),r.writingMode=t.writingMode,t.size&&(t.writingMode==mn?r.width=t.size+"%":r.height=t.size+"%")}function Jd(e,t){rd.call(this,e,t,"closed_caption");var n=this;this.button.classList.add("shaka-caption-button"),this.menu.classList.add("shaka-text-languages"),this.player&&this.player.bb()?this.button.setAttribute("aria-pressed","true"):this.button.setAttribute("aria-pressed","false"),e=this,(t=fl("button")).setAttribute("aria-selected","true"),e.menu.appendChild(t),t.appendChild(jl()),e.a=fl("span"),e.a.classList.add("shaka-auto-span"),t.appendChild(e.a),this.eventManager.m(this.localization,"locale-updated",function(){eh(n),Qd(n)}),this.eventManager.m(this.localization,"locale-changed",function(){eh(n),Qd(n)}),this.eventManager.m(this.player,"texttrackvisibility",function(){Zd(n),n.player.bb()&&th(n)}),this.eventManager.m(this.player,"textchanged",function(){Qd(n)}),this.eventManager.m(this.player,"trackschanged",function(){th(n)}),Zd(this),eh(this),Qd(this)}function Zd(e){e.player.bb()?(e.icon.classList.add("shaka-captions-on"),e.icon.classList.remove("shaka-captions-off"),e.button.setAttribute("aria-pressed","true")):(e.icon.classList.add("shaka-captions-off"),e.icon.classList.remove("shaka-captions-on"),e.button.setAttribute("aria-pressed","false")),e.controls.dispatchEvent(new D("captionselectionupdated"))}function Qd(i){var e=i.player.ib();Ll(e,i.menu,function(e){return t=i,n=e,G(function e(){return q(e,function(e){switch(e.o){case 1:return V(e,t.player.je(!0),2);case 2:t.player&&t.player.dd(n.language,n.roles[0]),x(e)}})});var t,n},i.player.bb(),i.currentSelection,i.localization,i.controls.g.trackLabelFormat),(e=fl("button")).classList.add("shaka-turn-captions-off-button"),i.eventManager.m(e,"click",function(){i.player.je(!1).catch(function(){}),Qd(i)}),e.appendChild(i.a),i.menu.appendChild(e),i.player.bb()||(e.setAttribute("aria-selected","true"),e.appendChild(jl()),i.a.classList.add("shaka-chosen-item"),i.currentSelection.textContent=i.localization.resolve("OFF")),Fl(i.menu),i.controls.dispatchEvent(new D("captionselectionupdated"))}function eh(e){e.button.setAttribute("aria-label",e.localization.resolve("CAPTIONS")),e.backButton.setAttribute("aria-label",e.localization.resolve("BACK")),e.nameSpan.textContent=e.localization.resolve("CAPTIONS"),e.backSpan.textContent=e.localization.resolve("CAPTIONS"),e.a.textContent=e.localization.resolve("OFF")}function th(e){var t=0<e.player.ib().length;Kl(e.button,t),Qd(e)}function nh(){}function ih(e,t,n){this.c=e,this.b=rh(),t.dataset.shakaPlayerContainer="",(t.ui=this).Te()&&t.classList.add("shaka-mobile"),this.a=new Hl(e,t,n,this.b),this.configure({}),n.controls||e.configure("textDisplayFactory",function(){return new qd(n,t)}),t.ui=this,n.ui=this}function rh(){return{controlPanelElements:"time_and_duration spacer mute volume fullscreen overflow_menu".split(" "),overflowMenuButtons:["captions","quality","language","picture_in_picture","cast"],addSeekBar:!0,addBigPlayButton:!0,castReceiverAppId:"",clearBufferOnQualityChange:!0,showUnbufferedStart:!0,seekBarColors:{base:"rgba(255, 255, 255, 0.3)",buffered:"rgba(255, 255, 255, 0.54)",played:"rgb(255, 255, 255)"},volumeBarColors:{base:"rgba(255, 255, 255, 0.54)",level:"rgb(255, 255, 255)"},trackLabelFormat:uh,fadeDelay:0,doubleClickForFullscreen:!0,enableKeyboardPlaybackControls:!0,enableFullscreenOnRotation:!0}}function ah(){return G(function e(){var n,i,r,a,o,s,u;return q(e,function(e){switch(e.o){case 1:if(ju(),!Ls())return X.error("Shaka Player does not support this browser. Please see https://tinyurl.com/y7s4j9tr for the list of supported browsers."),oh("shaka-ui-load-failed"),e.return();if(n=document.querySelectorAll("[data-shaka-player-container]"),!(i=document.querySelectorAll("[data-shaka-player]")).length&&!n.length){e.C(2);break}if(i.length&&!n.length){for(var t=0;t<i.length;t++)(r=i[t]).ui||(a=document.createElement("div"),r.parentElement.replaceChild(a,r),a.appendChild(r),sh(a,r));e.C(2);break}o=0;case 4:if(!(o<n.length)){e.C(2);break}if((s=n[o]).ui){e.C(5);break}for(u=null,t=0;t<i.length;t++)if(i[t].parentElement==s){u=i[t];break}return u||((u=document.createElement("video")).setAttribute("playsinline",""),s.appendChild(u)),V(e,sh(s,u),5);case 5:o++,e.C(4);break;case 2:oh("shaka-ui-loaded"),x(e)}})})}function oh(e){var t=document.createEvent("CustomEvent");t.initCustomEvent(e,!1,!1,null),document.dispatchEvent(t)}function sh(a,o){return G(function e(){var t,n,i,r;return q(e,function(e){switch(e.o){case 1:n=new Ns(o),t=new ih(n,a,o),n="",a.dataset&&a.dataset.shakaPlayerCastReceiverId?n=a.dataset.shakaPlayerCastReceiverId:o.dataset&&o.dataset.shakaPlayerCastReceiverId&&(n=o.dataset.shakaPlayerCastReceiverId),n.length&&t.configure({castReceiverAppId:n}),o.controls&&t.a.tf(!0),(n=o.getAttribute("src"))&&((i=document.createElement("source")).setAttribute("src",n),o.appendChild(i),o.removeAttribute("src")),n=B(o.querySelectorAll("source")),i=n.next();case 2:if(i.done){e.C(0);break}return r=i.value,z(e,5),V(e,t.a.$a().load(r.getAttribute("src")),7);case 7:e.C(0);break;case 5:r=W(e),X.error("Error auto-loading asset",r);case 3:i=n.next(),e.C(2)}})})}v(rd,Ul),_("shaka.ui.SettingsMenu",rd),v(ad,rd),_("shaka.ui.AudioLanguageSelection",ad),ud.prototype.create=function(e,t){return new ad(e,t)},ed("language",new ud),v(cd,Ul),_("shaka.ui.PlayButton",cd),v(hd,cd),_("shaka.ui.BigPlayButton",hd),v(pd,Ul),_("shaka.ui.CastButton",pd),bd.prototype.create=function(e,t){return new pd(e,t)},ed("cast",new bd),v(yd,Ul),_("shaka.ui.FastForwardButton",yd),wd.prototype.create=function(e,t){return new yd(e,t)},ql("fast_forward",new wd),v(Td,Ul),_("shaka.ui.FullscreenButton",Td),Ad.prototype.create=function(e,t){return new Td(e,t)},ql("fullscreen",new Ad),v(Id,Ul),_("shaka.ui.MuteButton",Id),Cd.prototype.create=function(e,t){return new Id(e,t)},ql("mute",new Cd),v(xd,Ul),_("shaka.ui.PipButton",xd),Pd.prototype.create=function(e,t){return new xd(e,t)},ed("picture_in_picture",new Pd),v(Md,Ul),_("shaka.ui.PresentationTimeTracker",Md),Ud.prototype.create=function(e,t){return new Md(e,t)},ql("time_and_duration",new Ud),v(_d,rd),_("shaka.ui.ResolutionSelection",_d),_d.prototype.b=function(e){this.player.configure({abr:{enabled:!1}}),this.player.qf(e,this.controls.g.clearBufferOnQualityChange)},Fd.prototype.create=function(e,t){return new _d(e,t)},ed("quality",new Fd),v(jd,Ul),_("shaka.ui.RewindButton",jd),Bd.prototype.create=function(e,t){return new jd(e,t)},ql("rewind",new Bd),v(Gd,cd),_("shaka.ui.SmallPlayButton",Gd),zd.prototype.create=function(e,t){return new Gd(e,t)},ql("play_pause",new zd),v(Hd,Ul),_("shaka.ui.Spacer",Hd),Wd.prototype.create=function(e,t){return new Hd(e,t)},ql("spacer",new Wd),_("shaka.ui.TextDisplayer",qd),qd.prototype.append=function(e){for(var t={},n=(e=B(e)).next();!n.done;t={cue:t.cue},n=e.next())t.cue=n.value,this.c.some(function(t){return function(e){return un(e,t.cue)}}(t))||this.c.push(t.cue)},qd.prototype.destroy=function(){this.j.removeChild(this.a),this.a=null,this.f=!1,this.c=[],this.g&&this.g.stop(),this.b.clear()},qd.prototype.remove=function(t,n){return!!this.a&&(this.c=this.c.filter(function(e){return e.startTime<t||e.endTime>=n}),Xd(this),!0)},qd.prototype.isTextVisible=function(){return this.f},qd.prototype.setTextVisibility=function(e){this.f=e},v(Jd,rd),_("shaka.ui.TextSelection",Jd),nh.prototype.create=function(e,t){return new Jd(e,t)},ed("captions",new nh),_("shaka.ui.Overlay",ih),ih.prototype.destroy=function(){var t=this;return G(function e(){return q(e,function(e){switch(e.o){case 1:if(t.a)return V(e,t.a.destroy(),3);e.C(2);break;case 3:t.a=null;case 2:if(t.c)return V(e,t.c.destroy(),5);e.C(0);break;case 5:t.c=null,x(e)}})})},ih.prototype.isMobile=ih.prototype.Te=function(){return!!/(?:iPhone|iPad|iPod|Android)/.test(navigator.userAgent)||dt()&&1<navigator.maxTouchPoints},ih.prototype.getConfiguration=function(){var e=rh();return ys(e,this.b,rh(),{},""),e},ih.prototype.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=Es(e,t)),ys(this.b,e,rh(),{},""),this.b.castReceiverAppId&&!this.b.overflowMenuButtons.includes("cast")&&this.b.overflowMenuButtons.push("cast"),this.a.configure(this.b),this.a.dispatchEvent(new D("uiupdated"))},ih.prototype.getPlayer=ih.prototype.$a=function(){return Xn("ui.Overlay.getPlayer()","Please use getControls().getPlayer() instead."),this.a.$a()},ih.prototype.getControls=ih.prototype.Zf=function(){return this.a},ih.prototype.setEnabled=ih.prototype.uh=function(e){this.a.ce(e)};var uh=0,ch=1,lh=2;function dh(e,t){_l.call(this,e,t,["shaka-volume-bar-container"],["shaka-volume-bar"]);var n=this;this.b=this.controls.g,this.eventManager.m(this.video,"volumechange",function(){return hh(n)}),this.eventManager.m(this.localization,"locale-updated",function(){return fh(n)}),this.eventManager.m(this.localization,"locale-changed",function(){return fh(n)}),hh(this),fh(this)}function hh(e){e.video.muted?e.setValue(0):e.setValue(e.video.volume);var t=e.b.volumeBarColors,n=["to right"];n.push(t.level+100*e.getValue()+"%"),n.push(t.base+100*e.getValue()+"%"),n.push(t.base+"100%"),e.container.style.background="linear-gradient("+n.join(",")+")"}function fh(e){e.bar.setAttribute("aria-label",e.localization.resolve("VOLUME"))}function ph(){}_("shaka.ui.TrackLabelFormat",{LANGUAGE:uh,ROLE:ch,LANGUAGE_ROLE:lh}),"complete"==document.readyState?Promise.resolve().then(ah):d.addEventListener("load",ah),v(dh,_l),_("shaka.ui.VolumeBar",dh),dh.prototype.onChange=function(){this.video.volume=this.getValue(),this.video.muted=0==this.video.volume},ph.prototype.create=function(e,t){return new dh(e,t)},ql("volume",new ph)}.call(t,e,e,void 0),"undefined"!=typeof exports)for(var n in t.shaka)exports[n]=t.shaka[n];else"function"==typeof define&&define.amd?define(function(){return t.shaka}):e.shaka=t.shaka}();