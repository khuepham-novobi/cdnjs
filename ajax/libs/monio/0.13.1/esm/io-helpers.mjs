/*! Monio: io-helpers.mjs
    v0.13.1 (c) 2021 Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
import{isPromise}from"./lib/util.mjs";import IO from"./io.mjs";import Maybe from"./maybe.mjs";import Either from"./either.mjs";var returnedValues=new WeakSet;export{applyIO};export{doIO};export{doIOBind};export{filterIOList};export{concatIOList};export{iif};export{elif};export{els};export{iNot};export{iReturn};export{wasReturned};function applyIO(t,e){return IO((()=>t.run(e)))}function doIO(t,...e){return e.length>0?IO((r=>IO.do(t(r,...e)).run(r))):IO.do(t)}function doIOBind(t,e){var r=IO((()=>IO.do(t).run(e)));return(...n)=>n.length>0?IO((()=>IO.do(t(e,...n)).run(e))):r}function filterIOList(t,e){return e.reduce(((e,r)=>e.chain((e=>t(r).map((t=>t?[...e,r]:e))))),IO.of([]))}function concatIOList(t){return t.reduce(((t,e)=>t.map((t=>[...t,e]))),IO.of([]))}function iif(t,e,...r){return IO((n=>liftIO(n,t).chain((function doThens(t){return t?(Array.isArray(e)?e:[e]).reduce(((t,e)=>t.chain((t=>liftIO(n,t).chain((t=>returnedValues.has(t)?IO.of(t):liftIO(n,e)))))),IO.of()).chain((e=>liftIO(n,e).chain((e=>IO.of(returnedValues.has(e)?e:t))))):IO.of(t)})).chain(function doNextElse(t){return e=>!e&&t.length>0?liftIO(n,t[0]).chain(doNextElse(t.slice(1))):IO.of(e)}(r)).run(n)))}function elif(t,e){return iif(t,e)}function els(t){return iif(!0,t)}function iReturn(t){return IO((e=>liftIO(e,t).chain((t=>{var e={returned:t};return returnedValues.add(e),IO.of(e)})).run(e)))}function iNot(t){return IO((e=>liftIO(e,t).chain((t=>IO.of(!t))).run(e)))}function wasReturned(t){return returnedValues.has(t)}function liftIO(t,e){if(e&&"object"==typeof e&&"function"==typeof e.chain){if(IO.is(e))return e;if(Either.Left.is(e)||Maybe.Nothing.is(e)){let t={returned:e};return returnedValues.add(t),IO.of(t)}{let t=e.chain(IO.of);return IO.is(t)?t:IO.of(e)}}return"function"==typeof e?liftIO(t,e(t)):e&&"object"==typeof e&&"function"==typeof e.next?IO.do(e):IO.of(e)}