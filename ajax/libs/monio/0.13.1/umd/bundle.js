/*! Monio: bundle.js
    v0.13.1 (c) 2021 Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
!function UMDBundle(t,n){for(let[e,r,i]of n)"function"==typeof define&&define.amd?(r=Object.keys(r).map((t=>t.replace(/^\.\//,""))),define(e,r,i)):"undefined"!=typeof module&&module.exports?(r=Object.keys(r).map((t=>require(t))),module.exports[e]=i(...r)):(r=Object.values(r).map((n=>t[n])),t[e]=i(...r))}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:new Function("return this")(),[["Nothing",{},function DEF(){"use strict";var t={};let n={};function Nothing(){var n={map:noop,chain:noop,flatMap:noop,bind:noop,ap:noop,concat:noop,_inspect:function _inspect(){return`${n[Symbol.toStringTag]}()`},_is:function _is(n){return n===t},[Symbol.toStringTag]:"Nothing"};return n;function noop(){return n}}return n=Object.assign(Nothing,{of:Nothing,pure:Nothing,unit:Nothing,is:function is(n){return n&&"function"==typeof n._is&&n._is(t)},isEmpty:function isEmpty(t){return null==t}}),n}],["Just",{},function DEF(){"use strict";var t={};let n={};function Just(n){var e={map:function map(t){return Just(t(n))},chain:chain,flatMap:chain,bind:chain,ap:function ap(t){return t.map(n)},concat:function concat(t){return t.map((t=>n.concat(t)))},_inspect:function _inspect(){return`${e[Symbol.toStringTag]}(${_serialize(n)})`},_is:function _is(n){return n===t},[Symbol.toStringTag]:"Just"};return e;function chain(t){return t(n)}function _serialize(t){return"string"==typeof t?`"${t}"`:void 0===t?"":"function"==typeof t?t.name||"anonymous function":t&&"function"==typeof t._inspect?t._inspect():Array.isArray(t)?`[${t.map((t=>null==t?String(t):_serialize(t)))}]`:String(t)}}return n=Object.assign(Just,{of:Just,pure:Just,unit:Just,is:function is(n){return n&&"function"==typeof n._is&&n._is(t)}}),n}],["Maybe",{"./just.js":"Just","./nothing.js":"Nothing"},function DEF(t,n){"use strict";var e={};Object.assign(MaybeJust,t),Object.assign(MaybeNothing,n);let r={};function MaybeJust(t){return Maybe(t)}function MaybeNothing(){return Maybe(n())}function Maybe(n){var r=n,i=MaybeJust.is(r)&&!is(r),o=MaybeNothing.is(r)&&!is(r);i||o?n=i?r.chain((t=>t)):void 0:(r=t(n),i=!0);var u={map:function map(t){return i?Maybe(r.map(t)):u},chain:chain,flatMap:chain,bind:chain,ap:function ap(t){return i?t.map(n):u},concat:function concat(t){return i?t.map((t=>n.concat(t))):u},fold:function fold(t,e){return i?e(n):t(n)},_inspect:function _inspect(){var t=i?r._inspect().match(/^Just\((.*)\)$/)[1]:"";return`${u[Symbol.toStringTag]}(${t})`},_is:function _is(t){return t===e||r._is(t)},get[Symbol.toStringTag](){return`Maybe:${r[Symbol.toStringTag]}`}};return u;function chain(t){return i?r.chain(t):u}}function is(t){return t&&"function"==typeof t._is&&t._is(e)}return r=Object.assign(Maybe,{Just:MaybeJust,Nothing:MaybeNothing,of:Maybe,pure:Maybe,unit:Maybe,is:is,from:function from(t){return MaybeNothing.isEmpty(t)?MaybeNothing():Maybe(t)}}),r}],["MonioUtil",{},function DEF(){"use strict";let t={};function isFunction(t){return t&&"function"==typeof t}function isPromise(t){return t&&"function"==typeof t.then}function curry(t,n=t.length){return function nextCurried(e){return(...r)=>{var i=[...e,...r];return i.length>=n?t(...i):nextCurried(i)}}([])}return t={isFunction:isFunction,isPromise:isPromise,curry:curry},t.isFunction=isFunction,t.isPromise=isPromise,t.curry=curry,t}],["Either",{"./just.js":"Just"},function DEF(t){"use strict";var n={};Left.is=function LeftIs(t){return is(t)&&!t._is_right()},Right.is=function RightIs(t){return is(t)&&t._is_right()};let e={};function Left(t){return LeftOrRight(t,!1)}function Right(t){return LeftOrRight(t,!0)}function LeftOrRight(e,r=!0){var i={map:function map(t){return r?LeftOrRight(t(e),r):i},chain:chain,flatMap:chain,bind:chain,ap:function ap(t){return r?t.map(e):i},concat:function concat(t){return r?t.map((t=>e.concat(t))):i},fold:function fold(t,n){return r?n(e):t(e)},_inspect:function _inspect(){var n=t(e)._inspect().match(/^Just\((.*)\)$/)[1];return`${i[Symbol.toStringTag]}(${n})`},_is:function _is(t){return t===n},_is_right:function _is_right(){return r},get[Symbol.toStringTag](){return"Either:"+(r?"Right":"Left")}};return i;function chain(t){return r?t(e):i}}function is(t){return t&&"function"==typeof t._is&&t._is(n)}return e=Object.assign((function Either(t){return LeftOrRight(t,!0)}),{Left:Left,Right:Right,of:Right,pure:Right,unit:Right,is:is,fromFoldable:function fromFoldable(t){return t.fold(Left,Right)}}),e}],["IO",{"./lib/util.js":"MonioUtil","./either.js":"Either"},function DEF(t,n){"use strict";var{isPromise:e}=t,r={};let i={};function IO(t){var n={map:function map(n){return IO((r=>{var i=t(r);return e(i)?i.then(n):n(i)}))},chain:chain,flatMap:chain,bind:chain,ap:function ap(n){return n.map(t)},concat:function concat(n){return IO((r=>{var i=t(r),o=n.run(r);return e(i)||e(o)?Promise.all([i,o]).then((([t,n])=>t.concat(n))):i.concat(o)}))},run:function run(n){return t(n)},_inspect:function _inspect(){return`${n[Symbol.toStringTag]}(${"function"==typeof t?t.name||"anonymous function":t&&"function"==typeof t._inspect?t._inspect():val})`},_is:function _is(t){return t===r},[Symbol.toStringTag]:"IO"};return n;function chain(n){return IO((r=>{var i=t(r);return e(i)?i.then(n).then((t=>t.run(r))):n(i).run(r)}))}}function processNext(t,r,i,o=!1){return new Promise((async function c(u,a){try{let s=function monadFlatMap(t,n){return t["flatMap"in t?"flatMap":"chain"in t?"chain":"bind"](n)}(e(r)?await r:r,(n=>IO((()=>t(n).then(u,a)))));IO.is(s)?await s.run(i):o&&n.Left.is(s)?a(s):u(s)}catch(t){a(t)}}))}function getIterator(t,n){return"function"==typeof t?t(n):t&&"object"==typeof t&&"function"==typeof t.next?t:void 0}return i=Object.assign(IO,{of:function of(t){return IO((()=>t))},is:function is(t){return t&&"function"==typeof t._is&&t._is(r)},do:function $do(t){return IO((n=>{var r=getIterator(t,n);return async function next(t){var i=r.next(e(t)?await t:t);return(i=e(i)?await i:i).done?i.value:processNext(next,i.value,n,!1)}()}))},doEither:function doEither(t){return IO((r=>{var i=getIterator(t,r);return async function next(t){try{t=e(t)?await t:t;let o=n.Left.is(t)?t.fold((t=>i.throw(t)),(()=>{})):i.next(t);o=e(o)?await o:o;let u=o.done&&e(o.value)?await o.value:o.value;if(o.done){if(n.Left.is(u))throw u;return n.Right.is(u)?u:n.Right(u)}return processNext(next,u,r,!0).catch(next)}catch(t){throw n.Left.is(t)?t:n.Left(t)}}()}))}}),i.RIO=IO,i.Reader=IO,i}],["IOHelpers",{"./lib/util.js":"MonioUtil","./io.js":"IO","./maybe.js":"Maybe","./either.js":"Either"},function DEF(t,n,e,r){"use strict";var{isPromise:i}=t,o=new WeakSet;let u={};function iif(t,e,...r){return n((i=>liftIO(i,t).chain((function doThens(t){return t?(Array.isArray(e)?e:[e]).reduce(((t,e)=>t.chain((t=>liftIO(i,t).chain((t=>o.has(t)?n.of(t):liftIO(i,e)))))),n.of()).chain((e=>liftIO(i,e).chain((e=>n.of(o.has(e)?e:t))))):n.of(t)})).chain(function doNextElse(t){return e=>!e&&t.length>0?liftIO(i,t[0]).chain(doNextElse(t.slice(1))):n.of(e)}(r)).run(i)))}function liftIO(t,i){if(i&&"object"==typeof i&&"function"==typeof i.chain){if(n.is(i))return i;if(r.Left.is(i)||e.Nothing.is(i)){let t={returned:i};return o.add(t),n.of(t)}{let t=i.chain(n.of);return n.is(t)?t:n.of(i)}}return"function"==typeof i?liftIO(t,i(t)):i&&"object"==typeof i&&"function"==typeof i.next?n.do(i):n.of(i)}return u.applyIO=function applyIO(t,e){return n((()=>t.run(e)))},u.doIO=function doIO(t,...e){return e.length>0?n((r=>n.do(t(r,...e)).run(r))):n.do(t)},u.doIOBind=function doIOBind(t,e){var r=n((()=>n.do(t).run(e)));return(...i)=>i.length>0?n((()=>n.do(t(e,...i)).run(e))):r},u.filterIOList=function filterIOList(t,e){return e.reduce(((n,e)=>n.chain((n=>t(e).map((t=>t?[...n,e]:n))))),n.of([]))},u.concatIOList=function concatIOList(t){return t.reduce(((t,n)=>t.map((t=>[...t,n]))),n.of([]))},u.iif=iif,u.elif=function elif(t,n){return iif(t,n)},u.els=function els(t){return iif(!0,t)},u.iNot=function iNot(t){return n((e=>liftIO(e,t).chain((t=>n.of(!t))).run(e)))},u.iReturn=function iReturn(t){return n((e=>liftIO(e,t).chain((t=>{var e={returned:t};return o.add(e),n.of(e)})).run(e)))},u.wasReturned=function wasReturned(t){return o.has(t)},u}],["IOEventStream",{"./lib/util.js":"MonioUtil","./io.js":"IO"},function DEF(t,n){"use strict";var{isFunction:e,curry:r}=t;let i={};function pullFromStreams(t){return t.map((function callIter(n,e){return n&&"function"==typeof n.next?(t[e]=async function getNext(){var r=n.next();try{let i=await r;return t[e]=[e,n,i]}catch(n){return t[e]=null,r}}(),t[e]):n})).filter(Boolean)}function close(...t){return n((()=>Promise.all(t.map((async function closeStream(t){if(t&&"function"==typeof t.return)try{return await t.return()}catch(t){}})))))}function getDeferred(){var t;return{pr:new Promise((n=>t=n)),next:t}}return i=r((function IOEventStream(t,r,i={}){var{bufferSize:o=100,throwBufferOverflow:u=!1,evtOpts:a={}}=i;return n((()=>{var n,i,s=Symbol("force closed"),{pr:f,next:l}=getDeferred(),h=async function*eventStream(){n=[],i=[],e(t.addEventListener)?t.addEventListener(r,handler,a):e(t.addListener)?t.addListener(r,handler):e(t.on)&&t.on(r,handler);try{for(;;){if(0==n.length){let{pr:t,next:e}=getDeferred();n.push(t),i.push(e)}let t=await Promise.race([f,n.shift()]);if(t==s)return;yield t}}finally{e(t.removeEventListener)?t.removeEventListener(r,handler,a):e(t.removeListener)?t.removeListener(r,handler):e(t.off)&&t.off(r,handler),n.length=i.length=0}}(),p=h.return;return h.return=function itReturn(...t){var n=p.apply(h,t);return l(s),h.return=p,n},h;function handler(t){if(i.length>0){i.shift()(t)}else if(n.length<o){let{pr:e,next:r}=getDeferred();n.push(e),r(t)}else if(u){let n=new Error("Event stream buffer overflow");throw n.evt=t,n}}}))})),i.merge=function merge(...t){return n((()=>async function*mergeStreams(){try{for(;;){let n=pullFromStreams(t);if(!(n.length>0))return;try{if(1==n.length){let[e,r,i]=await n[0];if(i.done)return void(t[e]=null);t[e]=r,yield i.value}else{let[e,r,i]=await Promise.race(n);t[e]=null,i.done||(t.push(r),yield i.value)}}catch(t){return Promise.reject(t)}}}finally{await close(t)}}()))},i.zip=function zip(...t){return n((()=>async function*zipStreams(){try{for(;;){let n=pullFromStreams(t);if(!(n.length>0))return;try{let e=(await Promise.all(n)).reduce((function getStreamVals(n,e){var[r,i,o]=e;return o.done?(t[r]=null,n):(t[r]=i,[...n,o.value])}),[]);if(!(e.length>0))return;yield e}catch(t){return Promise.reject(t)}}}finally{await close(...t).run()}}()))},i.close=close,i}],["AsyncEither",{"./lib/util.js":"MonioUtil","./either.js":"Either"},function DEF(t,n){"use strict";var{isPromise:e}=t,r={};let i={};function AsyncRight(t){return AsyncEither(n.Right(t))}function AsyncEither(t){return fromPromise(e(t)?t:n.Left.is(t)?Promise.reject(t):Promise.resolve(t))}function fromPromise(t){t=splitPromise(t);var i={map:function map(n){var handle=t=>{var _doMap=n=>{var r=t.chain(n);return e(r)?splitPromise(r):t._is_right()?r:Promise.reject(r)};return e(n)?n.then(_doMap):_doMap(n)};return AsyncEither(t.then(handle,handle))},chain:chain,flatMap:chain,bind:chain,ap:function ap(n){return n.map(t)},concat:function concat(n){return n.map((n=>t.then((t=>t.concat(n)))))},fold:function fold(n,e){var handle=t=>n=>n.fold((n=>Promise.reject(t(n))),t);return t.then(handle(e),handle(n))},_inspect:function _inspect(){return`${i[Symbol.toStringTag]}(Promise)`},_is:function _is(t){return t===r},[Symbol.toStringTag]:"AsyncEither"};return i;function chain(r){var handle=t=>{var _doChain=e=>{var r=t.chain(e);return is(r)?r.fold((t=>t),(t=>t)):n.is(r)?r.fold((t=>Promise.reject(t)),(t=>t)):r};return e(r)?r.then(_doChain):_doChain(r)};return AsyncEither(t.then(handle,handle))}}function is(t){return t&&"function"==typeof t._is&&t._is(r)}function splitPromise(t){return t.then((t=>n.is(t)?t:n.Right(t)),(t=>Promise.reject(n.is(t)?t:n.Left(t))))}return i=Object.assign(AsyncEither,{Left:function AsyncLeft(t){return AsyncEither(n.Left(t))},Right:AsyncRight,of:AsyncRight,pure:AsyncRight,unit:AsyncRight,is:is,fromFoldable:function fromFoldable(t){return t.fold(AsyncEither.Left,AsyncEither.Right)},fromPromise:fromPromise}),i}],["Monio",{"./just.js":"Just","./nothing.js":"Nothing","./maybe.js":"Maybe","./either.js":"Either","./async-either.js":"AsyncEither","./io.js":"IO","./io-helpers.js":"IOHelpers","./io-event-stream.js":"IOEventStream"},function DEF(t,n,e,r,i,o,u,a){"use strict";let s={};return s.Just=t,s.Nothing=n,s.Maybe=e,s.Either=r,s.AsyncEither=i,s.IO=o,s.Reader=o,s.RIO=o,s.IOHelpers=u,s.IOEventStream=a,s}]]);